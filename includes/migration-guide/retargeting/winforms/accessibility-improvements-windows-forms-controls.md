### <a name="accessibility-improvements-in-windows-forms-controls"></a>Miglioramenti di accessibilità nei controlli Windows Form

|   |   |
|---|---|
|Dettagli|In Windows Form è stato migliorato il funzionamento con le tecnologie di accessibilità per supportare al meglio i clienti Windows Form. Sono incluse le modifiche seguenti:<ul><li>Modifiche per migliorare la visualizzazione durante la modalità a contrasto elevato.</li><li>Modifiche per migliorare l'esperienza di visualizzazione delle proprietà. I miglioramenti di visualizzazione delle proprietà includono:</li><li>Migliori spostamenti tramite tastiera tra le varie finestre di selezione a discesa.</li><li>Riduzione delle tabulazioni non necessarie.</li><li>Segnalazione migliore dei tipi di controllo.</li><li>Comportamento migliorato dell'Assistente vocale.</li><li>Modifiche per implementare pattern di accessibilità dell'interfaccia utente mancanti nei controlli.</li></ul>|
|Suggerimento|<strong>Come accettare o rifiutare queste modifiche</strong>Affinché l'applicazione possa usufruire di queste modifiche, è necessario che sia eseguita in .NET Framework 4.7.1 o versione successiva. L'applicazione può trarre vantaggio da queste modifiche in uno dei modi seguenti:<ul><li>Viene ricompilata per usare .NET Framework 4.7.1. Queste modifiche di accessibilità sono abilitate per impostazione predefinita nelle applicazioni Windows Forms che usano .NET Framework 4.7.1 o versione successiva.</li><li>I comportamenti di accessibilità legacy vengono rifiutati aggiungendo l'[opzione di AppContext](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) seguente alla sezione <code>&lt;runtime&gt;</code> del file app.config e impostandola su <code>false</code>, come illustrato nell'esempio seguente.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Le applicazioni che usano .NET Framework 4.7.1 o versione successiva e che vogliono mantenere il comportamento di accessibilità legacy possono scegliere di usare le funzionalità di accessibilità legacy impostando in modo esplicito questa opzione di AppContext su <code>true</code>. Per una panoramica dell'automazione interfaccia utente, vedere [Panoramica di automazione interfaccia utente](~/docs/framework/ui-automation/ui-automation-overview.md).<strong>Aggiunta di supporto per pattern e proprietà dell'automazione interfaccia utente</strong>I client di accessibilità posso sfruttare la nuova funzionalità di accessibilità WinForms usando i comuni pattern della chiamata descritti pubblicamente. Questi pattern non sono specifici di Windows Form. Ad esempio, i client di accessibilità possono chiamare il metodo QueryInterface nell'interfaccia IAccessible (MAAS) per ottenere un'interfaccia IServiceProvider. Se questa interfaccia è disponibile, i client possono usare il suo metodo QueryService per richiedere un'interfaccia IAccessibleEx. Per altre informazioni, vedere [Using IAccessibleEx from a Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx) (Uso di IAccessibleEx da un client). A partire da .NET Framework 4.7.1, IServiceProvider e [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (dove applicabile) sono disponibili per gli oggetti di accessibilità WinForms. .NET Framework 4.7.1 aggiunge supporto per le proprietà e i pattern dell'automazione interfaccia utente seguenti:<ul><li>I controlli <code>T:System.Windows.Forms.ToolStripSplitButton</code> e <code>T:System.Windows.Forms.ComboBox</code> supportano il [pattern di espansione e comprensione](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Il controllo <code>T:System.Windows.Forms.ToolStripMenuItem</code> ha un valore della proprietà [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) di <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Il controllo <code>T:System.Windows.Forms.ToolStripItem</code> supporta la proprietà [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) e il [pattern di espansione e comprensione](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Il controllo <code>T:System.Windows.Forms.ToolStripDropDownItem</code> supporta <xref:System.Windows.Forms.AccessibleEvents> che indica StateChange e NameChange quando l'elenco a discesa è espanso o compresso.</li><li>Il controllo <code>T:System.Windows.Forms.ToolStripDropDownButton</code> ha un valore della proprietà [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) di <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Il controllo <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> supporta ora il [pattern di attivazione/disattivazione](xref:System.Windows.Automation.TogglePattern).</li><li>I controlli <code>T:System.Windows.Forms.NumericUpDown</code> e <code>T:System.Windows.Forms.DomainUpDown</code> supportano [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) e hanno un valore [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) di <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</li></ul><strong>Miglioramenti al controllo PropertyGrid</strong> .NET Framework 4.7.1 aggiunge i miglioramenti seguenti al controllo PropertyBrowser:<ul><li>Il pulsante <strong>Dettagli</strong> nella finestra di dialogo di errore visualizzata viene immesso un valore non corretto nel controllo <code>T:System.Windows.Forms.PropertyGrid</code> supporta il [pattern di espansione e comprensione](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), le notifiche della modifica di stato e nome e una proprietà [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) con un valore di <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Il riquadro del messaggio visualizzato quando il pulsante <strong>Dettagli</strong> nella finestra di dialogo di errore viene selezionato ora è accessibile tramite tastiera e consente all'Assistente vocale di annunciare il contenuto del messaggio di errore.</li><li>L'oggetto <xref:System.Windows.Forms.AccessibleRole> delle righe nel controllo <code>T:System.Windows.Forms.PropertyGrid</code> è stato modificato da &quot;Riga&quot; a &quot;Cella&quot;. La cella esegue il mapping all'oggetto &quot;DataItem&quot; di ControlType in Automazione interfaccia utente, che consente di supportare tasti di scelta rapida appropriati e annunci dell'Assistente vocale.</li><li>Le righe del controllo <code>T:System.Windows.Forms.PropertyGrid</code> che rappresentano gli elementi dell'intestazione quando il controllo <code>T:System.Windows.Forms.PropertyGrid</code> ha una proprietà <code>P:System.Windows.Forms.PropertySort</code> impostata su <code>F:System.Windows.Forms.PropertySory.Categorized</code> hanno un valore della proprietà [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) di <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></li><li>Le righe del controllo <code>T:System.Windows.Forms.PropertyGrid</code> che rappresentano gli oggetti delle intestazioni quando il controllo <code>T:System.Windows.Forms.PropertyGrid</code> ha una proprietà <code>P:System.Windows.Forms.PropertySort</code> impostata su <code>F:System.Windows.Forms.PropertySory.Categorized</code> supportano il [pattern di espansione e comprensione](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Miglioramento della navigazione tramite tastiera tra griglia e barra degli strumenti superiore. Premendo &quot;MAIUSC+TAB&quot; ora si seleziona il primo pulsante della barra degli strumenti, anziché l'intera barra degli strumenti</li><li>I controlli <code>T:System.Windows.Forms.PropertyGrid</code> visualizzati in modalità a contrasto elevato consentono di disegnare un rettangolo di selezione intorno al pulsante della barra degli strumenti che corrisponde al valore della proprietà <code>P:System.Windows.Forms.PropertySort</code> corrente.</li><li>I controlli <code>T:System.Windows.Forms.PropertyGrid</code> visualizzati in modalità a contrasto elevato e con una proprietà <code>P:System.Windows.Forms.PropertySort</code> impostata su <code>F:System.Windows.Forms.PropertySory.Categorized</code> ora visualizzeranno lo sfondo delle intestazioni di categoria usando un colore a contrasto elevato.</li><li>I controlli <code>T:System.Windows.Forms.PropertyGrid</code> riconoscono meglio la differenza tra gli elementi della barra degli strumenti con stato attivo e gli elementi della barra degli strumenti che indicano il valore corrente della proprietà <code>P:System.Windows.Forms.PropertySort</code>. Questa correzione prevede una modifica del contrasto elevato e una modifica per gli scenari non a contrasto elevato.</li><li>Gli elementi della barra degli strumenti del controllo <code>T:System.Windows.Forms.PropertyGrid</code> che indica il valore corrente della proprietà <code>P:System.Windows.Forms.PropertySort</code> supportano il [pattern di attivazione/disattivazione](xref:System.Windows.Automation.TogglePattern).</li><li>Supporto migliorato dell'Assistente vocale per distinguere l'allineamento selezionato in Selezione allineamento.</li><li>Quando un controllo <code>T:System.Windows.Forms.PropertyGrid</code> vuoto viene visualizzato in un form, ora riceve lo stato attivo nel punto in cui in precedenza non lo avrebbe ricevuto.</li></ul><strong>Uso di colori definiti dal sistema operativo nei temi a contrasto elevato</strong><ul><li>I controlli <code>T:System.Windows.Forms.Button</code> e <code>T:System.Windows.Forms.CheckBox</code> con <code>P:System.Windows.Forms.Control.FlatStyle</code> impostato sul valore predefinito <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType> per lo stile ora usano i colori definiti dal sistema operativo nel tema a contrasto elevato quando selezionato. In precedenza, i colori di sfondo e testo non erano in contrasto e risultavano di difficile lettura.</li><li><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> e <code>T:System.Windows.Forms.GroupBox</code> con <code>P:System.Windows.Forms.Control.Enabled</code> impostato su <em>False</em> usavano un colore ombreggiato per il rendering del testo nei temi a contrasto elevato. Si otteneva così uno scarso contrasto rispetto allo sfondo. Ora questi controlli usano il colore &quot;Testo disattivato&quot; definito dal sistema operativo. Questa correzione si applica ai controlli con la proprietà <code>P:System.Windows.Forms.Control.FlatStyle</code> impostata su un valore diverso da <code>F:System.Windows.Forms.FlatStyle.System</code>. Il rendering di questi ultimi controlli viene eseguito dal sistema operativo.</li><li><code>T:System.Windows.Forms.DataGridView</code> ora esegue il rendering di un rettangolo visibile intorno al contenuto della cella che ha lo stato attivo corrente. In precedenza, non era visibile in alcuni temi a contrasto elevato.</li><li>I controlli <code>T:System.Windows.Forms.ToolStripMenuItem</code> con una proprietà <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> impostata su <em>False</em> ora usano il colore &quot;Testo disattivato&quot; definito dal sistema operativo.</li><li>I controlli <code>T:System.Windows.Forms.ToolStripMenuItem</code> con una proprietà <code>P:System.Windows.Forms.ToolStripItem.Checked</code> impostata su <em>True</em> ora eseguono il rendering del segno di spunta associato usando un colore di sistema di contrasto.  In precedenza, il colore del segno di spunta non era sufficientemente in contrasto e non era visibile in temi a contrasto elevato.</li></ul>NOTA: in Windows10 sono stati modificati i valori per alcuni colori di sistema a contrasto elevato. Il framework di Windows Form Framework si basa sul framework Win32. Per risultati ottimali, eseguire la versione più recente di Windows e accettare le modifiche del sistema operativo più recenti aggiungendo un file app.manifest in un'applicazione di test e rimuovendo il commento dal codice seguente:<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Navigazione tramite tastiera migliorata</strong><ul><li>Quando un controllo <code>T:System.Windows.Forms.ComboBox</code> ha <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> impostato su <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> ed è il primo controllo nell'ordine di tabulazione nel form, ora viene visualizzato un rettangolo di selezione quando il form padre viene aperto tramite la tastiera. Prima di questa modifica, lo stato attivo della tastiera era su questo controllo, ma non veniva eseguito il rendering di un indicatore dello stato attivo.</li></ul><strong>Supporto migliorato di Assistente vocale</strong><ul><li>Il controllo <code>T:System.Windows.Forms.MonthCalendar</code> ha aggiunto supporto per tipi di assistive technology che facilitano l'accesso al controllo. È inclusa la possibilità per Assistente vocale di leggere il valore del controllo, quando in precedenza non era possibile.</li><li>Il controllo <code>T:System.Windows.Forms.CheckedListBox</code> ora invia una notifica all'Assistente vocale quando la proprietà <code>P:System.Windows.Forms.CheckState</code> è stata modificata. In precedenza, l'Assistente vocale non riceveva notifiche e di conseguenza gli utenti non venivano informati dell'aggiornamento di <code>P:System.Windows.Forms.CheckState</code>.</li><li>Il controllo <code>T:System.Windows.Forms.LinkLabel</code> ha modificato il modo di notificare all'Assistente vocale il testo del controllo. In precedenza, l'Assistente vocale annunciava il testo due volte e leggeva i simboli &quot;&amp;&quot; come testo reale anche se non erano visibili a un utente. Il testo duplicato è stato rimosso dagli annunci dell'Assistente vocale, così come i simboli &quot;&amp;&quot; non necessari.</li><li>I tipi di controllo <code>T:System.Windows.Forms.DataGridViewCell</code> ora segnalano correttamente lo stato di sola lettura all'Assistente vocale e ad altri tipi di assistive technology.</li><li>L'Assistente vocale ora può leggere il menu di sistema delle finestre secondarie nelle applicazioni con [interfaccia a documenti multipli](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md).</li><li>Assistente vocale ora può leggere i controlli <code>T:System.Windows.Forms.ToolStripMenuItem</code>con una proprietà <code>P:System.Windows.Forms.ToolStripItem.Enabled</code>impostata su <em>False</em>. In precedenza, l'Assistente vocale non poteva accedere alle voci di menu disabilitate per leggerne il contenuto.</li></ul>|
|Ambito|Principale|
|Versione|4.7.1|
|Tipo|Ridestinazione|
|API interessate|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

