### <a name="accessibility-improvements-in-windows-forms-controls"></a>Miglioramenti all'accessibilità nei controlli Windows Form

|   |   |
|---|---|
|Dettagli|Windows Form è migliorare il funzionamento con le tecnologie di accesso facilitato per un migliore supporto ai clienti di Windows Form. Tra le seguenti modifiche:<ul><li>Modifiche per migliorare la visualizzazione durante la modalità contrasto elevato.</li><li>Modifiche per migliorare l'esperienza di browser di proprietà. Proprietà browser miglioramenti includono:</li><li>Migliori spostamenti tramite tastiera tra le varie finestre di selezione a discesa.</li><li>Ridotto tabulazioni non necessari.</li><li>Segnalazione migliore dei tipi di controllo.</li><li>Comportamento migliorato dell'Assistente vocale.</li><li>Modifiche per implementare modelli di accessibilità dell'interfaccia utente mancante nei controlli.</li></ul>|
|Suggerimento|<strong>Come partecipare o meno queste modifiche</strong>affinché l'applicazione per trarre vantaggio da queste modifiche, è necessario eseguita su .NET Framework 4.7.1 o versione successiva. L'applicazione può trarre vantaggio da queste modifiche in uno dei modi seguenti:<ul><li>Viene ricompilato destinato a .NET Framework 4.7.1. Tali modifiche di accessibilità sono abilitati per impostazione predefinita in applicazioni Windows Form destinate a .NET Framework 4.7.1 o versioni successive.</li><li>Rifiuta esplicitamente i comportamenti di accessibilità legacy aggiungendo quanto segue [AppContext commutatore](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) per il <code>&lt;runtime&gt;</code> sezione del file app. config e impostarlo su <code>false</code>, come illustrato nell'esempio seguente.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Applicazioni destinate a .NET Framework 4.7.1 o versione successiva e si desidera mantenere legacy comportamento accessibilità può optare per l'utilizzo delle funzionalità di accessibilità legacy impostando in modo esplicito questa opzione AppContext su <code>true</code>. Per una panoramica di automazione interfaccia utente, vedere la [Panoramica di automazione dell'interfaccia utente](~/docs/framework/ui-automation/ui-automation-overview.md). <strong>Aggiunta del supporto per pattern di automazione interfaccia utente e proprietà</strong>client di accessibilità per trarre vantaggio dalle nuove funzionalità di accessibilità di Windows Form utilizzando i modelli comuni, descritti pubblicamente chiamata. Questi modelli non sono specifici di Windows Form. Ad esempio, i client di accessibilità possono chiamare il metodo QueryInterface sull'interfaccia IAccessible (MAAS) per ottenere un'interfaccia IServiceProvider. Se questa interfaccia è disponibile, i client possono utilizzare il metodo QueryService per richiedere un'interfaccia IAccessibleEx. Per altre informazioni, vedere [IAccessibleEx utilizzando da un Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx). A partire da .NET Framework 4.7.1, IServiceProvider e [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (dove applicabile) sono disponibili per gli oggetti di accessibilità di Windows Form. .NET Framework 4.7.1 aggiunge il supporto per le proprietà e pattern di automazione interfaccia utente seguenti:<ul><li>Il <code>T:System.Windows.Forms.ToolStripSplitButton</code> e <code>T:System.Windows.Forms.ComboBox</code> controlli supportano il [pattern Espandi/Comprimi](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Il <code>T:System.Windows.Forms.ToolStripMenuItem</code> controllo ha un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) valore della proprietà <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Il <code>T:System.Windows.Forms.ToolStripItem</code> controllo supporta il [nome](xref:System.Windows.Automation.AutomationElement.NameProperty) proprietà e [modello Espandi/Comprimi](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Il <code>T:System.Windows.Forms.ToolStripDropDownItem</code> controllare supporta <xref:System.Windows.Forms.AccessibleEvents> indicante StateChange e NameChange quando elenco a discesa è espansi o compressi.</li><li>Il <code>T:System.Windows.Forms.ToolStripDropDownButton</code> controllo ha un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) valore della proprietà <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Il <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> controllo supporta il [Pattern Toggle](xref:System.Windows.Automation.TogglePattern).</li><li>Il <code>T:System.Windows.Forms.NumericUpDown</code> e <code>T:System.Windows.Forms.DomainUpDown</code> controlli supportano il [nome](xref:System.Windows.Automation.AutomationElement.NameProperty) e un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) di <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</li></ul><strong>Miglioramenti al controllo PropertyGrid</strong>di .NET Framework 4.7.1 aggiunge i seguenti miglioramenti al controllo del Visualizzatore proprietà:<ul><li>Il <strong>dettagli</strong> pulsante nella finestra di dialogo di errore che viene visualizzato quando l'utente immette un valore non corretto nel <code>T:System.Windows.Forms.PropertyGrid</code> controllo supporta il [modello Espandi/Comprimi](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), stato e modifica del nome le notifiche e un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) proprietà con un valore di <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Il messaggio visualizzato quando il <strong>dettagli</strong> pulsante della finestra di dialogo di errore viene espanso è ora accessibile dalla tastiera e consente l'Assistente vocale annunciare il contenuto del messaggio di errore.</li><li>Il <xref:System.Windows.Forms.AccessibleRole> di righe in <code>T:System.Windows.Forms.PropertyGrid</code> controllo sono stati modificati rispetto &quot;riga&quot; al &quot;cella&quot;. La cella viene eseguito il mapping a automazione ControlType &quot;DataItem&quot;, che consente inoltre il supporto appropriato tasti di scelta rapida e annunci Assistente vocale.</li><li>Il <code>T:System.Windows.Forms.PropertyGrid</code> controllare le righe che rappresentano intestazioni quando il <code>T:System.Windows.Forms.PropertyGrid</code> controllo ha un <code>P:System.Windows.Forms.PropertySort</code> impostata su <code>F:System.Windows.Forms.PropertySory.Categorized</code> hanno un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) valore della proprietà <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></li><li>Il <code>T:System.Windows.Forms.PropertyGrid</code> controllare le righe che rappresentano intestazioni quando il <code>T:System.Windows.Forms.PropertyGrid</code> controllo ha un <code>P:System.Windows.Forms.PropertySort</code> impostata su <code>F:System.Windows.Forms.PropertySory.Categorized</code> supportano la [modello Espandi/Comprimi](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Navigazione tramite tastiera maggiore tra la griglia e barra degli strumenti sopra di esso. Premendo &quot;Maiusc + Tab&quot; seleziona il primo pulsante della barra degli strumenti, anziché l'intera barra degli strumenti</li><li><code>T:System.Windows.Forms.PropertyGrid</code> controlli visualizzati in modalità a contrasto elevato verranno Disegna un rettangolo di selezione attorno al pulsante della barra degli strumenti che corrisponde all'oggetto corrente <code>P:System.Windows.Forms.PropertySort</code> valore della proprietà.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> i controlli visualizzati in modalità a contrasto elevato e con un <code>P:System.Windows.Forms.PropertySort</code> impostata su <code>F:System.Windows.Forms.PropertySory.Categorized</code> verrà visualizzato ora lo sfondo delle intestazioni di categoria in un colore contrasto elevato.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> controlli riconosce meglio la differenza tra gli elementi della barra degli strumenti con stato attivo e gli elementi della barra degli strumenti che indicano il valore corrente del <code>P:System.Windows.Forms.PropertySort</code> proprietà. Questa correzione è costituito da una modifica a contrasto elevato e una modifica per gli scenari non - a contrasto elevato.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> gli elementi della barra degli strumenti che indica il valore corrente del controllo il <code>P:System.Windows.Forms.PropertySort</code> supporto della proprietà di [Pattern Toggle](xref:System.Windows.Automation.TogglePattern).</li><li>Supporto migliorato di Assistente vocale per distinguere l'allineamento selezionata nel selettore di allineamento.</li><li>Quando un oggetto vuoto <code>T:System.Windows.Forms.PropertyGrid</code> controllo viene visualizzato in un form, ora riceverà lo stato attivo in cui in precedenza non lo provocherebbe.</li></ul><strong>Utilizzo di colori definiti del sistema operativo dei temi di contrasto elevato</strong><ul><li><code>T:System.Windows.Forms.Button</code> e <code>T:System.Windows.Forms.CheckBox</code> controlla con <code>P:System.Windows.Forms.Control.FlatStyle</code> impostato su <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, vale a dire lo stile predefinito, ora usare colori del sistema operativo-definiti con tema a contrasto elevato quando selezionata. In precedenza, i colori di sfondo e testo non sono stati contrasto e sono difficili da leggere.</li><li><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> e <code>T:System.Windows.Forms.GroupBox</code> con<code>P:System.Windows.Forms.Control.Enabled</code> impostata su <em>false</em>, utilizzato un colore ombreggiato per il rendering del testo dei temi di contrasto elevato, risultante in contrasto con la in background. A questo punto usare questi controlli &quot;testo disabilitato&quot; colore definito dal sistema operativo. Questa correzione si applica ai controlli con <code>P:System.Windows.Forms.Control.FlatStyle</code> proprietà impostata su un valore diverso da <code>F:System.Windows.Forms.FlatStyle.System</code>. I controlli di quest'ultimi vengono visualizzati dal sistema operativo.</li><li><code>T:System.Windows.Forms.DataGridView</code> ora esegue il rendering di un rettangolo visibile intorno al contenuto della cella che ha lo stato attivo corrente. In precedenza, questo non è visibile in determinate temi a contrasto elevato.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> controlli con un <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> impostata su <em>false</em> ora usare i &quot;testo disabilitato&quot; colore definito dal sistema operativo.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> controlli con un <code>P:System.Windows.Forms.ToolStripItem.Checked</code> impostata su <em>true</em> ora esegue il rendering di spunta associato in un colore di sistema a contrasto.  Il colore del segno di spunta non è stato precedentemente contrasto sufficiente e non sono visibili in temi a contrasto elevato.</li></ul>Nota: Windows10 è stato modificato i valori per alcuni colori a contrasto elevato. Windows Form Framework si basa su framework Win32. Per risultati ottimali, eseguire la versione più recente di Windows e optare per le ultime modifiche del sistema operativo mediante l'aggiunta di un file app. manifest in un'applicazione di test e rimuovendo il codice seguente:<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Navigazione tramite tastiera migliorata</strong><ul><li>Quando un <code>T:System.Windows.Forms.ComboBox</code> controllo ha <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> impostato su <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> ed è il primo controllo nella scheda di ordine per il modulo viene ora visualizzato un rettangolo di attivazione quando il form padre viene aperta utilizzando la tastiera. Prima di questa modifica, lo stato attivo è su questo controllo, ma un indicatore di stato attivo non è stato eseguito il rendering.</li></ul><strong>Supporto migliorato di Assistente vocale</strong><ul><li>Il <code>T:System.Windows.Forms.MonthCalendar</code> controllo ha aggiunto il supporto per le tecnologie per l'accesso facilitato accedere al controllo, inclusa la possibilità per Assistente vocale leggere il valore del controllo quando in precedenza non è riuscito.</li><li>Il <code>T:System.Windows.Forms.CheckedListBox</code> controllo Avvisa ora Assistente vocale quando il <code>P:System.Windows.Forms.CheckState</code> proprietà è stata modificata. In precedenza, Assistente vocale non ha ricevuto notifica e di conseguenza gli utenti non informati che la <code>P:System.Windows.Forms.CheckState</code> è stato aggiornato.</li><li>Il <code>T:System.Windows.Forms.LinkLabel</code> controllo ha modificato la modalità di notifica all'Assistente vocale del testo del controllo. In precedenza, l'Assistente vocale ha annunciato il testo due volte e leggere &quot; &amp; &quot; simboli come testo reale anche se non sono visibili a un utente. Il testo duplicato è stato rimosso dagli annunci Assistente vocale, così come non necessari &quot; &amp; &quot; simboli.</li><li>Il <code>T:System.Windows.Forms.DataGridViewCell</code> tipi di controllo ora correttamente lo stato di sola lettura per l'Assistente vocale e altre tecnologie per l'accesso facilitato di report.</li><li>Assistente vocale è ora in grado di leggere il Menu di sistema delle finestre figlio nella [Multiple-Document Interface](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) applicazioni.</li><li>Assistente vocale è ora in grado di leggere <code>T:System.Windows.Forms.ToolStripMenuItem</code> controlli con un <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> impostata su <em>false</em>. In precedenza, l'Assistente vocale non è riuscito a concentrarsi sulle voci di menu disabilitata per leggere il contenuto.</li></ul>|
|Ambito|Principale|
|Versione|4.7.1|
|Tipo|Ridestinazione|
|API interessate|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

