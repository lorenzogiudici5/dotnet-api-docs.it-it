### <a name="new-64-bit-jit-compiler-in-the-net-framework-46"></a>Nuovo compilatore JIT a 64 bit in .NET Framework 4.6

|   |   |
|---|---|
|Dettagli|A partire da .NET Framework 4.6, viene usato un nuovo compilatore JIT a 64 bit per la compilazione JIT. In alcuni casi, viene generata un'eccezione imprevista o venga rispettato un comportamento diverso rispetto a se un'app viene eseguita tramite il compilatore a 32 bit o il compilatore JIT a 64 bit meno recente. Questa modifica non influenza il compilatore JIT a 32 bit. La nota differenze includono quanto segue:<ul><li>In determinate condizioni, un'operazione di conversione unboxing può generare <xref:System.NullReferenceException> nelle build di rilascio con l'ottimizzazione attivata.</li><li>In alcuni casi l'esecuzione del codice di produzione in un corpo del metodo di grandi dimensioni può generare <xref:System.StackOverflowException>.</li><li>In determinate condizioni, strutture passate a un metodo vengono considerate come tipi di riferimento piuttosto che come valore compila i tipi nella versione. Una delle manifestazioni di questo problema è che i singoli elementi in una raccolta vengono visualizzati in un ordine imprevisto.</li><li>In determinate condizioni, il confronto dei valori di <xref:System.UInt16> con il set di bit elevato non è corretto se l'ottimizzazione è abilitata.</li><li>In determinate condizioni, in particolare durante l'inizializzazione dei valori della matrice, è possibile che l'inizializzazione della memoria con l'istruzione IL <xref:System.Reflection.Emit.OpCodes.Initblk?displayProperty=nameWithType> venga eseguita con un valore non corretto. Ciò può generare un'eccezione non gestita o un output non corretto.</li><li>In alcuni casi rari, un test condizionale dei bit può restituire il valore <xref:System.Boolean> non corretto o generare un'eccezione se sono abilitate le ottimizzazioni del compilatore.</li><li>In determinate condizioni, se un'istruzione <code>if</code> viene usata per testare una condizione prima di immettere un blocco <code>try</code> e in uscita dal blocco <code>try</code>, e la stessa condizione viene valutata nel blocco <code>catch</code> o <code>finally</code>, il nuovo compilatore JIT a 64 bit rimuove la condizione <code>if</code> dal blocco <code>catch</code> o <code>finally</code> quando ottimizza il codice. Di conseguenza, il codice contenuto nell'istruzione <code>if</code> nel blocco <code>catch</code> o <code>finally</code> viene eseguita in modo non condizionale.</li></ul>|
|Suggerimento|<strong>Prevenzione dei problemi noti</strong> se si verificano i problemi elencati in precedenza, è possibile risolvere questi problemi effettuando una delle operazioni seguenti:<ul><li>Eseguire l'aggiornamento a .NET Framework 4.6.2. Il nuovo compilatore a 64 bit incluso in .NET Framework 4.6.2 risolve tutti questi problemi noti.</li><li>Assicurarsi che la versione di Windows venga aggiornata tramite l'esecuzione di Windows Update. Gli aggiornamenti dei servizi per .NET Framework 4.6 e 4.6.1 risolvono tutti questi problemi, ad eccezione di <xref:System.NullReferenceException> in un'operazione di conversione unboxing.</li><li>Eseguire la compilazione con la versione precedente del compilatore JIT a 64 bit. Vedere la sezione <strong>Mitigazione di altri problemi</strong> per altre informazioni su come eseguire questa operazione.</li></ul><strong>Attenuazione di altri problemi</strong> se si verifica qualsiasi altra differenza nel comportamento tra codice compilato con il compilatore a 64 bit precedente e il nuovo compilatore JIT a 64 bit o tra versioni di debug e rilascio dell'app che sono entrambi compilati con la nuova compilatore JIT a 64 bit, è possibile eseguire il comando seguente per compilare l'app con il compilatore JIT a 64 bit precedente:<ul><li>In base all'applicazione, è possibile aggiungere l'elemento [\<useLegacyJit>](~/docs/framework/configure-apps/file-schema/runtime/uselegacyjit-element.md) al file di configurazione dell'applicazione. Le operazioni seguenti consentono di disattivare la compilazione con il nuovo compilatore JIT a 64 bit e usare invece il compilatore JIT a 64 bit legacy.</li></ul><pre><code class="language-xml">&lt;?xml version =&quot;1.0&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;useLegacyJit enabled=&quot;1&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><ul><li>Per ogni utente è possibile aggiungere un valore <code>REG_DWORD</code> denominato <code>useLegacyJit</code> per la chiave <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework</code> del Registro di sistema. Il valore 1 abilita il compilatore JIT a 64 bit legacy, mentre il valore 0 lo disattiva e consente di abilitare il nuovo compilatore JIT a 64 bit.</li><li>Per ogni macchina è possibile aggiungere un valore <code>REG_DWORD</code> denominato <code>useLegacyJit</code> per la chiave <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework</code> del Registro di sistema. Il valore <code>1</code> compilatore JIT consente il legacy a 64 bit, il valore <code>0</code> lo disabilita e abilita il nuovo compilatore JIT a 64 bit.</li></ul>È possibile inoltre inviare i dettagli sul problema segnalando un bug in [Microsoft Connect](https://connect.microsoft.com/VisualStudio).|
|Ambito|Microsoft Edge|
|Versione|4.6|
|Tipo|Ridestinazione|

