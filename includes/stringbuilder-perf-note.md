<span data-ttu-id="e23d8-101">L'uso dell'indicizzazione basata sui caratteri con la proprietà <xref:System.Text.StringBuilder.Chars%2A> può essere lentissimo nelle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e23d8-101">Using character-based indexing with the <xref:System.Text.StringBuilder.Chars%2A> property can be extremely slow under the following conditions:</span></span>

- <span data-ttu-id="e23d8-102">L'istanza <xref:System.Text.StringBuilder> è di grandi dimensioni (ad esempio, è costituita da diverse decine di migliaia di caratteri).</span><span class="sxs-lookup"><span data-stu-id="e23d8-102">The <xref:System.Text.StringBuilder> instance is large (for example, it consists of several tens of thousands of characters).</span></span>
- <span data-ttu-id="e23d8-103"><xref:System.Text.StringBuilder> è "pesante".</span><span class="sxs-lookup"><span data-stu-id="e23d8-103">The <xref:System.Text.StringBuilder> is "chunky."</span></span> <span data-ttu-id="e23d8-104">Ovvero, le chiamate ripetute ai metodi, ad esempio <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType>, hanno automaticamente espanso la proprietà <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> dell'oggetto e allocato nuovi blocchi di memoria alla stessa.</span><span class="sxs-lookup"><span data-stu-id="e23d8-104">That is, repeated calls to methods such as <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> have automatically expanded the object's <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> property and allocated new chunks of memory to it.</span></span>

<span data-ttu-id="e23d8-105">L'impatto sulle prestazioni è notevole poiché ogni accesso ai caratteri scorre l'intero elenco di blocchi collegato per trovare il buffer corretto in cui eseguire l'indicizzazione.</span><span class="sxs-lookup"><span data-stu-id="e23d8-105">Performance is severely impacted because each character access walks the entire linked list of chunks to find the correct buffer to index into.</span></span>

> [!NOTE]
>  <span data-ttu-id="e23d8-106">Nel caso di un oggetto <xref:System.Text.StringBuilder> "pesante" e di grandi dimensioni, usare la proprietà <xref:System.Text.StringBuilder.Chars%2A> per eseguire l'accesso basato su indice a uno o un numero limitato di caratteri ha un impatto trascurabile sulle prestazioni, in genere è un'operazione **0(n)**.</span><span class="sxs-lookup"><span data-stu-id="e23d8-106">Even for a large "chunky" <xref:System.Text.StringBuilder> object, using the <xref:System.Text.StringBuilder.Chars%2A> property for index-based access to one or a small number of characters has a negligible performance impact; typically, it is an **0(n)** operation.</span></span> <span data-ttu-id="e23d8-107">L'impatto significativo sulle prestazioni si verifica durante l'iterazione dei caratteri nell'oggetto <xref:System.Text.StringBuilder>, che è un'operazione **O(n^2)**.</span><span class="sxs-lookup"><span data-stu-id="e23d8-107">The significant performance impact occurs when iterating the characters in the <xref:System.Text.StringBuilder> object, which is an **O(n^2)** operation.</span></span> 

<span data-ttu-id="e23d8-108">Se si verificano problemi di prestazioni quando si usa l'indicizzazione basata su caratteri con gli oggetti <xref:System.Text.StringBuilder>, è possibile adottare una delle seguenti soluzioni alternative:</span><span class="sxs-lookup"><span data-stu-id="e23d8-108">If you encounter performance issues when using character-based indexing with <xref:System.Text.StringBuilder> objects, you can use any of the following workarounds:</span></span>

- <span data-ttu-id="e23d8-109">Convertire l'istanza <xref:System.Text.StringBuilder> in un <xref:System.String> chiamando il metodo <xref:System.Text.StringBuilder.ToString%2A>, quindi accedere ai caratteri nella stringa.</span><span class="sxs-lookup"><span data-stu-id="e23d8-109">Convert the <xref:System.Text.StringBuilder> instance to a <xref:System.String> by calling the <xref:System.Text.StringBuilder.ToString%2A> method, then access the characters in the string.</span></span>

- <span data-ttu-id="e23d8-110">Copiare il contenuto dell'oggetto <xref:System.Text.StringBuilder> esistente in un nuovo oggetto <xref:System.Text.StringBuilder> con dimensioni preimpostate.</span><span class="sxs-lookup"><span data-stu-id="e23d8-110">Copy the contents of the existing <xref:System.Text.StringBuilder> object to a new pre-sized <xref:System.Text.StringBuilder> object.</span></span> <span data-ttu-id="e23d8-111">Le prestazioni migliorano perché il nuovo oggetto <xref:System.Text.StringBuilder> non è pesante.</span><span class="sxs-lookup"><span data-stu-id="e23d8-111">Performance improves because the new <xref:System.Text.StringBuilder> object is not chunky.</span></span> <span data-ttu-id="e23d8-112">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="e23d8-112">For example:</span></span>

   ```csharp
   // sbOriginal is the existing StringBuilder object
   var sbNew = new StringBuilder(sbOriginal.ToString(), sbOriginal.Length);
   ```
   ```vb
   ' sbOriginal is the existing StringBuilder object
   Dim sbNew = New StringBuilder(sbOriginal.ToString(), sbOriginal.Length)
   ```
- <span data-ttu-id="e23d8-113">Impostare la capacità iniziale dell'oggetto <xref:System.Text.StringBuilder> su un valore approssimativamente uguale alle dimensioni massime previste chiamando il costruttore <xref:System.Text.StringBuilder.%23ctor(System.Int32)>.</span><span class="sxs-lookup"><span data-stu-id="e23d8-113">Set the initial capacity of the <xref:System.Text.StringBuilder> object to a value that is approximately equal to its maximum expected size by calling the <xref:System.Text.StringBuilder.%23ctor(System.Int32)> constructor.</span></span> <span data-ttu-id="e23d8-114">Si noti che in questo modo viene allocato l'intero di memoria anche se <xref:System.Text.StringBuilder> raramente raggiunge la capacità massima.</span><span class="sxs-lookup"><span data-stu-id="e23d8-114">Note that this allocates the entire block of memory even if the <xref:System.Text.StringBuilder> rarely reaches its maximum capacity.</span></span>
