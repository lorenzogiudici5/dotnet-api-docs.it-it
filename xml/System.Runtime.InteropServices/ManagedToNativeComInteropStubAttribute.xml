<Type Name="ManagedToNativeComInteropStubAttribute" FullName="System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="3c43f21310b8a2ad71fde9b4218d5c67801eec44" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="it-IT" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
    <Meta Name="ms.locfileid" Value="30479055" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class ManagedToNativeComInteropStubAttribute : Attribute" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ManagedToNativeComInteropStubAttribute extends System.Attribute" />
  <TypeSignature Language="DocId" Value="T:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class ManagedToNativeComInteropStubAttribute&#xA;Inherits Attribute" />
  <TypeSignature Language="C++ CLI" Value="public ref class ManagedToNativeComInteropStubAttribute sealed : Attribute" />
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Runtime.InteropServices</AssemblyName>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Attribute</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.AttributeUsage(System.AttributeTargets.Method, AllowMultiple=false, Inherited=false)</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>Fornisce supporto per la personalizzazione dell'utente di stub di interoperabilità negli scenari di interoperabilità da gestito a COM.</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 Questo attributo consente agli sviluppatori di interoperabilità che contengono informazioni sul marshalling e il funzionamento interno chiamate di interoperabilità per effettuare le operazioni seguenti:  
  
-   Sfruttare gli stub di interoperabilità personalizzati in fase di compilazione anziché fase di esecuzione.  
  
-   Eseguire il debug di stub di interoperabilità personalizzato.  
  
-   Fornire all'interno di uno stub che il runtime non fornisce funzionalità di marshalling.  
  
-   Forniscono funzionalità di invio del metodo specifico dell'utente.  
  
 Si applica l'attributo su un metodo in un'interfaccia per specificare il metodo stub corrispondente per l'interoperabilità COM gestito a codice nativo.  
  
 Se questo attributo viene rilevato durante la fase di esecuzione, common language runtime non genera in modo dinamico uno stub di interoperabilità. Al contrario, viene richiamato lo stub personalizzato creato in fase di compilazione.  
  
 Il <xref:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute> presenta le caratteristiche seguenti:  
  
-   L'attributo può essere utilizzato solo in metodi dalle interfacce contrassegnate `[ComImport]`. Se l'attributo viene applicato a tipi non di interfaccia, viene ignorato dal runtime.  
  
-   L'attributo può essere utilizzato solo una volta sullo stesso metodo in un'interfaccia. Se viene utilizzata più volte, il compilatore genera un errore dell'attributo duplicato.  
  
-   L'attributo non è ereditabile da un'interfaccia base. Le interfacce derivate devono assegnare in modo esplicito l'attributo.  
  
-   L'assembly che contiene il metodo con attributi deve inoltre contenere lo stub personalizzato.  
  
 Metodi di overload stub sono validi. Anche se si specifica solo il tipo e il nome del metodo stub, il runtime consente di individuare lo stub corrispondente. Ciò avviene esaminando tutti gli argomenti di metodo di interfaccia e quindi eseguendo la firma completa con un'esplicita `this` puntatore.  
  
 È anche possibile chiamare i metodi più in un'interfaccia per condividere lo stesso metodo stub; Tuttavia, è opportuno prestare attenzione quando si utilizzano gli stub condivisi.  
  
> [!NOTE]
>  I metodi stub devono essere statici.  
  
 È possibile informare il runtime per l'utilizzo di uno stub di interoperabilità personalizzato in fase di compilazione anziché fase di esecuzione con il codice c# seguente:  
  
```  
[ComImport]  
interface IMyInterface  
{  
    [ManagedToNativeComInteropStubAttribute(typeof(TestStubClass),  
              "ForwardTestStub")]  
    void GetString (string arg);  
}  
```  
  
 È quindi possibile utilizzare il codice seguente per dichiarare il metodo stub corrispondente:  
  
```  
class TestStubClass  
{  
    internal static void ForwardTestStub(IMyInterface thisObject,  
             string arg) {…}  
}  
```  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ManagedToNativeComInteropStubAttribute (Type classType, string methodName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Type classType, string methodName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute.#ctor(System.Type,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (classType As Type, methodName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; ManagedToNativeComInteropStubAttribute(Type ^ classType, System::String ^ methodName);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Runtime.InteropServices</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="classType" Type="System.Type" />
        <Parameter Name="methodName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="classType">Classe che contiene il metodo stub richiesto.</param>
        <param name="methodName">Nome del metodo stub.</param>
        <summary>Inizializza una nuova istanza della classe <see cref="T:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute" /> con il nome di metodo e il tipo di classe specificati.</summary>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException">
          Non è possibile trovare l'oggetto <paramref name="methodName" />.  
  
 oppure  
  
 Il metodo non è statico o non generico.  
  
 oppure  
  
 L'elenco di parametri del metodo non corrisponde all'elenco di parametri previsto per lo stub.</exception>
        <exception cref="T:System.MethodAccessException">L'interfaccia che contiene il metodo di interoperabilità gestito non dispone di accesso al metodo stub, perché tale metodo dispone dell'accessibilità privata o protetta, o a causa di un problema di sicurezza.</exception>
      </Docs>
    </Member>
    <Member MemberName="ClassType">
      <MemberSignature Language="C#" Value="public Type ClassType { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Type ClassType" />
      <MemberSignature Language="DocId" Value="P:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute.ClassType" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ClassType As Type" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Type ^ ClassType { Type ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Runtime.InteropServices</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Type</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Ottiene la classe che contiene il metodo stub richiesto.</summary>
        <value>Classe che contiene lo stub di interoperabilità personalizzato.</value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="MethodName">
      <MemberSignature Language="C#" Value="public string MethodName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MethodName" />
      <MemberSignature Language="DocId" Value="P:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute.MethodName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property MethodName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MethodName { System::String ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Runtime.InteropServices</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Ottiene il nome del metodo stub.</summary>
        <value>Nome di uno stub di interoperabilità personalizzato.</value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
  </Members>
</Type>