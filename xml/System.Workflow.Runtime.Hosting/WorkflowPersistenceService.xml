<Type Name="WorkflowPersistenceService" FullName="System.Workflow.Runtime.Hosting.WorkflowPersistenceService">
  <TypeSignature Language="C#" Value="public abstract class WorkflowPersistenceService : System.Workflow.Runtime.Hosting.WorkflowRuntimeService" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi abstract beforefieldinit WorkflowPersistenceService extends System.Workflow.Runtime.Hosting.WorkflowRuntimeService" />
  <TypeSignature Language="DocId" Value="T:System.Workflow.Runtime.Hosting.WorkflowPersistenceService" />
  <TypeSignature Language="VB.NET" Value="Public MustInherit Class WorkflowPersistenceService&#xA;Inherits WorkflowRuntimeService" />
  <TypeSignature Language="C++ CLI" Value="public ref class WorkflowPersistenceService abstract : System::Workflow::Runtime::Hosting::WorkflowRuntimeService" />
  <AssemblyInfo>
    <AssemblyName>System.Workflow.Runtime</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Workflow.Runtime.Hosting.WorkflowRuntimeService</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.Obsolete("The System.Workflow.* types are deprecated.  Instead, please use the new types from System.Activities.*")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="b0977-101">Le classe di base astratta dalla quale vengono derivati tutti i servizi di persistenza.</span><span class="sxs-lookup"><span data-stu-id="b0977-101">The abstract base class from which all persistence services are derived.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!NOTE]
>  [!INCLUDE[DeprecatedContent](~/includes/deprecatedcontent-md.md)]  
  
 <span data-ttu-id="b0977-102">Quando si verificano determinate condizioni mentre il flusso di lavoro è in esecuzione, il motore di runtime del flusso di lavoro imposta come persistenti le informazioni sullo stato relative all'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-102">When certain conditions occur while the workflow is running, the workflow runtime engine persists state information about the workflow instance.</span></span> <span data-ttu-id="b0977-103">Può verificarsi la persistenza, ad esempio, quando finisce una transazione atomica, quando l'istanza del flusso di lavoro diventa inattiva, quando l'host chiama <xref:System.Workflow.Runtime.WorkflowInstance.Unload%2A?displayProperty=nameWithType> sull'istanza del flusso di lavoro o quando un'istanza del flusso di lavoro viene terminata o si conclude.</span><span class="sxs-lookup"><span data-stu-id="b0977-103">Persistence can occur, for example, when an atomic transaction finishes, when the workflow instance becomes idle, when the host calls <xref:System.Workflow.Runtime.WorkflowInstance.Unload%2A?displayProperty=nameWithType> on the workflow instance, or when a workflow instance is terminated or finishes.</span></span> <span data-ttu-id="b0977-104">Quando la semantica del motore di runtime del flusso di lavoro stabilisce che si verifichi la persistenza, il motore di runtime del flusso di lavoro chiama i metodi forniti da un servizio di persistenza per salvare le informazioni sullo stato relative all'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-104">When the workflow runtime engine semantics dictate that persistence should occur, the workflow runtime engine calls methods that are supplied by a persistence service to save state information about the workflow instance.</span></span> <span data-ttu-id="b0977-105">Analogamente, quando il motore di runtime del flusso di lavoro deve ripristinare un'istanza del flusso di lavoro precedentemente impostata come persistente, chiama i metodi forniti da un servizio di persistenza per caricare queste informazioni sullo stato.</span><span class="sxs-lookup"><span data-stu-id="b0977-105">Likewise, when the workflow runtime engine needs to restore a previously persisted workflow instance, it calls methods that are supplied by the persistence service to load this state information.</span></span> <span data-ttu-id="b0977-106">Il motore di runtime del flusso di lavoro gestisce tutta la semantica che definisce quando eseguire la persistenza.</span><span class="sxs-lookup"><span data-stu-id="b0977-106">The workflow runtime engine handles all the semantics regarding when to perform persistence.</span></span> <span data-ttu-id="b0977-107">Il servizio di persistenza gestisce le operazioni di salvataggio e caricamento delle informazioni sullo stato del flusso di lavoro da o verso un archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-107">The persistence service handles actually saving and loading the workflow state information to or from a data store.</span></span>  
  
 <span data-ttu-id="b0977-108">È possibile creare un servizio di persistenza derivando una classe dalla classe <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService>.</span><span class="sxs-lookup"><span data-stu-id="b0977-108">You can create a persistence service by deriving a class from the <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService> class.</span></span>  <span data-ttu-id="b0977-109">È possibile aggiungere il servizio di persistenza al motore di runtime del flusso di lavoro chiamando <xref:System.Workflow.Runtime.WorkflowRuntime.AddService%2A> o creando una voce adatta nel file di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b0977-109">You can add your persistence service to the workflow runtime engine by calling <xref:System.Workflow.Runtime.WorkflowRuntime.AddService%2A> or by making an appropriate entry in the application configuration file.</span></span> <span data-ttu-id="b0977-110"><xref:System.Workflow.Runtime.WorkflowRuntime> deve contenere solo un servizio di persistenza.</span><span class="sxs-lookup"><span data-stu-id="b0977-110">The <xref:System.Workflow.Runtime.WorkflowRuntime> should only contain one persistence service.</span></span> <span data-ttu-id="b0977-111">In Windows Workflow Foundation è disponibile la classe <xref:System.Workflow.Runtime.Hosting.SqlWorkflowPersistenceService>, un servizio di persistenza predefinito che può essere utilizzato direttamente o dopo essere stato esteso.</span><span class="sxs-lookup"><span data-stu-id="b0977-111">Windows Workflow Foundation provides the <xref:System.Workflow.Runtime.Hosting.SqlWorkflowPersistenceService> class, an out-of-box persistence service, which you can use as is or extend.</span></span>  
  
 <span data-ttu-id="b0977-112">Il motore di runtime del flusso di lavoro dispone della semantica necessaria per bloccare le informazioni sullo stato del flusso di lavoro negli ambienti in cui i servizi di persistenza che sono in esecuzione in processi diversi possono avere accesso a un solo archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-112">The workflow runtime engine has semantics for locking workflow state information for use in environments where persistence services that run in different processes might have access to a single data store.</span></span> <span data-ttu-id="b0977-113">La classe <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService> fornisce le capacità necessarie per supportare questa funzionalità del motore di runtime del flusso di lavoro fornendo un parametro a <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A> che specifica se le informazioni sullo stato di un'istanza del flusso di lavoro devono essere sbloccate nell'archivio dati, e fornendo un metodo <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.UnlockWorkflowInstanceState%2A> per sbloccare informazioni sullo stato del flusso di lavoro precedentemente bloccate.</span><span class="sxs-lookup"><span data-stu-id="b0977-113">The <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService> class provides the capability to support this functionality of the workflow runtime engine by providing a parameter to <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A> that specifies whether the state information of a workflow instance should be unlocked in the data store, and by providing a method <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.UnlockWorkflowInstanceState%2A> to unlock previously locked workflow state information.</span></span> <span data-ttu-id="b0977-114">In un servizio di persistenza che implementa il blocco, una chiamata a <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadWorkflowInstanceState%2A> deve bloccare le informazioni sullo stato per un'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-114">In a persistence service that implements locking, a call to <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadWorkflowInstanceState%2A> should lock the state information for a workflow instance.</span></span>  
  
 <span data-ttu-id="b0977-115">Il servizio di persistenza deve generare un'eccezione <xref:System.Workflow.Runtime.Hosting.PersistenceException> se non riesce a salvare informazioni sullo stato nell'archivio dati o a caricare informazioni sullo stato dall'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-115">Your persistence service should throw a <xref:System.Workflow.Runtime.Hosting.PersistenceException> if it fails to save state information to its data store or load state information from its data store.</span></span> <span data-ttu-id="b0977-116">Questo è il comportamento previsto dal motore di runtime del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-116">The workflow runtime engine expects this behavior.</span></span>  
  
 <span data-ttu-id="b0977-117">Un meccanismo di inclusione in batch è disponibile per i servizi che utilizzano un archivio durevole per salvare le informazioni sullo stato del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-117">A batching mechanism is provided for services that use a durable store to save workflow state information.</span></span> <span data-ttu-id="b0977-118">È importante in questi casi mantenere la coerenza tra l'archivio durevole utilizzato dal servizio di persistenza e lo stato interno del motore di runtime del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-118">It is important in these cases to maintain consistency between the durable store that is used by the persistence service and the internal state of the workflow runtime engine.</span></span> <span data-ttu-id="b0977-119">È possibile aggiungere la funzionalità definita dall'interfaccia <xref:System.Workflow.Runtime.IPendingWork> al servizio e quindi partecipare all'inclusione in batch delle transazioni del flusso di lavoro fornita da <xref:System.Workflow.Runtime.Hosting.WorkflowCommitWorkBatchService> aggiungendo modifiche all'archivio dati come elementi di lavoro in <xref:System.Workflow.Runtime.WorkflowEnvironment.WorkBatch%2A>.</span><span class="sxs-lookup"><span data-stu-id="b0977-119">You can add functionality defined by the <xref:System.Workflow.Runtime.IPendingWork> interface to your service, and then participate in workflow transaction batching provided by the <xref:System.Workflow.Runtime.Hosting.WorkflowCommitWorkBatchService> by adding changes to your data store as work items to the <xref:System.Workflow.Runtime.WorkflowEnvironment.WorkBatch%2A>.</span></span> <span data-ttu-id="b0977-120">Anche l'archivio durevole deve implementare l'interfaccia <xref:System.Transactions.IEnlistmentNotification>, in modo che le informazioni del flusso di lavoro non vengano erroneamente rese persistenti nel caso di un rollback della transazione.</span><span class="sxs-lookup"><span data-stu-id="b0977-120">The durable store itself should implement the <xref:System.Transactions.IEnlistmentNotification> interface, so that workflow information is not persisted incorrectly in the event of a transaction rollback.</span></span> <span data-ttu-id="b0977-121">Per altre informazioni, vedere <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveCompletedContextActivity%2A> o <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A>.</span><span class="sxs-lookup"><span data-stu-id="b0977-121">For more information, see <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveCompletedContextActivity%2A> or <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A>.</span></span>  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="protected WorkflowPersistenceService ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.#ctor" />
      <MemberSignature Language="VB.NET" Value="Protected Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; WorkflowPersistenceService();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="b0977-122">Quando viene implementato in una classe derivata, inizializza una nuova istanza della classe <see cref="T:System.Workflow.Runtime.Hosting.WorkflowPersistenceService" />.</span><span class="sxs-lookup"><span data-stu-id="b0977-122">When implemented in a derived class, initializes a new instance of the <see cref="T:System.Workflow.Runtime.Hosting.WorkflowPersistenceService" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="b0977-123">Nell'esempio seguente viene illustrato come creare un'istanza della classe `SqlWorkflowPersistenceService` (derivata da `WorkflowPersistenceService`).</span><span class="sxs-lookup"><span data-stu-id="b0977-123">The following example demonstrates creating an instance of the `SqlWorkflowPersistenceService` class (derived from `WorkflowPersistenceService`).</span></span> <span data-ttu-id="b0977-124">Questo esempio è tratto dall'esempio SDK Nested Exception Handlers, dalla classe Program.cs.</span><span class="sxs-lookup"><span data-stu-id="b0977-124">This example is from the Nested Exception Handlers SDK sample, from the Program.cs class.</span></span>  <span data-ttu-id="b0977-125">Per ulteriori informazioni, vedere il [annidati esempio gestori di eccezioni](http://msdn.microsoft.com/library/d1da0209-842b-41c8-9b7c-0cbaa1034265).</span><span class="sxs-lookup"><span data-stu-id="b0977-125">For more information, see the [Nested Exception Handlers Sample](http://msdn.microsoft.com/library/d1da0209-842b-41c8-9b7c-0cbaa1034265).</span></span>  
  
 [!code-csharp[WF_Samples#161](~/samples/snippets/csharp/VS_Snippets_CFX/wf_samples/cs/snippets11.cs#161)]
 [!code-vb[WF_Samples#161](~/samples/snippets/visualbasic/VS_Snippets_CFX/wf_samples/vb/snippets11.vb#161)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="GetDefaultSerializedForm">
      <MemberSignature Language="C#" Value="protected static byte[] GetDefaultSerializedForm (System.Workflow.ComponentModel.Activity activity);" />
      <MemberSignature Language="ILAsm" Value=".method familystatic hidebysig unsigned int8[] GetDefaultSerializedForm(class System.Workflow.ComponentModel.Activity activity) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.GetDefaultSerializedForm(System.Workflow.ComponentModel.Activity)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; static cli::array &lt;System::Byte&gt; ^ GetDefaultSerializedForm(System::Workflow::ComponentModel::Activity ^ activity);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Byte[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="activity" Type="System.Workflow.ComponentModel.Activity" />
      </Parameters>
      <Docs>
        <param name="activity"><span data-ttu-id="b0977-126"><see cref="T:System.Workflow.ComponentModel.Activity" /> di cui è richiesto il form serializzato.</span><span class="sxs-lookup"><span data-stu-id="b0977-126">The <see cref="T:System.Workflow.ComponentModel.Activity" /> whose serialized form is requested.</span></span></param>
        <summary><span data-ttu-id="b0977-127">Recupera il form predefinito serializzato di <see cref="T:System.Workflow.ComponentModel.Activity" />.</span><span class="sxs-lookup"><span data-stu-id="b0977-127">Retrieves the serialized default form of the <see cref="T:System.Workflow.ComponentModel.Activity" />.</span></span></summary>
        <returns><span data-ttu-id="b0977-128">Form predefinito serializzato di <see cref="T:System.Workflow.ComponentModel.Activity" />.</span><span class="sxs-lookup"><span data-stu-id="b0977-128">The serialized default form of the <see cref="T:System.Workflow.ComponentModel.Activity" />.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="GetIsBlocked">
      <MemberSignature Language="C#" Value="protected internal static bool GetIsBlocked (System.Workflow.ComponentModel.Activity rootActivity);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblystatic hidebysig bool GetIsBlocked(class System.Workflow.ComponentModel.Activity rootActivity) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.GetIsBlocked(System.Workflow.ComponentModel.Activity)" />
      <MemberSignature Language="VB.NET" Value="Protected Friend Shared Function GetIsBlocked (rootActivity As Activity) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; static bool GetIsBlocked(System::Workflow::ComponentModel::Activity ^ rootActivity);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rootActivity" Type="System.Workflow.ComponentModel.Activity" />
      </Parameters>
      <Docs>
        <param name="rootActivity"><span data-ttu-id="b0977-129">Attività radice dell'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-129">The root activity of the workflow instance.</span></span></param>
        <summary><span data-ttu-id="b0977-130">Indica se l'attività specificata è bloccata.</span><span class="sxs-lookup"><span data-stu-id="b0977-130">Indicates whether the given activity is blocked.</span></span></summary>
        <returns>
          <span data-ttu-id="b0977-131"><see langword="true" /> se l'attività specificata è bloccata; in caso contrario, <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="b0977-131"><see langword="true" /> if the given activity is blocked; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="GetSuspendOrTerminateInfo">
      <MemberSignature Language="C#" Value="protected internal static string GetSuspendOrTerminateInfo (System.Workflow.ComponentModel.Activity rootActivity);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblystatic hidebysig string GetSuspendOrTerminateInfo(class System.Workflow.ComponentModel.Activity rootActivity) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.GetSuspendOrTerminateInfo(System.Workflow.ComponentModel.Activity)" />
      <MemberSignature Language="VB.NET" Value="Protected Friend Shared Function GetSuspendOrTerminateInfo (rootActivity As Activity) As String" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; static System::String ^ GetSuspendOrTerminateInfo(System::Workflow::ComponentModel::Activity ^ rootActivity);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rootActivity" Type="System.Workflow.ComponentModel.Activity" />
      </Parameters>
      <Docs>
        <param name="rootActivity"><span data-ttu-id="b0977-132">Attività radice dell'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-132">The root activity of the workflow instance.</span></span></param>
        <summary><span data-ttu-id="b0977-133">Recupera le informazioni di chiusura o sospensione dell'attività specificata.</span><span class="sxs-lookup"><span data-stu-id="b0977-133">Retrieves the termination or suspend information of the given activity.</span></span></summary>
        <returns><span data-ttu-id="b0977-134">Un elemento <see cref="T:System.String" /> che contiene le informazioni di chiusura o sospensione.</span><span class="sxs-lookup"><span data-stu-id="b0977-134">A <see cref="T:System.String" /> that contains the termination or suspend information.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="GetWorkflowStatus">
      <MemberSignature Language="C#" Value="protected internal static System.Workflow.Runtime.WorkflowStatus GetWorkflowStatus (System.Workflow.ComponentModel.Activity rootActivity);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblystatic hidebysig valuetype System.Workflow.Runtime.WorkflowStatus GetWorkflowStatus(class System.Workflow.ComponentModel.Activity rootActivity) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.GetWorkflowStatus(System.Workflow.ComponentModel.Activity)" />
      <MemberSignature Language="VB.NET" Value="Protected Friend Shared Function GetWorkflowStatus (rootActivity As Activity) As WorkflowStatus" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; static System::Workflow::Runtime::WorkflowStatus GetWorkflowStatus(System::Workflow::ComponentModel::Activity ^ rootActivity);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Workflow.Runtime.WorkflowStatus</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rootActivity" Type="System.Workflow.ComponentModel.Activity" />
      </Parameters>
      <Docs>
        <param name="rootActivity"><span data-ttu-id="b0977-135">Attività radice dell'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-135">The root activity of the workflow instance.</span></span></param>
        <summary><span data-ttu-id="b0977-136">Recupera lo stato del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-136">Retrieves the status of the workflow.</span></span></summary>
        <returns><span data-ttu-id="b0977-137">Valore dell'enumerazione <see cref="T:System.Workflow.Runtime.WorkflowStatus" /> che indica lo stato del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-137">A <see cref="T:System.Workflow.Runtime.WorkflowStatus" /> enumeration value that denotes the status of the workflow.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="LoadCompletedContextActivity">
      <MemberSignature Language="C#" Value="protected internal abstract System.Workflow.ComponentModel.Activity LoadCompletedContextActivity (Guid scopeId, System.Workflow.ComponentModel.Activity outerActivity);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblyhidebysig newslot virtual instance class System.Workflow.ComponentModel.Activity LoadCompletedContextActivity(valuetype System.Guid scopeId, class System.Workflow.ComponentModel.Activity outerActivity) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadCompletedContextActivity(System.Guid,System.Workflow.ComponentModel.Activity)" />
      <MemberSignature Language="VB.NET" Value="Protected Friend MustOverride Function LoadCompletedContextActivity (scopeId As Guid, outerActivity As Activity) As Activity" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; abstract System::Workflow::ComponentModel::Activity ^ LoadCompletedContextActivity(Guid scopeId, System::Workflow::ComponentModel::Activity ^ outerActivity);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Workflow.ComponentModel.Activity</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scopeId" Type="System.Guid" />
        <Parameter Name="outerActivity" Type="System.Workflow.ComponentModel.Activity" />
      </Parameters>
      <Docs>
        <param name="scopeId"><span data-ttu-id="b0977-138"><see cref="T:System.Guid" /> dell'ambito completato.</span><span class="sxs-lookup"><span data-stu-id="b0977-138">The <see cref="T:System.Guid" /> of the completed scope.</span></span></param>
        <param name="outerActivity"><span data-ttu-id="b0977-139">Un oggetto <see cref="T:System.Workflow.ComponentModel.Activity" /> che rappresenta l'attività che racchiude l'ambito completato.</span><span class="sxs-lookup"><span data-stu-id="b0977-139">An <see cref="T:System.Workflow.ComponentModel.Activity" /> that represents the activity that encloses the completed scope.</span></span></param>
        <summary><span data-ttu-id="b0977-140">Se implementato in una classe derivata, carica di nuovo l'ambito completato specificato in memoria.</span><span class="sxs-lookup"><span data-stu-id="b0977-140">When implemented in a derived class, loads the specified completed scope back into memory.</span></span></summary>
        <returns><span data-ttu-id="b0977-141">Classe <see cref="T:System.Workflow.ComponentModel.Activity" /> che rappresenta l'ambito compilato.</span><span class="sxs-lookup"><span data-stu-id="b0977-141">An <see cref="T:System.Workflow.ComponentModel.Activity" /> that represents the completed scope.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="b0977-142">Il motore di runtime del flusso di lavoro utilizza <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadCompletedContextActivity%2A> per implementare la compensazione.</span><span class="sxs-lookup"><span data-stu-id="b0977-142">The workflow runtime engine uses <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadCompletedContextActivity%2A> to implement compensation.</span></span> <span data-ttu-id="b0977-143">È necessario ripristinare una copia identica dell'ambito completato.</span><span class="sxs-lookup"><span data-stu-id="b0977-143">You must restore an identical copy of the completed scope.</span></span> <span data-ttu-id="b0977-144">Per questo scopo, è necessario ripristinare un <xref:System.IO.Stream> valido dalla rappresentazione dell'ambito completato nell'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-144">To do this, you must restore a valid <xref:System.IO.Stream> from your representation of the completed scope in the data store.</span></span> <span data-ttu-id="b0977-145">Quindi è necessario passare <xref:System.IO.Stream> a uno dei metodi di overload di <xref:System.Workflow.ComponentModel.Activity.Load%2A> per eseguire la deserializzazione dell'ambito.</span><span class="sxs-lookup"><span data-stu-id="b0977-145">Then you must pass this <xref:System.IO.Stream> to one of the overloaded methods of <xref:System.Workflow.ComponentModel.Activity.Load%2A> to perform deserialization of the scope.</span></span>  
  
 <span data-ttu-id="b0977-146">Se il servizio di persistenza non può caricare l'ambito completato dall'archivio dati, deve generare un'eccezione <xref:System.Workflow.Runtime.Hosting.PersistenceException> con un messaggio adatto.</span><span class="sxs-lookup"><span data-stu-id="b0977-146">If your persistence service cannot load the completed scope from its data store, it should throw a <xref:System.Workflow.Runtime.Hosting.PersistenceException> with an appropriate message.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="b0977-147">Nell'esempio seguente viene illustrata un'implementazione del metodo `LoadCompletedContextActivity`.</span><span class="sxs-lookup"><span data-stu-id="b0977-147">The following example demonstrates an implementation of the `LoadCompletedContextActivity` method.</span></span> <span data-ttu-id="b0977-148">Questo esempio è tratto dall'esempio SDK Custom Persistence Service nel file FilePersistenceService.cs.</span><span class="sxs-lookup"><span data-stu-id="b0977-148">This example is from the Custom Persistence Service sample, from the FilePersistenceService.cs file.</span></span> <span data-ttu-id="b0977-149">Per ulteriori informazioni, vedere [esempio servizio di persistenza personalizzato](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span><span class="sxs-lookup"><span data-stu-id="b0977-149">For more information, see [Custom Persistence Service Sample](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span></span>  
  
 [!code-csharp[WF_Samples#269](~/samples/snippets/csharp/VS_Snippets_CFX/wf_samples/cs/snippets24.cs#269)]
 [!code-vb[WF_Samples#269](~/samples/snippets/visualbasic/VS_Snippets_CFX/wf_samples/vb/snippets24.vb#269)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="LoadWorkflowInstanceState">
      <MemberSignature Language="C#" Value="protected internal abstract System.Workflow.ComponentModel.Activity LoadWorkflowInstanceState (Guid instanceId);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblyhidebysig newslot virtual instance class System.Workflow.ComponentModel.Activity LoadWorkflowInstanceState(valuetype System.Guid instanceId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadWorkflowInstanceState(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Protected Friend MustOverride Function LoadWorkflowInstanceState (instanceId As Guid) As Activity" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; abstract System::Workflow::ComponentModel::Activity ^ LoadWorkflowInstanceState(Guid instanceId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Workflow.ComponentModel.Activity</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instanceId" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="instanceId"><span data-ttu-id="b0977-150"><see cref="T:System.Guid" /> dell'attività radice dell'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-150">The <see cref="T:System.Guid" /> of the root activity of the workflow instance.</span></span></param>
        <summary><span data-ttu-id="b0977-151">Se implementato in una classe derivata, carica di nuovo lo stato specificato dell'istanza del flusso di lavoro in memoria.</span><span class="sxs-lookup"><span data-stu-id="b0977-151">When implemented in a derived class, loads the specified state of the workflow instance back into memory.</span></span></summary>
        <returns><span data-ttu-id="b0977-152"><see cref="T:System.Workflow.ComponentModel.Activity" /> che rappresenta l'attività radice dell'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-152">An <see cref="T:System.Workflow.ComponentModel.Activity" /> that represents the root activity of the workflow instance.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="b0977-153">È necessario ripristinare una copia identica dell'attività.</span><span class="sxs-lookup"><span data-stu-id="b0977-153">You must restore an identical copy of the activity.</span></span> <span data-ttu-id="b0977-154">Per questo scopo, è necessario ripristinare un <xref:System.IO.Stream> valido dalla rappresentazione dell'istanza del flusso di lavoro nell'archivio dati; quindi è necessario passare questo <xref:System.IO.Stream> a uno dei metodi <xref:System.Workflow.ComponentModel.Activity.Load%2A> di overload per deserializzare lo stato dell'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-154">To do this, you must restore a valid <xref:System.IO.Stream> from your representation of the workflow instance in the data store; then you must pass this <xref:System.IO.Stream> to one of the overloaded <xref:System.Workflow.ComponentModel.Activity.Load%2A> methods to deserialize the workflow instance state.</span></span> <span data-ttu-id="b0977-155">Se il servizio di persistenza non può caricare lo stato dell'istanza del flusso di lavoro dall'archivio dati, deve generare un'eccezione <xref:System.Workflow.Runtime.Hosting.PersistenceException> con un messaggio adatto.</span><span class="sxs-lookup"><span data-stu-id="b0977-155">If your persistence service cannot load the workflow instance state from its data store, it should throw a <xref:System.Workflow.Runtime.Hosting.PersistenceException> with an appropriate message.</span></span>  
  
 <span data-ttu-id="b0977-156">Il motore di runtime del flusso di lavoro implementa la semantica di blocco per limitare l'accesso allo stato di un'istanza del flusso di lavoro salvato in un archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-156">The workflow runtime engine implements locking semantics to restrict access to a workflow instance state that is saved in a data store.</span></span> <span data-ttu-id="b0977-157">L'accesso può essere eseguito dai servizi di persistenza che sono in esecuzione in più processi.</span><span class="sxs-lookup"><span data-stu-id="b0977-157">This can be accessed by persistence services that run in multiple processes.</span></span> <span data-ttu-id="b0977-158">La semantica di blocco è progettata per impedire il caricamento della stessa istanza del flusso di lavoro in memoria contemporaneamente a servizi di persistenza in esecuzione in due processi diversi.</span><span class="sxs-lookup"><span data-stu-id="b0977-158">The locking semantics are designed to prevent persistence services that run in two different processes from loading the same workflow instance into memory at the same time.</span></span> <span data-ttu-id="b0977-159">A seconda del tipo di ambiente supportato dal servizio di persistenza, è possibile scegliere se supportare questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="b0977-159">Depending on the type of environment that your persistence service is designed to support, you may choose whether to support this functionality.</span></span> <span data-ttu-id="b0977-160">Se si sceglie di supportare la semantica di blocco della fase di esecuzione e questo stato dell'istanza del flusso di lavoro è stato precedentemente bloccato da un altro processo, è necessario generare un'eccezione <xref:System.Workflow.Runtime.WorkflowOwnershipException>.</span><span class="sxs-lookup"><span data-stu-id="b0977-160">If you choose to support the runtime locking semantics, and if this workflow instance state has been previously locked by another process, then you should throw a <xref:System.Workflow.Runtime.WorkflowOwnershipException>.</span></span> <span data-ttu-id="b0977-161">In caso contrario, è necessario bloccare l'accesso allo stato dell'istanza del flusso di lavoro nell'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-161">Otherwise, you should lock access to the workflow instance state in your data store.</span></span> <span data-ttu-id="b0977-162">Lo stato dell'istanza del flusso di lavoro può essere sbloccato mediante una chiamata a <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.UnlockWorkflowInstanceState%2A> oppure a <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A> con il parametro di sblocco impostato su `true`.</span><span class="sxs-lookup"><span data-stu-id="b0977-162">The workflow instance state can be unlocked by a call to <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.UnlockWorkflowInstanceState%2A> or a call to <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A> with the unlock parameter set to `true`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="b0977-163">Nell'esempio seguente viene illustrata un'implementazione del metodo `LoadWorkflowInstanceState`.</span><span class="sxs-lookup"><span data-stu-id="b0977-163">The following example demonstrates an implementation of the `LoadWorkflowInstanceState` method.</span></span> <span data-ttu-id="b0977-164">Questo esempio è tratto dall'esempio SDK Custom Persistence Service nel file FilePersistenceService.cs.</span><span class="sxs-lookup"><span data-stu-id="b0977-164">This example is from the Custom Persistence Service sample, from the FilePersistenceService.cs file.</span></span> <span data-ttu-id="b0977-165">Per ulteriori informazioni, vedere [esempio servizio di persistenza personalizzato](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span><span class="sxs-lookup"><span data-stu-id="b0977-165">For more information, see [Custom Persistence Service Sample](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span></span>  
  
 [!code-csharp[WF_Samples#266](~/samples/snippets/csharp/VS_Snippets_CFX/wf_samples/cs/snippets24.cs#266)]
 [!code-vb[WF_Samples#266](~/samples/snippets/visualbasic/VS_Snippets_CFX/wf_samples/vb/snippets24.vb#266)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="RestoreFromDefaultSerializedForm">
      <MemberSignature Language="C#" Value="protected static System.Workflow.ComponentModel.Activity RestoreFromDefaultSerializedForm (byte[] activityBytes, System.Workflow.ComponentModel.Activity outerActivity);" />
      <MemberSignature Language="ILAsm" Value=".method familystatic hidebysig class System.Workflow.ComponentModel.Activity RestoreFromDefaultSerializedForm(unsigned int8[] activityBytes, class System.Workflow.ComponentModel.Activity outerActivity) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.RestoreFromDefaultSerializedForm(System.Byte[],System.Workflow.ComponentModel.Activity)" />
      <MemberSignature Language="VB.NET" Value="Protected Shared Function RestoreFromDefaultSerializedForm (activityBytes As Byte(), outerActivity As Activity) As Activity" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; static System::Workflow::ComponentModel::Activity ^ RestoreFromDefaultSerializedForm(cli::array &lt;System::Byte&gt; ^ activityBytes, System::Workflow::ComponentModel::Activity ^ outerActivity);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Workflow.ComponentModel.Activity</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="activityBytes" Type="System.Byte[]" />
        <Parameter Name="outerActivity" Type="System.Workflow.ComponentModel.Activity" />
      </Parameters>
      <Docs>
        <param name="activityBytes"><span data-ttu-id="b0977-166">Form serializzato di <see cref="T:System.Workflow.ComponentModel.Activity" />.</span><span class="sxs-lookup"><span data-stu-id="b0977-166">The serialized form of <see cref="T:System.Workflow.ComponentModel.Activity" />.</span></span></param>
        <param name="outerActivity"><span data-ttu-id="b0977-167">Classe <see cref="T:System.Workflow.ComponentModel.Activity" /> esterna contenente la classe <see cref="T:System.Workflow.ComponentModel.Activity" /> da ripristinare.</span><span class="sxs-lookup"><span data-stu-id="b0977-167">The outer <see cref="T:System.Workflow.ComponentModel.Activity" />, containing the <see cref="T:System.Workflow.ComponentModel.Activity" /> to restore.</span></span></param>
        <summary><span data-ttu-id="b0977-168">Ripristina la classe <see cref="T:System.Workflow.ComponentModel.Activity" /> dal form serializzato.</span><span class="sxs-lookup"><span data-stu-id="b0977-168">Restores the <see cref="T:System.Workflow.ComponentModel.Activity" /> from its serialized form.</span></span></summary>
        <returns><span data-ttu-id="b0977-169"><see cref="T:System.Workflow.ComponentModel.Activity" /> ripristinata.</span><span class="sxs-lookup"><span data-stu-id="b0977-169">The restored <see cref="T:System.Workflow.ComponentModel.Activity" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="b0977-170">Nell'esempio seguente viene illustrata un'implementazione del metodo `RestoreFromDefaultSerializedForm`.</span><span class="sxs-lookup"><span data-stu-id="b0977-170">The following example demonstrates an implementation of the `RestoreFromDefaultSerializedForm` method.</span></span> <span data-ttu-id="b0977-171">Questo esempio è tratto dall'esempio SDK Custom Persistence Service nel file FilePersistenceService.cs.</span><span class="sxs-lookup"><span data-stu-id="b0977-171">This example is from the Custom Persistence Service sample, from the FilePersistenceService.cs file.</span></span> <span data-ttu-id="b0977-172">Per ulteriori informazioni, vedere [esempio servizio di persistenza personalizzato](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span><span class="sxs-lookup"><span data-stu-id="b0977-172">For more information, see [Custom Persistence Service Sample](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span></span>  
  
 [!code-csharp[WF_Samples#269](~/samples/snippets/csharp/VS_Snippets_CFX/wf_samples/cs/snippets24.cs#269)]
 [!code-vb[WF_Samples#269](~/samples/snippets/visualbasic/VS_Snippets_CFX/wf_samples/vb/snippets24.vb#269)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="SaveCompletedContextActivity">
      <MemberSignature Language="C#" Value="protected internal abstract void SaveCompletedContextActivity (System.Workflow.ComponentModel.Activity activity);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblyhidebysig newslot virtual instance void SaveCompletedContextActivity(class System.Workflow.ComponentModel.Activity activity) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveCompletedContextActivity(System.Workflow.ComponentModel.Activity)" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; abstract void SaveCompletedContextActivity(System::Workflow::ComponentModel::Activity ^ activity);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="activity" Type="System.Workflow.ComponentModel.Activity" />
      </Parameters>
      <Docs>
        <param name="activity"><span data-ttu-id="b0977-173">Classe <see cref="T:System.Workflow.ComponentModel.Activity" /> che rappresenta l'ambito compilato.</span><span class="sxs-lookup"><span data-stu-id="b0977-173">An <see cref="T:System.Workflow.ComponentModel.Activity" /> that represents the completed scope.</span></span></param>
        <summary><span data-ttu-id="b0977-174">Se implementato in una classe derivata, salva l'ambito completato specificato in un archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-174">When implemented in a derived class, saves the specified completed scope to a data store.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="b0977-175">Il motore di runtime del flusso di lavoro salva lo stato delle attività dell'ambito completato per implementare la compensazione.</span><span class="sxs-lookup"><span data-stu-id="b0977-175">The workflow runtime engine saves the state of completed scope activities in order to implement compensation.</span></span> <span data-ttu-id="b0977-176">È necessario chiamare uno dei metodi <xref:System.Workflow.ComponentModel.Activity.Save%2A> di overload per serializzare `activity` in un <xref:System.IO.Stream>; si può quindi scegliere anche di elaborare <xref:System.IO.Stream> prima di scriverlo nell'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-176">You must call one of the overloaded <xref:System.Workflow.ComponentModel.Activity.Save%2A> methods to serialize `activity` into a <xref:System.IO.Stream>; you may then choose to additionally process the <xref:System.IO.Stream> before writing it to your data store.</span></span> <span data-ttu-id="b0977-177">Tuttavia, quando il motore di runtime del flusso di lavoro chiama <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadCompletedContextActivity%2A>, è necessario ripristinare una copia identica dell'attività.</span><span class="sxs-lookup"><span data-stu-id="b0977-177">However, when the workflow runtime engine calls <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadCompletedContextActivity%2A>, you must restore an identical copy of the activity.</span></span>  
  
 <span data-ttu-id="b0977-178">È necessario essere in grado di associare l'ambito completato all'istanza del flusso di lavoro che lo racchiude per contrassegnare l'ambito come non necessario nell'archivio dati quando l'istanza del flusso di lavoro finisce o viene terminata.</span><span class="sxs-lookup"><span data-stu-id="b0977-178">You must be able to associate the completed scope with its enclosing workflow instance to mark the scope as unneeded in your data store when the workflow instance finishes or is terminated.</span></span> <span data-ttu-id="b0977-179">È pertanto necessario salvare anche il <xref:System.Guid> dell'istanza del flusso di lavoro associato all'ambito completato, che può essere ottenuto dalla proprietà <xref:System.Workflow.Runtime.WorkflowInstance.InstanceId%2A> della classe <xref:System.Workflow.Runtime.WorkflowInstance> associata a `activity`.</span><span class="sxs-lookup"><span data-stu-id="b0977-179">Therefore, you should also save the <xref:System.Guid> of the workflow instance that is associated with the completed scope; this can be obtained from the <xref:System.Workflow.Runtime.WorkflowInstance.InstanceId%2A> property of the <xref:System.Workflow.Runtime.WorkflowInstance> associated with `activity`.</span></span>  
  
 <span data-ttu-id="b0977-180"><xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadCompletedContextActivity%2A> accetta il <xref:System.Guid> dell'ambito completato come parametro.</span><span class="sxs-lookup"><span data-stu-id="b0977-180"><xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadCompletedContextActivity%2A> takes the <xref:System.Guid> of the completed scope as a parameter.</span></span> <span data-ttu-id="b0977-181">Di conseguenza, è necessario salvare la proprietà <xref:System.Workflow.ComponentModel.ActivityExecutionContext.ContextGuid%2A> associata a `activity`.</span><span class="sxs-lookup"><span data-stu-id="b0977-181">Therefore, you must also save the <xref:System.Workflow.ComponentModel.ActivityExecutionContext.ContextGuid%2A> property associated with `activity`.</span></span> <span data-ttu-id="b0977-182">Può essere fatto riferimento a questa proprietà tramite il campo <xref:System.Workflow.ComponentModel.Activity.ActivityContextGuidProperty> di `activity`.</span><span class="sxs-lookup"><span data-stu-id="b0977-182">This property can be referenced through the <xref:System.Workflow.ComponentModel.Activity.ActivityContextGuidProperty> field of `activity`.</span></span>  
  
 <span data-ttu-id="b0977-183">Se si sta implementando un servizio di persistenza che utilizza un archivio durevole, per mantenere la coerenza con lo stato interno del motore di runtime del flusso di lavoro, è necessario partecipare all'inclusione in batch delle transazioni del flusso di lavoro per rinviare l'effettiva scrittura nell'archivio durevole fino a un punto di commit del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-183">If you are implementing a persistence service that uses a durable store, to maintain consistency with the internal state of the workflow runtime engine, you should participate in workflow transaction batching to defer the actual write to your durable store until a workflow commit point.</span></span> <span data-ttu-id="b0977-184">Per partecipare all'inclusione in batch, aggiungere un elemento di lavoro alla proprietà <xref:System.Workflow.Runtime.WorkflowEnvironment.WorkBatch%2A> che rappresenta le modifiche in sospeso al database e implementare l'interfaccia <xref:System.Workflow.Runtime.IPendingWork> nel servizio di persistenza.</span><span class="sxs-lookup"><span data-stu-id="b0977-184">To participate in batching, add a work item to the <xref:System.Workflow.Runtime.WorkflowEnvironment.WorkBatch%2A> property that represents the pending changes to the database, and implement the <xref:System.Workflow.Runtime.IPendingWork> interface in your persistence service.</span></span>  
  
 <span data-ttu-id="b0977-185">Se non è possibile salvare l'ambito completato nell'archivio dati, è necessario generare un'eccezione <xref:System.Workflow.Runtime.Hosting.PersistenceException> con un messaggio di errore adatto.</span><span class="sxs-lookup"><span data-stu-id="b0977-185">If you cannot save the completed scope to your data store, you should throw a <xref:System.Workflow.Runtime.Hosting.PersistenceException> with an appropriate error message.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="b0977-186">Nell'esempio seguente viene illustrata un'implementazione del metodo `SaveCompletedContextActivity`.</span><span class="sxs-lookup"><span data-stu-id="b0977-186">The following example demonstrates an implementation of the `SaveCompletedContextActivity` method.</span></span> <span data-ttu-id="b0977-187">Questo esempio è tratto dall'esempio SDK Custom Persistence Service nel file FilePersistenceService.cs.</span><span class="sxs-lookup"><span data-stu-id="b0977-187">This example is from the Custom Persistence Service sample, from the FilePersistenceService.cs file.</span></span> <span data-ttu-id="b0977-188">Per ulteriori informazioni, vedere [esempio servizio di persistenza personalizzato](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span><span class="sxs-lookup"><span data-stu-id="b0977-188">For more information, see [Custom Persistence Service Sample](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span></span>  
  
 [!code-csharp[WF_Samples#268](~/samples/snippets/csharp/VS_Snippets_CFX/wf_samples/cs/snippets24.cs#268)]
 [!code-vb[WF_Samples#268](~/samples/snippets/visualbasic/VS_Snippets_CFX/wf_samples/vb/snippets24.vb#268)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="SaveWorkflowInstanceState">
      <MemberSignature Language="C#" Value="protected internal abstract void SaveWorkflowInstanceState (System.Workflow.ComponentModel.Activity rootActivity, bool unlock);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblyhidebysig newslot virtual instance void SaveWorkflowInstanceState(class System.Workflow.ComponentModel.Activity rootActivity, bool unlock) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState(System.Workflow.ComponentModel.Activity,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Friend MustOverride Sub SaveWorkflowInstanceState (rootActivity As Activity, unlock As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; abstract void SaveWorkflowInstanceState(System::Workflow::ComponentModel::Activity ^ rootActivity, bool unlock);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rootActivity" Type="System.Workflow.ComponentModel.Activity" />
        <Parameter Name="unlock" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="rootActivity"><span data-ttu-id="b0977-189">Attività radice dell'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-189">The root activity of the workflow instance.</span></span></param>
        <param name="unlock">
          <span data-ttu-id="b0977-190"><see langword="true" /> se l'istanza del flusso di lavoro non deve essere bloccata; <see langword="false" /> se l'istanza del flusso di lavoro deve essere bloccata.</span><span class="sxs-lookup"><span data-stu-id="b0977-190"><see langword="true" /> if the workflow instance should not be locked; <see langword="false" /> if the workflow instance should be locked.</span></span></param>
        <summary><span data-ttu-id="b0977-191">Se implementato in una classe derivata, salva lo stato dell'istanza del flusso di lavoro in un archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-191">When implemented in a derived class, saves the workflow instance state to a data store.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="b0977-192">È necessario chiamare uno dei metodi <xref:System.Workflow.ComponentModel.Activity.Save%2A> di overload per serializzare `rootActivity` in un <xref:System.IO.Stream>.</span><span class="sxs-lookup"><span data-stu-id="b0977-192">You must call one of the overloaded <xref:System.Workflow.ComponentModel.Activity.Save%2A> methods to serialize `rootActivity` into a <xref:System.IO.Stream>.</span></span> <span data-ttu-id="b0977-193">È quindi possibile scegliere anche di elaborare <xref:System.IO.Stream> prima di scriverlo nell'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-193">You can then choose to additionally process the <xref:System.IO.Stream> before writing it to your data store.</span></span> <span data-ttu-id="b0977-194">Tuttavia, quando il motore di runtime del flusso di lavoro chiama <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadWorkflowInstanceState%2A>, è necessario ripristinare una copia identica dell'attività radice.</span><span class="sxs-lookup"><span data-stu-id="b0977-194">However, when the workflow runtime engine calls <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadWorkflowInstanceState%2A>, you must restore an identical copy of the root activity.</span></span> <span data-ttu-id="b0977-195">Se non è possibile salvare lo stato dell'istanza del flusso di lavoro nell'archivio dati, è necessario generare un'eccezione <xref:System.Workflow.Runtime.Hosting.PersistenceException> con un messaggio di errore adatto.</span><span class="sxs-lookup"><span data-stu-id="b0977-195">If you cannot save the workflow instance state to your data store, you should throw a <xref:System.Workflow.Runtime.Hosting.PersistenceException> with an appropriate error message.</span></span>  
  
 <span data-ttu-id="b0977-196">Il motore di runtime del flusso di lavoro implementa la semantica di blocco per limitare l'accesso allo stato di un'istanza del flusso di lavoro salvato nell'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-196">The workflow runtime engine provides locking semantics to restrict access to a workflow instance state that is saved in the data store.</span></span> <span data-ttu-id="b0977-197">L'accesso può essere eseguito dai servizi di persistenza che sono in esecuzione in più host e che puntano allo stesso archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-197">This can be accessed by the persistence services running in multiple hosts and pointing to the same data store.</span></span> <span data-ttu-id="b0977-198">La semantica di blocco è progettata per impedire il caricamento della stessa istanza del flusso di lavoro in memoria contemporaneamente a servizi di persistenza in esecuzione in due runtime del flusso di lavoro diversi.</span><span class="sxs-lookup"><span data-stu-id="b0977-198">The locking semantics are designed to prevent persistence services that run in two different workflow runtimes from loading the same workflow instance into memory at the same time.</span></span> <span data-ttu-id="b0977-199">A seconda del tipo di ambiente supportato dal servizio di persistenza, è possibile scegliere se supportare o meno questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="b0977-199">Depending on the type of environment your persistence service is designed to support, you can choose whether to support this functionality.</span></span> <span data-ttu-id="b0977-200">Se si sceglie di supportare la semantica di blocco della fase di esecuzione e un servizio di persistenza tenta di salvare uno stato dell'istanza del flusso di lavoro precedentemente bloccato da un altro servizio di persistenza, è necessario generare un'eccezione <xref:System.Workflow.Runtime.WorkflowOwnershipException>.</span><span class="sxs-lookup"><span data-stu-id="b0977-200">If you choose to support the runtime locking semantics, then, if a persistence service tries to save a workflow instance state that has been previously locked by another persistence service, you should throw a <xref:System.Workflow.Runtime.WorkflowOwnershipException>.</span></span> <span data-ttu-id="b0977-201">Se `unlock` è `true`, è necessario sbloccare l'accesso allo stato dell'istanza del flusso di lavoro dopo averlo salvato.</span><span class="sxs-lookup"><span data-stu-id="b0977-201">If `unlock` is `true`, you should unlock access to the workflow instance state after you save it.</span></span>  
  
 <span data-ttu-id="b0977-202"><xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadWorkflowInstanceState%2A> accetta il <xref:System.Guid> dell'istanza del flusso di lavoro come parametro.</span><span class="sxs-lookup"><span data-stu-id="b0977-202"><xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.LoadWorkflowInstanceState%2A> takes the <xref:System.Guid> of the workflow instance as a parameter.</span></span> <span data-ttu-id="b0977-203">Di conseguenza, è necessario salvare questo <xref:System.Guid>.</span><span class="sxs-lookup"><span data-stu-id="b0977-203">Therefore, you should save this <xref:System.Guid>.</span></span> <span data-ttu-id="b0977-204">È anche possibile utilizzare questo <xref:System.Guid> per associare l'istanza del flusso di lavoro agli stati salvati degli ambiti completati.</span><span class="sxs-lookup"><span data-stu-id="b0977-204">You can also use this <xref:System.Guid> to associate the workflow instance with the saved states of its completed scopes.</span></span> <span data-ttu-id="b0977-205">Questa operazione è necessaria perché deve essere possibile contrassegnare questi ambiti completati come non necessari quando l'istanza del flusso di lavoro viene completata.</span><span class="sxs-lookup"><span data-stu-id="b0977-205">You must do this because you must be able to mark these completed scopes as unneeded when the workflow instance completes.</span></span>  
  
 <span data-ttu-id="b0977-206">Il motore di runtime del flusso di lavoro chiama <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A> un'ultima volta quando l'istanza del flusso di lavoro viene completata o terminata.</span><span class="sxs-lookup"><span data-stu-id="b0977-206">The workflow runtime engine calls <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A> a final time when the workflow instance is completed or terminated.</span></span> <span data-ttu-id="b0977-207">Di conseguenza, se <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.GetWorkflowStatus%2A> è uguale a <xref:System.Workflow.Runtime.WorkflowStatus.Completed> o <xref:System.Workflow.Runtime.WorkflowStatus.Terminated>, è possibile eliminare senza problemi l'istanza del flusso di lavoro e tutti i relativi ambiti completati dall'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b0977-207">Therefore, if <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.GetWorkflowStatus%2A> is equal to <xref:System.Workflow.Runtime.WorkflowStatus.Completed> or <xref:System.Workflow.Runtime.WorkflowStatus.Terminated>, you can safely delete the workflow instance and all its associated completed scopes from your data store.</span></span> <span data-ttu-id="b0977-208">In alternativa, è possibile sottoscrivere gli eventi <xref:System.Workflow.Runtime.WorkflowRuntime.WorkflowCompleted> o <xref:System.Workflow.Runtime.WorkflowRuntime.WorkflowTerminated> per determinare quando è possibile eliminare senza problemi i record associati all'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-208">Alternatively, you can subscribe to the <xref:System.Workflow.Runtime.WorkflowRuntime.WorkflowCompleted> or <xref:System.Workflow.Runtime.WorkflowRuntime.WorkflowTerminated> events to determine when it is safe to delete records associated with the workflow instance.</span></span> <span data-ttu-id="b0977-209">Il momento in cui i record vengono effettivamente eliminati dall'archivio dati dipende dall'implementazione.</span><span class="sxs-lookup"><span data-stu-id="b0977-209">Whether you actually delete the records from your data store depends on your implementation.</span></span>  
  
 <span data-ttu-id="b0977-210">Se si implementa un servizio di persistenza che utilizza un archivio durevole, per mantenere la coerenza con lo stato interno del motore di runtime del flusso di lavoro, è necessario partecipare all'inclusione in batch delle transazioni del flusso di lavoro per rinviare l'effettiva scrittura nell'archivio durevole fino a un punto di commit del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-210">If you implement a persistence service that uses a durable store, then, to maintain consistency with the internal state of the workflow runtime engine, you should participate in workflow transaction batching to defer the actual write to your durable store until a workflow commit point.</span></span> <span data-ttu-id="b0977-211">Per partecipare all'inclusione in batch, aggiungere un elemento di lavoro alla proprietà <xref:System.Workflow.Runtime.WorkflowEnvironment.WorkBatch%2A> che rappresenta le modifiche in sospeso all'archivio durevole e implementare l'interfaccia <xref:System.Workflow.Runtime.IPendingWork> nel servizio di persistenza.</span><span class="sxs-lookup"><span data-stu-id="b0977-211">To participate in batching, add a work item that represents the pending changes to your durable store to the <xref:System.Workflow.Runtime.WorkflowEnvironment.WorkBatch%2A> property, and implement the <xref:System.Workflow.Runtime.IPendingWork> interface in your persistence service.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="b0977-212">Nell'esempio seguente viene illustrata un'implementazione del metodo `SaveWorkflowInstanceState`.</span><span class="sxs-lookup"><span data-stu-id="b0977-212">The following example demonstrates an implementation of the `SaveWorkflowInstanceState` method.</span></span> <span data-ttu-id="b0977-213">Questo esempio è tratto dall'esempio SDK Custom Persistence Service nel file FilePersistenceService.cs.</span><span class="sxs-lookup"><span data-stu-id="b0977-213">This example is from the Custom Persistence Service sample, from the FilePersistenceService.cs file.</span></span> <span data-ttu-id="b0977-214">Per ulteriori informazioni, vedere [esempio servizio di persistenza personalizzato](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span><span class="sxs-lookup"><span data-stu-id="b0977-214">For more information, see [Custom Persistence Service Sample](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span></span>  
  
 [!code-csharp[WF_Samples#264](~/samples/snippets/csharp/VS_Snippets_CFX/wf_samples/cs/snippets24.cs#264)]
 [!code-vb[WF_Samples#264](~/samples/snippets/visualbasic/VS_Snippets_CFX/wf_samples/vb/snippets24.vb#264)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="UnloadOnIdle">
      <MemberSignature Language="C#" Value="protected internal abstract bool UnloadOnIdle (System.Workflow.ComponentModel.Activity activity);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblyhidebysig newslot virtual instance bool UnloadOnIdle(class System.Workflow.ComponentModel.Activity activity) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.UnloadOnIdle(System.Workflow.ComponentModel.Activity)" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; abstract bool UnloadOnIdle(System::Workflow::ComponentModel::Activity ^ activity);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="activity" Type="System.Workflow.ComponentModel.Activity" />
      </Parameters>
      <Docs>
        <param name="activity"><span data-ttu-id="b0977-215">Classe <see cref="T:System.Workflow.ComponentModel.Activity" /> che rappresenta l'ambito compilato.</span><span class="sxs-lookup"><span data-stu-id="b0977-215">An <see cref="T:System.Workflow.ComponentModel.Activity" /> that represents the completed scope.</span></span></param>
        <summary><span data-ttu-id="b0977-216">Determina se un flusso di lavoro deve essere scaricato quando è inattivo.</span><span class="sxs-lookup"><span data-stu-id="b0977-216">Determines whether a workflow should be unloaded when idle.</span></span></summary>
        <returns><span data-ttu-id="b0977-217">Se è <see langword="true" />, il motore di runtime del flusso di lavoro scaricherà il flusso di lavoro specificato quando diventa inattivo.</span><span class="sxs-lookup"><span data-stu-id="b0977-217">If <see langword="true" />, the workflow runtime engine unloads the specified workflow when it becomes idle.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="b0977-218">Nell'esempio seguente viene illustrata un'implementazione del metodo `UnloadOnIdle`.</span><span class="sxs-lookup"><span data-stu-id="b0977-218">The following example demonstrates an implementation of the `UnloadOnIdle` method.</span></span> <span data-ttu-id="b0977-219">Questo esempio è tratto dall'esempio SDK Custom Persistence Service nel file FilePersistenceService.cs.</span><span class="sxs-lookup"><span data-stu-id="b0977-219">This example is from the Custom Persistence Service sample, from the FilePersistenceService.cs file.</span></span> <span data-ttu-id="b0977-220">Per ulteriori informazioni, vedere [esempio servizio di persistenza personalizzato](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span><span class="sxs-lookup"><span data-stu-id="b0977-220">For more information, see [Custom Persistence Service Sample](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span></span>  
  
 [!code-csharp[WF_Samples#270](~/samples/snippets/csharp/VS_Snippets_CFX/wf_samples/cs/snippets24.cs#270)]
 [!code-vb[WF_Samples#270](~/samples/snippets/visualbasic/VS_Snippets_CFX/wf_samples/vb/snippets24.vb#270)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="UnlockWorkflowInstanceState">
      <MemberSignature Language="C#" Value="protected internal abstract void UnlockWorkflowInstanceState (System.Workflow.ComponentModel.Activity rootActivity);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblyhidebysig newslot virtual instance void UnlockWorkflowInstanceState(class System.Workflow.ComponentModel.Activity rootActivity) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.UnlockWorkflowInstanceState(System.Workflow.ComponentModel.Activity)" />
      <MemberSignature Language="VB.NET" Value="Protected Friend MustOverride Sub UnlockWorkflowInstanceState (rootActivity As Activity)" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; abstract void UnlockWorkflowInstanceState(System::Workflow::ComponentModel::Activity ^ rootActivity);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Workflow.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rootActivity" Type="System.Workflow.ComponentModel.Activity" />
      </Parameters>
      <Docs>
        <param name="rootActivity"><span data-ttu-id="b0977-221">Attività radice dell'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-221">The root activity of the workflow instance.</span></span></param>
        <summary><span data-ttu-id="b0977-222">Quando viene sottoposto a override in una classe derivata, sblocca lo stato dell'istanza del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="b0977-222">When overridden in a derived class, unlocks the workflow instance state.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="b0977-223">Questo metodo è astratto, pertanto non contiene un'implementazione predefinita per il blocco e lo sblocco.</span><span class="sxs-lookup"><span data-stu-id="b0977-223">This method is abstract, so it does not contain a default implementation on locking and unlocking.</span></span>  
  
 <span data-ttu-id="b0977-224">Durante l'implementazione di un servizio di persistenza personalizzato, se si desidera implementare uno schema di blocco è necessario eseguire l'override di questo metodo e fornire un meccanismo di blocco-sblocco nel metodo <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A> basato sul valore del parametro di sblocco.</span><span class="sxs-lookup"><span data-stu-id="b0977-224">While implementing a custom persistence service, if you want to implement a locking scheme you will need to override this method and provide a locking-unlocking mechanism in the <xref:System.Workflow.Runtime.Hosting.WorkflowPersistenceService.SaveWorkflowInstanceState%2A> method based on the value of the unlock parameter.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="b0977-225">Nell'esempio seguente viene illustrata un'implementazione del metodo `UnlockWorkflowInstanceState`.</span><span class="sxs-lookup"><span data-stu-id="b0977-225">The following example demonstrates an implementation of the `UnlockWorkflowInstanceState` method.</span></span> <span data-ttu-id="b0977-226">Questo esempio è tratto dall'esempio SDK Custom Persistence Service nel file FilePersistenceService.cs.</span><span class="sxs-lookup"><span data-stu-id="b0977-226">This example is from the Custom Persistence Service sample, from the FilePersistenceService.cs file.</span></span> <span data-ttu-id="b0977-227">Per ulteriori informazioni, vedere [esempio servizio di persistenza personalizzato](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span><span class="sxs-lookup"><span data-stu-id="b0977-227">For more information, see [Custom Persistence Service Sample](http://msdn.microsoft.com/library/869dfadf-5298-4551-bc80-f4cf7918729d).</span></span>  
  
 [!code-csharp[WF_Samples#267](~/samples/snippets/csharp/VS_Snippets_CFX/wf_samples/cs/snippets24.cs#267)]
 [!code-vb[WF_Samples#267](~/samples/snippets/visualbasic/VS_Snippets_CFX/wf_samples/vb/snippets24.vb#267)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>