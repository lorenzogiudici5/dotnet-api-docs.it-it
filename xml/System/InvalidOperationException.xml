<Type Name="InvalidOperationException" FullName="System.InvalidOperationException">
  <TypeSignature Language="C#" Value="public class InvalidOperationException : SystemException" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi serializable beforefieldinit InvalidOperationException extends System.SystemException" />
  <TypeSignature Language="DocId" Value="T:System.InvalidOperationException" />
  <TypeSignature Language="VB.NET" Value="Public Class InvalidOperationException&#xA;Inherits SystemException" />
  <TypeSignature Language="C++ CLI" Value="public ref class InvalidOperationException : SystemException" />
  <AssemblyInfo>
    <AssemblyName>System.Runtime</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.10.0</AssemblyVersion>
    <AssemblyVersion>4.0.20.0</AssemblyVersion>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Exception</BaseTypeName>
    <BaseTypeName FrameworkAlternate="netframework-4.5">System.SystemException</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.Runtime.InteropServices.ComVisible(true)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="32ae1-101">Eccezione generata quando una chiamata a un metodo non è valida per lo stato corrente dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="32ae1-101">The exception that is thrown when a method call is invalid for the object's current state.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="32ae1-102"><xref:System.InvalidOperationException> viene utilizzata quando l'impossibilità di richiamare un metodo è dovuta a motivi diversi da argomenti non validi.</span><span class="sxs-lookup"><span data-stu-id="32ae1-102"><xref:System.InvalidOperationException> is used in cases when the failure to invoke a method is caused by reasons other than invalid arguments.</span></span> <span data-ttu-id="32ae1-103">In genere, viene generata quando lo stato di un oggetto non è in grado di supportare la chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-103">Typically, it is thrown when the state of an object cannot support the method call.</span></span> <span data-ttu-id="32ae1-104">Ad esempio, un <xref:System.InvalidOperationException> eccezione viene generata dai metodi, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="32ae1-104">For example, an <xref:System.InvalidOperationException> exception is thrown by methods such as:</span></span>  
  
-   <span data-ttu-id="32ae1-105"><xref:System.Collections.IEnumerator.MoveNext%2A?displayProperty=nameWithType> Se gli oggetti di una raccolta vengono modificati dopo la creazione dell'enumeratore.</span><span class="sxs-lookup"><span data-stu-id="32ae1-105"><xref:System.Collections.IEnumerator.MoveNext%2A?displayProperty=nameWithType> if objects of a collection are modified after the enumerator is created.</span></span> <span data-ttu-id="32ae1-106">Per ulteriori informazioni, vedere [modifica di una raccolta durante lo scorrimento](#Iterating).</span><span class="sxs-lookup"><span data-stu-id="32ae1-106">For more information, see [Changing a collection while iterating it](#Iterating).</span></span>  
  
-   <span data-ttu-id="32ae1-107"><xref:System.Resources.ResourceSet.GetString%2A?displayProperty=nameWithType> Se il set di risorse viene chiusa prima della chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-107"><xref:System.Resources.ResourceSet.GetString%2A?displayProperty=nameWithType> if the resource set is closed before the method call is made.</span></span>  
  
-   <span data-ttu-id="32ae1-108"><xref:System.Xml.Linq.XContainer.Add%2A?displayProperty=nameWithType>, se gli oggetti da aggiungere restituirà un documento XML strutturato in modo non corretto.</span><span class="sxs-lookup"><span data-stu-id="32ae1-108"><xref:System.Xml.Linq.XContainer.Add%2A?displayProperty=nameWithType>, if the object or objects to be added would result in an incorrectly structured XML document.</span></span>  
  
-   <span data-ttu-id="32ae1-109">Un metodo che tenta di modificare l'interfaccia utente da un thread non principale o dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-109">A method that attempts to manipulate the UI from a thread that is not the main or UI thread.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="32ae1-110">Poiché il <xref:System.InvalidOperationException> eccezione può essere generata in una vasta gamma di circostanze, è importante leggere il messaggio di eccezione restituito dal <xref:System.Exception.Message%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="32ae1-110">Because the <xref:System.InvalidOperationException> exception can be thrown in a wide variety of circumstances, it is important to read the exception message returned by the <xref:System.Exception.Message%2A> property.</span></span>  
  
 <span data-ttu-id="32ae1-111">Contenuto della sezione:</span><span class="sxs-lookup"><span data-stu-id="32ae1-111">In this section:</span></span>  
  
 <span data-ttu-id="32ae1-112">[Alcune cause comuni di eccezioni InvalidOperationException](#Causes) </span><span class="sxs-lookup"><span data-stu-id="32ae1-112">[Some common causes of InvalidOperationException exceptions](#Causes) </span></span>  
 [<span data-ttu-id="32ae1-113">L'aggiornamento di un thread dell'interfaccia utente da un thread non dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="32ae1-113">Updating a UI thread from a non-UI thread</span></span>](#UI)  
 [<span data-ttu-id="32ae1-114">Modifica di una raccolta durante lo scorrimento</span><span class="sxs-lookup"><span data-stu-id="32ae1-114">Changing a collection while iterating it</span></span>](#Iterating)  
 [<span data-ttu-id="32ae1-115">Ordinamento di una matrice o raccolta i cui oggetti non possono essere confrontate.</span><span class="sxs-lookup"><span data-stu-id="32ae1-115">Sorting an array or collection whose objects cannot be compared</span></span>](#Sorting)  
 <span data-ttu-id="32ae1-116">[Cast di un tipo Nullable&lt;T&gt; null al relativo tipo sottostante](#Nullable) </span><span class="sxs-lookup"><span data-stu-id="32ae1-116">[Casting a Nullable&lt;T&gt; that is null to its underlying type](#Nullable) </span></span>  
 [<span data-ttu-id="32ae1-117">Chiamata a un metodo Enumerable su una raccolta vuota</span><span class="sxs-lookup"><span data-stu-id="32ae1-117">Calling a System.Linq.Enumerable method on an empty collection</span></span>](#Empty)  
 [<span data-ttu-id="32ae1-118">La chiamata Enumerable o SingleOrDefault su una sequenza senza un elemento</span><span class="sxs-lookup"><span data-stu-id="32ae1-118">Calling Enumerable.Single or Enumerable.SingleOrDefault on a sequence without one element</span></span>](#Single)  
 [<span data-ttu-id="32ae1-119">Accesso al campo dinamico dominio tra applicazioni</span><span class="sxs-lookup"><span data-stu-id="32ae1-119">Dynamic cross-application domain field access</span></span>](#Emit)  
[<span data-ttu-id="32ae1-120">Generare un'eccezione InvalidOperationException</span><span class="sxs-lookup"><span data-stu-id="32ae1-120">Throwing an InvalidOperationException exception</span></span>](#Throwing)  
[<span data-ttu-id="32ae1-121">Informazioni di vario tipo</span><span class="sxs-lookup"><span data-stu-id="32ae1-121">Miscellaneous information</span></span>](#Misc)  
  
<a name="Causes"></a>   
## <a name="some-common-causes-of-invalidoperationexception-exceptions"></a><span data-ttu-id="32ae1-122">Alcune cause comuni di eccezioni InvalidOperationException</span><span class="sxs-lookup"><span data-stu-id="32ae1-122">Some common causes of InvalidOperationException exceptions</span></span>  
 <span data-ttu-id="32ae1-123">Le sezioni seguenti mostrano come i casi in cui alcuni comuni <xref:System.InvalidOperationException> in un'applicazione viene generata l'eccezione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-123">The following sections show how some common cases in which in <xref:System.InvalidOperationException> exception is thrown in an app.</span></span> <span data-ttu-id="32ae1-124">Come gestire il problema dipende dalla situazione specifica.</span><span class="sxs-lookup"><span data-stu-id="32ae1-124">How you handle the issue depends on the specific situation.</span></span> <span data-ttu-id="32ae1-125">In genere, tuttavia, l'eccezione risultante dall'errore di sviluppatore e <xref:System.InvalidOperationException> eccezione può essere previste ed evitata.</span><span class="sxs-lookup"><span data-stu-id="32ae1-125">Most commonly, however, the exception results from developer error, and the <xref:System.InvalidOperationException> exception can be anticipated and avoided.</span></span>  
  
<a name="UI"></a>   
### <a name="updating-a-ui-thread-from-a-non-ui-thread"></a><span data-ttu-id="32ae1-126">L'aggiornamento di un thread dell'interfaccia utente da un thread non dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="32ae1-126">Updating a UI thread from a non-UI thread</span></span>  
 <span data-ttu-id="32ae1-127">Spesso, i thread di lavoro vengono usati per eseguire alcune operazioni in background che include la raccolta di dati da visualizzare nell'interfaccia utente di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-127">Often, worker threads are used to perform some background work that involves gathering data to be displayed in an application's user interface.</span></span> <span data-ttu-id="32ae1-128">Tuttavia.</span><span class="sxs-lookup"><span data-stu-id="32ae1-128">However.</span></span> <span data-ttu-id="32ae1-129">la maggior parte dei framework di applicazioni GUI (interfaccia utente grafica) per .NET Framework, ad esempio Windows Form e Windows Presentation Foundation (WPF), consentono di accedere agli oggetti della GUI solo dal thread che crea e gestisce l'interfaccia utente (il thread principale o dell'interfaccia utente).</span><span class="sxs-lookup"><span data-stu-id="32ae1-129">most GUI (graphical user interface) application frameworks for the .NET Framework, such as Windows Forms and Windows Presentation Foundation (WPF),  let you access GUI objects only from the thread that creates and manages the UI (the Main or UI thread).</span></span> <span data-ttu-id="32ae1-130">Un <xref:System.InvalidOperationException> viene generata quando si tenta di accedere a un elemento dell'interfaccia utente da un thread diverso dal thread dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-130">An <xref:System.InvalidOperationException> is thrown when you try to access a UI element from a thread other than the UI thread.</span></span>  <span data-ttu-id="32ae1-131">Il testo del messaggio di eccezione viene visualizzato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-131">The text of the exception message is shown in the following table.</span></span>  
  
|<span data-ttu-id="32ae1-132">Tipo di applicazione</span><span class="sxs-lookup"><span data-stu-id="32ae1-132">Application Type</span></span>|<span data-ttu-id="32ae1-133">Messaggio</span><span class="sxs-lookup"><span data-stu-id="32ae1-133">Message</span></span>|  
|----------------------|-------------|  
|<span data-ttu-id="32ae1-134">Applicazione WPF</span><span class="sxs-lookup"><span data-stu-id="32ae1-134">WPF app</span></span>|<span data-ttu-id="32ae1-135">**Il thread chiamante non è possibile accedere a questo oggetto perché un altro thread.**</span><span class="sxs-lookup"><span data-stu-id="32ae1-135">**The calling thread cannot access this object because a different thread owns it.**</span></span>|  
|<span data-ttu-id="32ae1-136">App UWP</span><span class="sxs-lookup"><span data-stu-id="32ae1-136">UWP app</span></span>|<span data-ttu-id="32ae1-137">**L'applicazione ha chiamato un'interfaccia che è stato sottoposto a marshalling per un thread differente.**</span><span class="sxs-lookup"><span data-stu-id="32ae1-137">**The application called an interface that was marshalled for a different thread.**</span></span>|  
|<span data-ttu-id="32ae1-138">App di Windows Form</span><span class="sxs-lookup"><span data-stu-id="32ae1-138">Windows Forms app</span></span>|<span data-ttu-id="32ae1-139">**Operazione cross-thread non valida: controllo 'TextBox1' accessibili da un thread diverso da quello in cui è stato creato.**</span><span class="sxs-lookup"><span data-stu-id="32ae1-139">**Cross-thread operation not valid: Control 'TextBox1' accessed from a thread other than the thread it was created on.**</span></span>|  
  
 <span data-ttu-id="32ae1-140">Framework dell'interfaccia utente per .NET Framework implementano un *dispatcher* modello che include un metodo per verificare se una chiamata a un membro di un elemento dell'interfaccia utente viene eseguita sul thread dell'interfaccia utente e altri metodi per pianificare la chiamata sul thread dell'interfaccia utente:</span><span class="sxs-lookup"><span data-stu-id="32ae1-140">UI frameworks for the .NET Framework implement a *dispatcher* pattern that includes a method to check whether a call to a member of a UI element is being executed on the UI thread, and other methods to schedule the call on the UI thread:</span></span>  
  
-   <span data-ttu-id="32ae1-141">Nelle App WPF, chiamare il <xref:System.Windows.Threading.Dispatcher.CheckAccess%2A?displayProperty=nameWithType> metodo per determinare se un metodo è in esecuzione su un thread non dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-141">In WPF apps, call the <xref:System.Windows.Threading.Dispatcher.CheckAccess%2A?displayProperty=nameWithType> method to determine if a method is running on a non-UI thread.</span></span> <span data-ttu-id="32ae1-142">Restituisce `true` se il metodo è in esecuzione nel thread UI e `false` in caso contrario.</span><span class="sxs-lookup"><span data-stu-id="32ae1-142">It returns `true` if the method is running on the UI thread and `false` otherwise.</span></span> <span data-ttu-id="32ae1-143">Chiamare uno degli overload di <xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType> metodo per pianificare la chiamata sul thread dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-143">Call one of the overloads of the <xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType> method to schedule the call on the UI thread.</span></span>  
  
-   <span data-ttu-id="32ae1-144">Nelle App UWP, chiamare il [CoreDispatcher.HasThreadAccess](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.hasthreadaccess.aspx) metodo per determinare se un metodo è in esecuzione su un thread non dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-144">In UWP apps, call the [CoreDispatcher.HasThreadAccess](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.hasthreadaccess.aspx) method to determine if a method is running on a non-UI thread.</span></span> <span data-ttu-id="32ae1-145">Chiamare il [CoreDispatcher.RunAsync](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.runasync.aspx) metodo per eseguire un delegato che aggiorna il thread dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-145">Call the  [CoreDispatcher.RunAsync](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.runasync.aspx) method to execute a delegate that updates the UI thread.</span></span> <span data-ttu-id="32ae1-146">Usa il comando</span><span class="sxs-lookup"><span data-stu-id="32ae1-146">Use the</span></span>  
  
-   <span data-ttu-id="32ae1-147">Nelle app di Windows Form, utilizzare il <xref:System.Windows.Forms.Control.InvokeRequired%2A?displayProperty=nameWithType> proprietà per determinare se un metodo è in esecuzione su un thread non dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-147">In Windows Forms apps, use the <xref:System.Windows.Forms.Control.InvokeRequired%2A?displayProperty=nameWithType> property to determine if a method is running on a non-UI thread.</span></span> <span data-ttu-id="32ae1-148">Chiamare uno degli overload di <xref:System.Windows.Forms.Control.Invoke%2A?displayProperty=nameWithType> metodo per eseguire un delegato che aggiorna il thread dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-148">Call one of the overloads of the <xref:System.Windows.Forms.Control.Invoke%2A?displayProperty=nameWithType> method to execute a delegate that updates the UI thread.</span></span>  
  
 <span data-ttu-id="32ae1-149">Gli esempi seguenti illustrano il <xref:System.InvalidOperationException> eccezione generata quando si tenta di aggiornare un elemento dell'interfaccia utente da un thread diverso da quello di cui è stato creato.</span><span class="sxs-lookup"><span data-stu-id="32ae1-149">The following examples illustrate the <xref:System.InvalidOperationException> exception that is thrown when you attempt to update a UI element from a thread other than the thread that created it.</span></span>  <span data-ttu-id="32ae1-150">Ogni esempio è necessario creare due controlli:</span><span class="sxs-lookup"><span data-stu-id="32ae1-150">Each example requires that you create two controls:</span></span>  
  
-   <span data-ttu-id="32ae1-151">Un controllo casella di testo denominato `textBox1`.</span><span class="sxs-lookup"><span data-stu-id="32ae1-151">A text box control named `textBox1`.</span></span>  <span data-ttu-id="32ae1-152">In un'applicazione Windows Form, è necessario impostare il relativo <xref:System.Windows.Forms.TextBox.Multiline%2A> proprietà `true`.</span><span class="sxs-lookup"><span data-stu-id="32ae1-152">In a Windows Forms app, you should set its <xref:System.Windows.Forms.TextBox.Multiline%2A> property to `true`.</span></span>  
  
-   <span data-ttu-id="32ae1-153">Un pulsante denominato `threadExampleBtn`.</span><span class="sxs-lookup"><span data-stu-id="32ae1-153">A button  control named `threadExampleBtn`.</span></span> <span data-ttu-id="32ae1-154">Nell'esempio viene fornito un gestore, `ThreadsExampleBtn_Click`, per il pulsante `Click` evento.</span><span class="sxs-lookup"><span data-stu-id="32ae1-154">The example provides a handler, `ThreadsExampleBtn_Click`, for the button's `Click` event.</span></span>  
  
 <span data-ttu-id="32ae1-155">In ogni caso, il `threadExampleBtn_Click` chiamate del gestore dell'evento di `DoSomeWork` metodo due volte.</span><span class="sxs-lookup"><span data-stu-id="32ae1-155">In each case, the `threadExampleBtn_Click` event handler calls the `DoSomeWork` method twice.</span></span> <span data-ttu-id="32ae1-156">La prima chiamata viene eseguita in modo sincrono e ha esito positivo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-156">The first call runs synchronously and succeeds.</span></span> <span data-ttu-id="32ae1-157">Ma la seconda chiamata, in quanto viene eseguito in modo asincrono in un pool di thread, tenta di aggiornare l'interfaccia utente da un thread non dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-157">But the second call, because it runs asynchronously on a thread pool thread, attempts to update the UI from a non-UI thread.</span></span> <span data-ttu-id="32ae1-158">Ciò comporta un <xref:System.InvalidOperationException> eccezione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-158">This results in a <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="32ae1-159">App UWP e WPF</span><span class="sxs-lookup"><span data-stu-id="32ae1-159">WPF and UWP apps</span></span>  
 [!code-csharp[System.InvalidOperationException.Threading.WPF1#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf1/cs/MainWindow.xaml.cs#1)]
 [!code-vb[System.InvalidOperationException.Threading.WPF1#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf1/vb/MainWindow.xaml.vb#1)]  
  
 <span data-ttu-id="32ae1-160">La seguente versione di `DoSomeWork` metodo elimina l'eccezione in un'applicazione WPF.</span><span class="sxs-lookup"><span data-stu-id="32ae1-160">The following version of the `DoSomeWork` method eliminates the exception in a WPF app.</span></span>  
  
 [!code-csharp[System.InvalidOperationException.Threading.WPF2#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf2/cs/MainWindowDispatcher.xaml.cs#3)]
 [!code-vb[System.InvalidOperationException.Threading.WPF2#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf2/vb/MainWindowDispatcher.xaml.vb#3)]  
  
 <span data-ttu-id="32ae1-161">La seguente versione di `DoSomeWork` metodo elimina l'eccezione in un'app UWP.</span><span class="sxs-lookup"><span data-stu-id="32ae1-161">The following version of the `DoSomeWork` method eliminates the exception in a UWP app.</span></span>  
  
 [!code-csharp[System.InvalidOperationException.Threading.UWP#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception.threading.uwp/cs/MainPage.xaml.cs#4)]
 [!code-vb[System.InvalidOperationException.Threading.UWP#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception.threading.uwp/vb/MainPage.xaml.vb#4)]  
  
 <span data-ttu-id="32ae1-162">App di Windows Form</span><span class="sxs-lookup"><span data-stu-id="32ae1-162">Windows Forms apps</span></span>  
 [!code-csharp[System.InvalidOperationException.Threading.WF#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf/cs/Form1.cs#2)]
 [!code-vb[System.InvalidOperationException.Threading.WF#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf/vb/Form1.vb#2)]  
  
 <span data-ttu-id="32ae1-163">La seguente versione di `DoSomeWork` metodo elimina l'eccezione in un'app di Windows Form.</span><span class="sxs-lookup"><span data-stu-id="32ae1-163">The following version of the `DoSomeWork` method eliminates the exception in a Windows Forms app.</span></span>  
  
 [!code-csharp[System.InvalidOperationException.Threading.WF2#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf2/cs/Form1.cs#5)]
 [!code-vb[System.InvalidOperationException.Threading.WF2#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf2/vb/Form1.vb#5)]  
  
<a name="Iterating"></a>   
### <a name="changing-a-collection-while-iterating-it"></a><span data-ttu-id="32ae1-164">Modifica di una raccolta durante lo scorrimento</span><span class="sxs-lookup"><span data-stu-id="32ae1-164">Changing a collection while iterating it</span></span>  
 <span data-ttu-id="32ae1-165">Il `foreach` istruzione in c# o `For Each` istruzione in Visual Basic viene usata per scorrere i membri di una raccolta e per leggere o modificare i singoli elementi.</span><span class="sxs-lookup"><span data-stu-id="32ae1-165">The `foreach` statement in C# or `For Each` statement in Visual Basic is used to iterate the members of a collection and to read or modify its individual elements.</span></span> <span data-ttu-id="32ae1-166">Tuttavia, e non può essere utilizzato per aggiungere o rimuovere elementi dalla raccolta.</span><span class="sxs-lookup"><span data-stu-id="32ae1-166">However, it can't be used to add or remove items from the collection.</span></span> <span data-ttu-id="32ae1-167">In caso contrario viene generata una <xref:System.InvalidOperationException> eccezione con un messaggio che è simile a "**raccolta è stata modificata; Impossibile eseguire l'operazione di enumerazione. **"</span><span class="sxs-lookup"><span data-stu-id="32ae1-167">Doing this throws an  <xref:System.InvalidOperationException> exception with a message that is similar to, "**Collection was modified; enumeration operation may not execute.**"</span></span>  
  
 <span data-ttu-id="32ae1-168">Nell'esempio seguente esegue l'iterazione di che una raccolta di numeri interi tenta di aggiungere il quadrato di ogni valore integer alla raccolta.</span><span class="sxs-lookup"><span data-stu-id="32ae1-168">The following example iterates a collection of integers attempts to add the square of each integer to the collection.</span></span> <span data-ttu-id="32ae1-169">Nell'esempio viene generata una <xref:System.InvalidOperationException> con la prima chiamata al <xref:System.Collections.Generic.List%601.Add%2A?displayProperty=nameWithType> metodo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-169">The example throws an <xref:System.InvalidOperationException> with the first call to the <xref:System.Collections.Generic.List%601.Add%2A?displayProperty=nameWithType> method.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Iterating1.cs#1)]
 [!code-vb[System.InvalidOperationException#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Iterating1.vb#1)]  
  
 <span data-ttu-id="32ae1-170">È possibile eliminare l'eccezione in uno dei due modi, a seconda della logica dell'applicazione:</span><span class="sxs-lookup"><span data-stu-id="32ae1-170">You can eliminate the exception in one of two ways, depending on your application logic:</span></span>  
  
-   <span data-ttu-id="32ae1-171">Se è necessario aggiungere elementi alla raccolta durante lo scorrimento, è possibile scorrere indice utilizzando il `for` istruzione anziché `foreach` o `For Each`.</span><span class="sxs-lookup"><span data-stu-id="32ae1-171">If elements must be added to the collection while iterating it, you can iterate it by index using the `for` statement instead of `foreach` or `For Each`.</span></span> <span data-ttu-id="32ae1-172">Nell'esempio seguente viene utilizzata l'istruzione aggiungere il quadrato dei numeri nella raccolta alla raccolta.</span><span class="sxs-lookup"><span data-stu-id="32ae1-172">The following example uses the for statement to add the square of numbers in the collection to the collection.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Iterating2.cs#2)]
     [!code-vb[System.InvalidOperationException#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Iterating2.vb#2)]  
  
     <span data-ttu-id="32ae1-173">Si noti che è necessario stabilire il numero di iterazioni prima l'iterazione della raccolta tramite l'utilizzo di un contatore all'interno del ciclo che terminerà il ciclo appropraitely, eseguendo l'iterazione all'indietro, da `Count` - 1 a 0, o, come avviene nell'esempio, assegnando il numero di elementi nella matrice in una variabile da utilizzare per stabilire il limite superiore del ciclo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-173">Note that you must establish the number of iterations before iterating the collection either by using a counter inside the loop that will exit the loop appropraitely, by iterating backward, from `Count` - 1 to 0, or, as the example does, by assigning the number of elements in the array to a variable and using it to establish the upper bound of the loop.</span></span> <span data-ttu-id="32ae1-174">In caso contrario, se un elemento viene aggiunto alla raccolta in ogni iterazione, un ciclo infinito.</span><span class="sxs-lookup"><span data-stu-id="32ae1-174">Otherwise, if an element is added to the collection on every iteration, an endless loop results.</span></span>  
  
-   <span data-ttu-id="32ae1-175">Se non è necessario aggiungere elementi alla raccolta durante lo scorrimento, è possibile archiviare gli elementi da aggiungere in una raccolta temporanea che si aggiunge quando ha terminato l'iterazione della raccolta.</span><span class="sxs-lookup"><span data-stu-id="32ae1-175">If it is not necessary to add elements to the collection while iterating it, you can store the elements to be added in a temporary collection that you add when iterating the collection has finished.</span></span>  <span data-ttu-id="32ae1-176">Nell'esempio seguente viene utilizzato questo approccio per aggiungere il quadrato dei numeri in una raccolta per una raccolta temporanea, quindi per combinare le raccolte in un singolo oggetto di matrice.</span><span class="sxs-lookup"><span data-stu-id="32ae1-176">The following example uses this approach to add the square of numbers in a collection to a temporary collection, and then to combine the collections into a single array object.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Iterating3.cs#3)]
     [!code-vb[System.InvalidOperationException#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Iterating3.vb#3)]  
  
<a name="Sorting"></a>   
### <a name="sorting-an-array-or-collection-whose-objects-cannot-be-compared"></a><span data-ttu-id="32ae1-177">Ordinamento di una matrice o raccolta i cui oggetti non possono essere confrontate.</span><span class="sxs-lookup"><span data-stu-id="32ae1-177">Sorting an array or collection whose objects cannot be compared</span></span>  
 <span data-ttu-id="32ae1-178">Generico, ad esempio metodi, di ordinamento il <xref:System.Array.Sort%28System.Array%29?displayProperty=nameWithType> (metodo) o <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> (metodo), in genere richiedono che almeno uno degli oggetti da ordinare implementare il <xref:System.IComparable%601> o <xref:System.IComparable> interfaccia.</span><span class="sxs-lookup"><span data-stu-id="32ae1-178">General-purpose sorting methods, such as the <xref:System.Array.Sort%28System.Array%29?displayProperty=nameWithType> method or the <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> method, usually require that at least one of the objects to be sorted implement the <xref:System.IComparable%601> or the <xref:System.IComparable> interface.</span></span> <span data-ttu-id="32ae1-179">Se la raccolta o la matrice non può essere ordinati non, e il metodo genera un <xref:System.InvalidOperationException> eccezione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-179">If not, the collection or array cannot be sorted, and the method throws an  <xref:System.InvalidOperationException> exception.</span></span> <span data-ttu-id="32ae1-180">L'esempio seguente definisce un `Person` classe archivi due `Person` gli oggetti in un oggetto generico <xref:System.Collections.Generic.List%601> oggetto e i tentativi per ordinarli.</span><span class="sxs-lookup"><span data-stu-id="32ae1-180">The following example defines a `Person` class, stores two `Person` objects in a generic <xref:System.Collections.Generic.List%601> object, and attempts to sort them.</span></span> <span data-ttu-id="32ae1-181">Come illustrato nell'esempio, la chiamata a dall'output di <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> metodo genera un <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="32ae1-181">As the output from the example shows, the call to the <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> method throws an <xref:System.InvalidOperationException>.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#12](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort1.cs#12)]
 [!code-vb[System.InvalidOperationException#12](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort1.vb#12)]  
  
 <span data-ttu-id="32ae1-182">È possibile eliminare l'eccezione in uno dei tre modi:</span><span class="sxs-lookup"><span data-stu-id="32ae1-182">You can eliminate the exception in any of three ways:</span></span>  
  
-   <span data-ttu-id="32ae1-183">Se si può essere proprietaria del tipo che si sta tentando di eseguire l'ordinamento (vale a dire, se si ha il controllo relativo codice sorgente), è possibile modificarlo per implementare il <xref:System.IComparable%601> o <xref:System.IComparable> interfaccia.</span><span class="sxs-lookup"><span data-stu-id="32ae1-183">If you can own the type that you are trying to sort (that is, if you control its source code), you can modify it to implement the <xref:System.IComparable%601> or the <xref:System.IComparable> interface.</span></span> <span data-ttu-id="32ae1-184">Ciò richiede che si implementa il <xref:System.IComparable%601.CompareTo%2A?displayProperty=nameWithType> o <xref:System.IComparable.CompareTo%2A> metodo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-184">This requires that you implement either the <xref:System.IComparable%601.CompareTo%2A?displayProperty=nameWithType> or the <xref:System.IComparable.CompareTo%2A> method.</span></span> <span data-ttu-id="32ae1-185">Aggiunta di un'implementazione dell'interfaccia a un tipo esistente non è una modifica di rilievo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-185">Adding an interface implementation to an existing type is not a breaking change.</span></span>  
  
     <span data-ttu-id="32ae1-186">Nell'esempio seguente viene utilizzato questo approccio per fornire un <xref:System.IComparable%601> implementazione per il `Person` classe.</span><span class="sxs-lookup"><span data-stu-id="32ae1-186">The following example uses this approach to provide an <xref:System.IComparable%601> implementation  for the `Person` class.</span></span> <span data-ttu-id="32ae1-187">È comunque possibile chiamare la raccolta o un metodo di ordinamento Generale della matrice e, come illustrato nell'output dell'esempio, la raccolta Ordina correttamente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-187">You can still call the collection or array's general sorting method and, as the output from the example shows, the collection sorts successfully.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#13](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort2.cs#13)]
     [!code-vb[System.InvalidOperationException#13](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort2.vb#13)]  
  
-   <span data-ttu-id="32ae1-188">Se non è possibile modificare il codice sorgente per il tipo a cui si sta tentando di eseguire l'ordinamento, è possibile definire una classe di ordinamento speciale che implementa il <xref:System.Collections.Generic.IComparer%601> interfaccia.</span><span class="sxs-lookup"><span data-stu-id="32ae1-188">If you cannot modify the source code for the type you are trying to sort, you can define a special-purpose sorting class that implements the <xref:System.Collections.Generic.IComparer%601> interface.</span></span>  <span data-ttu-id="32ae1-189">È possibile chiamare un overload di `Sort` metodo che include un <xref:System.Collections.Generic.IComparer%601> parametro.</span><span class="sxs-lookup"><span data-stu-id="32ae1-189">You can call an overload of the `Sort` method that includes an  <xref:System.Collections.Generic.IComparer%601> parameter.</span></span> <span data-ttu-id="32ae1-190">Questo approccio è particolarmente utile se si desidera sviluppare una classe specializzata di ordinamento che è possibile ordinare gli oggetti in base a più criteri.</span><span class="sxs-lookup"><span data-stu-id="32ae1-190">This approach is especially useful if you want to develop a specialized sorting class that can sort objects based on multiple criteria.</span></span>  
  
     <span data-ttu-id="32ae1-191">L'esempio seguente usa l'approccio personalizzato sviluppando `PersonComparer` classe che viene utilizzato per ordinare `Person` raccolte.</span><span class="sxs-lookup"><span data-stu-id="32ae1-191">The following example uses the approach by developing a custom `PersonComparer` class that is used to sort `Person` collections.</span></span>  <span data-ttu-id="32ae1-192">Passa quindi un'istanza di questa classe per il <xref:System.Collections.Generic.List%601.Sort%28System.Collections.Generic.IComparer%7B%600%7D%29?displayProperty=nameWithType> metodo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-192">It then passes an instance of this class to the <xref:System.Collections.Generic.List%601.Sort%28System.Collections.Generic.IComparer%7B%600%7D%29?displayProperty=nameWithType> method.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#14](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort3.cs#14)]
     [!code-vb[System.InvalidOperationException#14](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort3.vb#14)]  
  
-   <span data-ttu-id="32ae1-193">Se non è possibile modificare il codice sorgente per il tipo si sta tentando di eseguire l'ordinamento, è possibile creare un <xref:System.Comparison%601> delegato per eseguire l'ordinamento.</span><span class="sxs-lookup"><span data-stu-id="32ae1-193">If you cannot modify the source code for the type you are trying to sort, you can create a  <xref:System.Comparison%601> delegate to perform the sorting.</span></span> <span data-ttu-id="32ae1-194">La firma del delegato è</span><span class="sxs-lookup"><span data-stu-id="32ae1-194">The delegate signature is</span></span>  
  
    ```vb  
    Function Comparison(Of T)(x As T, y As T) As Integer  
    ```  
  
    ```csharp  
    int Comparison<T>(T x, T y)  
    ```  
  
     <span data-ttu-id="32ae1-195">L'esempio seguente usa l'approccio definendo un `PersonComparison` metodo corrispondente di <xref:System.Comparison%601> firma del delegato.</span><span class="sxs-lookup"><span data-stu-id="32ae1-195">The following example uses the approach by defining a  `PersonComparison` method that matches the  <xref:System.Comparison%601> delegate signature.</span></span>  <span data-ttu-id="32ae1-196">Passa quindi questo delegato per il <xref:System.Collections.Generic.List%601.Sort%28System.Comparison%7B%600%7D%29?displayProperty=nameWithType> metodo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-196">It then passes this delegate to the <xref:System.Collections.Generic.List%601.Sort%28System.Comparison%7B%600%7D%29?displayProperty=nameWithType> method.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#15](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort4.cs#15)]
     [!code-vb[System.InvalidOperationException#15](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort4.vb#15)]  
  
<a name="Nullable"></a>   
### <a name="casting-a-nullablet-that-is-null-to-its-underlying-type"></a><span data-ttu-id="32ae1-197">Cast di un tipo Nullable\<T > null al relativo tipo sottostante</span><span class="sxs-lookup"><span data-stu-id="32ae1-197">Casting a Nullable\<T> that is null to its underlying type</span></span>  
 <span data-ttu-id="32ae1-198">Il tentativo di eseguire il cast un <xref:System.Nullable%601> valore `null` al relativo tipo sottostante genera un <xref:System.InvalidOperationException> eccezione e viene visualizzato il messaggio di errore "**oggetto Nullable deve avere un valore.**</span><span class="sxs-lookup"><span data-stu-id="32ae1-198">Attempting to cast a <xref:System.Nullable%601> value that is `null` to its underlying type throws an <xref:System.InvalidOperationException> exception  and displays the error message, "**Nullable object must have a value.**</span></span>  
  
 <span data-ttu-id="32ae1-199">Nell'esempio seguente genera un <xref:System.InvalidOperationException> eccezione durante il tentativo di eseguire l'iterazione di una matrice che include un `Nullable(Of Integer)` valore.</span><span class="sxs-lookup"><span data-stu-id="32ae1-199">The following example throws an <xref:System.InvalidOperationException> exception  when it attempts to iterate an array that includes a `Nullable(Of Integer)` value.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Nullable1.cs#4)]
 [!code-vb[System.InvalidOperationException#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Nullable1.vb#4)]  
  
 <span data-ttu-id="32ae1-200">Per evitare l'eccezione:</span><span class="sxs-lookup"><span data-stu-id="32ae1-200">To prevent the exception:</span></span>  
  
-   <span data-ttu-id="32ae1-201">Utilizzare il <xref:System.Nullable%601.HasValue%2A?displayProperty=nameWithType> proprietà per selezionare solo gli elementi che non sono `null`.</span><span class="sxs-lookup"><span data-stu-id="32ae1-201">Use the <xref:System.Nullable%601.HasValue%2A?displayProperty=nameWithType> property to select only those elements that are not `null`.</span></span>  
  
-   <span data-ttu-id="32ae1-202">Chiamare uno del <xref:System.Nullable%601.GetValueOrDefault%2A?displayProperty=nameWithType> overload per fornire un valore predefinito per un `null` valore.</span><span class="sxs-lookup"><span data-stu-id="32ae1-202">Call one of the <xref:System.Nullable%601.GetValueOrDefault%2A?displayProperty=nameWithType> overloads to provide a default value for a `null` value.</span></span>  
  
 <span data-ttu-id="32ae1-203">Nell'esempio vengono entrambi per evitare il <xref:System.InvalidOperationException> eccezione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-203">The following example does both to avoid the  <xref:System.InvalidOperationException> exception.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Nullable2.cs#5)]
 [!code-vb[System.InvalidOperationException#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Nullable2.vb#5)]  
  
<a name="Empty"></a>   
### <a name="calling-a-systemlinqenumerable-method-on-an-empty-collection"></a><span data-ttu-id="32ae1-204">Chiamata a un metodo Enumerable su una raccolta vuota</span><span class="sxs-lookup"><span data-stu-id="32ae1-204">Calling a System.Linq.Enumerable method on an empty collection</span></span>  
 <span data-ttu-id="32ae1-205">Il <xref:System.Linq.Enumerable.Aggregate%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Max%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Min%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, e <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> metodi eseguono operazioni in una sequenza e restituiscono un singolo risultato.</span><span class="sxs-lookup"><span data-stu-id="32ae1-205">The <xref:System.Linq.Enumerable.Aggregate%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Max%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Min%2A?displayProperty=nameWithType>,  <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, and <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> methods perform operations on a sequence and return a single result.</span></span>   <span data-ttu-id="32ae1-206">Alcuni overload di questi metodi generano un' <xref:System.InvalidOperationException> eccezione quando la sequenza è vuota, mentre gli altri overload restituiscono `null`.</span><span class="sxs-lookup"><span data-stu-id="32ae1-206">Some overloads of these methods throw an <xref:System.InvalidOperationException> exception when the sequence is empty, while other overloads return `null`.</span></span> <span data-ttu-id="32ae1-207">Il <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> metodo genera inoltre un <xref:System.InvalidOperationException> eccezione quando la sequenza contiene più di un elemento.</span><span class="sxs-lookup"><span data-stu-id="32ae1-207">The <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method also throws an <xref:System.InvalidOperationException> exception when the sequence contains more than one element.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="32ae1-208">La maggior parte dei metodi che generano un <xref:System.InvalidOperationException> eccezione sono gli overload.</span><span class="sxs-lookup"><span data-stu-id="32ae1-208">Most of the methods that throw an <xref:System.InvalidOperationException> exception are overloads.</span></span> <span data-ttu-id="32ae1-209">Assicurarsi di aver compreso il comportamento dell'overload scelto.</span><span class="sxs-lookup"><span data-stu-id="32ae1-209">Be sure that you understand the behavior of the overload that you choose.</span></span>  
  
 <span data-ttu-id="32ae1-210">Nella tabella seguente elenca i messaggi di eccezione dal <xref:System.InvalidOperationException> oggetti eccezione generati da chiamate ad alcune <xref:System.Linq.Enumerable?displayProperty=nameWithType> metodi.</span><span class="sxs-lookup"><span data-stu-id="32ae1-210">The following table lists the exception messages from the <xref:System.InvalidOperationException> exception objects thrown by calls to some <xref:System.Linq.Enumerable?displayProperty=nameWithType> methods.</span></span>  
  
|<span data-ttu-id="32ae1-211">Metodo</span><span class="sxs-lookup"><span data-stu-id="32ae1-211">Method</span></span>|<span data-ttu-id="32ae1-212">Messaggio</span><span class="sxs-lookup"><span data-stu-id="32ae1-212">Message</span></span>|  
|------------|-------------|  
|`Aggregate` <br /> `Average` <br /> `Last` <br /> `Max` <br /> `Min`|<span data-ttu-id="32ae1-213">**Sequenza non contiene elementi**</span><span class="sxs-lookup"><span data-stu-id="32ae1-213">**Sequence contains no elements**</span></span>|  
|`First`|<span data-ttu-id="32ae1-214">**Sequenza non contiene elementi corrispondenti**</span><span class="sxs-lookup"><span data-stu-id="32ae1-214">**Sequence contains no matching element**</span></span>|  
|`Single` <br /> `SingleOrDefault`|<span data-ttu-id="32ae1-215">**La sequenza contiene più di un elemento corrispondente**</span><span class="sxs-lookup"><span data-stu-id="32ae1-215">**Sequence contains more than one matching element**</span></span>|  
  
 <span data-ttu-id="32ae1-216">Come eliminare o gestire l'eccezione dipende dal ipotesi dell'applicazione e in particolare metodo che viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="32ae1-216">How you eliminate or handle the exception depends on your application's assumptions and on the particular method you call.</span></span>  
  
-   <span data-ttu-id="32ae1-217">Quando si sceglie intenzionalmente chiama uno di questi metodi senza verificare la presenza di una sequenza vuota, si presuppone che la sequenza non sia vuota e che una sequenza vuota sia un'occorrenza imprevista.</span><span class="sxs-lookup"><span data-stu-id="32ae1-217">When you deliberately call one of these methods without checking for an empty sequence, you are assuming that the sequence is not empty, and that an empty sequence is an unexpected occurrence.</span></span> <span data-ttu-id="32ae1-218">In questo caso, rilevamento o rigenerare l'eccezione è appropriato.</span><span class="sxs-lookup"><span data-stu-id="32ae1-218">In this case, catching or rethrowing the exception is appropriate .</span></span>  
  
-   <span data-ttu-id="32ae1-219">Se l'impossibilità di verificare la presenza di una sequenza vuota è accidentale, è possibile chiamare uno degli overload di <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> overload per determinare se una sequenza contiene elementi.</span><span class="sxs-lookup"><span data-stu-id="32ae1-219">If your failure to check for an empty sequence was inadvertent, you can  call one of the overloads of the <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> overload to determine whether a sequence contains any elements.</span></span>  
  
    > [!TIP]
    >  <span data-ttu-id="32ae1-220">La chiamata di <xref:System.Linq.Enumerable.Any%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> metodo prima di generare una sequenza può migliorare le prestazioni se i dati per l'elaborazione potrebbero contenere un numero elevato di elementi o se l'operazione che genera la sequenza è onerosa.</span><span class="sxs-lookup"><span data-stu-id="32ae1-220">Calling the <xref:System.Linq.Enumerable.Any%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method before generating a sequence can improve performance if the data to be processed might contain a large number of elements or if operation that generates the sequence is expensive.</span></span>  
  
-   <span data-ttu-id="32ae1-221">Se è stato chiamato un metodo, ad esempio <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, o <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, è possibile sostituire un metodo alternativo, ad esempio <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.LastOrDefault%2A?displayProperty=nameWithType>, o <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>, che restituisce un valore predefinito anziché un membro della sequenza.</span><span class="sxs-lookup"><span data-stu-id="32ae1-221">If you've called a method such as <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, or <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, you can substitute an alternate method, such as <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.LastOrDefault%2A?displayProperty=nameWithType>, or  <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>, that returns a default value instead of a member of the sequence.</span></span>  
  
 <span data-ttu-id="32ae1-222">Gli esempi di forniscono ulteriori dettagli.</span><span class="sxs-lookup"><span data-stu-id="32ae1-222">The examples provide additional detail.</span></span>  
  
 <span data-ttu-id="32ae1-223">L'esempio seguente usa il <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType> metodo per calcolare la media di una sequenza i cui valori sono maggiori di 4.</span><span class="sxs-lookup"><span data-stu-id="32ae1-223">The following example uses the <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType> method to compute the average of a sequence whose values are greater than 4.</span></span> <span data-ttu-id="32ae1-224">Poiché non valori della matrice originale superano 4, non i valori sono inclusi nella sequenza e il metodo genera un <xref:System.InvalidOperationException> eccezione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-224">Since no values from the original array exceed 4, no values are included in the sequence, and the method throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#6](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable1.cs#6)]
 [!code-vb[System.InvalidOperationException#6](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable1.vb#6)]  
  
 <span data-ttu-id="32ae1-225">L'eccezione può essere eliminato chiamando il <xref:System.Linq.Enumerable.Any%2A> metodo per determinare se la sequenza contiene elementi prima di chiamare il metodo che elabora la sequenza, come illustrato nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-225">The exception can be eliminated by calling the <xref:System.Linq.Enumerable.Any%2A> method to determine whether the sequence contains any elements before calling the method that processes the sequence, as the following example shows.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#7](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable2.cs#7)]
 [!code-vb[System.InvalidOperationException#7](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable2.vb#7)]  
  
 <span data-ttu-id="32ae1-226">Il <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> metodo restituisce il primo elemento in una sequenza o il primo elemento in una sequenza che soddisfa una condizione specificata.</span><span class="sxs-lookup"><span data-stu-id="32ae1-226">The <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> method returns the first item in a sequence or the first element in a sequence that satisfies a specified condition.</span></span> <span data-ttu-id="32ae1-227">Se la sequenza è vuota e pertanto non dispone di un primo elemento, viene generata una <xref:System.InvalidOperationException> eccezione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-227">If the sequence is empty and therefore does not have a first element, it throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="32ae1-228">Nell'esempio seguente, il <xref:System.Linq.Enumerable.First%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> metodo genera un <xref:System.InvalidOperationException> eccezione perché la matrice di dbQueryResults non contiene un elemento maggiore di 4.</span><span class="sxs-lookup"><span data-stu-id="32ae1-228">In the following example, the <xref:System.Linq.Enumerable.First%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method throws an <xref:System.InvalidOperationException> exception because the dbQueryResults array doesn't contain an element greater than 4.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#8](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable3.cs#8)]
 [!code-vb[System.InvalidOperationException#8](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable3.vb#8)]  
  
 <span data-ttu-id="32ae1-229">È possibile chiamare il <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> anziché <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> per restituire un oggetto specificato o il valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="32ae1-229">You can call the <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> method instead of <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> to return a specified or default value.</span></span> <span data-ttu-id="32ae1-230">Se il metodo non viene trovato un primo elemento nella sequenza, restituisce il valore predefinito per tale tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="32ae1-230">If the method does not find a first element in the sequence, it returns  the default value for that data type.</span></span>  <span data-ttu-id="32ae1-231">Il valore predefinito è `null` per un tipo riferimento, zero per un tipo di dati numerici e <xref:System.DateTime.MinValue?displayProperty=nameWithType> per il <xref:System.DateTime> tipo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-231">The default value is `null` for a reference type, zero for a numeric data type, and <xref:System.DateTime.MinValue?displayProperty=nameWithType> for the <xref:System.DateTime> type.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="32ae1-232">Il valore restituito da interpretare il <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> metodo è spesso complicato dal fatto che il valore predefinito del tipo può essere un valore valido nella sequenza.</span><span class="sxs-lookup"><span data-stu-id="32ae1-232">Interpreting the value returned by the <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> method is often complicated by the fact that the default value of the type can be a valid value in the sequence.</span></span> <span data-ttu-id="32ae1-233">In questo caso, è una chiamata di <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> metodo per determinare se la sequenza dispone di membri validi prima di chiamare il <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> metodo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-233">In this case, you an call the <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> method to determine whether the sequence has valid members before calling the <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="32ae1-234">L'esempio seguente chiama il <xref:System.Linq.Enumerable.FirstOrDefault%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> per impedire il <xref:System.InvalidOperationException> eccezione nell'esempio precedente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-234">The following example calls the  <xref:System.Linq.Enumerable.FirstOrDefault%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method to prevent the <xref:System.InvalidOperationException> exception thrown in the previous example.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#9](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable4.cs#9)]
 [!code-vb[System.InvalidOperationException#9](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable4.vb#9)]  
  
<a name="Single"></a>   
### <a name="calling-enumerablesingle-or-enumerablesingleordefault-on-a-sequence-without-one-element"></a><span data-ttu-id="32ae1-235">La chiamata Enumerable o SingleOrDefault su una sequenza senza un elemento</span><span class="sxs-lookup"><span data-stu-id="32ae1-235">Calling Enumerable.Single or Enumerable.SingleOrDefault on a sequence without one element</span></span>  
 <span data-ttu-id="32ae1-236">Il <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> metodo restituisce l'unico elemento di una sequenza o l'unico elemento di una sequenza che soddisfa una condizione specificata.</span><span class="sxs-lookup"><span data-stu-id="32ae1-236">The <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> method returns the only element of a sequence, or the only element of a sequence that meets a specified condition.</span></span>    <span data-ttu-id="32ae1-237">Se non sono presenti elementi nella sequenza o se è presente più di un elemento, il metodo genera un <xref:System.InvalidOperationException> eccezione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-237">If there are no elements in the sequence, or if there is more than one element , the method throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="32ae1-238">È possibile utilizzare il <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> per restituire un valore predefinito anziché generare un'eccezione quando la sequenza non contiene elementi.</span><span class="sxs-lookup"><span data-stu-id="32ae1-238">You can use the <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method to return a default value instead of throwing an exception when the sequence contains no elements.</span></span> <span data-ttu-id="32ae1-239">Tuttavia, il <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> metodo genera comunque un <xref:System.InvalidOperationException> eccezione quando la sequenza contiene più di un elemento.</span><span class="sxs-lookup"><span data-stu-id="32ae1-239">However, the <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method still throws an <xref:System.InvalidOperationException> exception  when the sequence contains more than one element.</span></span>  
  
 <span data-ttu-id="32ae1-240">Nella tabella seguente elenca i messaggi di eccezione dal <xref:System.InvalidOperationException> oggetti eccezione generati da chiamate al <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> e <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> metodi.</span><span class="sxs-lookup"><span data-stu-id="32ae1-240">The following table lists the exception messages from the <xref:System.InvalidOperationException> exception objects thrown by calls to the <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> and <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> methods.</span></span>  
  
|<span data-ttu-id="32ae1-241">Metodo</span><span class="sxs-lookup"><span data-stu-id="32ae1-241">Method</span></span>|<span data-ttu-id="32ae1-242">Messaggio</span><span class="sxs-lookup"><span data-stu-id="32ae1-242">Message</span></span>|  
|------------|-------------|  
|`Single`|<span data-ttu-id="32ae1-243">**Sequenza non contiene elementi corrispondenti**</span><span class="sxs-lookup"><span data-stu-id="32ae1-243">**Sequence contains no matching element**</span></span>|  
|`Single` <br /> `SingleOrDefault`|<span data-ttu-id="32ae1-244">**La sequenza contiene più di un elemento corrispondente**</span><span class="sxs-lookup"><span data-stu-id="32ae1-244">**Sequence contains more than one matching element**</span></span>|  
  
 <span data-ttu-id="32ae1-245">Nell'esempio seguente, la chiamata al <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> metodo genera un <xref:System.InvalidOperationException> eccezione perché la sequenza non dispone di un elemento maggiore di 4.</span><span class="sxs-lookup"><span data-stu-id="32ae1-245">In the following example, the call to the <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> method throws an <xref:System.InvalidOperationException> exception because the sequence doesn't have an element greater than 4.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#10](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable5.cs#10)]
 [!code-vb[System.InvalidOperationException#10](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable5.vb#10)]  
  
 <span data-ttu-id="32ae1-246">Nell'esempio seguente tenta di impedire il <xref:System.InvalidOperationException> eccezione generata quando una sequenza è vuota, chiamare invece il <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> metodo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-246">The following example attempts to prevent the <xref:System.InvalidOperationException> exception thrown when a sequence is empty by instead calling the <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="32ae1-247">Tuttavia, poiché questa sequenza restituisce più gli elementi il cui valore è maggiore di 2, genera inoltre un <xref:System.InvalidOperationException> eccezione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-247">However, because this sequence returns multiple elements whose value is greater than 2, it also throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#11](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable6.cs#11)]
 [!code-vb[System.InvalidOperationException#11](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable6.vb#11)]  
  
 <span data-ttu-id="32ae1-248">La chiamata di <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> metodo presuppone che una sequenza o la sequenza che soddisfa i criteri specificati contiene un solo elemento.</span><span class="sxs-lookup"><span data-stu-id="32ae1-248">Calling the <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> method assumes that either a sequence or the sequence that meets specified criteria contains only one element.</span></span>  <span data-ttu-id="32ae1-249"><xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> si presuppone una sequenza con zero o un risultato, ma non più.</span><span class="sxs-lookup"><span data-stu-id="32ae1-249"><xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> assumes a sequence with zero or one result, but no more.</span></span> <span data-ttu-id="32ae1-250">Se questa ipotesi sia intenzionale da parte dell'utente e non vengono soddisfatte queste condizioni, rigenerare o in anticipo il valore risultante <xref:System.InvalidOperationException> appropriato.</span><span class="sxs-lookup"><span data-stu-id="32ae1-250">If this assumption is a deliberate one on your part and these conditions are not met, rethrowing or catching the resulting <xref:System.InvalidOperationException> is appropriate.</span></span> <span data-ttu-id="32ae1-251">In caso contrario, o se si prevede il verificano di condizioni non valide con una certa frequenza, è consigliabile usare un altro <xref:System.Linq.Enumerable> metodo, ad esempio <xref:System.Linq.Enumerable.FirstOrDefault%2A> o <xref:System.Linq.Enumerable.Where%2A>.</span><span class="sxs-lookup"><span data-stu-id="32ae1-251">Otherwise, or if you expect that invalid conditions will occur with some frequency, you should consider using some other <xref:System.Linq.Enumerable> method, such as <xref:System.Linq.Enumerable.FirstOrDefault%2A> or <xref:System.Linq.Enumerable.Where%2A>.</span></span>  
  
<a name="Emit"></a>   
### <a name="dynamic-cross-application-domain-field-access"></a><span data-ttu-id="32ae1-252">Accesso al campo dinamico dominio tra applicazioni</span><span class="sxs-lookup"><span data-stu-id="32ae1-252">Dynamic cross-application domain field access</span></span>  
 <span data-ttu-id="32ae1-253">Il <xref:System.Reflection.Emit.OpCodes.Ldflda?displayProperty=nameWithType> Microsoft intermediate language (MSIL) istruzione genera un <xref:System.InvalidOperationException> eccezione se l'oggetto che contiene il campo cui si sta tentando di recuperare l'indirizzo non è presente all'interno del dominio applicazione in cui è in esecuzione il codice.</span><span class="sxs-lookup"><span data-stu-id="32ae1-253">The <xref:System.Reflection.Emit.OpCodes.Ldflda?displayProperty=nameWithType> Microsoft intermediate language (MSIL) instruction throws an <xref:System.InvalidOperationException> exception if the object containing the field whose address you are trying to retrieve is not within the application domain in which your code is executing.</span></span> <span data-ttu-id="32ae1-254">L'indirizzo di un campo è accessibile solo dal dominio applicazione in cui si trova.</span><span class="sxs-lookup"><span data-stu-id="32ae1-254">The address of a field can only be accessed from the application domain in which it resides.</span></span>  
  
<a name="Throwing"></a>   
## <a name="throwing-an-invalidoperationexception-exception"></a><span data-ttu-id="32ae1-255">Generare un'eccezione InvalidOperationException</span><span class="sxs-lookup"><span data-stu-id="32ae1-255">Throwing an InvalidOperationException exception</span></span>  
 <span data-ttu-id="32ae1-256">È necessario generare un <xref:System.InvalidOperationException> eccezione solo quando lo stato dell'oggetto per qualche motivo non supporta una particolare chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="32ae1-256">You should throw an <xref:System.InvalidOperationException> exception only when the state of your object for some reason does not support a particular method call.</span></span> <span data-ttu-id="32ae1-257">Ovvero, la chiamata al metodo è valida in alcune circostanze o contesti, ma non è valida in altri.</span><span class="sxs-lookup"><span data-stu-id="32ae1-257">That is, the method call is valid in some circumstances or contexts, but is invalid in others.</span></span>  
  
 <span data-ttu-id="32ae1-258">Se l'errore nella chiamata al metodo a causa di argomenti non validi, quindi <xref:System.ArgumentException> o una delle relative classi derivate, <xref:System.ArgumentNullException> o <xref:System.ArgumentOutOfRangeException>, devono invece essere generata.</span><span class="sxs-lookup"><span data-stu-id="32ae1-258">If the method invocation failure is due to invalid arguments, then <xref:System.ArgumentException> or one of its derived classes, <xref:System.ArgumentNullException> or <xref:System.ArgumentOutOfRangeException>, should be thrown instead.</span></span>  
  
<a name="Misc"></a>   
## <a name="miscellaneous-information"></a><span data-ttu-id="32ae1-259">Informazioni di vario tipo</span><span class="sxs-lookup"><span data-stu-id="32ae1-259">Miscellaneous information</span></span>  
 <span data-ttu-id="32ae1-260"><xref:System.InvalidOperationException> utilizza COR_E_INVALIDOPERATION HRESULT, con valore 0x80131509.</span><span class="sxs-lookup"><span data-stu-id="32ae1-260"><xref:System.InvalidOperationException> uses the HRESULT COR_E_INVALIDOPERATION, which has the value 0x80131509.</span></span>  
  
 <span data-ttu-id="32ae1-261">Per un elenco di valori di proprietà iniziali per un'istanza di <xref:System.InvalidOperationException>, vedere il <xref:System.InvalidOperationException.%23ctor%2A> costruttori.</span><span class="sxs-lookup"><span data-stu-id="32ae1-261">For a list of initial property values for an instance of <xref:System.InvalidOperationException>, see the <xref:System.InvalidOperationException.%23ctor%2A> constructors.</span></span>  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Exception" />
    <altmember cref="T:System.Collections.IEnumerator" />
    <altmember cref="T:System.Resources.ResourceSet" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="32ae1-262">Inizializza una nuova istanza della classe <see cref="T:System.InvalidOperationException" />.</span><span class="sxs-lookup"><span data-stu-id="32ae1-262">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InvalidOperationException ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InvalidOperationException();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="32ae1-263">Inizializza una nuova istanza della classe <see cref="T:System.InvalidOperationException" />.</span><span class="sxs-lookup"><span data-stu-id="32ae1-263">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="32ae1-264">Questo costruttore inizializza la <xref:System.Exception.Message%2A> proprietà della nuova istanza di un messaggio fornito dal sistema che descrive l'errore, ad esempio "non è possibile eseguire l'operazione richiesta".</span><span class="sxs-lookup"><span data-stu-id="32ae1-264">This constructor initializes the <xref:System.Exception.Message%2A> property of the new instance to a system-supplied message that describes the error, such as "The requested operation cannot be performed."</span></span> <span data-ttu-id="32ae1-265">Questo messaggio prende in considerazione le impostazioni cultura correnti del sistema.</span><span class="sxs-lookup"><span data-stu-id="32ae1-265">This message takes into account the current system culture.</span></span>  
  
 <span data-ttu-id="32ae1-266">Nella tabella seguente vengono illustrati i valori di proprietà iniziali per un'istanza di <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="32ae1-266">The following table shows the initial property values for an instance of <xref:System.InvalidOperationException>.</span></span>  
  
|<span data-ttu-id="32ae1-267">Proprietà</span><span class="sxs-lookup"><span data-stu-id="32ae1-267">Property</span></span>|<span data-ttu-id="32ae1-268">Valore</span><span class="sxs-lookup"><span data-stu-id="32ae1-268">Value</span></span>|  
|--------------|-----------|  
|<xref:System.Exception.InnerException%2A>|<span data-ttu-id="32ae1-269">Riferimento null (`Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="32ae1-269">A null reference (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Exception.Message%2A>|<span data-ttu-id="32ae1-270">Stringa del messaggio di errore localizzato.</span><span class="sxs-lookup"><span data-stu-id="32ae1-270">The localized error message string.</span></span>|  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InvalidOperationException (string message);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InvalidOperationException(System::String ^ message);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="32ae1-271">Messaggio in cui viene descritto l'errore.</span><span class="sxs-lookup"><span data-stu-id="32ae1-271">The message that describes the error.</span></span></param>
        <summary><span data-ttu-id="32ae1-272">Inizializza una nuova istanza della classe <see cref="T:System.InvalidOperationException" /> con un messaggio di errore specificato.</span><span class="sxs-lookup"><span data-stu-id="32ae1-272">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class with a specified error message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="32ae1-273">Questo costruttore inizializza la <xref:System.Exception.Message%2A?displayProperty=nameWithType> proprietà della nuova eccezione utilizzando il `message` parametro.</span><span class="sxs-lookup"><span data-stu-id="32ae1-273">This constructor initializes the <xref:System.Exception.Message%2A?displayProperty=nameWithType> property of the new exception using the `message` parameter.</span></span> <span data-ttu-id="32ae1-274">Il contenuto di `message` deve essere facilmente comprensibile.</span><span class="sxs-lookup"><span data-stu-id="32ae1-274">The content of `message` is intended to be understood by humans.</span></span> <span data-ttu-id="32ae1-275">Il chiamante del costruttore deve garantire che la stringa sia stata localizzata in base alle impostazioni cultura correnti del sistema.</span><span class="sxs-lookup"><span data-stu-id="32ae1-275">The caller of this constructor is required to ensure that this string has been localized for the current system culture.</span></span>  
  
 <span data-ttu-id="32ae1-276">Nella tabella seguente vengono illustrati i valori di proprietà iniziali per un'istanza di <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="32ae1-276">The following table shows the initial property values for an instance of <xref:System.InvalidOperationException>.</span></span>  
  
|<span data-ttu-id="32ae1-277">Proprietà</span><span class="sxs-lookup"><span data-stu-id="32ae1-277">Property</span></span>|<span data-ttu-id="32ae1-278">Valore</span><span class="sxs-lookup"><span data-stu-id="32ae1-278">Value</span></span>|  
|--------------|-----------|  
|<xref:System.Exception.InnerException%2A>|<span data-ttu-id="32ae1-279">Riferimento null (`Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="32ae1-279">A null reference (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Exception.Message%2A>|<span data-ttu-id="32ae1-280">Stringa del messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="32ae1-280">The error message string.</span></span>|  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="protected InvalidOperationException (System.Runtime.Serialization.SerializationInfo info, System.Runtime.Serialization.StreamingContext context);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig specialname rtspecialname instance void .ctor(class System.Runtime.Serialization.SerializationInfo info, valuetype System.Runtime.Serialization.StreamingContext context) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor(System.Runtime.Serialization.SerializationInfo,System.Runtime.Serialization.StreamingContext)" />
      <MemberSignature Language="VB.NET" Value="Protected Sub New (info As SerializationInfo, context As StreamingContext)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; InvalidOperationException(System::Runtime::Serialization::SerializationInfo ^ info, System::Runtime::Serialization::StreamingContext context);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="info" Type="System.Runtime.Serialization.SerializationInfo" />
        <Parameter Name="context" Type="System.Runtime.Serialization.StreamingContext" />
      </Parameters>
      <Docs>
        <param name="info"><span data-ttu-id="32ae1-281">Oggetto che contiene i dati oggetto serializzati.</span><span class="sxs-lookup"><span data-stu-id="32ae1-281">The object that holds the serialized object data.</span></span></param>
        <param name="context"><span data-ttu-id="32ae1-282">Informazioni contestuali sull'origine o sulla destinazione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-282">The contextual information about the source or destination.</span></span></param>
        <summary><span data-ttu-id="32ae1-283">Inizializza una nuova istanza della classe <see cref="T:System.InvalidOperationException" /> con dati serializzati.</span><span class="sxs-lookup"><span data-stu-id="32ae1-283">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class with serialized data.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="32ae1-284">Questo costruttore viene chiamato durante la deserializzazione per ricostituire l'oggetto eccezione trasmesso su un flusso.</span><span class="sxs-lookup"><span data-stu-id="32ae1-284">This constructor is called during deserialization to reconstitute the exception object transmitted over a stream.</span></span> <span data-ttu-id="32ae1-285">Per ulteriori informazioni, vedere [serializzazione XML e SOAP](~/docs/standard/serialization/xml-and-soap-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="32ae1-285">For more information, see [XML and SOAP Serialization](~/docs/standard/serialization/xml-and-soap-serialization.md).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InvalidOperationException (string message, Exception innerException);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string message, class System.Exception innerException) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor(System.String,System.Exception)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (message As String, innerException As Exception)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InvalidOperationException(System::String ^ message, Exception ^ innerException);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="innerException" Type="System.Exception" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="32ae1-286">Messaggio di errore in cui viene indicato il motivo dell'eccezione.</span><span class="sxs-lookup"><span data-stu-id="32ae1-286">The error message that explains the reason for the exception.</span></span></param>
        <param name="innerException"><span data-ttu-id="32ae1-287">Eccezione che ha determinato l'eccezione corrente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-287">The exception that is the cause of the current exception.</span></span> <span data-ttu-id="32ae1-288">Se il parametro <c>innerException</c> non è un riferimento Null (<see langword="Nothing" /> in Visual Basic), l'eccezione corrente viene generata in un blocco <see langword="catch" /> che gestisce l'eccezione interna.</span><span class="sxs-lookup"><span data-stu-id="32ae1-288">If the <c>innerException</c> parameter is not a null reference (<see langword="Nothing" /> in Visual Basic), the current exception is raised in a <see langword="catch" /> block that handles the inner exception.</span></span></param>
        <summary><span data-ttu-id="32ae1-289">Inizializza una nuova istanza della classe <see cref="T:System.InvalidOperationException" /> con un messaggio di errore specificato e un riferimento all'eccezione interna che è la causa dell'eccezione corrente.</span><span class="sxs-lookup"><span data-stu-id="32ae1-289">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class with a specified error message and a reference to the inner exception that is the cause of this exception.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="32ae1-290">Un'eccezione generata come risultato diretto di un'eccezione precedente deve includere un riferimento all'eccezione precedente nella proprietà <xref:System.Exception.InnerException%2A>.</span><span class="sxs-lookup"><span data-stu-id="32ae1-290">An exception that is thrown as a direct result of a previous exception should include a reference to the previous exception in the <xref:System.Exception.InnerException%2A> property.</span></span> <span data-ttu-id="32ae1-291">La proprietà <xref:System.Exception.InnerException%2A> restituisce lo stesso valore che viene passato al costruttore o un riferimento null (`Nothing` in Visual Basic), se la proprietà <xref:System.Exception.InnerException%2A> non fornisce al costruttore il valore dell'eccezione interna.</span><span class="sxs-lookup"><span data-stu-id="32ae1-291">The <xref:System.Exception.InnerException%2A> property returns the same value that is passed into the constructor, or a null reference (`Nothing` in Visual Basic) if the <xref:System.Exception.InnerException%2A> property does not supply the inner exception value to the constructor.</span></span>  
  
 <span data-ttu-id="32ae1-292">Nella tabella seguente vengono illustrati i valori di proprietà iniziali per un'istanza di <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="32ae1-292">The following table shows the initial property values for an instance of <xref:System.InvalidOperationException>.</span></span>  
  
|<span data-ttu-id="32ae1-293">Proprietà</span><span class="sxs-lookup"><span data-stu-id="32ae1-293">Property</span></span>|<span data-ttu-id="32ae1-294">Valore</span><span class="sxs-lookup"><span data-stu-id="32ae1-294">Value</span></span>|  
|--------------|-----------|  
|<xref:System.Exception.InnerException%2A>|<span data-ttu-id="32ae1-295">Riferimento all'eccezione interna.</span><span class="sxs-lookup"><span data-stu-id="32ae1-295">The inner exception reference.</span></span>|  
|<xref:System.Exception.Message%2A>|<span data-ttu-id="32ae1-296">Stringa del messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="32ae1-296">The error message string.</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Exception" />
      </Docs>
    </Member>
  </Members>
</Type>