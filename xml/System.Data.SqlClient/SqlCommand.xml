<Type Name="SqlCommand" FullName="System.Data.SqlClient.SqlCommand">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="232e437bba67fbe5cf8e4ca13ad75a55cbdba1dd" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="it-IT" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36680606" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class SqlCommand : System.Data.Common.DbCommand, ICloneable, IDisposable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit SqlCommand extends System.Data.Common.DbCommand implements class System.Data.IDbCommand, class System.ICloneable, class System.IDisposable" />
  <TypeSignature Language="DocId" Value="T:System.Data.SqlClient.SqlCommand" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class SqlCommand&#xA;Inherits DbCommand&#xA;Implements ICloneable, IDisposable" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlCommand sealed : System::Data::Common::DbCommand, ICloneable, IDisposable" />
  <TypeSignature Language="F#" Value="type SqlCommand = class&#xA;    inherit DbCommand&#xA;    interface IDbCommand&#xA;    interface ICloneable&#xA;    interface IDisposable" />
  <AssemblyInfo>
    <AssemblyName>System.Data.SqlClient</AssemblyName>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Data</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Data.Common.DbCommand</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.ICloneable</InterfaceName>
    </Interface>
    <Interface>
      <InterfaceName>System.IDisposable</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute>
      <AttributeName>System.ComponentModel.DefaultEvent("RecordsAffected")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.Designer("Microsoft.VSDesigner.Data.VS.SqlCommandDesigner, Microsoft.VSDesigner, Version=0.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", "System.ComponentModel.Design.IDesigner")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.ToolboxItem("System.Drawing.Design.ToolboxItem, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="c00a7-101">Rappresenta un'istruzione Transact-SQL o una stored procedure da eseguire in relazione a un database SQL Server.</span>
      <span class="sxs-lookup">
        <span data-stu-id="c00a7-101">Represents a Transact-SQL statement or stored procedure to execute against a SQL Server database.</span>
      </span>
      <span data-ttu-id="c00a7-102">Questa classe non può essere ereditata.</span>
      <span class="sxs-lookup">
        <span data-stu-id="c00a7-102">This class cannot be inherited.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-103">Quando un'istanza di <xref:System.Data.SqlClient.SqlCommand> creazione, lettura/scrittura sono impostate sui valori iniziali.</span><span class="sxs-lookup"><span data-stu-id="c00a7-103">When an instance of <xref:System.Data.SqlClient.SqlCommand> is created, the read/write properties are set to their initial values.</span></span> <span data-ttu-id="c00a7-104">Per un elenco di questi valori, vedere il <xref:System.Data.SqlClient.SqlCommand> costruttore.</span><span class="sxs-lookup"><span data-stu-id="c00a7-104">For a list of these values, see the <xref:System.Data.SqlClient.SqlCommand> constructor.</span></span>  
  
 <span data-ttu-id="c00a7-105"><xref:System.Data.SqlClient.SqlCommand> comprende i seguenti metodi per l'esecuzione di comandi a livello di database SQL Server:</span><span class="sxs-lookup"><span data-stu-id="c00a7-105"><xref:System.Data.SqlClient.SqlCommand> features the following methods for executing commands at a SQL Server database:</span></span>  
  
|<span data-ttu-id="c00a7-106">Elemento</span><span class="sxs-lookup"><span data-stu-id="c00a7-106">Item</span></span>|<span data-ttu-id="c00a7-107">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c00a7-107">Description</span></span>|  
|----------|-----------------|  
|<xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A>|<span data-ttu-id="c00a7-108">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <xref:System.Data.SqlClient.SqlCommand>, in genere l'esecuzione di comandi, ad esempio INSERT, DELETE, UPDATE e istruzioni SET.</span><span class="sxs-lookup"><span data-stu-id="c00a7-108">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <xref:System.Data.SqlClient.SqlCommand>, generally executing commands such as INSERT, DELETE, UPDATE, and SET statements.</span></span> <span data-ttu-id="c00a7-109">Ogni chiamata a <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> devono essere abbinate a una chiamata a <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> che termina l'operazione, in genere in un thread separato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-109">Each call to <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> must be paired with a call to <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> which finishes the operation, typically on a separate thread.</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>|<span data-ttu-id="c00a7-110">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <xref:System.Data.SqlClient.SqlCommand> e recupera uno o più risultati imposta dal server.</span><span class="sxs-lookup"><span data-stu-id="c00a7-110">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <xref:System.Data.SqlClient.SqlCommand> and retrieves one or more results sets from the server.</span></span> <span data-ttu-id="c00a7-111">Ogni chiamata a <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> devono essere abbinate a una chiamata a <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> che termina l'operazione, in genere in un thread separato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-111">Each call to <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> must be paired with a call to <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> which finishes the operation, typically on a separate thread.</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A>|<span data-ttu-id="c00a7-112">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <xref:System.Data.SqlClient.SqlCommand>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-112">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <xref:System.Data.SqlClient.SqlCommand>.</span></span> <span data-ttu-id="c00a7-113">Ogni chiamata a `BeginExecuteXmlReader` devono essere abbinate a una chiamata a `EndExecuteXmlReader`, che completa l'operazione, in genere in un thread separato e restituisce un <xref:System.Xml.XmlReader> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-113">Each call to `BeginExecuteXmlReader` must be paired with a call to `EndExecuteXmlReader`, which finishes the operation, typically on a separate thread, and returns an <xref:System.Xml.XmlReader> object.</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>|<span data-ttu-id="c00a7-114">Esegue i comandi che restituiscono righe.</span><span class="sxs-lookup"><span data-stu-id="c00a7-114">Executes commands that return rows.</span></span> <span data-ttu-id="c00a7-115">Per ottenere migliori prestazioni, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> richiama i comandi mediante l'istruzione Transact-SQL `sp_executesql` stored procedure di sistema.</span><span class="sxs-lookup"><span data-stu-id="c00a7-115">For increased performance, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> invokes commands using the Transact-SQL `sp_executesql` system stored procedure.</span></span> <span data-ttu-id="c00a7-116">Pertanto, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> potrebbe non avere l'effetto che si desidera vengano utilizzati per eseguire i comandi, ad esempio le istruzioni Transact-SQL SET.</span><span class="sxs-lookup"><span data-stu-id="c00a7-116">Therefore, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> might not have the effect that you want if used to execute commands such as Transact-SQL SET statements.</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>|<span data-ttu-id="c00a7-117">Esegue i comandi, ad esempio le istruzioni Transact-SQL INSERT, DELETE, UPDATE e SET.</span><span class="sxs-lookup"><span data-stu-id="c00a7-117">Executes commands such as Transact-SQL INSERT, DELETE, UPDATE, and SET statements.</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.ExecuteScalar%2A>|<span data-ttu-id="c00a7-118">Recupera un valore singolo (ad esempio, un valore aggregato) da un database.</span><span class="sxs-lookup"><span data-stu-id="c00a7-118">Retrieves a single value (for example, an aggregate value) from a database.</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A>|<span data-ttu-id="c00a7-119">Invia la proprietà <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> alla proprietà <xref:System.Data.SqlClient.SqlCommand.Connection%2A> e compila un oggetto <xref:System.Xml.XmlReader>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-119">Sends the <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> to the <xref:System.Data.SqlClient.SqlCommand.Connection%2A> and builds an <xref:System.Xml.XmlReader> object.</span></span>|  
  
 <span data-ttu-id="c00a7-120">È possibile reimpostare la <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> riutilizzo e la proprietà di <xref:System.Data.SqlClient.SqlCommand> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-120">You can reset the <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> property and reuse the <xref:System.Data.SqlClient.SqlCommand> object.</span></span> <span data-ttu-id="c00a7-121">Tuttavia, è necessario chiudere il <xref:System.Data.SqlClient.SqlDataReader> prima di poter eseguire un comando nuovo o precedente.</span><span class="sxs-lookup"><span data-stu-id="c00a7-121">However, you must close the <xref:System.Data.SqlClient.SqlDataReader> before you can execute a new or previous command.</span></span>  
  
 <span data-ttu-id="c00a7-122">Se un <xref:System.Data.SqlClient.SqlException> viene generato dal metodo che esegue un <xref:System.Data.SqlClient.SqlCommand>, il <xref:System.Data.SqlClient.SqlConnection> rimane aperta quando il livello di gravità 19 o inferiore.</span><span class="sxs-lookup"><span data-stu-id="c00a7-122">If a <xref:System.Data.SqlClient.SqlException> is generated by the method executing a <xref:System.Data.SqlClient.SqlCommand>, the <xref:System.Data.SqlClient.SqlConnection> remains open when the severity level is 19 or less.</span></span> <span data-ttu-id="c00a7-123">Quando il livello di gravità è 20 o superiore, il server chiude normalmente il <xref:System.Data.SqlClient.SqlConnection>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-123">When the severity level is 20 or greater, the server ordinarily closes the <xref:System.Data.SqlClient.SqlConnection>.</span></span> <span data-ttu-id="c00a7-124">L'utente può tuttavia riaprire la connessione e continuare.</span><span class="sxs-lookup"><span data-stu-id="c00a7-124">However, the user can reopen the connection and continue.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c00a7-125">Senza nome, collettivamente indicati come ordinale, con parametri non sono supportati dal Provider di dati .NET Framework per SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c00a7-125">Nameless, also called ordinal, parameters are not supported by the .NET Framework Data Provider for SQL Server.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-126">Nell'esempio seguente viene creata una <xref:System.Data.SqlClient.SqlConnection>, una <xref:System.Data.SqlClient.SqlCommand>e un <xref:System.Data.SqlClient.SqlDataReader>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-126">The following example creates a <xref:System.Data.SqlClient.SqlConnection>, a <xref:System.Data.SqlClient.SqlCommand>, and a <xref:System.Data.SqlClient.SqlDataReader>.</span></span> <span data-ttu-id="c00a7-127">Nell'esempio legge i dati e li scrive nella console.</span><span class="sxs-lookup"><span data-stu-id="c00a7-127">The example reads through the data, writing it to the console.</span></span> <span data-ttu-id="c00a7-128">Infine, l'esempio chiude il <xref:System.Data.SqlClient.SqlDataReader> e quindi il <xref:System.Data.SqlClient.SqlConnection> alla chiusura di `Using` blocchi di codice.</span><span class="sxs-lookup"><span data-stu-id="c00a7-128">Finally, the example closes the <xref:System.Data.SqlClient.SqlDataReader> and then the <xref:System.Data.SqlClient.SqlConnection> as it exits the `Using` code blocks.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand Example#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand Example/CS/source.cs#1)]
 [!code-vb[Classic WebData SqlCommand Example#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand Example/VB/source.vb#1)]  
  
 <span data-ttu-id="c00a7-129">L'esempio seguente viene illustrato come creare ed eseguire diversi tipi di oggetti SqlCommand.</span><span class="sxs-lookup"><span data-stu-id="c00a7-129">The following sample shows how to create and execute different types of SqlCommand objects.</span></span>  
  
 <span data-ttu-id="c00a7-130">È necessario innanzitutto creare il database di esempio, eseguendo lo script seguente:</span><span class="sxs-lookup"><span data-stu-id="c00a7-130">First you must create the sample database, by executing the following script:</span></span>  
  
```  
USE [master]  
GO  
  
CREATE DATABASE [MySchool]  
GO  
  
USE [MySchool]  
GO  
  
SET ANSI_NULLS ON  
GO  
SET QUOTED_IDENTIFIER ON  
GO  
CREATE procedure [dbo].[CourseExtInfo] @CourseId int  
as  
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName  
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID  
where c.CourseID=@CourseId  
  
GO  
  
SET ANSI_NULLS ON  
GO  
SET QUOTED_IDENTIFIER ON  
GO  
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output  
as  
select @CourseCount=Count(c.CourseID)  
from course as c  
where c.DepartmentID=@DepartmentId  
  
select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator  
from Department as d  
where d.DepartmentID=@DepartmentId  
  
GO  
  
SET ANSI_NULLS ON  
GO  
SET QUOTED_IDENTIFIER ON  
GO  
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear]   
@Year int,@BudgetSum money output  
AS  
BEGIN  
        SELECT @BudgetSum=SUM([Budget])  
  FROM [MySchool].[dbo].[Department]  
  Where YEAR([StartDate])=@Year   
  
SELECT [DepartmentID]  
      ,[Name]  
      ,[Budget]  
      ,[StartDate]  
      ,[Administrator]  
  FROM [MySchool].[dbo].[Department]  
  Where YEAR([StartDate])=@Year  
  
END  
GO  
  
SET ANSI_NULLS ON  
GO  
SET QUOTED_IDENTIFIER ON  
GO  
CREATE TABLE [dbo].[Course]([CourseID] [nvarchar](10) NOT NULL,  
[Year] [smallint] NOT NULL,  
[Title] [nvarchar](100) NOT NULL,  
[Credits] [int] NOT NULL,  
[DepartmentID] [int] NOT NULL,  
 CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED   
(  
[CourseID] ASC,  
[Year] ASC  
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]) ON [PRIMARY]  
  
GO  
  
SET ANSI_NULLS ON  
GO  
SET QUOTED_IDENTIFIER ON  
GO  
CREATE TABLE [dbo].[Department]([DepartmentID] [int] IDENTITY(1,1) NOT NULL,  
[Name] [nvarchar](50) NOT NULL,  
[Budget] [money] NOT NULL,  
[StartDate] [datetime] NOT NULL,  
[Administrator] [int] NULL,  
 CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED   
(  
[DepartmentID] ASC  
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]) ON [PRIMARY]  
  
GO  
  
SET ANSI_NULLS ON  
GO  
SET QUOTED_IDENTIFIER ON  
GO  
CREATE TABLE [dbo].[Person]([PersonID] [int] IDENTITY(1,1) NOT NULL,  
[LastName] [nvarchar](50) NOT NULL,  
[FirstName] [nvarchar](50) NOT NULL,  
[HireDate] [datetime] NULL,  
[EnrollmentDate] [datetime] NULL,  
 CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED   
(  
[PersonID] ASC  
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]) ON [PRIMARY]  
  
GO  
  
SET ANSI_NULLS ON  
GO  
SET QUOTED_IDENTIFIER ON  
GO  
CREATE TABLE [dbo].[StudentGrade]([EnrollmentID] [int] IDENTITY(1,1) NOT NULL,  
[CourseID] [nvarchar](10) NOT NULL,  
[StudentID] [int] NOT NULL,  
[Grade] [decimal](3, 2) NOT NULL,  
 CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED   
(  
[EnrollmentID] ASC  
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]) ON [PRIMARY]  
  
GO  
  
SET ANSI_NULLS ON  
GO  
SET QUOTED_IDENTIFIER ON  
GO  
create view [dbo].[EnglishCourse]  
as  
select c.CourseID,c.Title,c.Credits,c.DepartmentID  
from Course as c join Department as d on c.DepartmentID=d.DepartmentID  
where d.Name=N'English'  
  
GO  
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)  
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)  
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)  
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)  
SET IDENTITY_INSERT [dbo].[Department] ON   
  
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)  
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)  
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)  
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)  
SET IDENTITY_INSERT [dbo].[Department] OFF  
SET IDENTITY_INSERT [dbo].[Person] ON   
  
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))  
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))  
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))  
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))  
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))  
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)  
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)  
SET IDENTITY_INSERT [dbo].[Person] OFF  
SET IDENTITY_INSERT [dbo].[StudentGrade] ON   
  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))  
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))  
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF  
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])  
REFERENCES [dbo].[Department] ([DepartmentID])  
GO  
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]  
GO  
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])  
REFERENCES [dbo].[Person] ([PersonID])  
GO  
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]  
GO  
```  
  
 <span data-ttu-id="c00a7-131">Successivamente, compilare ed eseguire quanto segue:</span><span class="sxs-lookup"><span data-stu-id="c00a7-131">Next, compile and execute the following:</span></span>  
  
```  
using System;  
using System.Data;  
using System.Data.SqlClient;  
using System.Threading.Tasks;  
  
class Program {  
  
   static class SqlHelper {  
      // Set the connection, command, and then execute the command with non query.  
      public static Int32 ExecuteNonQuery(String connectionString, String commandText,  
          CommandType commandType, params SqlParameter[] parameters) {  
         using (SqlConnection conn = new SqlConnection(connectionString)) {  
            using (SqlCommand cmd = new SqlCommand(commandText, conn)) {  
               // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect   
               // type is only for OLE DB.    
               cmd.CommandType = commandType;  
               cmd.Parameters.AddRange(parameters);  
  
               conn.Open();  
               return cmd.ExecuteNonQuery();  
            }  
         }  
      }  
  
      // Set the connection, command, and then execute the command and only return one value.  
      public static Object ExecuteScalar(String connectionString, String commandText,  
          CommandType commandType, params SqlParameter[] parameters) {  
         using (SqlConnection conn = new SqlConnection(connectionString)) {  
            using (SqlCommand cmd = new SqlCommand(commandText, conn)) {  
               cmd.CommandType = commandType;  
               cmd.Parameters.AddRange(parameters);  
  
               conn.Open();  
               return cmd.ExecuteScalar();  
            }  
         }  
      }  
  
      // Set the connection, command, and then execute the command with query and return the reader.  
      public static SqlDataReader ExecuteReader(String connectionString, String commandText,  
          CommandType commandType, params SqlParameter[] parameters) {  
         SqlConnection conn = new SqlConnection(connectionString);  
  
         using (SqlCommand cmd = new SqlCommand(commandText, conn)) {  
            cmd.CommandType = commandType;  
            cmd.Parameters.AddRange(parameters);  
  
            conn.Open();  
            // When using CommandBehavior.CloseConnection, the connection will be closed when the   
            // IDataReader is closed.  
            SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);  
  
            return reader;  
         }  
      }  
   }  
  
   static void Main(string[] args) {  
      String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";  
  
      CountCourses(connectionString, 2012);  
      Console.WriteLine();  
  
      Console.WriteLine("Following result is the departments that started from 2007:");  
      GetDepartments(connectionString, 2007);  
      Console.WriteLine();  
  
      Console.WriteLine("Add the credits when the credits of course is lower than 4.");  
      AddCredits(connectionString, 4);  
      Console.WriteLine();  
  
      Console.WriteLine("Please press any key to exit...");  
      Console.ReadKey();  
   }  
  
   static void CountCourses(String connectionString, Int32 year) {  
      String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";  
      SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);  
      parameterYear.Value = year;  
  
      Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);  
      Int32 count;  
      if (Int32.TryParse(oValue.ToString(), out count))  
         Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);  
   }  
  
   // Display the Departments that start from the specified year.  
   static void GetDepartments(String connectionString, Int32 year) {  
      String commandText = "dbo.GetDepartmentsOfSpecifiedYear";  
  
      // Specify the year of StartDate  
      SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);  
      parameterYear.Value = year;  
  
      // When the direction of parameter is set as Output, you can get the value after   
      // executing the command.  
      SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);  
      parameterBudget.Direction = ParameterDirection.Output;  
  
      using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,  
          CommandType.StoredProcedure, parameterYear, parameterBudget)) {  
         Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",  
             "Administrator");  
         while (reader.Read()) {  
            Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],  
                reader["Budget"], reader["StartDate"], reader["Administrator"]);  
         }  
      }  
      Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);  
   }  
  
   // If credits of course is lower than the certain value, the method will add the credits.  
   static void AddCredits(String connectionString, Int32 creditsLow) {  
      String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@Credits";  
  
      SqlParameter parameterCredits = new SqlParameter("@Credits", creditsLow);  
  
      Int32 rows = SqlHelper.ExecuteNonQuery(connectionString, commandText, CommandType.Text, parameterCredits);  
  
      Console.WriteLine("{0} row{1} {2} updated.", rows, rows > 1 ? "s" : null, rows > 1 ? "are" : "is");  
   }  
}  
```  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-132">Inizializza una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-132">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlCommand" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlCommand ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlCommand();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-133">Inizializza una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-133">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlCommand" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-134">Il costruttore basa Inizializza tutti i campi in base ai valori predefiniti.</span><span class="sxs-lookup"><span data-stu-id="c00a7-134">The base constructor initializes all fields to their default values.</span></span> <span data-ttu-id="c00a7-135">La tabella seguente illustra i valori di proprietà iniziali per un'istanza di <xref:System.Data.SqlClient.SqlCommand>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-135">The following table shows initial property values for an instance of <xref:System.Data.SqlClient.SqlCommand>.</span></span>  
  
|<span data-ttu-id="c00a7-136">Proprietà</span><span class="sxs-lookup"><span data-stu-id="c00a7-136">Properties</span></span>|<span data-ttu-id="c00a7-137">Valore iniziale</span><span class="sxs-lookup"><span data-stu-id="c00a7-137">Initial value</span></span>|  
|----------------|-------------------|  
|<xref:System.Data.SqlClient.SqlCommand.CommandText%2A>|<span data-ttu-id="c00a7-138">una stringa vuota ("")</span><span class="sxs-lookup"><span data-stu-id="c00a7-138">empty string ("")</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A>|<span data-ttu-id="c00a7-139">30</span><span class="sxs-lookup"><span data-stu-id="c00a7-139">30</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.CommandType%2A>|`CommandType.Text`|  
|<xref:System.Data.SqlClient.SqlCommand.Connection%2A>|<span data-ttu-id="c00a7-140">Null</span><span class="sxs-lookup"><span data-stu-id="c00a7-140">Null</span></span>|  
  
 <span data-ttu-id="c00a7-141">È possibile modificare il valore per una di queste proprietà tramite una chiamata separata per la proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-141">You can change the value for any of these properties through a separate call to the property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-142">Nell'esempio seguente viene creata una <xref:System.Data.SqlClient.SqlCommand> e imposta il `CommandTimeout` proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-142">The following example creates a <xref:System.Data.SqlClient.SqlCommand> and sets the `CommandTimeout` property.</span></span>  
  
 [!code-csharp[Classic WebData IDbCommand.CommandTimeout Example#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData IDbCommand.CommandTimeout Example/CS/source.cs#1)]
 [!code-vb[Classic WebData IDbCommand.CommandTimeout Example#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData IDbCommand.CommandTimeout Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlCommand (string cmdText);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string cmdText) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (cmdText As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlCommand(System::String ^ cmdText);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlCommand : string -&gt; System.Data.SqlClient.SqlCommand" Usage="new System.Data.SqlClient.SqlCommand cmdText" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="cmdText" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="cmdText">
          <span data-ttu-id="c00a7-143">Testo della query.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-143">The text of the query.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-144">Inizializza una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlCommand" /> con il testo della query.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-144">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlCommand" /> class with the text of the query.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-145">Quando un'istanza di <xref:System.Data.SqlClient.SqlCommand> viene creato, le seguenti proprietà vengono impostate sui valori iniziali di lettura/scrittura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-145">When an instance of <xref:System.Data.SqlClient.SqlCommand> is created, the following read/write properties are set to initial values.</span></span>  
  
|<span data-ttu-id="c00a7-146">Proprietà</span><span class="sxs-lookup"><span data-stu-id="c00a7-146">Properties</span></span>|<span data-ttu-id="c00a7-147">Valore iniziale</span><span class="sxs-lookup"><span data-stu-id="c00a7-147">Initial value</span></span>|  
|----------------|-------------------|  
|<xref:System.Data.SqlClient.SqlCommand.CommandText%2A>|`cmdText`|  
|<xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A>|<span data-ttu-id="c00a7-148">30</span><span class="sxs-lookup"><span data-stu-id="c00a7-148">30</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.CommandType%2A>|`CommandType.Text`|  
|<xref:System.Data.SqlClient.SqlCommand.Connection%2A>|<span data-ttu-id="c00a7-149">Null</span><span class="sxs-lookup"><span data-stu-id="c00a7-149">null</span></span>|  
  
 <span data-ttu-id="c00a7-150">È possibile modificare il valore per una di queste proprietà tramite una chiamata separata per la proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-150">You can change the value for any of these properties through a separate call to the property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-151">Nell'esempio seguente viene creato un <xref:System.Data.SqlClient.SqlCommand>, passando il testo di stringa e un comando di connessione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-151">The following example creates a <xref:System.Data.SqlClient.SqlCommand>, passing in the connection string and command text.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.SqlCommand1 Example#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.SqlCommand1 Example/CS/source.cs#1)]
 [!code-vb[Classic WebData SqlCommand.SqlCommand1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.SqlCommand1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlCommand (string cmdText, System.Data.SqlClient.SqlConnection connection);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string cmdText, class System.Data.SqlClient.SqlConnection connection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.#ctor(System.String,System.Data.SqlClient.SqlConnection)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (cmdText As String, connection As SqlConnection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlCommand(System::String ^ cmdText, System::Data::SqlClient::SqlConnection ^ connection);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlCommand : string * System.Data.SqlClient.SqlConnection -&gt; System.Data.SqlClient.SqlCommand" Usage="new System.Data.SqlClient.SqlCommand (cmdText, connection)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="cmdText" Type="System.String" />
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
      </Parameters>
      <Docs>
        <param name="cmdText">
          <span data-ttu-id="c00a7-152">Testo della query.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-152">The text of the query.</span>
          </span>
        </param>
        <param name="connection">
          <span data-ttu-id="c00a7-153">Oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> che rappresenta la connessione a un'istanza di SQL Server.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-153">A <see cref="T:System.Data.SqlClient.SqlConnection" /> that represents the connection to an instance of SQL Server.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-154">Inizializza una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlCommand" /> con il testo della query e un oggetto <see cref="T:System.Data.SqlClient.SqlConnection" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-154">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlCommand" /> class with the text of the query and a <see cref="T:System.Data.SqlClient.SqlConnection" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-155">La tabella seguente illustra i valori di proprietà iniziali per un'istanza di <xref:System.Data.SqlClient.SqlCommand>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-155">The following table shows initial property values for an instance of <xref:System.Data.SqlClient.SqlCommand>.</span></span>  
  
|<span data-ttu-id="c00a7-156">Proprietà</span><span class="sxs-lookup"><span data-stu-id="c00a7-156">Properties</span></span>|<span data-ttu-id="c00a7-157">Valore iniziale</span><span class="sxs-lookup"><span data-stu-id="c00a7-157">Initial value</span></span>|  
|----------------|-------------------|  
|<xref:System.Data.SqlClient.SqlCommand.CommandText%2A>|`cmdText`|  
|<xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A>|<span data-ttu-id="c00a7-158">30</span><span class="sxs-lookup"><span data-stu-id="c00a7-158">30</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.CommandType%2A>|`CommandType.Text`|  
|<xref:System.Data.SqlClient.SqlCommand.Connection%2A>|<span data-ttu-id="c00a7-159">Un nuovo <xref:System.Data.SqlClient.SqlConnection> che rappresenta il valore per il `connection` parametro.</span><span class="sxs-lookup"><span data-stu-id="c00a7-159">A new <xref:System.Data.SqlClient.SqlConnection> that is the value for the `connection` parameter.</span></span>|  
  
 <span data-ttu-id="c00a7-160">È possibile modificare il valore per uno di questi parametri impostando la proprietà correlata.</span><span class="sxs-lookup"><span data-stu-id="c00a7-160">You can change the value for any of these parameters by setting the related property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-161">Nell'esempio seguente viene creato un <xref:System.Data.SqlClient.SqlCommand> e vengono impostate alcune delle relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-161">The following example creates a <xref:System.Data.SqlClient.SqlCommand> and sets some of its properties.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.SqlCommand2 Example#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.SqlCommand2 Example/CS/source.cs#1)]
 [!code-vb[Classic WebData SqlCommand.SqlCommand2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.SqlCommand2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlCommand (string cmdText, System.Data.SqlClient.SqlConnection connection, System.Data.SqlClient.SqlTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string cmdText, class System.Data.SqlClient.SqlConnection connection, class System.Data.SqlClient.SqlTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.#ctor(System.String,System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (cmdText As String, connection As SqlConnection, transaction As SqlTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlCommand(System::String ^ cmdText, System::Data::SqlClient::SqlConnection ^ connection, System::Data::SqlClient::SqlTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlCommand : string * System.Data.SqlClient.SqlConnection * System.Data.SqlClient.SqlTransaction -&gt; System.Data.SqlClient.SqlCommand" Usage="new System.Data.SqlClient.SqlCommand (cmdText, connection, transaction)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="cmdText" Type="System.String" />
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
        <Parameter Name="transaction" Type="System.Data.SqlClient.SqlTransaction" />
      </Parameters>
      <Docs>
        <param name="cmdText">
          <span data-ttu-id="c00a7-162">Testo della query.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-162">The text of the query.</span>
          </span>
        </param>
        <param name="connection">
          <span data-ttu-id="c00a7-163">Oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> che rappresenta la connessione a un'istanza di SQL Server.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-163">A <see cref="T:System.Data.SqlClient.SqlConnection" /> that represents the connection to an instance of SQL Server.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="c00a7-164">Oggetto <see cref="T:System.Data.SqlClient.SqlTransaction" /> in cui viene eseguito l'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-164">The <see cref="T:System.Data.SqlClient.SqlTransaction" /> in which the <see cref="T:System.Data.SqlClient.SqlCommand" /> executes.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-165">Inizializza una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlCommand" /> con il testo della query, un oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> e l'oggetto <see cref="T:System.Data.SqlClient.SqlTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-165">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlCommand" /> class with the text of the query, a <see cref="T:System.Data.SqlClient.SqlConnection" />, and the <see cref="T:System.Data.SqlClient.SqlTransaction" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-166">La tabella seguente illustra i valori di proprietà iniziali per un'istanza di <xref:System.Data.SqlClient.SqlCommand>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-166">The following table shows initial property values for an instance of <xref:System.Data.SqlClient.SqlCommand>.</span></span>  
  
|<span data-ttu-id="c00a7-167">Proprietà</span><span class="sxs-lookup"><span data-stu-id="c00a7-167">Properties</span></span>|<span data-ttu-id="c00a7-168">Valore iniziale</span><span class="sxs-lookup"><span data-stu-id="c00a7-168">Initial value</span></span>|  
|----------------|-------------------|  
|<xref:System.Data.SqlClient.SqlCommand.CommandText%2A>|`cmdText`|  
|<xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A>|<span data-ttu-id="c00a7-169">30</span><span class="sxs-lookup"><span data-stu-id="c00a7-169">30</span></span>|  
|<xref:System.Data.SqlClient.SqlCommand.CommandType%2A>|`CommandType.Text`|  
|<xref:System.Data.SqlClient.SqlCommand.Connection%2A>|<span data-ttu-id="c00a7-170">Un nuovo <xref:System.Data.SqlClient.SqlConnection> che rappresenta il valore per il `connection` parametro.</span><span class="sxs-lookup"><span data-stu-id="c00a7-170">A new <xref:System.Data.SqlClient.SqlConnection> that is the value for the `connection` parameter.</span></span>|  
  
 <span data-ttu-id="c00a7-171">È possibile modificare il valore per uno di questi parametri impostando la proprietà correlata.</span><span class="sxs-lookup"><span data-stu-id="c00a7-171">You can change the value for any of these parameters by setting the related property.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlCommand (string cmdText, System.Data.SqlClient.SqlConnection connection, System.Data.SqlClient.SqlTransaction transaction, System.Data.SqlClient.SqlCommandColumnEncryptionSetting columnEncryptionSetting);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string cmdText, class System.Data.SqlClient.SqlConnection connection, class System.Data.SqlClient.SqlTransaction transaction, valuetype System.Data.SqlClient.SqlCommandColumnEncryptionSetting columnEncryptionSetting) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.#ctor(System.String,System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlTransaction,System.Data.SqlClient.SqlCommandColumnEncryptionSetting)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (cmdText As String, connection As SqlConnection, transaction As SqlTransaction, columnEncryptionSetting As SqlCommandColumnEncryptionSetting)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlCommand(System::String ^ cmdText, System::Data::SqlClient::SqlConnection ^ connection, System::Data::SqlClient::SqlTransaction ^ transaction, System::Data::SqlClient::SqlCommandColumnEncryptionSetting columnEncryptionSetting);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlCommand : string * System.Data.SqlClient.SqlConnection * System.Data.SqlClient.SqlTransaction * System.Data.SqlClient.SqlCommandColumnEncryptionSetting -&gt; System.Data.SqlClient.SqlCommand" Usage="new System.Data.SqlClient.SqlCommand (cmdText, connection, transaction, columnEncryptionSetting)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="cmdText" Type="System.String" />
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
        <Parameter Name="transaction" Type="System.Data.SqlClient.SqlTransaction" />
        <Parameter Name="columnEncryptionSetting" Type="System.Data.SqlClient.SqlCommandColumnEncryptionSetting" />
      </Parameters>
      <Docs>
        <param name="cmdText">
          <span data-ttu-id="c00a7-172">Testo della query.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-172">The text of the query.</span>
          </span>
        </param>
        <param name="connection">
          <span data-ttu-id="c00a7-173">Oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> che rappresenta la connessione a un'istanza di SQL Server.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-173">A <see cref="T:System.Data.SqlClient.SqlConnection" /> that represents the connection to an instance of SQL Server.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="c00a7-174">Oggetto <see cref="T:System.Data.SqlClient.SqlTransaction" /> in cui viene eseguito l'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-174">The <see cref="T:System.Data.SqlClient.SqlTransaction" /> in which the <see cref="T:System.Data.SqlClient.SqlCommand" /> executes.</span>
          </span>
        </param>
        <param name="columnEncryptionSetting">
          <span data-ttu-id="c00a7-175">Impostazione di crittografia.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-175">The encryption setting.</span>
          </span>
          <span data-ttu-id="c00a7-176">Per altre informazioni, vedere [Always Encrypted](/sql/relational-databases/security/encryption/always-encrypted-database-engine).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-176">For more information, see [Always Encrypted](/sql/relational-databases/security/encryption/always-encrypted-database-engine).</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-177">Inizializza una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlCommand" /> con l'impostazione specificata per il testo del comando, la connessione, la transazione e la crittografia.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-177">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlCommand" /> class with specified command text, connection, transaction, and encryption setting.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginExecuteNonQuery">
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-178">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-178">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginExecuteNonQuery">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginExecuteNonQuery ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginExecuteNonQuery() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginExecuteNonQuery () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginExecuteNonQuery();" />
      <MemberSignature Language="F#" Value="member this.BeginExecuteNonQuery : unit -&gt; IAsyncResult" Usage="sqlCommand.BeginExecuteNonQuery " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-179">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-179">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-180">Oggetto <see cref="T:System.IAsyncResult" /> che può essere utilizzato per eseguire il polling, attendere i risultati o entrambe le cose; questo valore è necessario anche per chiamare il metodo <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" />, che restituisce il numero delle righe interessate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-180">An <see cref="T:System.IAsyncResult" /> that can be used to poll or wait for results, or both; this value is also needed when invoking <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" />, which returns the number of affected rows.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-181">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> metodo avvia il processo di esecuzione in modo asincrono un [!INCLUDE[tsql](~/includes/tsql-md.md)] istruzione o stored procedure che non restituisce righe, in modo che altre attività eseguibili contemporaneamente durante l'esecuzione dell'istruzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-181">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> method starts the process of asynchronously executing a [!INCLUDE[tsql](~/includes/tsql-md.md)] statement or stored procedure that does not return rows, so that other tasks can run concurrently while the statement is executing.</span></span> <span data-ttu-id="c00a7-182">Quando l'istruzione è stata completata, gli sviluppatori devono chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> metodo per completare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-182">When the statement has completed, developers must call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> method to finish the operation.</span></span> <span data-ttu-id="c00a7-183">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> metodo viene restituito immediatamente (<xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> ha alcun effetto sui <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A>), ma fino a quando non viene eseguito il codice corrispondente <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> chiamata al metodo, non è necessario eseguire altre chiamate che iniziano con un'esecuzione sincrona o asincrona sullo stesso <xref:System.Data.SqlClient.SqlCommand> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-183">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> method returns immediately (<xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> has no effect on <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A>), but until the code executes the corresponding <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> method call, it must not execute any other calls that start a synchronous or asynchronous execution against the same <xref:System.Data.SqlClient.SqlCommand> object.</span></span> <span data-ttu-id="c00a7-184">La chiamata di <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> prima dell'esecuzione del comando completamento causa il <xref:System.Data.SqlClient.SqlCommand> blocco oggetto fino al completamento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-184">Calling the <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> before the command's execution is completed causes the <xref:System.Data.SqlClient.SqlCommand> object to block until the execution is finished.</span></span>  
  
 <span data-ttu-id="c00a7-185">Si noti che il testo del comando e i parametri vengono inviati al server in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-185">Note that the command text and parameters are sent to the server synchronously.</span></span> <span data-ttu-id="c00a7-186">Se un comando di grandi dimensioni o numerosi parametri vengono inviati, questo metodo può bloccare durante la scrittura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-186">If a large command or many parameters are sent, this method may block during writes.</span></span> <span data-ttu-id="c00a7-187">Dopo l'invio del comando, il metodo restituisce immediatamente senza attendere una risposta dal server, vale a dire, operazioni di lettura sono asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-187">After the command is sent, the method returns immediately without waiting for an answer from the server--that is, reads are asynchronous.</span></span>  
  
 <span data-ttu-id="c00a7-188">Poiché questo overload non supporta una routine di callback, gli sviluppatori devono entrambi polling per determinare se il comando è stata completata, tramite il <xref:System.IAsyncResult.IsCompleted%2A> proprietà del <xref:System.IAsyncResult> restituito dal <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> metodo; o attendere il completamento di uno o più comandi usando il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà dell'oggetto restituito <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-188">Because this overload does not support a callback procedure, developers must either poll to determine whether the command has completed, using the <xref:System.IAsyncResult.IsCompleted%2A> property of the <xref:System.IAsyncResult> returned by the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> method; or wait for the completion of one or more commands using the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the returned <xref:System.IAsyncResult>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-189">La seguente applicazione console crea l'aggiornamento dei dati all'interno di **AdventureWorks** database di esempio, in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-189">The following console application creates updates data within the **AdventureWorks** sample database, doing its work asynchronously.</span></span> <span data-ttu-id="c00a7-190">Per emulare un processo a esecuzione prolungata, in questo esempio viene inserita un'istruzione WAITFOR nel testo del comando.</span><span class="sxs-lookup"><span data-stu-id="c00a7-190">In order to emulate a long-running process, this example inserts a WAITFOR statement in the command text.</span></span> <span data-ttu-id="c00a7-191">In genere, non è necessario eseguire attività necessarie per eseguire i comandi più lentamente, ma questa operazione in questo caso rende più semplice illustrare il comportamento asincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-191">Normally, you would not take efforts to make your commands run slower, but doing this in this case makes it easier to demonstrate the asynchronous behavior.</span></span>  
  
 [!code-csharp[DataWorks SqlCommand.BeginExecuteNonQuery#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteNonQuery/CS/source.cs#1)]
 [!code-vb[DataWorks SqlCommand.BeginExecuteNonQuery#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteNonQuery/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-192">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-192">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-193">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-193">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-194">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-194">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-195">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-195">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-196">Qualsiasi errore che si è verificato durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-196">Any error that occurred while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-197">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-197">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-198">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-198">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-199">La coppia nome/valore "Asynchronous Processing=true" non è stata inclusa nella stringa di connessione che definisce la connessione per <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-199">The name/value pair "Asynchronous Processing=true" was not included within the connection string defining the connection for this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
          <span data-ttu-id="c00a7-200">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-200">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-201">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-201">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-202">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-202">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-203">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-203">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-204">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-204">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-205">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-205">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="BeginExecuteNonQuery">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginExecuteNonQuery (AsyncCallback callback, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginExecuteNonQuery(class System.AsyncCallback callback, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery(System.AsyncCallback,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginExecuteNonQuery (callback As AsyncCallback, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginExecuteNonQuery(AsyncCallback ^ callback, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginExecuteNonQuery : AsyncCallback * obj -&gt; IAsyncResult" Usage="sqlCommand.BeginExecuteNonQuery (callback, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="callback" Type="System.AsyncCallback" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="callback">
          <span data-ttu-id="c00a7-206">Delegato <see cref="T:System.AsyncCallback" /> richiamato al termine dell'esecuzione del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-206">An <see cref="T:System.AsyncCallback" /> delegate that is invoked when the command's execution has completed.</span>
          </span>
          <span data-ttu-id="c00a7-207">Passare <see langword="null" /> (<see langword="Nothing" /> in Microsoft Visual Basic) per indicare che non è necessario alcun callback.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-207">Pass <see langword="null" /> (<see langword="Nothing" /> in Microsoft Visual Basic) to indicate that no callback is required.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="c00a7-208">Oggetto di stato definito dall'utente e passato alla routine di callback.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-208">A user-defined state object that is passed to the callback procedure.</span>
          </span>
          <span data-ttu-id="c00a7-209">Recuperare questo oggetto dalla routine di callback usando la proprietà <see cref="P:System.IAsyncResult.AsyncState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-209">Retrieve this object from within the callback procedure using the <see cref="P:System.IAsyncResult.AsyncState" /> property.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-210">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" />, data una routine di callback e informazioni sullo stato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-210">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" />, given a callback procedure and state information.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-211">Oggetto <see cref="T:System.IAsyncResult" /> che può essere utilizzato per eseguire il polling, attendere i risultati o entrambe le cose; questo valore è necessario anche per chiamare il metodo <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" />, che restituisce il numero delle righe interessate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-211">An <see cref="T:System.IAsyncResult" /> that can be used to poll or wait for results, or both; this value is also needed when invoking <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" />, which returns the number of affected rows.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-212">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> metodo avvia il processo di esecuzione in modo asincrono un'istruzione Transact-SQL o stored procedure che non restituisce righe, in modo che altre attività eseguibili contemporaneamente durante l'esecuzione dell'istruzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-212">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> method starts the process of asynchronously executing a Transact-SQL statement or stored procedure that does not return rows, so that other tasks can run concurrently while the statement is executing.</span></span> <span data-ttu-id="c00a7-213">Quando l'istruzione è stata completata, gli sviluppatori devono chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> metodo per completare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-213">When the statement has completed, developers must call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> method to finish the operation.</span></span> <span data-ttu-id="c00a7-214">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> metodo viene restituito immediatamente (<xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> ha alcun effetto sui <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A>), ma fino a quando non viene eseguito il codice corrispondente <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> chiamata al metodo, non è necessario eseguire altre chiamate che iniziano con un'esecuzione sincrona o asincrona sullo stesso <xref:System.Data.SqlClient.SqlCommand> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-214">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> method returns immediately (<xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> has no effect on <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A>), but until the code executes the corresponding <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> method call, it must not execute any other calls that start a synchronous or asynchronous execution against the same <xref:System.Data.SqlClient.SqlCommand> object.</span></span> <span data-ttu-id="c00a7-215">La chiamata di <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> prima dell'esecuzione del comando completamento causa il <xref:System.Data.SqlClient.SqlCommand> blocco oggetto fino al completamento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-215">Calling the <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> before the command's execution is completed causes the <xref:System.Data.SqlClient.SqlCommand> object to block until the execution is finished.</span></span>  
  
 <span data-ttu-id="c00a7-216">Il `callback` parametro consente di specificare un <xref:System.AsyncCallback> delegato che viene chiamato quando l'istruzione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="c00a7-216">The `callback` parameter lets you specify an <xref:System.AsyncCallback> delegate that is called when the statement has completed.</span></span> <span data-ttu-id="c00a7-217">È possibile chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> metodo dall'interno della routine delegato o da qualsiasi altra posizione all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-217">You can call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> method from within this delegate procedure, or from any other location within your application.</span></span> <span data-ttu-id="c00a7-218">Inoltre, è possibile passare qualsiasi oggetto nel `asyncStateObject` parametro e la routine di callback può recuperare queste informazioni utilizzando il <xref:System.IAsyncResult.AsyncState%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-218">In addition, you can pass any object in the `asyncStateObject` parameter, and your callback procedure can retrieve this information using the <xref:System.IAsyncResult.AsyncState%2A> property.</span></span>  
  
 <span data-ttu-id="c00a7-219">Si noti che il testo del comando e i parametri vengono inviati al server in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-219">Note that the command text and parameters are sent to the server synchronously.</span></span> <span data-ttu-id="c00a7-220">Se un comando di grandi dimensioni o numerosi parametri vengono inviati, questo metodo può bloccare durante la scrittura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-220">If a large command or many parameters are sent, this method may block during writes.</span></span> <span data-ttu-id="c00a7-221">Dopo l'invio del comando, il metodo restituisce immediatamente senza attendere una risposta dal server, vale a dire, operazioni di lettura sono asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-221">After the command is sent, the method returns immediately without waiting for an answer from the server--that is, reads are asynchronous.</span></span>  
  
 <span data-ttu-id="c00a7-222">Poiché la routine di callback viene eseguita da un thread in background fornito da Microsoft .NET common language runtime, è molto importante una rigorosa alla gestione delle interazioni tra thread dall'interno di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c00a7-222">Because the callback procedure executes from within a background thread supplied by the Microsoft .NET common language runtime, it is very important that you take a rigorous approach to handling cross-thread interactions from within your applications.</span></span> <span data-ttu-id="c00a7-223">Ad esempio, non è possibile interagire con il contenuto di un modulo di routine di callback; è necessario aggiornare il form, è necessario passare al thread del form per svolgere il proprio lavoro.</span><span class="sxs-lookup"><span data-stu-id="c00a7-223">For example, you must not interact with a form's contents from within your callback procedure; should you have to update the form, you must switch back to the form's thread in order to do your work.</span></span> <span data-ttu-id="c00a7-224">L'esempio incluso in questo argomento viene illustrato questo comportamento.</span><span class="sxs-lookup"><span data-stu-id="c00a7-224">The example in this topic demonstrates this behavior.</span></span>  
  
 <span data-ttu-id="c00a7-225">Tutti gli errori che si verificano durante l'esecuzione dell'operazione vengono generati come eccezioni nella routine di callback.</span><span class="sxs-lookup"><span data-stu-id="c00a7-225">All errors that occur during the execution of the operation are thrown as exceptions in the callback procedure.</span></span> <span data-ttu-id="c00a7-226">È necessario gestire l'eccezione nella routine di callback, non nell'applicazione principale.</span><span class="sxs-lookup"><span data-stu-id="c00a7-226">You must handle the exception in the callback procedure, not in the main application.</span></span> <span data-ttu-id="c00a7-227">Vedere l'esempio in questo argomento per ulteriori informazioni sulla gestione delle eccezioni nella routine di callback.</span><span class="sxs-lookup"><span data-stu-id="c00a7-227">See the example in this topic for additional information on handling exceptions in the callback procedure.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-228">Nella seguente applicazione Windows viene illustrato come utilizzare il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> metodo, che esegue un'istruzione Transact-SQL che include un ritardo di qualche secondo (emulando un comando a esecuzione prolungata).</span><span class="sxs-lookup"><span data-stu-id="c00a7-228">The following Windows application demonstrates the use of the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> method, executing a Transact-SQL statement that includes a delay of several seconds (emulating a long-running command).</span></span>  
  
 <span data-ttu-id="c00a7-229">Questo esempio illustra molte tecniche importanti.</span><span class="sxs-lookup"><span data-stu-id="c00a7-229">This example demonstrates many important techniques.</span></span> <span data-ttu-id="c00a7-230">Ciò include la chiamata a un metodo che interagisce con il form da un thread separato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-230">This includes calling a method that interacts with the form from a separate thread.</span></span> <span data-ttu-id="c00a7-231">Inoltre, questo esempio viene illustrato come sia necessario impedire agli utenti di eseguire contemporaneamente più volte un comando e come è necessario assicurarsi che il modulo non venga chiuso prima della routine di callback viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-231">In addition, this example demonstrates how you must block users from executing a command multiple times concurrently, and how you must make sure that the form does not close before the callback procedure is called.</span></span>  
  
 <span data-ttu-id="c00a7-232">Per impostare questo esempio, creare una nuova applicazione Windows.</span><span class="sxs-lookup"><span data-stu-id="c00a7-232">To set up this example, create a new Windows application.</span></span> <span data-ttu-id="c00a7-233">Inserire un <xref:System.Windows.Forms.Button> controllo e un <xref:System.Windows.Forms.Label> controllo del form (accettando il nome predefinito per ogni controllo).</span><span class="sxs-lookup"><span data-stu-id="c00a7-233">Put a <xref:System.Windows.Forms.Button> control and a <xref:System.Windows.Forms.Label> control on the form (accepting the default name for each control).</span></span> <span data-ttu-id="c00a7-234">Aggiungere il codice seguente alla classe del form, modificando la stringa di connessione necessarie per l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="c00a7-234">Add the following code to the form's class, modifying the connection string as needed for your environment.</span></span>  
  
 [!code-csharp[DataWorks SqlCommand.BeginExecuteNonQueryForm#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteNonQueryForm/CS/Form1.cs#1)]
 [!code-vb[DataWorks SqlCommand.BeginExecuteNonQueryForm#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteNonQueryForm/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-235">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-235">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-236">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-236">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-237">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-237">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-238">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-238">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-239">Qualsiasi errore che si è verificato durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-239">Any error that occurred while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-240">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-240">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-241">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-241">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-242">La coppia nome/valore "Asynchronous Processing=true" non è stata inclusa nella stringa di connessione che definisce la connessione per <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-242">The name/value pair "Asynchronous Processing=true" was not included within the connection string defining the connection for this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
          <span data-ttu-id="c00a7-243">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-243">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-244">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-244">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-245">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-245">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-246">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-246">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-247">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-247">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-248">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-248">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginExecuteReader">
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-249">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> e recupera uno o più set di risultati dal server.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-249">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" />, and retrieves one or more result sets from the server.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginExecuteReader">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginExecuteReader ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginExecuteReader() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.BeginExecuteReader" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginExecuteReader () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginExecuteReader();" />
      <MemberSignature Language="F#" Value="member this.BeginExecuteReader : unit -&gt; IAsyncResult" Usage="sqlCommand.BeginExecuteReader " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-250">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> e recupera uno o più set di risultati dal server.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-250">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" />, and retrieves one or more result sets from the server.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-251">Oggetto <see cref="T:System.IAsyncResult" /> che può essere utilizzato per eseguire il polling, attendere i risultati o entrambe le cose; questo valore è necessario anche per chiamare il metodo <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" />, che restituisce un'istanza <see cref="T:System.Data.SqlClient.SqlDataReader" /> che può essere utilizzata per recuperare le righe restituite.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-251">An <see cref="T:System.IAsyncResult" /> that can be used to poll or wait for results, or both; this value is also needed when invoking <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" />, which returns a <see cref="T:System.Data.SqlClient.SqlDataReader" /> instance that can be used to retrieve the returned rows.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-252">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo avvia il processo di esecuzione in modo asincrono un'istruzione Transact-SQL o stored procedure che restituisce righe, in modo che altre attività eseguibili contemporaneamente durante l'esecuzione dell'istruzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-252">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method starts the process of asynchronously executing a Transact-SQL statement or stored procedure that returns rows, so that other tasks can run concurrently while the statement is executing.</span></span> <span data-ttu-id="c00a7-253">Quando l'istruzione è stata completata, gli sviluppatori devono chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> metodo per completare l'operazione e recuperare il <xref:System.Data.SqlClient.SqlDataReader> restituita dal comando.</span><span class="sxs-lookup"><span data-stu-id="c00a7-253">When the statement has completed, developers must call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method to finish the operation and retrieve the <xref:System.Data.SqlClient.SqlDataReader> returned by the command.</span></span> <span data-ttu-id="c00a7-254">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo viene restituito immediatamente, ma fino a quando non viene eseguito il codice corrispondente <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> chiamata al metodo, non è necessario eseguire altre chiamate che iniziano con un'esecuzione sincrona o asincrona sullo stesso <xref:System.Data.SqlClient.SqlCommand> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-254">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method returns immediately, but until the code executes the corresponding <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method call, it must not execute any other calls that start a synchronous or asynchronous execution against the same <xref:System.Data.SqlClient.SqlCommand> object.</span></span> <span data-ttu-id="c00a7-255">La chiamata di <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> prima dell'esecuzione del comando completamento causa il <xref:System.Data.SqlClient.SqlCommand> blocco oggetto fino al completamento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-255">Calling the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> before the command's execution is completed causes the <xref:System.Data.SqlClient.SqlCommand> object to block until the execution is finished.</span></span>  
  
 <span data-ttu-id="c00a7-256">Si noti che il testo del comando e i parametri vengono inviati al server in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-256">Note that the command text and parameters are sent to the server synchronously.</span></span> <span data-ttu-id="c00a7-257">Se un comando di grandi dimensioni o numerosi parametri vengono inviati, questo metodo può bloccare durante la scrittura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-257">If a large command or many parameters are sent, this method may block during writes.</span></span> <span data-ttu-id="c00a7-258">Dopo l'invio del comando, il metodo restituisce immediatamente senza attendere una risposta dal server, vale a dire, operazioni di lettura sono asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-258">After the command is sent, the method returns immediately without waiting for an answer from the server--that is, reads are asynchronous.</span></span> <span data-ttu-id="c00a7-259">Anche se l'esecuzione del comando è asincrono, il recupero dei valori è sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-259">Although command execution is asynchronous, value fetching is still synchronous.</span></span> <span data-ttu-id="c00a7-260">Ciò significa che le chiamate a <xref:System.Data.SqlClient.SqlDataReader.Read%2A> possono venire bloccate se sono necessari più dati e di rete sottostante operazione di lettura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-260">This means that calls to <xref:System.Data.SqlClient.SqlDataReader.Read%2A> may block if more data is required and the underlying network's read operation blocks.</span></span>  
  
 <span data-ttu-id="c00a7-261">Poiché questo overload non supporta una routine di callback, gli sviluppatori devono entrambi polling per determinare se il comando è stata completata, tramite il <xref:System.IAsyncResult.IsCompleted%2A> proprietà del <xref:System.IAsyncResult> restituito dal <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo; o attendere il completamento di uno o più comandi usando il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà dell'oggetto restituito <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-261">Because this overload does not support a callback procedure, developers must either poll to determine whether the command has completed, using the <xref:System.IAsyncResult.IsCompleted%2A> property of the <xref:System.IAsyncResult> returned by the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method; or wait for the completion of one or more commands using the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the returned <xref:System.IAsyncResult>.</span></span>  
  
 <span data-ttu-id="c00a7-262">Se si utilizza <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per accedere ai dati XML, SQL Server restituirà i risultati XML maggiore 2033 caratteri di lunghezza in più righe di 2033 caratteri.</span><span class="sxs-lookup"><span data-stu-id="c00a7-262">If you use <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each.</span></span> <span data-ttu-id="c00a7-263">Per evitare questo comportamento, utilizzare <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per leggere le query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-263">To avoid this behavior, use <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to read FOR XML queries.</span></span> <span data-ttu-id="c00a7-264">Per altre informazioni, vedere l'articolo Q310378, "PRB: XML dati viene troncato quando si usa SqlDataReader," nella Microsoft Knowledge Base al http://support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="c00a7-264">For more information, see article Q310378, "PRB: XML Data Is Truncated When You Use SqlDataReader," in the Microsoft Knowledge Base at http://support.microsoft.com.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-265">La seguente applicazione console viene avviato il processo di recupero in modo asincrono un lettore di dati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-265">The following console application starts the process of retrieving a data reader asynchronously.</span></span> <span data-ttu-id="c00a7-266">Durante l'attesa di risultati, questa semplice applicazione si trova in un ciclo, analizzando il <xref:System.IAsyncResult.IsCompleted%2A> valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-266">While waiting for the results, this simple application sits in a loop, investigating the <xref:System.IAsyncResult.IsCompleted%2A> property value.</span></span> <span data-ttu-id="c00a7-267">Non appena terminato il processo, il codice recupera il <xref:System.Data.SqlClient.SqlDataReader> e visualizzarne il contenuto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-267">As soon as the process has completed, the code retrieves the <xref:System.Data.SqlClient.SqlDataReader> and displays its contents.</span></span>  
  
 [!code-csharp[DataWorks SqlCommand.BeginExecuteReader#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteReader/CS/source.cs#1)]
 [!code-vb[DataWorks SqlCommand.BeginExecuteReader#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteReader/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-268">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-268">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-269">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-269">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-270">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-270">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-271">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-271">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-272">Qualsiasi errore che si è verificato durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-272">Any error that occurred while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-273">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-273">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-274">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-274">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-275">La coppia nome/valore "Asynchronous Processing=true" non è stata inclusa nella stringa di connessione che definisce la connessione per <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-275">The name/value pair "Asynchronous Processing=true" was not included within the connection string defining the connection for this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
          <span data-ttu-id="c00a7-276">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-276">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-277">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-277">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-278">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-278">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-279">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-279">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-280">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-280">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-281">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-281">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="BeginExecuteReader">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginExecuteReader (System.Data.CommandBehavior behavior);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginExecuteReader(valuetype System.Data.CommandBehavior behavior) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.BeginExecuteReader(System.Data.CommandBehavior)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginExecuteReader (behavior As CommandBehavior) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginExecuteReader(System::Data::CommandBehavior behavior);" />
      <MemberSignature Language="F#" Value="member this.BeginExecuteReader : System.Data.CommandBehavior -&gt; IAsyncResult" Usage="sqlCommand.BeginExecuteReader behavior" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="behavior" Type="System.Data.CommandBehavior" />
      </Parameters>
      <Docs>
        <param name="behavior">
          <span data-ttu-id="c00a7-282">Uno dei valori <see cref="T:System.Data.CommandBehavior" /> che indica le opzioni per l'esecuzione dell'istruzione e il recupero dei dati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-282">One of the <see cref="T:System.Data.CommandBehavior" /> values, indicating options for statement execution and data retrieval.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-283">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> utilizzando uno dei valori <see cref="T:System.Data.CommandBehavior" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-283">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" /> using one of the <see cref="T:System.Data.CommandBehavior" /> values.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-284">Oggetto <see cref="T:System.IAsyncResult" /> che può essere utilizzato per eseguire il polling, attendere i risultati o entrambe le cose; questo valore è necessario anche per chiamare il metodo <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" />, che restituisce un'istanza <see cref="T:System.Data.SqlClient.SqlDataReader" /> che può essere utilizzata per recuperare le righe restituite.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-284">An <see cref="T:System.IAsyncResult" /> that can be used to poll, wait for results, or both; this value is also needed when invoking <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" />, which returns a <see cref="T:System.Data.SqlClient.SqlDataReader" /> instance that can be used to retrieve the returned rows.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-285">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo avvia il processo di esecuzione in modo asincrono un'istruzione Transact-SQL o stored procedure che restituisce righe, in modo che altre attività eseguibili contemporaneamente durante l'esecuzione dell'istruzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-285">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method starts the process of asynchronously executing a Transact-SQL statement or stored procedure that returns rows, so that other tasks can run concurrently while the statement is executing.</span></span> <span data-ttu-id="c00a7-286">Quando l'istruzione è stata completata, gli sviluppatori devono chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> metodo per completare l'operazione e recuperare il <xref:System.Data.SqlClient.SqlDataReader> restituita dal comando.</span><span class="sxs-lookup"><span data-stu-id="c00a7-286">When the statement has completed, developers must call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method to finish the operation and retrieve the <xref:System.Data.SqlClient.SqlDataReader> returned by the command.</span></span> <span data-ttu-id="c00a7-287">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo viene restituito immediatamente, ma fino a quando non viene eseguito il codice corrispondente <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> chiamata al metodo, non è necessario eseguire altre chiamate che iniziano con un'esecuzione sincrona o asincrona sullo stesso <xref:System.Data.SqlClient.SqlCommand> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-287">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method returns immediately, but until the code executes the corresponding <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method call, it must not execute any other calls that start a synchronous or asynchronous execution against the same <xref:System.Data.SqlClient.SqlCommand> object.</span></span> <span data-ttu-id="c00a7-288">La chiamata di <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> prima dell'esecuzione del comando completamento causa il <xref:System.Data.SqlClient.SqlCommand> blocco oggetto fino al completamento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-288">Calling the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> before the command's execution is completed causes the <xref:System.Data.SqlClient.SqlCommand> object to block until the execution is finished.</span></span>  
  
 <span data-ttu-id="c00a7-289">Il `behavior` parametro consente di specificare le opzioni che controllano il comportamento del comando e la connessione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-289">The `behavior` parameter lets you specify options that control the behavior of the command and its connection.</span></span> <span data-ttu-id="c00a7-290">Questi valori possono essere combinati tra loro (usando il linguaggio di programmazione `OR` operatore); in genere, gli sviluppatori utilizzano il `CommandBehavior.CloseConnection` valore per assicurarsi che la connessione viene chiusa dal runtime quando la <xref:System.Data.SqlClient.SqlDataReader> viene chiuso.</span><span class="sxs-lookup"><span data-stu-id="c00a7-290">These values can be combined together (using the programming language's `OR` operator); generally, developers use the `CommandBehavior.CloseConnection` value to make sure that the connection is closed by the runtime when the <xref:System.Data.SqlClient.SqlDataReader> is closed.</span></span>  
  
 <span data-ttu-id="c00a7-291">Si noti che il testo del comando e i parametri vengono inviati al server in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-291">Note that the command text and parameters are sent to the server synchronously.</span></span> <span data-ttu-id="c00a7-292">Se un comando di grandi dimensioni o numerosi parametri vengono inviati, questo metodo può bloccare durante la scrittura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-292">If a large command or many parameters are sent, this method may block during writes.</span></span> <span data-ttu-id="c00a7-293">Dopo l'invio del comando, il metodo restituisce immediatamente senza attendere una risposta dal server, vale a dire, operazioni di lettura sono asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-293">After the command is sent, the method returns immediately without waiting for an answer from the server--that is, reads are asynchronous.</span></span> <span data-ttu-id="c00a7-294">Anche se l'esecuzione del comando è asincrono, il recupero dei valori è sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-294">Although command execution is asynchronous, value fetching is still synchronous.</span></span> <span data-ttu-id="c00a7-295">Ciò significa che le chiamate a <xref:System.Data.SqlClient.SqlDataReader.Read%2A> possono venire bloccate se sono necessari più dati e di rete sottostante operazione di lettura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-295">This means that calls to <xref:System.Data.SqlClient.SqlDataReader.Read%2A> may block if more data is required and the underlying network's read operation blocks.</span></span>  
  
 <span data-ttu-id="c00a7-296">Poiché questo overload non supporta una routine di callback, gli sviluppatori devono entrambi polling per determinare se il comando è stata completata, tramite il <xref:System.IAsyncResult.IsCompleted%2A> proprietà del <xref:System.IAsyncResult> restituito dal <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> metodo; o attendere il completamento di uno o più comandi usando il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà dell'oggetto restituito <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-296">Because this overload does not support a callback procedure, developers must either poll to determine whether the command has completed, using the <xref:System.IAsyncResult.IsCompleted%2A> property of the <xref:System.IAsyncResult> returned by the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> method; or wait for the completion of one or more commands using the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the returned <xref:System.IAsyncResult>.</span></span>  
  
 <span data-ttu-id="c00a7-297">Se si utilizza <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per accedere ai dati XML, SQL Server restituisce i risultati XML maggiore 2033 caratteri di lunghezza in più righe di 2033 caratteri.</span><span class="sxs-lookup"><span data-stu-id="c00a7-297">If you use <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to access XML data, SQL Server returns any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each.</span></span> <span data-ttu-id="c00a7-298">Per evitare questo comportamento, utilizzare <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per leggere le query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-298">To avoid this behavior, use <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to read FOR XML queries.</span></span> <span data-ttu-id="c00a7-299">Per altre informazioni, vedere l'articolo Q310378, "PRB: XML dati viene troncato quando si usa SqlDataReader," nella Microsoft Knowledge Base al http://support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="c00a7-299">For more information, see article Q310378, "PRB: XML Data Is Truncated When You Use SqlDataReader," in the Microsoft Knowledge Base at http://support.microsoft.com.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-300">La seguente applicazione console viene avviato il processo di recupero in modo asincrono un lettore di dati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-300">The following console application starts the process of retrieving a data reader asynchronously.</span></span> <span data-ttu-id="c00a7-301">Durante l'attesa di risultati, questa semplice applicazione si trova in un ciclo, analizzando il <xref:System.IAsyncResult.IsCompleted%2A> valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-301">While waiting for the results, this simple application sits in a loop, investigating the <xref:System.IAsyncResult.IsCompleted%2A> property value.</span></span> <span data-ttu-id="c00a7-302">Una volta completato il processo, il codice recupera il <xref:System.Data.SqlClient.SqlDataReader> e visualizzarne il contenuto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-302">Once the process has completed, the code retrieves the <xref:System.Data.SqlClient.SqlDataReader> and displays its contents.</span></span>  
  
 <span data-ttu-id="c00a7-303">Questo esempio passa anche il `CommandBehavior.CloseConnection` e `CommandBehavior.SingleRow` valori di parametro relativo al comportamento, determinando la connessione da chiudere con l'oggetto restituito <xref:System.Data.SqlClient.SqlDataReader> è chiuso e ottimizzare i risultati a riga singola.</span><span class="sxs-lookup"><span data-stu-id="c00a7-303">This example also passes the `CommandBehavior.CloseConnection` and `CommandBehavior.SingleRow` values in the behavior parameter, causing the connection to be closed with the returned <xref:System.Data.SqlClient.SqlDataReader> is closed, and to optimize for a single row result.</span></span>  
  
 [!code-csharp[DataWorks SqlCommand.BeginExecuteReaderAsyncSimple#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteReaderAsyncSimple/CS/source.cs#1)]
 [!code-vb[DataWorks SqlCommand.BeginExecuteReaderAsyncSimple#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteReaderAsyncSimple/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-304">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-304">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-305">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-305">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-306">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-306">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-307">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-307">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-308">Qualsiasi errore che si è verificato durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-308">Any error that occurred while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-309">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-309">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-310">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-310">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-311">La coppia nome/valore "Asynchronous Processing=true" non è stata inclusa nella stringa di connessione che definisce la connessione per <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-311">The name/value pair "Asynchronous Processing=true" was not included within the connection string defining the connection for this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
          <span data-ttu-id="c00a7-312">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-312">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-313">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-313">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-314">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-314">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-315">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-315">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-316">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-316">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-317">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-317">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="BeginExecuteReader">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginExecuteReader (AsyncCallback callback, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginExecuteReader(class System.AsyncCallback callback, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.BeginExecuteReader(System.AsyncCallback,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginExecuteReader (callback As AsyncCallback, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginExecuteReader(AsyncCallback ^ callback, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginExecuteReader : AsyncCallback * obj -&gt; IAsyncResult" Usage="sqlCommand.BeginExecuteReader (callback, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="callback" Type="System.AsyncCallback" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="callback">
          <span data-ttu-id="c00a7-318">Delegato <see cref="T:System.AsyncCallback" /> richiamato al termine dell'esecuzione del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-318">An <see cref="T:System.AsyncCallback" /> delegate that is invoked when the command's execution has completed.</span>
          </span>
          <span data-ttu-id="c00a7-319">Passare <see langword="null" /> (<see langword="Nothing" /> in Microsoft Visual Basic) per indicare che non è necessario alcun callback.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-319">Pass <see langword="null" /> (<see langword="Nothing" /> in Microsoft Visual Basic) to indicate that no callback is required.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="c00a7-320">Oggetto di stato definito dall'utente e passato alla routine di callback.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-320">A user-defined state object that is passed to the callback procedure.</span>
          </span>
          <span data-ttu-id="c00a7-321">Recuperare questo oggetto dalla routine di callback usando la proprietà <see cref="P:System.IAsyncResult.AsyncState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-321">Retrieve this object from within the callback procedure using the <see cref="P:System.IAsyncResult.AsyncState" /> property.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-322">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> e recupera uno o più set di risultati dal server, in base alla routine di callback e alle informazioni sullo stato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-322">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" /> and retrieves one or more result sets from the server, given a callback procedure and state information.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-323">Oggetto <see cref="T:System.IAsyncResult" /> che può essere utilizzato per eseguire il polling, attendere i risultati o entrambe le cose; questo valore è necessario anche per chiamare il metodo <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" />, che restituisce un'istanza <see cref="T:System.Data.SqlClient.SqlDataReader" /> che può essere utilizzata per recuperare le righe restituite.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-323">An <see cref="T:System.IAsyncResult" /> that can be used to poll, wait for results, or both; this value is also needed when invoking <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" />, which returns a <see cref="T:System.Data.SqlClient.SqlDataReader" /> instance which can be used to retrieve the returned rows.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-324">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo avvia il processo di esecuzione in modo asincrono un'istruzione Transact-SQL o stored procedure che restituisce righe, in modo che altre attività eseguibili contemporaneamente durante l'esecuzione dell'istruzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-324">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method starts the process of asynchronously executing a Transact-SQL statement or stored procedure that returns rows, so that other tasks can run concurrently while the statement is executing.</span></span> <span data-ttu-id="c00a7-325">Quando l'istruzione è stata completata, gli sviluppatori devono chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> metodo per completare l'operazione e recuperare il <xref:System.Data.SqlClient.SqlDataReader> restituita dal comando.</span><span class="sxs-lookup"><span data-stu-id="c00a7-325">When the statement has completed, developers must call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method to finish the operation and retrieve the <xref:System.Data.SqlClient.SqlDataReader> returned by the command.</span></span> <span data-ttu-id="c00a7-326">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo viene restituito immediatamente, ma fino a quando non viene eseguito il codice corrispondente <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> chiamata al metodo, non è necessario eseguire altre chiamate che iniziano con un'esecuzione sincrona o asincrona sullo stesso <xref:System.Data.SqlClient.SqlCommand> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-326">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method returns immediately, but until the code executes the corresponding <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method call, it must not execute any other calls that start a synchronous or asynchronous execution against the same <xref:System.Data.SqlClient.SqlCommand> object.</span></span> <span data-ttu-id="c00a7-327">La chiamata di <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> prima del completamento dell'esecuzione del comando causa la <xref:System.Data.SqlClient.SqlCommand> blocco oggetto fino al completamento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-327">Calling the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> before the command's execution is completed cause the <xref:System.Data.SqlClient.SqlCommand> object to block until the execution is finished.</span></span>  
  
 <span data-ttu-id="c00a7-328">Il `callback` parametro consente di specificare un <xref:System.AsyncCallback> delegato che viene chiamato quando l'istruzione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="c00a7-328">The `callback` parameter lets you specify an <xref:System.AsyncCallback> delegate that is called when the statement has completed.</span></span> <span data-ttu-id="c00a7-329">È possibile chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> metodo dall'interno della routine delegato o da qualsiasi altra posizione all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-329">You can call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method from within this delegate procedure, or from any other location within your application.</span></span> <span data-ttu-id="c00a7-330">Inoltre, è possibile passare qualsiasi oggetto nel `stateObject` parametro e la routine di callback può recuperare queste informazioni utilizzando il <xref:System.IAsyncResult.AsyncState%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-330">In addition, you can pass any object in the `stateObject` parameter, and your callback procedure can retrieve this information using the <xref:System.IAsyncResult.AsyncState%2A> property.</span></span>  
  
 <span data-ttu-id="c00a7-331">Si noti che il testo del comando e i parametri vengono inviati al server in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-331">Note that the command text and parameters are sent to the server synchronously.</span></span> <span data-ttu-id="c00a7-332">Se un comando di grandi dimensioni o numerosi parametri vengono inviati, questo metodo può bloccare durante la scrittura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-332">If a large command or many parameters are sent, this method may block during writes.</span></span> <span data-ttu-id="c00a7-333">Dopo l'invio del comando, il metodo restituisce immediatamente senza attendere una risposta dal server, vale a dire, operazioni di lettura sono asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-333">After the command is sent, the method returns immediately without waiting for an answer from the server--that is, reads are asynchronous.</span></span> <span data-ttu-id="c00a7-334">Anche se l'esecuzione del comando è asincrono, il recupero dei valori è sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-334">Although command execution is asynchronous, value fetching is still synchronous.</span></span> <span data-ttu-id="c00a7-335">Ciò significa che le chiamate a <xref:System.Data.SqlClient.SqlDataReader.Read%2A> possono venire bloccate se sono necessari più dati e di rete sottostante operazione di lettura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-335">This means that calls to <xref:System.Data.SqlClient.SqlDataReader.Read%2A> may block if more data is required and the underlying network's read operation blocks.</span></span>  
  
 <span data-ttu-id="c00a7-336">Poiché la routine di callback viene eseguita da un thread in background fornito dal runtime di Microsoft .NET, è molto importante una rigorosa alla gestione delle interazioni tra thread dall'interno di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c00a7-336">Because the callback procedure executes from within a background thread supplied by the Microsoft .NET runtime, it is very important that you take a rigorous approach to handling cross-thread interactions from within your applications.</span></span> <span data-ttu-id="c00a7-337">Ad esempio, non è possibile interagire con il contenuto di un modulo di routine di callback; è necessario aggiornare il form, è necessario passare al thread del form per svolgere il proprio lavoro.</span><span class="sxs-lookup"><span data-stu-id="c00a7-337">For example, you must not interact with a form's contents from within your callback procedure; should you have to update the form, you must switch back to the form's thread in order to do your work.</span></span> <span data-ttu-id="c00a7-338">L'esempio incluso in questo argomento viene illustrato questo comportamento.</span><span class="sxs-lookup"><span data-stu-id="c00a7-338">The example in this topic demonstrates this behavior.</span></span>  
  
 <span data-ttu-id="c00a7-339">Tutti gli errori che si verificano durante l'esecuzione dell'operazione vengono generati come eccezioni nella routine di callback.</span><span class="sxs-lookup"><span data-stu-id="c00a7-339">All errors that occur during the execution of the operation are thrown as exceptions in the callback procedure.</span></span> <span data-ttu-id="c00a7-340">È necessario gestire l'eccezione nella routine di callback, non nell'applicazione principale.</span><span class="sxs-lookup"><span data-stu-id="c00a7-340">You must handle the exception in the callback procedure, not in the main application.</span></span> <span data-ttu-id="c00a7-341">Vedere l'esempio in questo argomento per ulteriori informazioni sulla gestione delle eccezioni nella routine di callback.</span><span class="sxs-lookup"><span data-stu-id="c00a7-341">See the example in this topic for additional information on handling exceptions in the callback procedure.</span></span>  
  
 <span data-ttu-id="c00a7-342">Se si utilizza <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per accedere ai dati XML, SQL Server restituisce i risultati XML maggiore 2033 caratteri di lunghezza in più righe di 2033 caratteri.</span><span class="sxs-lookup"><span data-stu-id="c00a7-342">If you use <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to access XML data, SQL Server returns any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each.</span></span> <span data-ttu-id="c00a7-343">Per evitare questo comportamento, utilizzare <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per leggere le query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-343">To avoid this behavior, use <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to read FOR XML queries.</span></span> <span data-ttu-id="c00a7-344">Per altre informazioni, vedere l'articolo Q310378, "PRB: XML dati viene troncato quando si usa SqlDataReader," nella Microsoft Knowledge Base al http://support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="c00a7-344">For more information, see article Q310378, "PRB: XML Data Is Truncated When You Use SqlDataReader," in the Microsoft Knowledge Base at http://support.microsoft.com.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-345">Nella seguente applicazione Windows viene illustrato l'uso del metodo <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>, eseguendo un'istruzione Transact-SQL che include un ritardo di qualche secondo, ovvero emulando un comando a esecuzione prolungata.</span><span class="sxs-lookup"><span data-stu-id="c00a7-345">The following Windows application demonstrates the use of the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method, executing a Transact-SQL statement that includes a delay of a few seconds (emulating a long-running command).</span></span> <span data-ttu-id="c00a7-346">Poiché l'esempio esegue il comando in modo asincrono, il modulo resta reattivo in attesa dei risultati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-346">Because the sample executes the command asynchronously, the form remains responsive while awaiting the results.</span></span> <span data-ttu-id="c00a7-347">Questo esempio viene passato l'esecuzione <xref:System.Data.SqlClient.SqlCommand> dell'oggetto come i `stateObject` parametro; in questo modo è pertanto sufficiente recuperare il <xref:System.Data.SqlClient.SqlCommand> oggetto dalla routine di callback, in modo che il codice può chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> metodo corrispondente al chiamata a iniziale <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-347">This example passes the executing <xref:System.Data.SqlClient.SqlCommand> object as the `stateObject` parameter; doing so makes it simple to retrieve the <xref:System.Data.SqlClient.SqlCommand> object from within the callback procedure, so that the code can call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method corresponding to the initial call to <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>.</span></span>  
  
 <span data-ttu-id="c00a7-348">Questo esempio illustra molte tecniche importanti.</span><span class="sxs-lookup"><span data-stu-id="c00a7-348">This example demonstrates many important techniques.</span></span> <span data-ttu-id="c00a7-349">Ciò include la chiamata a un metodo che interagisce con il form da un thread separato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-349">This includes calling a method that interacts with the form from a separate thread.</span></span> <span data-ttu-id="c00a7-350">Inoltre, questo esempio viene illustrato come sia necessario impedire agli utenti di eseguire contemporaneamente più volte un comando e come è necessario assicurarsi che il modulo non venga chiuso prima della routine di callback viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-350">In addition, this example demonstrates how you must block users from executing a command multiple times concurrently, and how you must make sure that the form does not close before the callback procedure is called.</span></span>  
  
 <span data-ttu-id="c00a7-351">Per impostare questo esempio, creare una nuova applicazione Windows.</span><span class="sxs-lookup"><span data-stu-id="c00a7-351">To set up this example, create a new Windows application.</span></span> <span data-ttu-id="c00a7-352">Inserire un <xref:System.Windows.Forms.Button> (controllo), una <xref:System.Windows.Forms.DataGridView> (controllo) e un <xref:System.Windows.Forms.Label> controllo del form (accettando il nome predefinito per ogni controllo).</span><span class="sxs-lookup"><span data-stu-id="c00a7-352">Put a <xref:System.Windows.Forms.Button> control, a <xref:System.Windows.Forms.DataGridView> control, and a <xref:System.Windows.Forms.Label> control on the form (accepting the default name for each control).</span></span> <span data-ttu-id="c00a7-353">Aggiungere il codice seguente alla classe del form, modificando la stringa di connessione necessarie per l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="c00a7-353">Add the following code to the form's class, modifying the connection string as needed for your environment.</span></span>  
  
 [!code-csharp[DataWorks SqlCommand.BeginExecuteReaderAsync#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteReaderAsync/CS/Form1.cs#1)]
 [!code-vb[DataWorks SqlCommand.BeginExecuteReaderAsync#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteReaderAsync/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-354">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-354">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-355">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-355">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-356">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-356">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-357">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-357">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-358">Qualsiasi errore che si è verificato durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-358">Any error that occurred while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-359">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-359">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-360">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-360">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-361">La coppia nome/valore "Asynchronous Processing=true" non è stata inclusa nella stringa di connessione che definisce la connessione per <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-361">The name/value pair "Asynchronous Processing=true" was not included within the connection string defining the connection for this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
          <span data-ttu-id="c00a7-362">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-362">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-363">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-363">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-364">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-364">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-365">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-365">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-366">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-366">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-367">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-367">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="BeginExecuteReader">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginExecuteReader (AsyncCallback callback, object stateObject, System.Data.CommandBehavior behavior);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginExecuteReader(class System.AsyncCallback callback, object stateObject, valuetype System.Data.CommandBehavior behavior) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.BeginExecuteReader(System.AsyncCallback,System.Object,System.Data.CommandBehavior)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginExecuteReader (callback As AsyncCallback, stateObject As Object, behavior As CommandBehavior) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginExecuteReader(AsyncCallback ^ callback, System::Object ^ stateObject, System::Data::CommandBehavior behavior);" />
      <MemberSignature Language="F#" Value="member this.BeginExecuteReader : AsyncCallback * obj * System.Data.CommandBehavior -&gt; IAsyncResult" Usage="sqlCommand.BeginExecuteReader (callback, stateObject, behavior)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="callback" Type="System.AsyncCallback" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="behavior" Type="System.Data.CommandBehavior" />
      </Parameters>
      <Docs>
        <param name="callback">
          <span data-ttu-id="c00a7-368">Delegato <see cref="T:System.AsyncCallback" /> richiamato al termine dell'esecuzione del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-368">An <see cref="T:System.AsyncCallback" /> delegate that is invoked when the command's execution has completed.</span>
          </span>
          <span data-ttu-id="c00a7-369">Passare <see langword="null" /> (<see langword="Nothing" /> in Microsoft Visual Basic) per indicare che non è necessario alcun callback.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-369">Pass <see langword="null" /> (<see langword="Nothing" /> in Microsoft Visual Basic) to indicate that no callback is required.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="c00a7-370">Oggetto di stato definito dall'utente e passato alla routine di callback.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-370">A user-defined state object that is passed to the callback procedure.</span>
          </span>
          <span data-ttu-id="c00a7-371">Recuperare questo oggetto dalla routine di callback usando la proprietà <see cref="P:System.IAsyncResult.AsyncState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-371">Retrieve this object from within the callback procedure using the <see cref="P:System.IAsyncResult.AsyncState" /> property.</span>
          </span>
        </param>
        <param name="behavior">
          <span data-ttu-id="c00a7-372">Uno dei valori <see cref="T:System.Data.CommandBehavior" /> che indica le opzioni per l'esecuzione dell'istruzione e il recupero dei dati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-372">One of the <see cref="T:System.Data.CommandBehavior" /> values, indicating options for statement execution and data retrieval.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-373">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> utilizzando uno dei valori <see langword="CommandBehavior" /> e recuperando uno o più set di risultati dal server, in base alla routine di callback e alle informazioni sullo stato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-373">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" />, using one of the <see langword="CommandBehavior" /> values, and retrieving one or more result sets from the server, given a callback procedure and state information.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-374">Oggetto <see cref="T:System.IAsyncResult" /> che può essere utilizzato per eseguire il polling, attendere i risultati o entrambe le cose; questo valore è necessario anche per chiamare il metodo <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" />, che restituisce un'istanza <see cref="T:System.Data.SqlClient.SqlDataReader" /> che può essere utilizzata per recuperare le righe restituite.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-374">An <see cref="T:System.IAsyncResult" /> that can be used to poll or wait for results, or both; this value is also needed when invoking <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" />, which returns a <see cref="T:System.Data.SqlClient.SqlDataReader" /> instance which can be used to retrieve the returned rows.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-375">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo avvia il processo di esecuzione in modo asincrono un'istruzione Transact-SQL o stored procedure che restituisce righe, in modo che altre attività eseguibili contemporaneamente durante l'esecuzione dell'istruzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-375">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method starts the process of asynchronously executing a Transact-SQL statement or stored procedure that returns rows, so that other tasks can run concurrently while the statement is executing.</span></span> <span data-ttu-id="c00a7-376">Quando l'istruzione è stata completata, gli sviluppatori devono chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> metodo per completare l'operazione e recuperare il <xref:System.Data.SqlClient.SqlDataReader> restituita dal comando.</span><span class="sxs-lookup"><span data-stu-id="c00a7-376">When the statement has completed, developers must call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method to finish the operation and retrieve the <xref:System.Data.SqlClient.SqlDataReader> returned by the command.</span></span> <span data-ttu-id="c00a7-377">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo viene restituito immediatamente, ma fino a quando non viene eseguito il codice corrispondente <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> chiamata al metodo, non è necessario eseguire altre chiamate che iniziano con un'esecuzione sincrona o asincrona sullo stesso <xref:System.Data.SqlClient.SqlCommand> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-377">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method returns immediately, but until the code executes the corresponding <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method call, it must not execute any other calls that start a synchronous or asynchronous execution against the same <xref:System.Data.SqlClient.SqlCommand> object.</span></span> <span data-ttu-id="c00a7-378">La chiamata di <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> prima dell'esecuzione del comando completamento causa il <xref:System.Data.SqlClient.SqlCommand> blocco oggetto fino al completamento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-378">Calling the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> before the command's execution is completed causes the <xref:System.Data.SqlClient.SqlCommand> object to block until the execution is finished.</span></span>  
  
 <span data-ttu-id="c00a7-379">Il `callback` parametro consente di specificare un <xref:System.AsyncCallback> delegato che viene chiamato quando l'istruzione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="c00a7-379">The `callback` parameter lets you specify an <xref:System.AsyncCallback> delegate that is called when the statement has completed.</span></span> <span data-ttu-id="c00a7-380">È possibile chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> metodo dall'interno della routine delegato o da qualsiasi altra posizione all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-380">You can call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method from within this delegate procedure, or from any other location within your application.</span></span> <span data-ttu-id="c00a7-381">Inoltre, è possibile passare qualsiasi oggetto nel `stateObject` parametro e la routine di callback può recuperare queste informazioni utilizzando il <xref:System.IAsyncResult.AsyncState%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-381">In addition, you can pass any object in the `stateObject` parameter, and your callback procedure can retrieve this information using the <xref:System.IAsyncResult.AsyncState%2A> property.</span></span>  
  
 <span data-ttu-id="c00a7-382">Il `behavior` parametro consente di specificare le opzioni che controllano il comportamento del comando e la connessione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-382">The `behavior` parameter lets you specify options that control the behavior of the command and its connection.</span></span> <span data-ttu-id="c00a7-383">Questi valori possono essere combinati tra loro (usando il linguaggio di programmazione `Or` operatore); in genere, gli sviluppatori utilizzano il `CloseConnection` valore per assicurarsi che la connessione viene chiusa dal runtime quando la <xref:System.Data.SqlClient.SqlDataReader> viene chiuso.</span><span class="sxs-lookup"><span data-stu-id="c00a7-383">These values can be combined together (using the programming language's `Or` operator); generally, developers use the `CloseConnection` value to make sure that the connection is closed by the runtime when the <xref:System.Data.SqlClient.SqlDataReader> is closed.</span></span> <span data-ttu-id="c00a7-384">Gli sviluppatori possono inoltre ottimizzare il comportamento del <xref:System.Data.SqlClient.SqlDataReader> specificando il `SingleRow` valore quando è noto in anticipo che l'istruzione Transact-SQL o stored procedure restituisce solo una singola riga.</span><span class="sxs-lookup"><span data-stu-id="c00a7-384">Developers can also optimize the behavior of the <xref:System.Data.SqlClient.SqlDataReader> by specifying the `SingleRow` value when it is known in advance that the Transact-SQL statement or stored procedure only returns a single row.</span></span>  
  
 <span data-ttu-id="c00a7-385">Si noti che il testo del comando e i parametri vengono inviati al server in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-385">Note that the command text and parameters are sent to the server synchronously.</span></span> <span data-ttu-id="c00a7-386">Se un comando di grandi dimensioni o numerosi parametri vengono inviati, questo metodo può bloccare durante la scrittura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-386">If a large command or many parameters are sent, this method may block during writes.</span></span> <span data-ttu-id="c00a7-387">Dopo l'invio del comando, il metodo restituisce immediatamente senza attendere una risposta dal server, vale a dire, operazioni di lettura sono asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-387">After the command is sent, the method returns immediately without waiting for an answer from the server--that is, reads are asynchronous.</span></span> <span data-ttu-id="c00a7-388">Anche se l'esecuzione del comando è asincrono, il recupero dei valori è sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-388">Although command execution is asynchronous, value fetching is still synchronous.</span></span> <span data-ttu-id="c00a7-389">Ciò significa che le chiamate a <xref:System.Data.SqlClient.SqlDataReader.Read%2A> possono venire bloccate se sono necessari più dati e di rete sottostante operazione di lettura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-389">This means that calls to <xref:System.Data.SqlClient.SqlDataReader.Read%2A> may block if more data is required and the underlying network's read operation blocks.</span></span>  
  
 <span data-ttu-id="c00a7-390">Poiché la routine di callback viene eseguita da un thread in background fornito da Microsoft .NET common language runtime, è molto importante una rigorosa alla gestione delle interazioni tra thread dall'interno di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c00a7-390">Because the callback procedure executes from within a background thread supplied by the Microsoft .NET common language runtime, it is very important that you take a rigorous approach to handling cross-thread interactions from within your applications.</span></span> <span data-ttu-id="c00a7-391">Ad esempio, non è possibile interagire con il contenuto di un modulo di routine di callback, è necessario aggiornare il form, è necessario passare al thread del form per svolgere il proprio lavoro.</span><span class="sxs-lookup"><span data-stu-id="c00a7-391">For example, you must not interact with a form's contents from within your callback procedure--should you have to update the form, you must switch back to the form's thread in order to do your work.</span></span> <span data-ttu-id="c00a7-392">L'esempio incluso in questo argomento viene illustrato questo comportamento.</span><span class="sxs-lookup"><span data-stu-id="c00a7-392">The example in this topic demonstrates this behavior.</span></span>  
  
 <span data-ttu-id="c00a7-393">Tutti gli errori che si verificano durante l'esecuzione dell'operazione vengono generati come eccezioni nella routine di callback.</span><span class="sxs-lookup"><span data-stu-id="c00a7-393">All errors that occur during the execution of the operation are thrown as exceptions in the callback procedure.</span></span> <span data-ttu-id="c00a7-394">È necessario gestire l'eccezione nella routine di callback, non nell'applicazione principale.</span><span class="sxs-lookup"><span data-stu-id="c00a7-394">You must handle the exception in the callback procedure, not in the main application.</span></span> <span data-ttu-id="c00a7-395">Vedere l'esempio in questo argomento per ulteriori informazioni sulla gestione delle eccezioni nella routine di callback.</span><span class="sxs-lookup"><span data-stu-id="c00a7-395">See the example in this topic for additional information on handling exceptions in the callback procedure.</span></span>  
  
 <span data-ttu-id="c00a7-396">Se si utilizza <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per accedere ai dati XML, SQL Server restituirà i risultati XML maggiore 2033 caratteri di lunghezza in più righe di 2033 caratteri.</span><span class="sxs-lookup"><span data-stu-id="c00a7-396">If you use <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each.</span></span> <span data-ttu-id="c00a7-397">Per evitare questo comportamento, utilizzare <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per leggere le query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-397">To avoid this behavior, use <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to read FOR XML queries.</span></span> <span data-ttu-id="c00a7-398">Per altre informazioni, vedere l'articolo Q310378, "PRB: XML dati viene troncato quando si usa SqlDataReader," nella Microsoft Knowledge Base al http://support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="c00a7-398">For more information, see article Q310378, "PRB: XML Data Is Truncated When You Use SqlDataReader," in the Microsoft Knowledge Base at http://support.microsoft.com.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-399">Nella seguente applicazione Windows viene illustrato l'uso del metodo <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>, eseguendo un'istruzione Transact-SQL che include un ritardo di qualche secondo, ovvero emulando un comando a esecuzione prolungata.</span><span class="sxs-lookup"><span data-stu-id="c00a7-399">The following Windows application demonstrates the use of the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method, executing a Transact-SQL statement that includes a delay of a few seconds (emulating a long-running command).</span></span> <span data-ttu-id="c00a7-400">Poiché l'esempio esegue il comando in modo asincrono, il modulo resta reattivo in attesa dei risultati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-400">Because the sample executes the command asynchronously, the form remains responsive while awaiting the results.</span></span> <span data-ttu-id="c00a7-401">Questo esempio viene passato l'esecuzione <xref:System.Data.SqlClient.SqlCommand> dell'oggetto come i `stateObject` parametro; in questo modo è pertanto sufficiente recuperare il <xref:System.Data.SqlClient.SqlCommand> oggetto dalla routine di callback, in modo che il codice può chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> metodo corrispondente al chiamata a iniziale <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-401">This example passes the executing <xref:System.Data.SqlClient.SqlCommand> object as the `stateObject` parameter; doing so makes it simple to retrieve the <xref:System.Data.SqlClient.SqlCommand> object from within the callback procedure, so that the code can call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method corresponding to the initial call to <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>.</span></span>  
  
 <span data-ttu-id="c00a7-402">Questo esempio illustra molte tecniche importanti.</span><span class="sxs-lookup"><span data-stu-id="c00a7-402">This example demonstrates many important techniques.</span></span> <span data-ttu-id="c00a7-403">Ciò include la chiamata a un metodo che interagisce con il form da un thread separato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-403">This includes calling a method that interacts with the form from a separate thread.</span></span> <span data-ttu-id="c00a7-404">Inoltre, questo esempio viene illustrato come sia necessario impedire agli utenti di eseguire contemporaneamente più volte un comando e come è necessario assicurarsi che il modulo non venga chiuso prima della routine di callback viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-404">In addition, this example demonstrates how you must block users from executing a command multiple times concurrently, and how you must make sure that the form does not close before the callback procedure is called.</span></span>  
  
 <span data-ttu-id="c00a7-405">Per impostare questo esempio, creare una nuova applicazione Windows.</span><span class="sxs-lookup"><span data-stu-id="c00a7-405">To set up this example, create a new Windows application.</span></span> <span data-ttu-id="c00a7-406">Inserire un <xref:System.Windows.Forms.Button> (controllo), una <xref:System.Windows.Forms.DataGridView> (controllo) e un <xref:System.Windows.Forms.Label> controllo del form (accettando il nome predefinito per ogni controllo).</span><span class="sxs-lookup"><span data-stu-id="c00a7-406">Put a <xref:System.Windows.Forms.Button> control, a <xref:System.Windows.Forms.DataGridView> control, and a <xref:System.Windows.Forms.Label> control on the form (accepting the default name for each control).</span></span> <span data-ttu-id="c00a7-407">Aggiungere il codice seguente alla classe del form, modificando la stringa di connessione necessarie per l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="c00a7-407">Add the following code to the form's class, modifying the connection string as needed for your environment.</span></span>  
  
 <span data-ttu-id="c00a7-408">Questo esempio passa il `CommandBehavior.CloseConnection` valore di `behavior` parametro, determinando l'oggetto restituito <xref:System.Data.SqlClient.SqlDataReader> chiudere automaticamente la connessione è chiusa.</span><span class="sxs-lookup"><span data-stu-id="c00a7-408">This example passes the `CommandBehavior.CloseConnection` value in the `behavior` parameter, causing the returned <xref:System.Data.SqlClient.SqlDataReader> to automatically close its connection when it is closed.</span></span>  
  
 [!code-csharp[DataWorks SqlCommand.BeginExecuteReaderAsyncBehavior#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteReaderAsyncBehavior/CS/Form1.cs#1)]
 [!code-vb[DataWorks SqlCommand.BeginExecuteReaderAsyncBehavior#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteReaderAsyncBehavior/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-409">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-409">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-410">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-410">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-411">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-411">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-412">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-412">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-413">Qualsiasi errore che si è verificato durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-413">Any error that occurred while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-414">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-414">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-415">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-415">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-416">La coppia nome/valore "Asynchronous Processing=true" non è stata inclusa nella stringa di connessione che definisce la connessione per <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-416">The name/value pair "Asynchronous Processing=true" was not included within the connection string defining the connection for this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
          <span data-ttu-id="c00a7-417">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-417">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-418">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-418">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-419">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-419">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-420">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-420">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-421">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-421">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-422">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-422">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginExecuteXmlReader">
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-423">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> e restituisce i risultati come oggetto <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-423">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" /> and returns results as an <see cref="T:System.Xml.XmlReader" /> object.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginExecuteXmlReader">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginExecuteXmlReader ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginExecuteXmlReader() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginExecuteXmlReader () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginExecuteXmlReader();" />
      <MemberSignature Language="F#" Value="member this.BeginExecuteXmlReader : unit -&gt; IAsyncResult" Usage="sqlCommand.BeginExecuteXmlReader " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-424">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> e restituisce i risultati come oggetto <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-424">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" /> and returns results as an <see cref="T:System.Xml.XmlReader" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-425">Oggetto <see cref="T:System.IAsyncResult" /> che può essere utilizzato per eseguire il polling, attendere i risultati o entrambe le cose; questo valore è necessario anche per chiamare il metodo <see langword="EndExecuteXmlReader" />, che restituisce un singolo valore XML.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-425">An <see cref="T:System.IAsyncResult" /> that can be used to poll or wait for results, or both; this value is also needed when invoking <see langword="EndExecuteXmlReader" />, which returns a single XML value.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-426">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> metodo avvia il processo di esecuzione in modo asincrono un'istruzione Transact-SQL che restituisce le righe in XML, in modo che altre attività eseguibili contemporaneamente durante l'esecuzione dell'istruzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-426">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> method starts the process of asynchronously executing a Transact-SQL statement that returns rows as XML, so that other tasks can run concurrently while the statement is executing.</span></span> <span data-ttu-id="c00a7-427">Quando l'istruzione è stata completata, gli sviluppatori devono chiamare il `EndExecuteXmlReader` metodo per completare l'operazione e recuperare il codice XML restituito dal comando.</span><span class="sxs-lookup"><span data-stu-id="c00a7-427">When the statement has completed, developers must call the `EndExecuteXmlReader` method to finish the operation and retrieve the XML returned by the command.</span></span> <span data-ttu-id="c00a7-428">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> metodo viene restituito immediatamente, ma fino a quando non viene eseguito il codice corrispondente `EndExecuteXmlReader` chiamata al metodo, non è necessario eseguire altre chiamate che iniziano con un'esecuzione sincrona o asincrona sullo stesso <xref:System.Data.SqlClient.SqlCommand> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-428">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> method returns immediately, but until the code executes the corresponding `EndExecuteXmlReader` method call, it must not execute any other calls that start a synchronous or asynchronous execution against the same <xref:System.Data.SqlClient.SqlCommand> object.</span></span> <span data-ttu-id="c00a7-429">La chiamata di `EndExecuteXmlReader` prima dell'esecuzione del comando completamento causa il <xref:System.Data.SqlClient.SqlCommand> blocco oggetto fino al completamento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-429">Calling the `EndExecuteXmlReader` before the command's execution is completed causes the <xref:System.Data.SqlClient.SqlCommand> object to block until the execution is finished.</span></span>  
  
 <span data-ttu-id="c00a7-430">Il <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> proprietà specifica, in genere un'istruzione Transact-SQL con una clausola FOR XML valida.</span><span class="sxs-lookup"><span data-stu-id="c00a7-430">The <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> property ordinarily specifies a Transact-SQL statement with a valid FOR XML clause.</span></span> <span data-ttu-id="c00a7-431">Tuttavia, `CommandText` inoltre possibile specificare un'istruzione che restituisce `ntext` dati che contenga un XML valido.</span><span class="sxs-lookup"><span data-stu-id="c00a7-431">However, `CommandText` can also specify a statement that returns `ntext` data that contains valid XML.</span></span>  
  
 <span data-ttu-id="c00a7-432">Una tipica <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> query possono essere formattati come nell'esempio c# seguente:</span><span class="sxs-lookup"><span data-stu-id="c00a7-432">A typical <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> query can be formatted as in the following C# example:</span></span>  
  
```  
SqlCommand command = new SqlCommand("SELECT ContactID, FirstName, LastName FROM dbo.Contact FOR XML AUTO, XMLDATA", SqlConn);  
```  
  
 <span data-ttu-id="c00a7-433">Questo metodo può essere utilizzato anche per recuperare un set di risultati a riga singola e una sola colonna.</span><span class="sxs-lookup"><span data-stu-id="c00a7-433">This method can also be used to retrieve a single-row, single-column result set.</span></span> <span data-ttu-id="c00a7-434">In questo caso, se più di una riga viene restituita, il `EndExecuteXmlReader` metodo associa la <xref:System.Xml.XmlReader> al valore della prima riga e viene eliminato il resto del risultato del gruppo.</span><span class="sxs-lookup"><span data-stu-id="c00a7-434">In this case, if more than one row is returned, the `EndExecuteXmlReader` method attaches the <xref:System.Xml.XmlReader> to the value on the first row, and discards the rest of the result set.</span></span>  
  
 <span data-ttu-id="c00a7-435">La funzionalità di multiple active result set (MARS) consente a più azioni di usare la stessa connessione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-435">The multiple active result set (MARS) feature lets multiple actions use the same connection.</span></span>  
  
 <span data-ttu-id="c00a7-436">Si noti che il testo del comando e i parametri vengono inviati al server in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-436">Note that the command text and parameters are sent to the server synchronously.</span></span> <span data-ttu-id="c00a7-437">Se un comando di grandi dimensioni o numerosi parametri vengono inviati, questo metodo può bloccare durante la scrittura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-437">If a large command or many parameters are sent, this method may block during writes.</span></span> <span data-ttu-id="c00a7-438">Dopo l'invio del comando, il metodo restituisce immediatamente senza attendere una risposta dal server, vale a dire, operazioni di lettura sono asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-438">After the command is sent, the method returns immediately without waiting for an answer from the server--that is, reads are asynchronous.</span></span> <span data-ttu-id="c00a7-439">Anche se l'esecuzione del comando è asincrono, il recupero dei valori è sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-439">Although command execution is asynchronous, value fetching is still synchronous.</span></span>  
  
 <span data-ttu-id="c00a7-440">Poiché questo overload non supporta una routine di callback, gli sviluppatori necessario entrambi polling per determinare se il comando è stata completata, utilizzando il <xref:System.IAsyncResult.IsCompleted%2A> proprietà del <xref:System.IAsyncResult> restituito dal <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> metodo; o attendere il completamento di uno o più comandi usando il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà dell'oggetto restituito <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-440">Because this overload does not support a callback procedure, developers need to either poll to determine whether the command has completed, using the <xref:System.IAsyncResult.IsCompleted%2A> property of the <xref:System.IAsyncResult> returned by the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> method; or wait for the completion of one or more commands using the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the returned <xref:System.IAsyncResult>.</span></span>  
  
 <span data-ttu-id="c00a7-441">Se si utilizza <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per accedere ai dati XML, SQL Server restituisce i risultati XML maggiore 2033 caratteri di lunghezza in più righe di 2033 caratteri.</span><span class="sxs-lookup"><span data-stu-id="c00a7-441">If you use <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to access XML data, SQL Server returns any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each.</span></span> <span data-ttu-id="c00a7-442">Per evitare questo comportamento, utilizzare <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per leggere le query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-442">To avoid this behavior, use <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to read FOR XML queries.</span></span> <span data-ttu-id="c00a7-443">Per altre informazioni, vedere l'articolo Q310378, "PRB: XML dati viene troncato quando si usa SqlDataReader," nella Microsoft Knowledge Base al http://support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="c00a7-443">For more information, see article Q310378, "PRB: XML Data Is Truncated When You Use SqlDataReader," in the Microsoft Knowledge Base at http://support.microsoft.com.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-444">La seguente applicazione console avvia il processo di recupero di dati XML in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-444">The following console application starts the process of retrieving XML data asynchronously.</span></span> <span data-ttu-id="c00a7-445">Durante l'attesa di risultati, questa semplice applicazione si trova in un ciclo, analizzando il <xref:System.IAsyncResult.IsCompleted%2A> valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-445">While waiting for the results, this simple application sits in a loop, investigating the <xref:System.IAsyncResult.IsCompleted%2A> property value.</span></span> <span data-ttu-id="c00a7-446">Una volta completato il processo, il codice recupera il codice XML e ne visualizza il contenuto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-446">Once the process has completed, the code retrieves the XML and displays its contents.</span></span>  
  
 [!code-csharp[DataWorks SqlCommand.BeginExecuteXmlReader#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteXmlReader/CS/source.cs#1)]
 [!code-vb[DataWorks SqlCommand.BeginExecuteXmlReader#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteXmlReader/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-447">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-447">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-448">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-448">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-449">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-449">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-450">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-450">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-451">Qualsiasi errore che si è verificato durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-451">Any error that occurred while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-452">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-452">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-453">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-453">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-454">La coppia nome/valore "Asynchronous Processing=true" non è stata inclusa nella stringa di connessione che definisce la connessione per <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-454">The name/value pair "Asynchronous Processing=true" was not included within the connection string defining the connection for this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
          <span data-ttu-id="c00a7-455">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-455">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-456">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-456">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-457">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-457">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-458">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-458">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-459">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-459">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-460">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-460">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="BeginExecuteXmlReader">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginExecuteXmlReader (AsyncCallback callback, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginExecuteXmlReader(class System.AsyncCallback callback, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader(System.AsyncCallback,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginExecuteXmlReader (callback As AsyncCallback, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginExecuteXmlReader(AsyncCallback ^ callback, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginExecuteXmlReader : AsyncCallback * obj -&gt; IAsyncResult" Usage="sqlCommand.BeginExecuteXmlReader (callback, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="callback" Type="System.AsyncCallback" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="callback">
          <span data-ttu-id="c00a7-461">Delegato <see cref="T:System.AsyncCallback" /> richiamato al termine dell'esecuzione del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-461">An <see cref="T:System.AsyncCallback" /> delegate that is invoked when the command's execution has completed.</span>
          </span>
          <span data-ttu-id="c00a7-462">Passare <see langword="null" /> (<see langword="Nothing" /> in Microsoft Visual Basic) per indicare che non è necessario alcun callback.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-462">Pass <see langword="null" /> (<see langword="Nothing" /> in Microsoft Visual Basic) to indicate that no callback is required.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="c00a7-463">Oggetto di stato definito dall'utente e passato alla routine di callback.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-463">A user-defined state object that is passed to the callback procedure.</span>
          </span>
          <span data-ttu-id="c00a7-464">Recuperare questo oggetto dalla routine di callback usando la proprietà <see cref="P:System.IAsyncResult.AsyncState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-464">Retrieve this object from within the callback procedure using the <see cref="P:System.IAsyncResult.AsyncState" /> property.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-465">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> e restituisce i risultati come oggetto <see cref="T:System.Xml.XmlReader" /> usando una routine di callback.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-465">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" /> and returns results as an <see cref="T:System.Xml.XmlReader" /> object, using a callback procedure.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-466">Oggetto <see cref="T:System.IAsyncResult" /> che può essere usato per eseguire il polling, attendere i risultati o entrambe le cose. Questo valore è necessario anche per chiamare il metodo <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader(System.IAsyncResult)" />, che restituisce i risultati del comando come dati XML.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-466">An <see cref="T:System.IAsyncResult" /> that can be used to poll, wait for results, or both; this value is also needed when the <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader(System.IAsyncResult)" /> is called, which returns the results of the command as XML.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-467">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> metodo avvia il processo di esecuzione in modo asincrono un'istruzione Transact-SQL o stored procedure che restituisce le righe in XML, in modo che altre attività eseguibili contemporaneamente durante l'esecuzione dell'istruzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-467">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> method starts the process of asynchronously executing a Transact-SQL statement or stored procedure that returns rows as XML, so that other tasks can run concurrently while the statement is executing.</span></span> <span data-ttu-id="c00a7-468">Quando l'istruzione è stata completata, gli sviluppatori devono chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> metodo al termine dell'operazione di recuperare i dati XML richiesti.</span><span class="sxs-lookup"><span data-stu-id="c00a7-468">When the statement has completed, developers must call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> method to finish the operation and retrieve the requested XML data.</span></span> <span data-ttu-id="c00a7-469">Il <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> metodo viene restituito immediatamente, ma fino a quando non viene eseguito il codice corrispondente <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> chiamata al metodo, non è necessario eseguire altre chiamate che iniziano con un'esecuzione sincrona o asincrona sullo stesso <xref:System.Data.SqlClient.SqlCommand> oggetto.</span><span class="sxs-lookup"><span data-stu-id="c00a7-469">The <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> method returns immediately, but until the code executes the corresponding <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> method call, it must not execute any other calls that start a synchronous or asynchronous execution against the same <xref:System.Data.SqlClient.SqlCommand> object.</span></span> <span data-ttu-id="c00a7-470">La chiamata di <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> prima dell'esecuzione del comando completamento causa il <xref:System.Data.SqlClient.SqlCommand> blocco oggetto fino al completamento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-470">Calling the <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> before the command's execution is completed causes the <xref:System.Data.SqlClient.SqlCommand> object to block until the execution is finished.</span></span>  
  
 <span data-ttu-id="c00a7-471">Il <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> proprietà specifica, in genere un'istruzione Transact-SQL con una clausola FOR XML valida.</span><span class="sxs-lookup"><span data-stu-id="c00a7-471">The <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> property ordinarily specifies a Transact-SQL statement with a valid FOR XML clause.</span></span> <span data-ttu-id="c00a7-472">Tuttavia, `CommandText` inoltre possibile specificare un'istruzione che restituisce dati che contenga un XML valido.</span><span class="sxs-lookup"><span data-stu-id="c00a7-472">However, `CommandText` can also specify a statement that returns data that contains valid XML.</span></span> <span data-ttu-id="c00a7-473">Questo metodo può essere utilizzato anche per recuperare un set di risultati a riga singola e una sola colonna.</span><span class="sxs-lookup"><span data-stu-id="c00a7-473">This method can also be used to retrieve a single-row, single-column result set.</span></span> <span data-ttu-id="c00a7-474">In questo caso, se più di una riga viene restituita, il <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> metodo associa la <xref:System.Xml.XmlReader> al valore della prima riga e viene eliminato il resto del risultato del gruppo.</span><span class="sxs-lookup"><span data-stu-id="c00a7-474">In this case, if more than one row is returned, the <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> method attaches the <xref:System.Xml.XmlReader> to the value on the first row, and discards the rest of the result set.</span></span>  
  
 <span data-ttu-id="c00a7-475">Una tipica <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> query possono essere formattati come nell'esempio c# seguente:</span><span class="sxs-lookup"><span data-stu-id="c00a7-475">A typical <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> query can be formatted as in the following C# example:</span></span>  
  
```  
SqlCommand command = new SqlCommand("SELECT ContactID, FirstName, LastName FROM Contact FOR XML AUTO, XMLDATA", SqlConn);  
```  
  
 <span data-ttu-id="c00a7-476">Questo metodo può essere utilizzato anche per recuperare un set di risultati a riga singola e una sola colonna.</span><span class="sxs-lookup"><span data-stu-id="c00a7-476">This method can also be used to retrieve a single-row, single-column result set.</span></span> <span data-ttu-id="c00a7-477">In questo caso, se più di una riga viene restituita, il <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> metodo associa la <xref:System.Xml.XmlReader> al valore della prima riga e viene eliminato il resto del risultato del gruppo.</span><span class="sxs-lookup"><span data-stu-id="c00a7-477">In this case, if more than one row is returned, the <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> method attaches the <xref:System.Xml.XmlReader> to the value on the first row, and discards the rest of the result set.</span></span>  
  
 <span data-ttu-id="c00a7-478">La funzionalità di multiple active result set (MARS) consente a più azioni di usare la stessa connessione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-478">The multiple active result set (MARS) feature lets multiple actions use the same connection.</span></span>  
  
 <span data-ttu-id="c00a7-479">Il `callback` parametro consente di specificare un <xref:System.AsyncCallback> delegato che viene chiamato quando l'istruzione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="c00a7-479">The `callback` parameter lets you specify an <xref:System.AsyncCallback> delegate that is called when the statement has completed.</span></span> <span data-ttu-id="c00a7-480">È possibile chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> metodo dall'interno della routine delegato o da qualsiasi altra posizione all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-480">You can call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> method from within this delegate procedure, or from any other location within your application.</span></span> <span data-ttu-id="c00a7-481">Inoltre, è possibile passare qualsiasi oggetto nel `stateObject` parametro e la routine di callback può recuperare queste informazioni utilizzando il <xref:System.IAsyncResult.AsyncState%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-481">In addition, you can pass any object in the `stateObject` parameter, and your callback procedure can retrieve this information using the <xref:System.IAsyncResult.AsyncState%2A> property.</span></span>  
  
 <span data-ttu-id="c00a7-482">Si noti che il testo del comando e i parametri vengono inviati al server in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="c00a7-482">Note that the command text and parameters are sent to the server synchronously.</span></span> <span data-ttu-id="c00a7-483">Se viene inviato un comando di grandi dimensioni o sono stati specificati parametri, questo metodo può bloccare durante la scrittura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-483">If a large command or many parameters is sent, this method may block during writes.</span></span> <span data-ttu-id="c00a7-484">Dopo l'invio del comando, il metodo restituisce immediatamente senza attendere una risposta dal server, vale a dire, operazioni di lettura sono asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-484">After the command is sent, the method returns immediately without waiting for an answer from the server--that is, reads are asynchronous.</span></span>  
  
 <span data-ttu-id="c00a7-485">Tutti gli errori che si verificano durante l'esecuzione dell'operazione vengono generati come eccezioni nella routine di callback.</span><span class="sxs-lookup"><span data-stu-id="c00a7-485">All errors that occur during the execution of the operation are thrown as exceptions in the callback procedure.</span></span> <span data-ttu-id="c00a7-486">È necessario gestire l'eccezione nella routine di callback, non nell'applicazione principale.</span><span class="sxs-lookup"><span data-stu-id="c00a7-486">You must handle the exception in the callback procedure, not in the main application.</span></span> <span data-ttu-id="c00a7-487">Vedere l'esempio in questo argomento per ulteriori informazioni sulla gestione delle eccezioni nella routine di callback.</span><span class="sxs-lookup"><span data-stu-id="c00a7-487">See the example in this topic for additional information on handling exceptions in the callback procedure.</span></span>  
  
 <span data-ttu-id="c00a7-488">Se si utilizza <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per accedere ai dati XML, SQL Server restituirà i risultati XML maggiore 2033 caratteri di lunghezza in più righe di 2033 caratteri.</span><span class="sxs-lookup"><span data-stu-id="c00a7-488">If you use <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each.</span></span> <span data-ttu-id="c00a7-489">Per evitare questo comportamento, utilizzare <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per leggere le query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-489">To avoid this behavior, use <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to read FOR XML queries.</span></span> <span data-ttu-id="c00a7-490">Per altre informazioni, vedere l'articolo Q310378, "PRB: XML dati viene troncato quando si usa SqlDataReader," nella Microsoft Knowledge Base al http://support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="c00a7-490">For more information, see article Q310378, "PRB: XML Data Is Truncated When You Use SqlDataReader," in the Microsoft Knowledge Base at http://support.microsoft.com.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-491">Nella seguente applicazione Windows viene illustrato l'uso del metodo <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A>, eseguendo un'istruzione Transact-SQL che include un ritardo di qualche secondo, ovvero emulando un comando a esecuzione prolungata.</span><span class="sxs-lookup"><span data-stu-id="c00a7-491">The following Windows application demonstrates the use of the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> method, executing a Transact-SQL statement that includes a delay of a few seconds (emulating a long-running command).</span></span> <span data-ttu-id="c00a7-492">Questo esempio viene passato l'esecuzione <xref:System.Data.SqlClient.SqlCommand> dell'oggetto come il `stateObject` parametro - in questo modo, un modo semplice per recuperare il <xref:System.Data.SqlClient.SqlCommand> oggetto dalla routine di callback, in modo che il codice può chiamare il <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> corrispondente metodo il chiamata a iniziale <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-492">This example passes the executing <xref:System.Data.SqlClient.SqlCommand> object as the `stateObject` parameter--doing so makes it simple to retrieve the <xref:System.Data.SqlClient.SqlCommand> object from within the callback procedure, so that the code can call the <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> method corresponding to the initial call to <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A>.</span></span>  
  
 <span data-ttu-id="c00a7-493">Questo esempio illustra molte tecniche importanti.</span><span class="sxs-lookup"><span data-stu-id="c00a7-493">This example demonstrates many important techniques.</span></span> <span data-ttu-id="c00a7-494">Ciò include la chiamata a un metodo che interagisce con il form da un thread separato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-494">This includes calling a method that interacts with the form from a separate thread.</span></span> <span data-ttu-id="c00a7-495">Inoltre, questo esempio viene illustrato come sia necessario impedire agli utenti di eseguire contemporaneamente più volte un comando e come è necessario assicurarsi che il modulo non venga chiuso prima della routine di callback viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-495">In addition, this example demonstrates how you must block users from executing a command multiple times concurrently, and how you must make sure that the form does not close before the callback procedure is called.</span></span>  
  
 <span data-ttu-id="c00a7-496">Per impostare questo esempio, creare una nuova applicazione Windows.</span><span class="sxs-lookup"><span data-stu-id="c00a7-496">To set up this example, create a new Windows application.</span></span> <span data-ttu-id="c00a7-497">Inserire un <xref:System.Windows.Forms.Button> (controllo), una <xref:System.Windows.Forms.ListBox> (controllo) e un <xref:System.Windows.Forms.Label> controllo del form (accettando il nome predefinito per ogni controllo).</span><span class="sxs-lookup"><span data-stu-id="c00a7-497">Put a <xref:System.Windows.Forms.Button> control, a <xref:System.Windows.Forms.ListBox> control, and a <xref:System.Windows.Forms.Label> control on the form (accepting the default name for each control).</span></span> <span data-ttu-id="c00a7-498">Aggiungere il codice seguente alla classe del form, modificando la stringa di connessione necessarie per l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="c00a7-498">Add the following code to the form's class, modifying the connection string as needed for your environment.</span></span>  
  
 [!code-csharp[DataWorks SqlCommand.BeginExecuteXmlReaderAsync#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteXmlReaderAsync/CS/Form1.cs#1)]
 [!code-vb[DataWorks SqlCommand.BeginExecuteXmlReaderAsync#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlCommand.BeginExecuteXmlReaderAsync/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-499">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-499">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-500">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-500">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-501">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-501">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-502">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-502">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-503">Qualsiasi errore che si è verificato durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-503">Any error that occurred while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-504">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-504">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-505">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-505">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-506">La coppia nome/valore "Asynchronous Processing=true" non è stata inclusa nella stringa di connessione che definisce la connessione per <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-506">The name/value pair "Asynchronous Processing=true" was not included within the connection string defining the connection for this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
          <span data-ttu-id="c00a7-507">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-507">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-508">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-508">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-509">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-509">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-510">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-510">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-511">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-511">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-512">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-512">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <altmember cref="M:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader(System.IAsyncResult)" />
        <altmember cref="M:System.Data.SqlClient.SqlCommand.ExecuteXmlReader" />
      </Docs>
    </Member>
    <Member MemberName="Cancel">
      <MemberSignature Language="C#" Value="public override void Cancel ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Cancel() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.Cancel" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Cancel ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Cancel();" />
      <MemberSignature Language="F#" Value="override this.Cancel : unit -&gt; unit" Usage="sqlCommand.Cancel " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Data.IDbCommand.Cancel</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-513">Prova ad annullare l'esecuzione di <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-513">Tries to cancel the execution of a <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-514">Se non sono presenti operazioni da annullare, non viene eseguita alcuna azione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-514">If there is nothing to cancel, nothing occurs.</span></span> <span data-ttu-id="c00a7-515">Se, tuttavia, è in corso l'esecuzione di un comando e il tentativo di annullarlo non riesce, non viene generata alcuna eccezione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-515">However, if there is a command in process, and the attempt to cancel fails, no exception is generated.</span></span>  
  
 <span data-ttu-id="c00a7-516">In alcuni casi rari, se si chiama <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> quindi chiamare <xref:System.Data.SqlClient.SqlDataReader.Close%2A> (implicitamente o esplicitamente) prima di chiamare <xref:System.Data.SqlClient.SqlCommand.Cancel%2A>, quindi chiamare <xref:System.Data.SqlClient.SqlCommand.Cancel%2A>, il comando di annullamento non verrà inviato a SQL Server e il set di risultati è possibile continuare a trasmettere dopo aver chiamare <xref:System.Data.SqlClient.SqlConnection.Close%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-516">In some, rare, cases, if you call <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> then call <xref:System.Data.SqlClient.SqlDataReader.Close%2A> (implicitily or explicitly) before calling <xref:System.Data.SqlClient.SqlCommand.Cancel%2A>, and then call <xref:System.Data.SqlClient.SqlCommand.Cancel%2A>, the cancel command will not be sent to SQL Server and the result set can continue to stream after you call <xref:System.Data.SqlClient.SqlConnection.Close%2A>.</span></span> <span data-ttu-id="c00a7-517">Per evitare questo problema, assicurarsi che venga chiamato <xref:System.Data.SqlClient.SqlCommand.Cancel%2A> prima di chiudere la lettura o la connessione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-517">To avoid this, make sure that you call <xref:System.Data.SqlClient.SqlCommand.Cancel%2A> before closing the reader or connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-518">Nell'esempio seguente viene illustrato l'uso del metodo <xref:System.Data.SqlClient.SqlCommand.Cancel%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-518">The following example demonstrates the use of the <xref:System.Data.SqlClient.SqlCommand.Cancel%2A> method.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.Cancel#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.Cancel/CS/source.cs#1)]
 [!code-vb[Classic WebData SqlCommand.Cancel#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.Cancel/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Clone">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlCommand Clone ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Data.SqlClient.SqlCommand Clone() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.Clone" />
      <MemberSignature Language="VB.NET" Value="Public Function Clone () As SqlCommand" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Data::SqlClient::SqlCommand ^ Clone();" />
      <MemberSignature Language="F#" Value="member this.Clone : unit -&gt; System.Data.SqlClient.SqlCommand" Usage="sqlCommand.Clone " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlCommand</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-519">Crea un nuovo oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> che è una copia dell'istanza corrente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-519">Creates a new <see cref="T:System.Data.SqlClient.SqlCommand" /> object that is a copy of the current instance.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-520">Nuovo oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> che è una copia dell'istanza corrente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-520">A new <see cref="T:System.Data.SqlClient.SqlCommand" /> object that is a copy of this instance.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="ColumnEncryptionSetting">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlCommandColumnEncryptionSetting ColumnEncryptionSetting { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Data.SqlClient.SqlCommandColumnEncryptionSetting ColumnEncryptionSetting" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.ColumnEncryptionSetting" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ColumnEncryptionSetting As SqlCommandColumnEncryptionSetting" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Data::SqlClient::SqlCommandColumnEncryptionSetting ColumnEncryptionSetting { System::Data::SqlClient::SqlCommandColumnEncryptionSetting get(); };" />
      <MemberSignature Language="F#" Value="member this.ColumnEncryptionSetting : System.Data.SqlClient.SqlCommandColumnEncryptionSetting" Usage="System.Data.SqlClient.SqlCommand.ColumnEncryptionSetting" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlCommandColumnEncryptionSetting</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-521">Ottiene o imposta l'impostazione di crittografia delle colonne per questo comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-521">Gets or sets the column encryption setting for this command.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-522">Impostazione di crittografia delle colonne per questo comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-522">The column encryption setting for this command.</span>
          </span>
        </value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="CommandText">
      <MemberSignature Language="C#" Value="public override string CommandText { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string CommandText" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.CommandText" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property CommandText As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ CommandText { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.CommandText : string with get, set" Usage="System.Data.SqlClient.SqlCommand.CommandText" />
      <MemberType>Property</MemberType>
      <Implements>
        <InterfaceMember>P:System.Data.IDbCommand.CommandText</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("Microsoft.VSDesigner.Data.SQL.Design.SqlCommandTextEditor, Microsoft.VSDesigner, Version=0.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.RefreshProperties</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-523">Ottiene o imposta l'istruzione Transact-SQL, il nome di tabella o la stored procedure da eseguire all'origine dati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-523">Gets or sets the Transact-SQL statement, table name or stored procedure to execute at the data source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-524">Istruzione Transact-SQL o stored procedure da eseguire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-524">The Transact-SQL statement or stored procedure to execute.</span>
          </span>
          <span data-ttu-id="c00a7-525">Il valore predefinito è una stringa vuota.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-525">The default is an empty string.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-526">Quando il <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> è impostata su `StoredProcedure`, il <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> proprietà deve essere impostata sul nome della stored procedure.</span><span class="sxs-lookup"><span data-stu-id="c00a7-526">When the <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> property is set to `StoredProcedure`, the <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> property should be set to the name of the stored procedure.</span></span> <span data-ttu-id="c00a7-527">L'utente potrebbe essere necessario utilizzare la sintassi dei caratteri di escape se il nome della stored procedure contiene caratteri speciali.</span><span class="sxs-lookup"><span data-stu-id="c00a7-527">The user may be required to use escape character syntax if the stored procedure name contains any special characters.</span></span> <span data-ttu-id="c00a7-528">Il comando che esegue questa stored procedure quando si chiama uno del `Execute` metodi.</span><span class="sxs-lookup"><span data-stu-id="c00a7-528">The command executes this stored procedure when you call one of the `Execute` methods.</span></span>  
  
 <span data-ttu-id="c00a7-529">Il Provider di dati Microsoft .NET Framework per SQL Server non supporta il punto interrogativo (?) come segnaposto per passare parametri a un'istruzione Transact-SQL o una stored procedure chiamata da un comando di `CommandType.Text`.</span><span class="sxs-lookup"><span data-stu-id="c00a7-529">The Microsoft .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to a Transact-SQL statement or a stored procedure called by a command of `CommandType.Text`.</span></span> <span data-ttu-id="c00a7-530">In questo caso, è necessario utilizzare parametri denominati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-530">In this case, named parameters must be used.</span></span> <span data-ttu-id="c00a7-531">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="c00a7-531">For example:</span></span>  
  
```  
SELECT * FROM dbo.Customers WHERE CustomerID = @CustomerID  
```  
  
 <span data-ttu-id="c00a7-532">Per altre informazioni, vedere [configurazione dei parametri e tipi di dati di parametro](~/docs/framework/data/adonet/configuring-parameters-and-parameter-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-532">For more information, see [Configuring Parameters and Parameter Data Types](~/docs/framework/data/adonet/configuring-parameters-and-parameter-data-types.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-533">Nell'esempio seguente viene creato un <xref:System.Data.SqlClient.SqlCommand> e vengono impostate alcune delle relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-533">The following example creates a <xref:System.Data.SqlClient.SqlCommand> and sets some of its properties.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.CommandText Example#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.CommandText Example/CS/source.cs#1)]
 [!code-vb[Classic WebData SqlCommand.CommandText Example#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.CommandText Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CommandTimeout">
      <MemberSignature Language="C#" Value="public override int CommandTimeout { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 CommandTimeout" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.CommandTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property CommandTimeout As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int CommandTimeout { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.CommandTimeout : int with get, set" Usage="System.Data.SqlClient.SqlCommand.CommandTimeout" />
      <MemberType>Property</MemberType>
      <Implements>
        <InterfaceMember>P:System.Data.IDbCommand.CommandTimeout</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-534">Ottiene o imposta il tempo di attesa prima di terminare il tentativo di esecuzione di un comando e di generare un errore.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-534">Gets or sets the wait time before terminating the attempt to execute a command and generating an error.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-535">Tempo di attesa in secondi per l'esecuzione del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-535">The time in seconds to wait for the command to execute.</span>
          </span>
          <span data-ttu-id="c00a7-536">Il valore predefinito è 30 secondi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-536">The default is 30 seconds.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-537">Un valore pari a 0 indica nessun limite (un tentativo di eseguire un comando attenderà per un periodo illimitato).</span><span class="sxs-lookup"><span data-stu-id="c00a7-537">A value of 0 indicates no limit (an attempt to execute a command will wait indefinitely).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c00a7-538">Il <xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> proprietà verrà ignorata durante le chiamate al metodo asincrono, ad esempio <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-538">The <xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> property will be ignored during asynchronous method calls such as <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>.</span></span>  
  
 <span data-ttu-id="c00a7-539"><xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> non ha alcun effetto quando il comando viene eseguito su una connessione di contesto (un <xref:System.Data.SqlClient.SqlConnection> aperto con "connessione contesto = true" nella stringa di connessione).</span><span class="sxs-lookup"><span data-stu-id="c00a7-539"><xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> has no effect when the command is executed against a context connection (a <xref:System.Data.SqlClient.SqlConnection> opened with "context connection=true" in the connection string).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c00a7-540">Questa proprietà è il timeout (per tutti i pacchetti di rete che vengono lette durante la chiamata di un metodo di) per tutte le letture di rete durante l'esecuzione del comando o l'elaborazione dei risultati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-540">This property is the cumulative time-out (for all network packets that are read during the invocation of a method) for all network reads during command execution or processing of the results.</span></span> <span data-ttu-id="c00a7-541">Un periodo di timeout può ancora verificarsi dopo la prima riga viene restituita e non include il tempo di elaborazione di utente, solo il tempo di lettura.</span><span class="sxs-lookup"><span data-stu-id="c00a7-541">A time-out can still occur after the first row is returned, and does not include user processing time, only network read time.</span></span>  
>   
>  <span data-ttu-id="c00a7-542">Ad esempio, con un tempo di 30 secondi, out se <xref:System.Data.SqlClient.SqlDataReader.Read%2A> richiede due pacchetti di rete, quindi dispone di 30 secondi per lettura entrambi i pacchetti di rete.</span><span class="sxs-lookup"><span data-stu-id="c00a7-542">For example, with a 30 second time out, if <xref:System.Data.SqlClient.SqlDataReader.Read%2A> requires two network packets, then it has 30 seconds to read both network packets.</span></span> <span data-ttu-id="c00a7-543">Se si chiama <xref:System.Data.SqlClient.SqlDataReader.Read%2A> anche in questo caso avrà un altro 30 secondi per leggere i dati richiesti.</span><span class="sxs-lookup"><span data-stu-id="c00a7-543">If you call <xref:System.Data.SqlClient.SqlDataReader.Read%2A> again, it will have another 30 seconds to read any data that it requires.</span></span>  
  
```  
using System;  
using System.Data.SqlClient;  
///   
public class A {  
   ///   
   public static void Main() {  
      string connectionString = "";  
      // Wait for 5 second delay in the command  
      string queryString = "waitfor delay '00:00:05'";  
      using (SqlConnection connection = new SqlConnection(connectionString)) {  
         connection.Open();  
         SqlCommand command = new SqlCommand(queryString, connection);  
         // Setting command timeout to 1 second  
         command.CommandTimeout = 1;  
         try {  
            command.ExecuteNonQuery();  
         }  
         catch (SqlException e) {  
            Console.WriteLine("Got expected SqlException due to command timeout ");  
            Console.WriteLine(e);  
         }  
      }  
   }  
}  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CommandType">
      <MemberSignature Language="C#" Value="public override System.Data.CommandType CommandType { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Data.CommandType CommandType" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.CommandType" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property CommandType As CommandType" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::Data::CommandType CommandType { System::Data::CommandType get(); void set(System::Data::CommandType value); };" />
      <MemberSignature Language="F#" Value="member this.CommandType : System.Data.CommandType with get, set" Usage="System.Data.SqlClient.SqlCommand.CommandType" />
      <MemberType>Property</MemberType>
      <Implements>
        <InterfaceMember>P:System.Data.IDbCommand.CommandType</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(Mono.Cecil.CustomAttributeArgument)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.RefreshProperties</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Data.CommandType</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-544">Ottiene o imposta un valore che indica come interpretare la proprietà <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-544">Gets or sets a value indicating how the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> property is to be interpreted.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-545">Uno dei valori di <see cref="T:System.Data.CommandType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-545">One of the <see cref="T:System.Data.CommandType" /> values.</span>
          </span>
          <span data-ttu-id="c00a7-546">Il valore predefinito è <see langword="Text" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-546">The default is <see langword="Text" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-547">Quando si imposta la <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> proprietà da `StoredProcedure`, è consigliabile impostare il <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> proprietà sul nome della stored procedure.</span><span class="sxs-lookup"><span data-stu-id="c00a7-547">When you set the <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> property to `StoredProcedure`, you should set the <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> property to the name of the stored procedure.</span></span> <span data-ttu-id="c00a7-548">Il comando esegue questa stored procedure quando si chiama uno dei metodi Execute.</span><span class="sxs-lookup"><span data-stu-id="c00a7-548">The command executes this stored procedure when you call one of the Execute methods.</span></span>  
  
 <span data-ttu-id="c00a7-549">Il Provider di dati Microsoft .NET Framework per SQL Server non supporta il punto interrogativo (?) come segnaposto per passare parametri a un'istruzione SQL o una stored procedure chiamata con un <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> di <xref:System.Data.CommandType.Text>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-549">The Microsoft .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to a SQL Statement or a stored procedure called with a <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> of <xref:System.Data.CommandType.Text>.</span></span> <span data-ttu-id="c00a7-550">In questo caso, è necessario utilizzare parametri denominati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-550">In this case, named parameters must be used.</span></span> <span data-ttu-id="c00a7-551">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="c00a7-551">For example:</span></span>  
  
 <span data-ttu-id="c00a7-552">Selezionare \* da clienti in cui CustomerID = @CustomerID</span><span class="sxs-lookup"><span data-stu-id="c00a7-552">SELECT \* FROM Customers WHERE CustomerID = @CustomerID</span></span>  
  
 <span data-ttu-id="c00a7-553">Per altre informazioni, vedere [configurazione dei parametri e tipi di dati di parametro](~/docs/framework/data/adonet/configuring-parameters-and-parameter-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-553">For more information, see [Configuring Parameters and Parameter Data Types](~/docs/framework/data/adonet/configuring-parameters-and-parameter-data-types.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-554">Nell'esempio seguente viene creato un <xref:System.Data.SqlClient.SqlCommand> e vengono impostate alcune delle relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-554">The following example creates a <xref:System.Data.SqlClient.SqlCommand> and sets some of its properties.</span></span>  
  
 [!code-csharp[Classic WebData IDbCommand.CommandTimeout Example#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData IDbCommand.CommandTimeout Example/CS/source.cs#1)]
 [!code-vb[Classic WebData IDbCommand.CommandTimeout Example#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData IDbCommand.CommandTimeout Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="c00a7-555">Il valore non era un valore <see cref="T:System.Data.CommandType" /> valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-555">The value was not a valid <see cref="T:System.Data.CommandType" />.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="Connection">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlConnection Connection { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.SqlClient.SqlConnection Connection" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.Connection" />
      <MemberSignature Language="VB.NET" Value="Public Property Connection As SqlConnection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Data::SqlClient::SqlConnection ^ Connection { System::Data::SqlClient::SqlConnection ^ get(); void set(System::Data::SqlClient::SqlConnection ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Connection : System.Data.SqlClient.SqlConnection with get, set" Usage="System.Data.SqlClient.SqlCommand.Connection" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("Microsoft.VSDesigner.Data.Design.DbConnectionEditor, Microsoft.VSDesigner, Version=0.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlConnection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-556">Ottiene o imposta l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> usato da questa istanza dell'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-556">Gets or sets the <see cref="T:System.Data.SqlClient.SqlConnection" /> used by this instance of the <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-557">Connessione a un'origine dati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-557">The connection to a data source.</span>
          </span>
          <span data-ttu-id="c00a7-558">Il valore predefinito è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-558">The default value is <see langword="null" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-559">Se il comando viene inserito in una transazione esistente e la connessione viene modificata, il tentativo di eseguire il comando genererà un <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-559">If the command is enlisted in an existing transaction, and the connection is changed, trying to execute the command will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="c00a7-560">Se la proprietà <xref:System.Data.SqlClient.SqlCommand.Transaction%2A> non è Null ed è già stato eseguito il rollback o il commit della transazione, <xref:System.Data.SqlClient.SqlCommand.Transaction%2A> verrà impostato su Null.</span><span class="sxs-lookup"><span data-stu-id="c00a7-560">If the <xref:System.Data.SqlClient.SqlCommand.Transaction%2A> property is not null and the transaction has already been committed or rolled back, <xref:System.Data.SqlClient.SqlCommand.Transaction%2A> is set to null.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-561">Nell'esempio seguente viene creato un <xref:System.Data.SqlClient.SqlCommand> e vengono impostate alcune delle relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="c00a7-561">The following example creates a <xref:System.Data.SqlClient.SqlCommand> and sets some of its properties.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.Connection Example#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.Connection Example/CS/source.cs#1)]
 [!code-vb[Classic WebData SqlCommand.Connection Example#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.Connection Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-562">La proprietà <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> è stata modificata mentre il comando era inserito in una transazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-562">The <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> property was changed while the command was enlisted in a transaction..</span>
          </span>
        </exception>
        <altmember cref="P:System.Data.SqlClient.SqlCommand.CommandText" />
        <altmember cref="P:System.Data.SqlClient.SqlCommand.CommandTimeout" />
        <altmember cref="P:System.Data.SqlClient.SqlCommand.CommandType" />
      </Docs>
    </Member>
    <Member MemberName="CreateDbParameter">
      <MemberSignature Language="C#" Value="protected override System.Data.Common.DbParameter CreateDbParameter ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance class System.Data.Common.DbParameter CreateDbParameter() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.CreateDbParameter" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Function CreateDbParameter () As DbParameter" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override System::Data::Common::DbParameter ^ CreateDbParameter();" />
      <MemberSignature Language="F#" Value="override this.CreateDbParameter : unit -&gt; System.Data.Common.DbParameter" Usage="sqlCommand.CreateDbParameter " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.Common.DbParameter</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>To be added.</summary>
        <returns>To be added.</returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="CreateParameter">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlParameter CreateParameter ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Data.SqlClient.SqlParameter CreateParameter() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.CreateParameter" />
      <MemberSignature Language="VB.NET" Value="Public Function CreateParameter () As SqlParameter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Data::SqlClient::SqlParameter ^ CreateParameter();" />
      <MemberSignature Language="F#" Value="override this.CreateParameter : unit -&gt; System.Data.SqlClient.SqlParameter" Usage="sqlCommand.CreateParameter " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlParameter</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-563">Crea una nuova istanza di un oggetto <see cref="T:System.Data.SqlClient.SqlParameter" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-563">Creates a new instance of a <see cref="T:System.Data.SqlClient.SqlParameter" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-564">Un oggetto <see cref="T:System.Data.SqlClient.SqlParameter" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-564">A <see cref="T:System.Data.SqlClient.SqlParameter" /> object.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-565">Il <xref:System.Data.SqlClient.SqlCommand.CreateParameter%2A> metodo è una versione fortemente tipizzata di <xref:System.Data.IDbCommand.CreateParameter%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-565">The <xref:System.Data.SqlClient.SqlCommand.CreateParameter%2A> method is a strongly-typed version of <xref:System.Data.IDbCommand.CreateParameter%2A>.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="DbConnection">
      <MemberSignature Language="C#" Value="protected override System.Data.Common.DbConnection DbConnection { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.Common.DbConnection DbConnection" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.DbConnection" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Property DbConnection As DbConnection" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; virtual property System::Data::Common::DbConnection ^ DbConnection { System::Data::Common::DbConnection ^ get(); void set(System::Data::Common::DbConnection ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DbConnection : System.Data.Common.DbConnection with get, set" Usage="System.Data.SqlClient.SqlCommand.DbConnection" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.Common.DbConnection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>To be added.</summary>
        <value>To be added.</value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="DbParameterCollection">
      <MemberSignature Language="C#" Value="protected override System.Data.Common.DbParameterCollection DbParameterCollection { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.Common.DbParameterCollection DbParameterCollection" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.DbParameterCollection" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides ReadOnly Property DbParameterCollection As DbParameterCollection" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; virtual property System::Data::Common::DbParameterCollection ^ DbParameterCollection { System::Data::Common::DbParameterCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.DbParameterCollection : System.Data.Common.DbParameterCollection" Usage="System.Data.SqlClient.SqlCommand.DbParameterCollection" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.Common.DbParameterCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>To be added.</summary>
        <value>To be added.</value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="DbTransaction">
      <MemberSignature Language="C#" Value="protected override System.Data.Common.DbTransaction DbTransaction { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.Common.DbTransaction DbTransaction" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.DbTransaction" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Property DbTransaction As DbTransaction" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; virtual property System::Data::Common::DbTransaction ^ DbTransaction { System::Data::Common::DbTransaction ^ get(); void set(System::Data::Common::DbTransaction ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DbTransaction : System.Data.Common.DbTransaction with get, set" Usage="System.Data.SqlClient.SqlCommand.DbTransaction" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.Common.DbTransaction</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>To be added.</summary>
        <value>To be added.</value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="DesignTimeVisible">
      <MemberSignature Language="C#" Value="public override bool DesignTimeVisible { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool DesignTimeVisible" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.DesignTimeVisible" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property DesignTimeVisible As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool DesignTimeVisible { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.DesignTimeVisible : bool with get, set" Usage="System.Data.SqlClient.SqlCommand.DesignTimeVisible" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignOnly(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.EditorBrowsable(System.ComponentModel.EditorBrowsableState.Never)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-566">Ottiene o imposta un valore che indica se l'oggetto comando deve essere visualizzato in un controllo Progettazione Windows Form.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-566">Gets or sets a value indicating whether the command object should be visible in a Windows Form Designer control.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-567">Valore che indica se l'oggetto comando deve essere visibile in un controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-567">A value indicating whether the command object should be visible in a control.</span>
          </span>
          <span data-ttu-id="c00a7-568">Il valore predefinito è * * true * *.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-568">The default is **true**.</span>
          </span>
        </value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="abstract member Dispose : bool -&gt; unit&#xA;override this.Dispose : bool -&gt; unit" Usage="sqlCommand.Dispose disposing" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing">To be added.</param>
        <summary>To be added.</summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="EndExecuteNonQuery">
      <MemberSignature Language="C#" Value="public int EndExecuteNonQuery (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 EndExecuteNonQuery(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndExecuteNonQuery (asyncResult As IAsyncResult) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; int EndExecuteNonQuery(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndExecuteNonQuery : IAsyncResult -&gt; int" Usage="sqlCommand.EndExecuteNonQuery asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult">
          <span data-ttu-id="c00a7-569">Oggetto <see cref="T:System.IAsyncResult" /> restituito dalla chiamata all'oggetto <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-569">The <see cref="T:System.IAsyncResult" /> returned by the call to <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-570">Completa l'esecuzione asincrona di un'istruzione Transact-SQL.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-570">Finishes asynchronous execution of a Transact-SQL statement.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-571">Numero di righe interessate. Il comportamento è identico a quello del metodo <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteNonQuery" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-571">The number of rows affected (the same behavior as <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteNonQuery" />).</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-572">Quando si chiama <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> per eseguire un [!INCLUDE[tsql](~/includes/tsql-md.md)] istruzione, è necessario chiamare <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> per completare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-572">When you call <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> to execute a [!INCLUDE[tsql](~/includes/tsql-md.md)] statement, you must call <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> in order to complete the operation.</span></span> <span data-ttu-id="c00a7-573">Se il processo di esecuzione del comando non ha ancora completato, questo metodo si blocca fino al completamento dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-573">If the process of executing the command has not yet finished, this method blocks until the operation is complete.</span></span> <span data-ttu-id="c00a7-574">Gli utenti possono verificare che il comando è stata completata l'operazione usando il <xref:System.IAsyncResult> istanza restituita dal <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> metodo.</span><span class="sxs-lookup"><span data-stu-id="c00a7-574">Users can verify that the command has completed its operation by using the <xref:System.IAsyncResult> instance returned by the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A> method.</span></span> <span data-ttu-id="c00a7-575">Se una routine di callback è stata specificata nella chiamata a <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A>, questo metodo deve essere chiamato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-575">If a callback procedure was specified in the call to <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A>, this method must be called.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-576">Per esempi che illustrano l'utilizzo del <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> metodo, vedere <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-576">For examples demonstrating the use of the <xref:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery%2A> method, see <xref:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="c00a7-577">Il parametro <paramref name="asyncResult" /> è Null (<see langword="Nothing" /> in Microsoft Visual Basic).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-577">
              <paramref name="asyncResult" /> parameter is null (<see langword="Nothing" /> in Microsoft Visual Basic)</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-578">
            <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" /> è stato chiamato più di una volta per l'esecuzione di un singolo comando oppure il metodo non corrispondeva al relativo metodo di esecuzione (ad esempio, il codice ha chiamato <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" /> per completare l'esecuzione di una chiamata a <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-578">
              <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" /> was called more than once for a single command execution, or the method was mismatched against its execution method (for example, the code called <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" /> to complete execution of a call to <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-579">L'intervallo di tempo specificato in <see cref="P:System.Data.SqlClient.SqlCommand.CommandTimeout" /> è scaduto e l'operazione asincrona specificata con <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery" /> non è stata completata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-579">The amount of time specified in <see cref="P:System.Data.SqlClient.SqlCommand.CommandTimeout" /> elapsed and the asynchronous operation specified with <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery" /> is not complete.</span>
          </span>
          <span data-ttu-id="c00a7-580">In alcune situazioni, <see cref="T:System.IAsyncResult" /> può essere impostato su <see langword="IsCompleted" /> in modo non corretto.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-580">In some situations, <see cref="T:System.IAsyncResult" /> can be set to <see langword="IsCompleted" /> incorrectly.</span>
          </span>
          <span data-ttu-id="c00a7-581">In questo caso, e se viene chiamato <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" />, EndExecuteNonQuery potrebbe generare un errore SqlException se l'intervallo di tempo specificato in <see cref="P:System.Data.SqlClient.SqlCommand.CommandTimeout" /> è scaduto e l'operazione asincrona specificata con <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery" /> non è stata completata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-581">If this occurs and <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(System.IAsyncResult)" /> is called, EndExecuteNonQuery could raise a SqlException error if the amount of time specified in <see cref="P:System.Data.SqlClient.SqlCommand.CommandTimeout" /> elapsed and the asynchronous operation specified with <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery" /> is not complete.</span>
          </span>
          <span data-ttu-id="c00a7-582">Per risolvere questo problema, è necessario aumentare il valore di CommandTimeout o ridurre il lavoro svolto dall'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-582">To correct this situation, you should either increase the value of CommandTimeout or reduce the work being done by the asynchronous operation.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="EndExecuteReader">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlDataReader EndExecuteReader (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Data.SqlClient.SqlDataReader EndExecuteReader(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndExecuteReader (asyncResult As IAsyncResult) As SqlDataReader" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Data::SqlClient::SqlDataReader ^ EndExecuteReader(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndExecuteReader : IAsyncResult -&gt; System.Data.SqlClient.SqlDataReader" Usage="sqlCommand.EndExecuteReader asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlDataReader</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult">
          <span data-ttu-id="c00a7-583">Oggetto <see cref="T:System.IAsyncResult" /> restituito dalla chiamata all'oggetto <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-583">The <see cref="T:System.IAsyncResult" /> returned by the call to <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteReader" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-584">Completa l'esecuzione asincrona di un'istruzione Transact-SQL, restituendo l'oggetto <see cref="T:System.Data.SqlClient.SqlDataReader" /> richiesto.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-584">Finishes asynchronous execution of a Transact-SQL statement, returning the requested <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-585">Oggetto <see cref="T:System.Data.SqlClient.SqlDataReader" /> che può essere usato per recuperare le righe richieste.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-585">A <see cref="T:System.Data.SqlClient.SqlDataReader" /> object that can be used to retrieve the requested rows.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-586">Quando si chiama <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per eseguire un'istruzione Transact-SQL, è necessario chiamare <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> per completare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-586">When you call <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to execute a Transact-SQL statement, you must call <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> in order to complete the operation.</span></span> <span data-ttu-id="c00a7-587">Se il processo di esecuzione del comando non ha ancora completato, questo metodo si blocca fino al completamento dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-587">If the process of executing the command has not yet finished, this method blocks until the operation is complete.</span></span> <span data-ttu-id="c00a7-588">Gli utenti possono verificare che il comando è stata completata l'operazione usando il <xref:System.IAsyncResult> istanza restituita dal <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> metodo.</span><span class="sxs-lookup"><span data-stu-id="c00a7-588">Users can verify that the command has completed its operation by using the <xref:System.IAsyncResult> instance returned by the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> method.</span></span> <span data-ttu-id="c00a7-589">Se una routine di callback è stata specificata nella chiamata a <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>, questo metodo deve essere chiamato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-589">If a callback procedure was specified in the call to <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>, this method must be called.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-590">Per esempi che illustrano l'utilizzo del <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> metodo, vedere <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-590">For examples demonstrating the use of the <xref:System.Data.SqlClient.SqlCommand.EndExecuteReader%2A> method, see <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="c00a7-591">Il parametro <paramref name="asyncResult" /> è Null (<see langword="Nothing" /> in Microsoft Visual Basic).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-591">
              <paramref name="asyncResult" /> parameter is null (<see langword="Nothing" /> in Microsoft Visual Basic)</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-592">
            <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" /> è stato chiamato più di una volta per l'esecuzione di un singolo comando oppure il metodo non corrispondeva al relativo metodo di esecuzione (ad esempio, il codice ha chiamato <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" /> per completare l'esecuzione di una chiamata a <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-592">
              <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" /> was called more than once for a single command execution, or the method was mismatched against its execution method (for example, the code called <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteReader(System.IAsyncResult)" /> to complete execution of a call to <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader" />.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="EndExecuteXmlReader">
      <MemberSignature Language="C#" Value="public System.Xml.XmlReader EndExecuteXmlReader (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Xml.XmlReader EndExecuteXmlReader(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndExecuteXmlReader (asyncResult As IAsyncResult) As XmlReader" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Xml::XmlReader ^ EndExecuteXmlReader(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndExecuteXmlReader : IAsyncResult -&gt; System.Xml.XmlReader" Usage="sqlCommand.EndExecuteXmlReader asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Xml.XmlReader</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult">
          <span data-ttu-id="c00a7-593">Oggetto <see cref="T:System.IAsyncResult" /> restituito dalla chiamata all'oggetto <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-593">The <see cref="T:System.IAsyncResult" /> returned by the call to <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-594">Completa l'esecuzione asincrona di un'istruzione Transact-SQL, restituendo i dati richiesti in formato XML.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-594">Finishes asynchronous execution of a Transact-SQL statement, returning the requested data as XML.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-595">Oggetto <see cref="T:System.Xml.XmlReader" /> che può essere usato per recuperare i dati XML risultanti.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-595">An <see cref="T:System.Xml.XmlReader" /> object that can be used to fetch the resulting XML data.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-596">Quando si chiama <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per eseguire un'istruzione Transact-SQL, è necessario chiamare <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> per completare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-596">When you call <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to execute a Transact-SQL statement, you must call <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> in order to complete the operation.</span></span> <span data-ttu-id="c00a7-597">Se il processo di esecuzione del comando non ha ancora completato, questo metodo si blocca fino al completamento dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-597">If the process of executing the command has not yet finished, this method blocks until the operation is complete.</span></span> <span data-ttu-id="c00a7-598">Gli utenti possono verificare che il comando è stata completata l'operazione usando il <xref:System.IAsyncResult> istanza restituita dal <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> metodo.</span><span class="sxs-lookup"><span data-stu-id="c00a7-598">Users can verify that the command has completed its operation by using the <xref:System.IAsyncResult> instance returned by the <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> method.</span></span> <span data-ttu-id="c00a7-599">Se una routine di callback è stata specificata nella chiamata a <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A>, questo metodo deve essere chiamato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-599">If a callback procedure was specified in the call to <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A>, this method must be called.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-600">Per esempi che illustrano l'utilizzo del <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> metodo, vedere <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-600">For examples demonstrating the use of the <xref:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader%2A> method, see <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="c00a7-601">Il parametro <paramref name="asyncResult" /> è Null (<see langword="Nothing" /> in Microsoft Visual Basic).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-601">
              <paramref name="asyncResult" /> parameter is null (<see langword="Nothing" /> in Microsoft Visual Basic)</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-602">
            <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader(System.IAsyncResult)" /> è stato chiamato più di una volta per l'esecuzione di un singolo comando oppure il metodo non corrispondeva al relativo metodo di esecuzione (ad esempio, il codice ha chiamato <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader(System.IAsyncResult)" /> per completare l'esecuzione di una chiamata a <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-602">
              <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader(System.IAsyncResult)" /> was called more than once for a single command execution, or the method was mismatched against its execution method (for example, the code called <see cref="M:System.Data.SqlClient.SqlCommand.EndExecuteXmlReader(System.IAsyncResult)" /> to complete execution of a call to <see cref="M:System.Data.SqlClient.SqlCommand.BeginExecuteNonQuery" />.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteDbDataReader">
      <MemberSignature Language="C#" Value="protected override System.Data.Common.DbDataReader ExecuteDbDataReader (System.Data.CommandBehavior behavior);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance class System.Data.Common.DbDataReader ExecuteDbDataReader(valuetype System.Data.CommandBehavior behavior) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(System.Data.CommandBehavior)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Function ExecuteDbDataReader (behavior As CommandBehavior) As DbDataReader" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override System::Data::Common::DbDataReader ^ ExecuteDbDataReader(System::Data::CommandBehavior behavior);" />
      <MemberSignature Language="F#" Value="override this.ExecuteDbDataReader : System.Data.CommandBehavior -&gt; System.Data.Common.DbDataReader" Usage="sqlCommand.ExecuteDbDataReader behavior" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.Common.DbDataReader</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="behavior" Type="System.Data.CommandBehavior" />
      </Parameters>
      <Docs>
        <param name="behavior">To be added.</param>
        <summary>To be added.</summary>
        <returns>To be added.</returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="ExecuteDbDataReaderAsync">
      <MemberSignature Language="C#" Value="protected override System.Threading.Tasks.Task&lt;System.Data.Common.DbDataReader&gt; ExecuteDbDataReaderAsync (System.Data.CommandBehavior behavior, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance class System.Threading.Tasks.Task`1&lt;class System.Data.Common.DbDataReader&gt; ExecuteDbDataReaderAsync(valuetype System.Data.CommandBehavior behavior, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteDbDataReaderAsync(System.Data.CommandBehavior,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override System::Threading::Tasks::Task&lt;System::Data::Common::DbDataReader ^&gt; ^ ExecuteDbDataReaderAsync(System::Data::CommandBehavior behavior, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="override this.ExecuteDbDataReaderAsync : System.Data.CommandBehavior * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task&lt;System.Data.Common.DbDataReader&gt;" Usage="sqlCommand.ExecuteDbDataReaderAsync (behavior, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Data.Common.DbDataReader&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="behavior" Type="System.Data.CommandBehavior" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="behavior">To be added.</param>
        <param name="cancellationToken">To be added.</param>
        <summary>To be added.</summary>
        <returns>To be added.</returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="ExecuteNonQuery">
      <MemberSignature Language="C#" Value="public override int ExecuteNonQuery ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 ExecuteNonQuery() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteNonQuery" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ExecuteNonQuery () As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int ExecuteNonQuery();" />
      <MemberSignature Language="F#" Value="override this.ExecuteNonQuery : unit -&gt; int" Usage="sqlCommand.ExecuteNonQuery " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Data.IDbCommand.ExecuteNonQuery</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-603">Permette di eseguire un'istruzione Transact-SQL in base alla connessione e restituisce un numero di righe modificate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-603">Executes a Transact-SQL statement against the connection and returns the number of rows affected.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-604">Numero di righe interessate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-604">The number of rows affected.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-605">È possibile usare il <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> per eseguire operazioni di catalogo (ad esempio, eseguire query sulla struttura di un database o creare oggetti di database quali tabelle) o per modificare i dati in un database senza utilizzare un <xref:System.Data.DataSet> eseguendo UPDATE, INSERT o DELETE istruzioni.</span><span class="sxs-lookup"><span data-stu-id="c00a7-605">You can use the <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> to perform catalog operations (for example, querying the structure of a database or creating database objects such as tables), or to change the data in a database without using a <xref:System.Data.DataSet> by executing UPDATE, INSERT, or DELETE statements.</span></span>  
  
 <span data-ttu-id="c00a7-606">Sebbene il <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> restituisce alcuna riga, gli eventuali parametri di output o restituire valori mappati ai parametri vengono popolati con dati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-606">Although the <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> returns no rows, any output parameters or return values mapped to parameters are populated with data.</span></span>  
  
 <span data-ttu-id="c00a7-607">Nel caso delle istruzioni UPDATE, INSERT e DELETE, il valore restituito è il numero di righe interessate dal comando.</span><span class="sxs-lookup"><span data-stu-id="c00a7-607">For UPDATE, INSERT, and DELETE statements, the return value is the number of rows affected by the command.</span></span> <span data-ttu-id="c00a7-608">In presenza di un trigger in una tabella inserita o aggiornata, il valore restituito include il numero di righe interessate dall'operazione insert o update di e il numero di righe interessate dal trigger o trigger.</span><span class="sxs-lookup"><span data-stu-id="c00a7-608">When a trigger exists on a table being inserted or updated, the return value includes the number of rows affected by both the insert or update operation and the number of rows affected by the trigger or triggers.</span></span> <span data-ttu-id="c00a7-609">Per tutti gli altri tipi di istruzioni, il valore restituito è -1.</span><span class="sxs-lookup"><span data-stu-id="c00a7-609">For all other types of statements, the return value is -1.</span></span> <span data-ttu-id="c00a7-610">Se si verifica un'operazione di rollback, anche il valore restituito è -1.</span><span class="sxs-lookup"><span data-stu-id="c00a7-610">If a rollback occurs, the return value is also -1.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-611">Nell'esempio seguente viene creata una <xref:System.Data.SqlClient.SqlCommand> e viene quindi eseguito mediante <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-611">The following example creates a <xref:System.Data.SqlClient.SqlCommand> and then executes it using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="c00a7-612">Nell'esempio viene passata una stringa che rappresenta un'istruzione Transact-SQL (ad esempio UPDATE, INSERT o DELETE) e una stringa da utilizzare per la connessione all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-612">The example is passed a string that is a Transact-SQL statement (such as UPDATE, INSERT, or DELETE) and a string to use to connect to the data source.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.ExecuteNonQuery Example#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.ExecuteNonQuery Example/CS/source.cs#1)]
 [!code-vb[Classic WebData SqlCommand.ExecuteNonQuery Example#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.ExecuteNonQuery Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-613">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-613">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-614">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-614">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-615">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-615">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-616">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-616">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-617">È stata generata un'eccezione durante l'esecuzione del comando su una riga bloccata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-617">An exception occurred while executing the command against a locked row.</span>
          </span>
          <span data-ttu-id="c00a7-618">Tale eccezione non viene generata quando si usa Microsoft .NET Framework Versione 1.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-618">This exception is not generated when you are using Microsoft .NET Framework version 1.0.</span>
          </span>
          <span data-ttu-id="c00a7-619">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-619">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-620">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-620">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-621">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-621">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-622">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-622">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-623">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-623">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-624">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-624">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-625">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-625">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-626">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-626">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteNonQueryAsync">
      <MemberSignature Language="C#" Value="public override System.Threading.Tasks.Task&lt;int&gt; ExecuteNonQueryAsync (System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Threading.Tasks.Task`1&lt;int32&gt; ExecuteNonQueryAsync(valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteNonQueryAsync(System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Threading::Tasks::Task&lt;int&gt; ^ ExecuteNonQueryAsync(System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="override this.ExecuteNonQueryAsync : System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task&lt;int&gt;" Usage="sqlCommand.ExecuteNonQueryAsync cancellationToken" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Int32&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="cancellationToken">
          <span data-ttu-id="c00a7-627">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-627">The cancellation instruction.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-628">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteNonQuery" />, che esegue un'istruzione [!INCLUDE[tsql](~/includes/tsql-md.md)] a fronte della connessione e restituisce il numero di righe interessate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-628">An asynchronous version of <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteNonQuery" />, which executes a [!INCLUDE[tsql](~/includes/tsql-md.md)] statement against the connection and returns the number of rows affected.</span>
          </span>
          <span data-ttu-id="c00a7-629">Il token di annullamento può essere usato per richiedere che l'operazione venga abbandonata prima del timeout del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-629">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="c00a7-630">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-630">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-631">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-631">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-632">Per ulteriori informazioni sulla programmazione asincrona nel Provider di dati .NET Framework per SQL Server, vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-632">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-633">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-633">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-634">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-634">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-635">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-635">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-636">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-636">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-637">
            <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteNonQueryAsync(System.Threading.CancellationToken)" /> viene chiamato più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-637">Calling <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteNonQueryAsync(System.Threading.CancellationToken)" /> more than once for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="c00a7-638">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-638">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-639">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-639">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-640">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-640">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-641">SQL Server ha restituito un errore durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-641">SQL Server returned an error while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-642">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-642">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-643">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-643">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-644">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-644">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-645">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-645">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-646">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-646">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-647">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-647">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="ExecuteReader">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-648">Invia <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> a <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-648">Sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> and builds a <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ExecuteReader">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlDataReader ExecuteReader ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Data.SqlClient.SqlDataReader ExecuteReader() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteReader" />
      <MemberSignature Language="VB.NET" Value="Public Function ExecuteReader () As SqlDataReader" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Data::SqlClient::SqlDataReader ^ ExecuteReader();" />
      <MemberSignature Language="F#" Value="override this.ExecuteReader : unit -&gt; System.Data.SqlClient.SqlDataReader" Usage="sqlCommand.ExecuteReader " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlDataReader</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-649">Invia <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> a <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-649">Sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> and builds a <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-650">Un oggetto <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-650">A <see cref="T:System.Data.SqlClient.SqlDataReader" /> object.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-651">Quando il <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> è impostata su `StoredProcedure`, il <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> proprietà deve essere impostata sul nome della stored procedure.</span><span class="sxs-lookup"><span data-stu-id="c00a7-651">When the <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> property is set to `StoredProcedure`, the <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> property should be set to the name of the stored procedure.</span></span> <span data-ttu-id="c00a7-652">Il comando che esegue questa stored procedure quando si chiama <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-652">The command executes this stored procedure when you call <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c00a7-653">Se una transazione è una condizione di deadlock, finché non può essere generata un'eccezione <xref:System.Data.SqlClient.SqlDataReader.Read%2A> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="c00a7-653">If a transaction is deadlocked, an exception may not be thrown until <xref:System.Data.SqlClient.SqlDataReader.Read%2A> is called.</span></span>  
  
 <span data-ttu-id="c00a7-654">La funzionalità di multiple active result set (MARS) consente a più azioni utilizzando la stessa connessione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-654">The multiple active result set (MARS) feature allows for multiple actions using the same connection.</span></span>  
  
 <span data-ttu-id="c00a7-655">Se si utilizza <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per accedere ai dati XML, SQL Server restituirà i risultati XML maggiore 2033 caratteri di lunghezza in più righe di 2033 caratteri.</span><span class="sxs-lookup"><span data-stu-id="c00a7-655">If you use <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each.</span></span> <span data-ttu-id="c00a7-656">Per evitare questo comportamento, utilizzare <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per leggere le query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-656">To avoid this behavior, use <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to read FOR XML queries.</span></span> <span data-ttu-id="c00a7-657">Per altre informazioni, vedere l'articolo Q310378, "PRB: XML dati viene troncato quando si usa SqlDataReader," nella Microsoft Knowledge Base al http://support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="c00a7-657">For more information, see article Q310378, "PRB: XML Data Is Truncated When You Use SqlDataReader," in the Microsoft Knowledge Base at http://support.microsoft.com.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-658">Nell'esempio seguente viene creato un <xref:System.Data.SqlClient.SqlCommand>che viene quindi eseguito passando una stringa che rappresenta un'istruzione Transact-SQL SELECT e una stringa da utilizzare per la connessione all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-658">The following example creates a <xref:System.Data.SqlClient.SqlCommand>, and then executes it by passing a string that is a Transact-SQL SELECT statement, and a string to use to connect to the data source.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.ExecuteReader Example#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.ExecuteReader Example/CS/source.cs#1)]
 [!code-vb[Classic WebData SqlCommand.ExecuteReader Example#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.ExecuteReader Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-659">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-659">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-660">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-660">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-661">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-661">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-662">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-662">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-663">È stata generata un'eccezione durante l'esecuzione del comando su una riga bloccata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-663">An exception occurred while executing the command against a locked row.</span>
          </span>
          <span data-ttu-id="c00a7-664">Tale eccezione non viene generata quando si usa Microsoft .NET Framework Versione 1.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-664">This exception is not generated when you are using Microsoft .NET Framework version 1.0.</span>
          </span>
          <span data-ttu-id="c00a7-665">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-665">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-666">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-666">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-667">Lo stato corrente della connessione è chiuso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-667">The current state of the connection is closed.</span>
          </span>
          <span data-ttu-id="c00a7-668">Con <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader" /> è richiesto un oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> aperto.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-668">
              <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader" /> requires an open <see cref="T:System.Data.SqlClient.SqlConnection" />.</span>
          </span>
          <span data-ttu-id="c00a7-669">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-669">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-670">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-670">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-671">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-671">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-672">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-672">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-673">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-673">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-674">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-674">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteReader">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlDataReader ExecuteReader (System.Data.CommandBehavior behavior);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Data.SqlClient.SqlDataReader ExecuteReader(valuetype System.Data.CommandBehavior behavior) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteReader(System.Data.CommandBehavior)" />
      <MemberSignature Language="VB.NET" Value="Public Function ExecuteReader (behavior As CommandBehavior) As SqlDataReader" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Data::SqlClient::SqlDataReader ^ ExecuteReader(System::Data::CommandBehavior behavior);" />
      <MemberSignature Language="F#" Value="override this.ExecuteReader : System.Data.CommandBehavior -&gt; System.Data.SqlClient.SqlDataReader" Usage="sqlCommand.ExecuteReader behavior" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlDataReader</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="behavior" Type="System.Data.CommandBehavior" />
      </Parameters>
      <Docs>
        <param name="behavior">
          <span data-ttu-id="c00a7-675">Uno dei valori di <see cref="T:System.Data.CommandBehavior" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-675">One of the <see cref="T:System.Data.CommandBehavior" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-676">Invia <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> a <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila <see cref="T:System.Data.SqlClient.SqlDataReader" /> mediante uno dei valori di <see cref="T:System.Data.CommandBehavior" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-676">Sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" />, and builds a <see cref="T:System.Data.SqlClient.SqlDataReader" /> using one of the <see cref="T:System.Data.CommandBehavior" /> values.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-677">Un oggetto <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-677">A <see cref="T:System.Data.SqlClient.SqlDataReader" /> object.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-678">Quando il <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> è impostata su `StoredProcedure`, il <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> proprietà deve essere impostata sul nome della stored procedure.</span><span class="sxs-lookup"><span data-stu-id="c00a7-678">When the <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> property is set to `StoredProcedure`, the <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> property should be set to the name of the stored procedure.</span></span> <span data-ttu-id="c00a7-679">Il comando che esegue questa stored procedure quando si chiama <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-679">The command executes this stored procedure when you call <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c00a7-680">Utilizzare <xref:System.Data.CommandBehavior.SequentialAccess> per recuperare valori di grandi dimensioni e i dati binari.</span><span class="sxs-lookup"><span data-stu-id="c00a7-680">Use <xref:System.Data.CommandBehavior.SequentialAccess> to retrieve large values and binary data.</span></span> <span data-ttu-id="c00a7-681">In caso contrario, un <xref:System.OutOfMemoryException> potrebbero verificarsi e la connessione verrà chiusa.</span><span class="sxs-lookup"><span data-stu-id="c00a7-681">Otherwise, an <xref:System.OutOfMemoryException> might occur and the connection will be closed.</span></span>  
  
 <span data-ttu-id="c00a7-682">La funzionalità di multiple active result set (MARS) consente a più azioni utilizzando la stessa connessione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-682">The multiple active result set (MARS) feature allows for multiple actions using the same connection.</span></span>  
  
 <span data-ttu-id="c00a7-683">Se si utilizza <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per accedere ai dati XML, SQL Server restituirà i risultati XML maggiore 2033 caratteri di lunghezza in più righe di 2033 caratteri.</span><span class="sxs-lookup"><span data-stu-id="c00a7-683">If you use <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each.</span></span> <span data-ttu-id="c00a7-684">Per evitare questo comportamento, utilizzare <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per leggere le query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-684">To avoid this behavior, use <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to read FOR XML queries.</span></span> <span data-ttu-id="c00a7-685">Per altre informazioni, vedere l'articolo Q310378, "PRB: XML dati viene troncato quando si usa SqlDataReader," nella Microsoft Knowledge Base al http://support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="c00a7-685">For more information, see article Q310378, "PRB: XML Data Is Truncated When You Use SqlDataReader," in the Microsoft Knowledge Base at http://support.microsoft.com.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-686">Nell'esempio seguente viene creato un <xref:System.Data.SqlClient.SqlCommand>che viene quindi eseguito passando una stringa che rappresenta un'istruzione Transact-SQL SELECT e una stringa da utilizzare per la connessione all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-686">The following example creates a <xref:System.Data.SqlClient.SqlCommand>, and then executes it by passing a string that is a Transact-SQL SELECT statement, and a string to use to connect to the data source.</span></span> <span data-ttu-id="c00a7-687"><xref:System.Data.CommandBehavior> è impostato su <xref:System.Data.CommandBehavior.CloseConnection>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-687"><xref:System.Data.CommandBehavior> is set to <xref:System.Data.CommandBehavior.CloseConnection>.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.ExecuteReader2#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.ExecuteReader2/CS/mysample.cs#1)]
 [!code-vb[Classic WebData SqlCommand.ExecuteReader2#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.ExecuteReader2/VB/mysample.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-688">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-688">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-689">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-689">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-690">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-690">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-691">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-691">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-692">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-692">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-693">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-693">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-694">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-694">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-695">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-695">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-696">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-696">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-697">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-697">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-698">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-698">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-699">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-699">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="ExecuteReaderAsync">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-700">Avvia l'esecuzione asincrona dell'istruzione [!INCLUDE[tsql](~/includes/tsql-md.md)] o della stored procedure descritta da <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-700">Initiates the asynchronous execution of the [!INCLUDE[tsql](~/includes/tsql-md.md)] statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-701">Per ulteriori informazioni sulla programmazione asincrona nel Provider di dati .NET Framework per SQL Server, vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-701">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName="ExecuteReaderAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt; ExecuteReaderAsync ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task`1&lt;class System.Data.SqlClient.SqlDataReader&gt; ExecuteReaderAsync() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync" />
      <MemberSignature Language="VB.NET" Value="Public Function ExecuteReaderAsync () As Task(Of SqlDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task&lt;System::Data::SqlClient::SqlDataReader ^&gt; ^ ExecuteReaderAsync();" />
      <MemberSignature Language="F#" Value="override this.ExecuteReaderAsync : unit -&gt; System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt;" Usage="sqlCommand.ExecuteReaderAsync " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt;</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-702">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader" />, che invia <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> a <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila un oggetto <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-702">An asynchronous version of <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader" />, which sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> and builds a <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-703">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-703">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-704">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-704">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-705">Per ulteriori informazioni sulla programmazione asincrona nel Provider di dati .NET Framework per SQL Server, vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-705">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-706">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-706">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-707">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-707">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-708">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-708">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-709">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-709">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="c00a7-710">Valore di <see cref="T:System.Data.CommandBehavior" /> non valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-710">An invalid <see cref="T:System.Data.CommandBehavior" /> value.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-711">
            <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync" /> viene chiamato più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-711">Calling <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync" /> more than once for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="c00a7-712">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-712">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-713">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-713">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-714">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-714">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-715">SQL Server ha restituito un errore durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-715">SQL Server returned an error while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-716">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-716">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-717">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-717">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-718">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-718">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-719">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-719">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-720">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-720">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-721">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-721">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteReaderAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt; ExecuteReaderAsync (System.Data.CommandBehavior behavior);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task`1&lt;class System.Data.SqlClient.SqlDataReader&gt; ExecuteReaderAsync(valuetype System.Data.CommandBehavior behavior) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior)" />
      <MemberSignature Language="VB.NET" Value="Public Function ExecuteReaderAsync (behavior As CommandBehavior) As Task(Of SqlDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task&lt;System::Data::SqlClient::SqlDataReader ^&gt; ^ ExecuteReaderAsync(System::Data::CommandBehavior behavior);" />
      <MemberSignature Language="F#" Value="override this.ExecuteReaderAsync : System.Data.CommandBehavior -&gt; System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt;" Usage="sqlCommand.ExecuteReaderAsync behavior" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="behavior" Type="System.Data.CommandBehavior" />
      </Parameters>
      <Docs>
        <param name="behavior">
          <span data-ttu-id="c00a7-722">Opzioni per l'esecuzione di istruzioni e il recupero dei dati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-722">Options for statement execution and data retrieval.</span>
          </span>
          <span data-ttu-id="c00a7-723">Se impostato su <see langword="Default" />, <see cref="M:System.Data.SqlClient.SqlDataReader.ReadAsync(System.Threading.CancellationToken)" /> legge l'intera riga prima di restituire un'attività completa.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-723">When is set to <see langword="Default" />, <see cref="M:System.Data.SqlClient.SqlDataReader.ReadAsync(System.Threading.CancellationToken)" /> reads the entire row before returning a complete Task.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-724">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader(System.Data.CommandBehavior)" />, che invia <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> a <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila un oggetto <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-724">An asynchronous version of <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader(System.Data.CommandBehavior)" />, which sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" />, and builds a <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-725">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-725">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-726">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-726">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-727">Per ulteriori informazioni sulla programmazione asincrona nel Provider di dati .NET Framework per SQL Server, vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-727">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-728">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-728">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-729">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-729">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-730">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-730">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-731">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-731">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="c00a7-732">Valore di <see cref="T:System.Data.CommandBehavior" /> non valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-732">An invalid <see cref="T:System.Data.CommandBehavior" /> value.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-733">
            <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior)" /> viene chiamato più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-733">Calling <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior)" /> more than once for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="c00a7-734">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-734">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-735">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-735">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-736">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-736">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-737">SQL Server ha restituito un errore durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-737">SQL Server returned an error while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-738">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-738">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-739">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-739">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-740">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-740">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-741">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-741">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-742">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-742">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-743">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-743">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteReaderAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt; ExecuteReaderAsync (System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task`1&lt;class System.Data.SqlClient.SqlDataReader&gt; ExecuteReaderAsync(valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task&lt;System::Data::SqlClient::SqlDataReader ^&gt; ^ ExecuteReaderAsync(System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="override this.ExecuteReaderAsync : System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt;" Usage="sqlCommand.ExecuteReaderAsync cancellationToken" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="cancellationToken">
          <span data-ttu-id="c00a7-744">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-744">The cancellation instruction.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-745">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader" />, che invia <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> a <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila un oggetto <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-745">An asynchronous version of <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader" />, which sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> and builds a <see cref="T:System.Data.SqlClient.SqlDataReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-746">Il token di annullamento può essere usato per richiedere che l'operazione venga abbandonata prima del timeout del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-746">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="c00a7-747">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-747">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-748">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-748">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-749">Per ulteriori informazioni sulla programmazione asincrona nel Provider di dati .NET Framework per SQL Server, vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-749">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-750">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-750">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-751">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-751">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-752">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-752">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-753">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-753">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="c00a7-754">Valore di <see cref="T:System.Data.CommandBehavior" /> non valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-754">An invalid <see cref="T:System.Data.CommandBehavior" /> value.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-755">
            <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior,System.Threading.CancellationToken)" /> viene chiamato più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-755">Calling <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior,System.Threading.CancellationToken)" /> more than once for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="c00a7-756">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-756">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-757">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-757">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-758">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-758">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-759">SQL Server ha restituito un errore durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-759">SQL Server returned an error while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-760">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-760">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-761">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-761">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-762">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-762">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-763">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-763">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-764">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-764">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-765">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-765">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteReaderAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt; ExecuteReaderAsync (System.Data.CommandBehavior behavior, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task`1&lt;class System.Data.SqlClient.SqlDataReader&gt; ExecuteReaderAsync(valuetype System.Data.CommandBehavior behavior, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task&lt;System::Data::SqlClient::SqlDataReader ^&gt; ^ ExecuteReaderAsync(System::Data::CommandBehavior behavior, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="override this.ExecuteReaderAsync : System.Data.CommandBehavior * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt;" Usage="sqlCommand.ExecuteReaderAsync (behavior, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Data.SqlClient.SqlDataReader&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="behavior" Type="System.Data.CommandBehavior" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="behavior">
          <span data-ttu-id="c00a7-766">Opzioni per l'esecuzione di istruzioni e il recupero dei dati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-766">Options for statement execution and data retrieval.</span>
          </span>
          <span data-ttu-id="c00a7-767">Se impostato su <see langword="Default" />, <see cref="M:System.Data.SqlClient.SqlDataReader.ReadAsync(System.Threading.CancellationToken)" /> legge l'intera riga prima di restituire un'attività completa.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-767">When is set to <see langword="Default" />, <see cref="M:System.Data.SqlClient.SqlDataReader.ReadAsync(System.Threading.CancellationToken)" /> reads the entire row before returning a complete Task.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="c00a7-768">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-768">The cancellation instruction.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-769">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader(System.Data.CommandBehavior)" />, che invia <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> a <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila un <see cref="T:System.Data.SqlClient.SqlDataReader" />. Il token di annullamento può essere usato per richiedere che l'operazione venga abbandonata prima del timeout del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-769">An asynchronous version of <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReader(System.Data.CommandBehavior)" />, which sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" />, and builds a <see cref="T:System.Data.SqlClient.SqlDataReader" />  The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="c00a7-770">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-770">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-771">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-771">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-772">Per ulteriori informazioni sulla programmazione asincrona nel Provider di dati .NET Framework per SQL Server, vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-772">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-773">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-773">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-774">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-774">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-775">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-775">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-776">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-776">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="c00a7-777">Valore di <see cref="T:System.Data.CommandBehavior" /> non valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-777">An invalid <see cref="T:System.Data.CommandBehavior" /> value.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-778">
            <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior,System.Threading.CancellationToken)" /> viene chiamato più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-778">Calling <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior,System.Threading.CancellationToken)" /> more than once for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="c00a7-779">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-779">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-780">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-780">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-781">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-781">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-782">SQL Server ha restituito un errore durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-782">SQL Server returned an error while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-783">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-783">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-784">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-784">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-785">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-785">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-786">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-786">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-787">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-787">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-788">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-788">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteScalar">
      <MemberSignature Language="C#" Value="public override object ExecuteScalar ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance object ExecuteScalar() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteScalar" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ExecuteScalar () As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Object ^ ExecuteScalar();" />
      <MemberSignature Language="F#" Value="override this.ExecuteScalar : unit -&gt; obj" Usage="sqlCommand.ExecuteScalar " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Data.IDbCommand.ExecuteScalar</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-789">Esegue la query e restituisce la prima colonna della prima riga nel set di risultati restituito dalla query.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-789">Executes the query, and returns the first column of the first row in the result set returned by the query.</span>
          </span>
          <span data-ttu-id="c00a7-790">Le colonne o le righe aggiuntive vengono ignorate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-790">Additional columns or rows are ignored.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-791">Prima colonna della prima riga del set di risultati o un riferimento null (<see langword="Nothing" /> in Visual Basic) se il set di risultati è vuoto.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-791">The first column of the first row in the result set, or a null reference (<see langword="Nothing" /> in Visual Basic) if the result set is empty.</span>
          </span>
          <span data-ttu-id="c00a7-792">Restituisce al massimo 2033 caratteri.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-792">Returns a maximum of 2033 characters.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-793">Utilizzare il <xref:System.Data.SqlClient.SqlCommand.ExecuteScalar%2A> metodo per recuperare un singolo valore (ad esempio, un valore aggregato) da un database.</span><span class="sxs-lookup"><span data-stu-id="c00a7-793">Use the <xref:System.Data.SqlClient.SqlCommand.ExecuteScalar%2A> method to retrieve a single value (for example, an aggregate value) from a database.</span></span> <span data-ttu-id="c00a7-794">Ciò richiede meno codice rispetto all'utilizzo di <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> metodo e l'esecuzione delle operazioni che è necessario generare il valore singolo utilizzando i dati restituiti da una <xref:System.Data.SqlClient.SqlDataReader>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-794">This requires less code than using the <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> method, and then performing the operations that you need to generate the single value using the data returned by a <xref:System.Data.SqlClient.SqlDataReader>.</span></span>  
  
 <span data-ttu-id="c00a7-795">Una tipica <xref:System.Data.SqlClient.SqlCommand.ExecuteScalar%2A> query possono essere formattati come nell'esempio c# seguente:</span><span class="sxs-lookup"><span data-stu-id="c00a7-795">A typical <xref:System.Data.SqlClient.SqlCommand.ExecuteScalar%2A> query can be formatted as in the following C# example:</span></span>  
  
```  
cmd.CommandText = "SELECT COUNT(*) FROM dbo.region";  
Int32 count = (Int32) cmd.ExecuteScalar();  
```  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-796">Nell'esempio seguente viene creata una <xref:System.Data.SqlClient.SqlCommand> e viene quindi eseguito mediante <xref:System.Data.SqlClient.SqlCommand.ExecuteScalar%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-796">The following example creates a <xref:System.Data.SqlClient.SqlCommand> and then executes it using <xref:System.Data.SqlClient.SqlCommand.ExecuteScalar%2A>.</span></span> <span data-ttu-id="c00a7-797">Nell'esempio viene passata una stringa che rappresenta un nuovo valore da inserire in una tabella e una stringa da utilizzare per la connessione all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-797">The example is passed a string representing a new value to be inserted into a table, and a string to use to connect to the data source.</span></span> <span data-ttu-id="c00a7-798">La funzione restituisce il nuovo **identità** 0 su errore, valore della colonna se è stata inserita una nuova riga.</span><span class="sxs-lookup"><span data-stu-id="c00a7-798">The function returns the new **Identity** column value if a new row was inserted, 0 on failure.</span></span>  
  
 [!code-csharp[DataWorks SqlCommand.ExecuteScalar#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlCommand.ExecuteScalar/CS/source.cs#1)]
 [!code-vb[DataWorks SqlCommand.ExecuteScalar#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlCommand.ExecuteScalar/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-799">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-799">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-800">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-800">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-801">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-801">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-802">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-802">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-803">È stata generata un'eccezione durante l'esecuzione del comando su una riga bloccata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-803">An exception occurred while executing the command against a locked row.</span>
          </span>
          <span data-ttu-id="c00a7-804">Tale eccezione non viene generata quando si usa Microsoft .NET Framework Versione 1.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-804">This exception is not generated when you are using Microsoft .NET Framework version 1.0.</span>
          </span>
          <span data-ttu-id="c00a7-805">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-805">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-806">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-806">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-807">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-807">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-808">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-808">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-809">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-809">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-810">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-810">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-811">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-811">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-812">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-812">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteScalarAsync">
      <MemberSignature Language="C#" Value="public override System.Threading.Tasks.Task&lt;object&gt; ExecuteScalarAsync (System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Threading.Tasks.Task`1&lt;object&gt; ExecuteScalarAsync(valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteScalarAsync(System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Threading::Tasks::Task&lt;System::Object ^&gt; ^ ExecuteScalarAsync(System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="override this.ExecuteScalarAsync : System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task&lt;obj&gt;" Usage="sqlCommand.ExecuteScalarAsync cancellationToken" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Object&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="cancellationToken">
          <span data-ttu-id="c00a7-813">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-813">The cancellation instruction.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-814">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteScalar" />, che esegue la query in modo asincrono e restituisce la prima colonna della prima riga nel set di risultati restituito dalla query.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-814">An asynchronous version of <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteScalar" />, which executes the query asynchronously and returns the first column of the first row in the result set returned by the query.</span>
          </span>
          <span data-ttu-id="c00a7-815">Le colonne o le righe aggiuntive vengono ignorate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-815">Additional columns or rows are ignored.</span>
          </span>
          <span data-ttu-id="c00a7-816">Il token di annullamento può essere usato per richiedere che l'operazione venga abbandonata prima del timeout del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-816">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="c00a7-817">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-817">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-818">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-818">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-819">Per ulteriori informazioni sulla programmazione asincrona nel Provider di dati .NET Framework per SQL Server, vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-819">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-820">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-820">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-821">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-821">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-822">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-822">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-823">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-823">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-824">
            <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteScalarAsync(System.Threading.CancellationToken)" /> viene chiamato più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-824">Calling <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteScalarAsync(System.Threading.CancellationToken)" /> more than once for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="c00a7-825">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-825">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-826">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-826">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-827">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-827">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-828">SQL Server ha restituito un errore durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-828">SQL Server returned an error while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-829">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-829">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-830">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-830">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-831">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-831">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-832">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-832">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-833">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-833">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-834">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-834">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteXmlReader">
      <MemberSignature Language="C#" Value="public System.Xml.XmlReader ExecuteXmlReader ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Xml.XmlReader ExecuteXmlReader() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteXmlReader" />
      <MemberSignature Language="VB.NET" Value="Public Function ExecuteXmlReader () As XmlReader" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Xml::XmlReader ^ ExecuteXmlReader();" />
      <MemberSignature Language="F#" Value="member this.ExecuteXmlReader : unit -&gt; System.Xml.XmlReader" Usage="sqlCommand.ExecuteXmlReader " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Xml.XmlReader</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-835">Invia la proprietà <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> alla proprietà <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila un oggetto <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-835">Sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> and builds an <see cref="T:System.Xml.XmlReader" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-836">Oggetto <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-836">An <see cref="T:System.Xml.XmlReader" /> object.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-837">Il **XmlReader** restituito da questo metodo non supporta le operazioni asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-837">The **XmlReader** returned by this method does not support asynchronous operations.</span></span>

 <span data-ttu-id="c00a7-838">Il <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> proprietà specifica, in genere un [!INCLUDE[tsql](~/includes/tsql-md.md)] istruzione con una clausola FOR XML valida.</span><span class="sxs-lookup"><span data-stu-id="c00a7-838">The <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> property ordinarily specifies a [!INCLUDE[tsql](~/includes/tsql-md.md)] statement with a valid FOR XML clause.</span></span> <span data-ttu-id="c00a7-839">Tuttavia, <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> inoltre possibile specificare un'istruzione che restituisce `ntext` oppure `nvarchar` contenenti dati XML validi, o il contenuto di una colonna definita con il `xml` tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-839">However, <xref:System.Data.SqlClient.SqlCommand.CommandText%2A> can also specify a statement that returns `ntext` or `nvarchar` data that contains valid XML, or the contents of a column defined with the `xml` data type.</span></span>  
  
 <span data-ttu-id="c00a7-840">Una tipica <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> query possono essere formattati come nell'esempio seguente di Microsoft Visual c#:</span><span class="sxs-lookup"><span data-stu-id="c00a7-840">A typical <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> query can be formatted as in the following Microsoft Visual C# example:</span></span>  
  
```  
SqlCommand command = new SqlCommand("SELECT * FROM dbo.Customers FOR XML AUTO, XMLDATA", SqlConn);  
```  
  
 <span data-ttu-id="c00a7-841">Questo metodo può essere utilizzato anche per recuperare un set di risultati a riga e una sola colonna che contiene dati XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-841">This method can also be used to retrieve a single-row, single-column result set that contains XML data.</span></span> <span data-ttu-id="c00a7-842">In questo caso, se più di una riga viene restituita, il <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> metodo associa la <xref:System.Xml.XmlReader> al valore della prima riga e viene eliminato il resto del risultato del gruppo.</span><span class="sxs-lookup"><span data-stu-id="c00a7-842">In this case, if more than one row is returned, the <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> method attaches the <xref:System.Xml.XmlReader> to the value on the first row, and discards the rest of the result set.</span></span>  
  
 <span data-ttu-id="c00a7-843">La funzionalità di multiple active result set (MARS) consente a più azioni utilizzando la stessa connessione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-843">The multiple active result set (MARS) feature allows for multiple actions using the same connection.</span></span>  
  
 <span data-ttu-id="c00a7-844">Se si utilizza <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> per accedere ai dati XML, SQL Server restituirà i risultati XML maggiore 2033 caratteri di lunghezza in più righe di 2033 caratteri.</span><span class="sxs-lookup"><span data-stu-id="c00a7-844">If you use <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteReader%2A> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each.</span></span> <span data-ttu-id="c00a7-845">Per evitare questo comportamento, utilizzare <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> o <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> per leggere le query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="c00a7-845">To avoid this behavior, use <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A> or <xref:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader%2A> to read FOR XML queries.</span></span> <span data-ttu-id="c00a7-846">Per altre informazioni, vedere l'articolo Q310378, "PRB: XML dati viene troncato quando si usa SqlDataReader," nella Microsoft Knowledge Base al http://support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="c00a7-846">For more information, see article Q310378, "PRB: XML Data Is Truncated When You Use SqlDataReader," in the Microsoft Knowledge Base at http://support.microsoft.com.</span></span>  


## Examples  
 <span data-ttu-id="c00a7-847">Nell'esempio seguente viene creata una <xref:System.Data.SqlClient.SqlCommand> e viene quindi eseguito mediante <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-847">The following example creates a <xref:System.Data.SqlClient.SqlCommand> and then executes it using <xref:System.Data.SqlClient.SqlCommand.ExecuteXmlReader%2A>.</span></span> <span data-ttu-id="c00a7-848">Nell'esempio viene passata una stringa che rappresenta un'istruzione Transact-SQL per selezionare XML e una stringa da utilizzare per la connessione all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-848">The example is passed a string that is a Transact-SQL FOR XML SELECT statement, and a string to use to connect to the data source.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.ExecuteXmlReader#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.ExecuteXmlReader/CS/mysample.cs#1)]
 [!code-vb[Classic WebData SqlCommand.ExecuteXmlReader#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.ExecuteXmlReader/VB/mysample.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-849">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-849">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-850">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-850">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-851">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-851">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-852">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-852">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-853">È stata generata un'eccezione durante l'esecuzione del comando su una riga bloccata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-853">An exception occurred while executing the command against a locked row.</span>
          </span>
          <span data-ttu-id="c00a7-854">Tale eccezione non viene generata quando si usa Microsoft .NET Framework Versione 1.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-854">This exception is not generated when you are using Microsoft .NET Framework version 1.0.</span>
          </span>
          <span data-ttu-id="c00a7-855">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-855">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-856">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-856">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-857">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-857">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-858">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-858">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-859">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-859">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-860">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-860">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-861">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-861">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-862">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-862">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="ExecuteXmlReaderAsync">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-863">Avvia l'esecuzione asincrona dell'istruzione Transact-SQL o della stored procedure descritta dall'oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> e restituisce i risultati come oggetto <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-863">Initiates the asynchronous execution of the Transact-SQL statement or stored procedure that is described by this <see cref="T:System.Data.SqlClient.SqlCommand" /> and returns results as an <see cref="T:System.Xml.XmlReader" /> object.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ExecuteXmlReaderAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task&lt;System.Xml.XmlReader&gt; ExecuteXmlReaderAsync ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task`1&lt;class System.Xml.XmlReader&gt; ExecuteXmlReaderAsync() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteXmlReaderAsync" />
      <MemberSignature Language="VB.NET" Value="Public Function ExecuteXmlReaderAsync () As Task(Of XmlReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task&lt;System::Xml::XmlReader ^&gt; ^ ExecuteXmlReaderAsync();" />
      <MemberSignature Language="F#" Value="member this.ExecuteXmlReaderAsync : unit -&gt; System.Threading.Tasks.Task&lt;System.Xml.XmlReader&gt;" Usage="sqlCommand.ExecuteXmlReaderAsync " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Xml.XmlReader&gt;</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-864">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteXmlReader" />, che invia <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> a <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila un oggetto <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-864">An asynchronous version of <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteXmlReader" />, which sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> and builds an <see cref="T:System.Xml.XmlReader" /> object.</span>
          </span>
          <span data-ttu-id="c00a7-865">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-865">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-866">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-866">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  

<span data-ttu-id="c00a7-867">Il **XmlReader** restituito da questo metodo non supporta le operazioni asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-867">The **XmlReader** returned by this method does not support asynchronous operations.</span></span>

<span data-ttu-id="c00a7-868">Per ulteriori informazioni sulla programmazione asincrona nel Provider di dati .NET Framework per SQL Server, vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-868">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-869">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-869">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-870">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-870">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-871">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-871">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-872">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-872">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-873">
            <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteScalarAsync(System.Threading.CancellationToken)" /> viene chiamato più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-873">Calling <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteScalarAsync(System.Threading.CancellationToken)" /> more than once for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="c00a7-874">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-874">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-875">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-875">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-876">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-876">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-877">SQL Server ha restituito un errore durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-877">SQL Server returned an error while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-878">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-878">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-879">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-879">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-880">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-880">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-881">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-881">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-882">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-882">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-883">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-883">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExecuteXmlReaderAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task&lt;System.Xml.XmlReader&gt; ExecuteXmlReaderAsync (System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task`1&lt;class System.Xml.XmlReader&gt; ExecuteXmlReaderAsync(valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ExecuteXmlReaderAsync(System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task&lt;System::Xml::XmlReader ^&gt; ^ ExecuteXmlReaderAsync(System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.ExecuteXmlReaderAsync : System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task&lt;System.Xml.XmlReader&gt;" Usage="sqlCommand.ExecuteXmlReaderAsync cancellationToken" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Xml.XmlReader&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="cancellationToken">
          <span data-ttu-id="c00a7-884">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-884">The cancellation instruction.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c00a7-885">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteXmlReader" />, che invia <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> a <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> e compila un oggetto <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-885">An asynchronous version of <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteXmlReader" />, which sends the <see cref="P:System.Data.SqlClient.SqlCommand.CommandText" /> to the <see cref="P:System.Data.SqlClient.SqlCommand.Connection" /> and builds an <see cref="T:System.Xml.XmlReader" /> object.</span>
          </span>
          <span data-ttu-id="c00a7-886">Il token di annullamento può essere usato per richiedere che l'operazione venga abbandonata prima del timeout del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-886">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="c00a7-887">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-887">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-888">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-888">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  

<span data-ttu-id="c00a7-889">Il **XmlReader** restituito da questo metodo non supporta le operazioni asincrone.</span><span class="sxs-lookup"><span data-stu-id="c00a7-889">The **XmlReader** returned by this method does not support asynchronous operations.</span></span>

<span data-ttu-id="c00a7-890">Per ulteriori informazioni sulla programmazione asincrona nel Provider di dati .NET Framework per SQL Server, vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-890">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidCastException">
          <span data-ttu-id="c00a7-891">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Binary** o **VarBinary** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.Stream" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-891">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Binary** or **VarBinary** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.Stream" />.</span>
          </span>
          <span data-ttu-id="c00a7-892">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-892">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-893">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Char**, **NChar**, **NVarChar**, **VarChar** o **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.IO.TextReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-893">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Char**, **NChar**, **NVarChar**, **VarChar**, or  **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.IO.TextReader" />.</span>
          </span>
          <span data-ttu-id="c00a7-894">È stato usato un valore <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> diverso da **Xml** quando <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> era impostato su <see cref="T:System.Xml.XmlReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-894">A <see cref="P:System.Data.SqlClient.SqlParameter.SqlDbType" /> other than **Xml** was used when <see cref="P:System.Data.SqlClient.SqlParameter.Value" /> was set to <see cref="T:System.Xml.XmlReader" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="c00a7-895">
            <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteScalarAsync(System.Threading.CancellationToken)" /> viene chiamato più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-895">Calling <see cref="M:System.Data.SqlClient.SqlCommand.ExecuteScalarAsync(System.Threading.CancellationToken)" /> more than once for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="c00a7-896">L'elemento <see cref="T:System.Data.SqlClient.SqlConnection" /> chiuso o eliminato durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-896">The <see cref="T:System.Data.SqlClient.SqlConnection" /> closed or dropped during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-897">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-897">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
          <span data-ttu-id="c00a7-898">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-898">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="c00a7-899">SQL Server ha restituito un errore durante l'esecuzione del testo del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-899">SQL Server returned an error while executing the command text.</span>
          </span>
          <span data-ttu-id="c00a7-900">Si è verificato un timeout durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-900">A timeout occurred during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-901">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-901">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="c00a7-902">Errore nell'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> durante un'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-902">An error occurred in a <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-903">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-903">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="c00a7-904">L'oggetto <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> o <see cref="T:System.IO.TextReader" /> è stato chiuso durante l'operazione di flusso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-904">The <see cref="T:System.IO.Stream" />, <see cref="T:System.Xml.XmlReader" /> or <see cref="T:System.IO.TextReader" /> object was closed during a streaming operation.</span>
          </span>
          <span data-ttu-id="c00a7-905">Per altre informazioni sul flusso, vedere [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-905">For more information about streaming, see [SqlClient Streaming Support](~/docs/framework/data/adonet/sqlclient-streaming-support.md).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="Notification">
      <MemberSignature Language="C#" Value="public System.Data.Sql.SqlNotificationRequest Notification { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.Sql.SqlNotificationRequest Notification" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.Notification" />
      <MemberSignature Language="VB.NET" Value="Public Property Notification As SqlNotificationRequest" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Data::Sql::SqlNotificationRequest ^ Notification { System::Data::Sql::SqlNotificationRequest ^ get(); void set(System::Data::Sql::SqlNotificationRequest ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Notification : System.Data.Sql.SqlNotificationRequest with get, set" Usage="System.Data.SqlClient.SqlCommand.Notification" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Data.Sql.SqlNotificationRequest</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-906">Ottiene o imposta un valore che specifica l'oggetto <see cref="T:System.Data.Sql.SqlNotificationRequest" /> associato a questo comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-906">Gets or sets a value that specifies the <see cref="T:System.Data.Sql.SqlNotificationRequest" /> object bound to this command.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-907">Quando viene impostato su Null, che rappresenta il valore predefinito, non è possibile richiedere alcuna notifica.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-907">When set to null (default), no notification should be requested.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-908">È necessario impostare il valore di questa proprietà prima che il comando viene eseguito per poter rendere effettiva.</span><span class="sxs-lookup"><span data-stu-id="c00a7-908">You must set the value for this property before the command is executed for it to take effect.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="NotificationAutoEnlist">
      <MemberSignature Language="C#" Value="public bool NotificationAutoEnlist { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool NotificationAutoEnlist" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.NotificationAutoEnlist" />
      <MemberSignature Language="VB.NET" Value="Public Property NotificationAutoEnlist As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool NotificationAutoEnlist { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.NotificationAutoEnlist : bool with get, set" Usage="System.Data.SqlClient.SqlCommand.NotificationAutoEnlist" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-909">Ottiene o imposta un valore che indica se l'applicazione deve ricevere automaticamente le notifiche di query da un oggetto <see cref="T:System.Data.SqlClient.SqlDependency" /> comune.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-909">Gets or sets a value indicating whether the application should automatically receive query notifications from a common <see cref="T:System.Data.SqlClient.SqlDependency" /> object.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-910">* * true * * se l'applicazione deve ricevere automaticamente le notifiche delle query; in caso contrario, * * false * *.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-910">**true** if the application should automatically receive query notifications; otherwise **false**.</span>
          </span>
          <span data-ttu-id="c00a7-911">Il valore predefinito è * * true * *.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-911">The default value is **true**.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-912">Questa funzionalità viene usata nelle applicazioni ASP.NET per ricevere le notifiche per tutti i comandi eseguiti in una pagina ASP in SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c00a7-912">This feature is used in ASP.NET applications to receive notifications for all commands executed in an ASP page against SQL Server.</span></span> <span data-ttu-id="c00a7-913">Ciò consente ad ASP.NET di memorizzare nella cache la pagina fino a quando le query usate per il rendering della pagina produrrebbe un risultato diverso.</span><span class="sxs-lookup"><span data-stu-id="c00a7-913">This enables ASP.NET to cache the page until the queries used to render the page would produce a different result.</span></span> <span data-ttu-id="c00a7-914">Inserimento automatico.</span><span class="sxs-lookup"><span data-stu-id="c00a7-914">Automatic enlistment.</span></span>  
  
 <span data-ttu-id="c00a7-915">Questa proprietà viene applicata solo alle versioni di SQL Server che supportano le notifiche delle query.</span><span class="sxs-lookup"><span data-stu-id="c00a7-915">This property applies only to versions of SQL Server that support query notifications.</span></span> <span data-ttu-id="c00a7-916">Per le versioni precedenti, impostando questa proprietà su **true** non ha alcun effetto sull'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-916">For earlier versions, setting this property to **true** has no effect on the application.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Parameters">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlParameterCollection Parameters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.SqlClient.SqlParameterCollection Parameters" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.Parameters" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Parameters As SqlParameterCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Data::SqlClient::SqlParameterCollection ^ Parameters { System::Data::SqlClient::SqlParameterCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Parameters : System.Data.SqlClient.SqlParameterCollection" Usage="System.Data.SqlClient.SqlCommand.Parameters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlParameterCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-917">Ottiene l'oggetto <see cref="T:System.Data.SqlClient.SqlParameterCollection" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-917">Gets the <see cref="T:System.Data.SqlClient.SqlParameterCollection" />.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-918">Parametri dell'istruzione Transact-SQL o della stored procedure.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-918">The parameters of the Transact-SQL statement or stored procedure.</span>
          </span>
          <span data-ttu-id="c00a7-919">Il valore predefinito è una raccolta vuota.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-919">The default is an empty collection.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-920">Il Provider di dati Microsoft .NET Framework per SQL Server non supporta il punto interrogativo (?) come segnaposto per passare parametri a un'istruzione SQL o una stored procedure chiamata da un comando di `CommandType.Text`.</span><span class="sxs-lookup"><span data-stu-id="c00a7-920">The Microsoft .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to a SQL Statement or a stored procedure called by a command of `CommandType.Text`.</span></span> <span data-ttu-id="c00a7-921">In questo caso, è necessario utilizzare parametri denominati.</span><span class="sxs-lookup"><span data-stu-id="c00a7-921">In this case, named parameters must be used.</span></span> <span data-ttu-id="c00a7-922">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="c00a7-922">For example:</span></span>  
  
 <span data-ttu-id="c00a7-923">Selezionare \* da clienti in cui CustomerID = @CustomerID</span><span class="sxs-lookup"><span data-stu-id="c00a7-923">SELECT \* FROM Customers WHERE CustomerID = @CustomerID</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c00a7-924">Se i parametri nella raccolta non corrispondono ai requisiti della query da eseguire, potrebbe verificarsi un errore.</span><span class="sxs-lookup"><span data-stu-id="c00a7-924">If the parameters in the collection do not match the requirements of the query to be executed, an error may result.</span></span>  
  
 <span data-ttu-id="c00a7-925">Per altre informazioni, vedere [configurazione dei parametri e tipi di dati di parametro](~/docs/framework/data/adonet/configuring-parameters-and-parameter-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-925">For more information, see [Configuring Parameters and Parameter Data Types](~/docs/framework/data/adonet/configuring-parameters-and-parameter-data-types.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-926">Nell'esempio seguente viene illustrato come creare un <xref:System.Data.SqlClient.SqlCommand> e aggiungere i parametri per il <xref:System.Data.SqlClient.SqlParameterCollection>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-926">The following example demonstrates how to create a <xref:System.Data.SqlClient.SqlCommand> and add parameters to the <xref:System.Data.SqlClient.SqlParameterCollection>.</span></span>  
  
 [!code-csharp[DataWorks SqlParameterCollection.AddWithValue#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlParameterCollection.AddWithValue/CS/source.cs#1)]
 [!code-vb[DataWorks SqlParameterCollection.AddWithValue#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlParameterCollection.AddWithValue/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Prepare">
      <MemberSignature Language="C#" Value="public override void Prepare ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Prepare() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.Prepare" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Prepare ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Prepare();" />
      <MemberSignature Language="F#" Value="override this.Prepare : unit -&gt; unit" Usage="sqlCommand.Prepare " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Data.IDbCommand.Prepare</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-927">Crea una versione preparata del comando in un'istanza di SQL Server.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-927">Creates a prepared version of the command on an instance of SQL Server.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-928">Se <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> è impostata su `StoredProcedure`, la chiamata a <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> dovrebbe avere esito positivo, anche se eseguita alcuna operazione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-928">If <xref:System.Data.SqlClient.SqlCommand.CommandType%2A> is set to `StoredProcedure`, the call to <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> should succeed, although it may cause a no-op.</span></span>  
  
 <span data-ttu-id="c00a7-929">Prima di chiamare <xref:System.Data.SqlClient.SqlCommand.Prepare%2A>, specificare il tipo di dati di ogni parametro nell'istruzione da preparare.</span><span class="sxs-lookup"><span data-stu-id="c00a7-929">Before you call <xref:System.Data.SqlClient.SqlCommand.Prepare%2A>, specify the data type of each parameter in the statement to be prepared.</span></span> <span data-ttu-id="c00a7-930">Per ogni parametro con un tipo di dati di lunghezza variabile, è necessario impostare il <xref:System.Data.SqlClient.SqlParameter.Size%2A> proprietà per le dimensioni massime necessita.</span><span class="sxs-lookup"><span data-stu-id="c00a7-930">For each parameter that has a variable length data type, you must set the <xref:System.Data.SqlClient.SqlParameter.Size%2A> property to the maximum size needed.</span></span> <span data-ttu-id="c00a7-931"><xref:System.Data.SqlClient.SqlCommand.Prepare%2A> Restituisce un errore se non vengono soddisfatte queste condizioni.</span><span class="sxs-lookup"><span data-stu-id="c00a7-931"><xref:System.Data.SqlClient.SqlCommand.Prepare%2A> returns an error if these conditions are not met.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c00a7-932">Se viene modificato il contesto del database eseguendo l'istruzione Transact-SQL `USE <database>` istruzione, oppure chiamando il <xref:System.Data.SqlClient.SqlConnection.ChangeDatabase%2A> (metodo), quindi <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> deve essere chiamato una seconda volta.</span><span class="sxs-lookup"><span data-stu-id="c00a7-932">If the database context is changed by executing the Transact-SQL `USE <database>` statement, or by calling the <xref:System.Data.SqlClient.SqlConnection.ChangeDatabase%2A> method, then <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> must be called a second time.</span></span>  
  
 <span data-ttu-id="c00a7-933">Se si chiama un `Execute` dopo la chiamata al metodo <xref:System.Data.SqlClient.SqlCommand.Prepare%2A>, qualsiasi valore del parametro è maggiore del valore specificato per il <xref:System.Data.SqlClient.SqlParameter.Size%2A> proprietà viene troncata automaticamente alle dimensioni specificate originale del parametro e non gli errori di troncamento sono restituito.</span><span class="sxs-lookup"><span data-stu-id="c00a7-933">If you call an `Execute` method after calling <xref:System.Data.SqlClient.SqlCommand.Prepare%2A>, any parameter value that is larger than the value specified by the <xref:System.Data.SqlClient.SqlParameter.Size%2A> property is automatically truncated to the original specified size of the parameter, and no truncation errors are returned.</span></span>  
  
 <span data-ttu-id="c00a7-934">I parametri di output (se preparati o meno) deve avere un tipo di dati specificato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="c00a7-934">Output parameters (whether prepared or not) must have a user-specified data type.</span></span> <span data-ttu-id="c00a7-935">Se si specifica un tipo di dati di lunghezza variabile, è necessario specificare anche il valore massimo <xref:System.Data.SqlClient.SqlParameter.Size%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-935">If you specify a variable length data type, you must also specify the maximum <xref:System.Data.SqlClient.SqlParameter.Size%2A>.</span></span>  
  
 <span data-ttu-id="c00a7-936">Prima di Visual Studio 2010, <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> ha generato un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-936">Prior to Visual Studio 2010, <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> threw an exception.</span></span>  <span data-ttu-id="c00a7-937">A partire da Visual Studio 2010, questo metodo non genera un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-937">Beginning in Visual Studio 2010, this method does not throw an exception.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c00a7-938">Nell'esempio seguente viene illustrato l'uso del metodo <xref:System.Data.SqlClient.SqlCommand.Prepare%2A>.</span><span class="sxs-lookup"><span data-stu-id="c00a7-938">The following example demonstrates the use of the <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> method.</span></span>  
  
 [!code-csharp[Classic WebData SqlCommand.Prepare#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/Classic WebData SqlCommand.Prepare/CS/Source.cs#1)]
 [!code-vb[Classic WebData SqlCommand.Prepare#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/Classic WebData SqlCommand.Prepare/VB/Source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ResetCommandTimeout">
      <MemberSignature Language="C#" Value="public void ResetCommandTimeout ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ResetCommandTimeout() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.ResetCommandTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Sub ResetCommandTimeout ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ResetCommandTimeout();" />
      <MemberSignature Language="F#" Value="member this.ResetCommandTimeout : unit -&gt; unit" Usage="sqlCommand.ResetCommandTimeout " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-939">Reimposta il valore predefinito della proprietà <see cref="P:System.Data.SqlClient.SqlCommand.CommandTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-939">Resets the <see cref="P:System.Data.SqlClient.SqlCommand.CommandTimeout" /> property to its default value.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-940">Il valore predefinito di <xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> è 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="c00a7-940">The default value of the <xref:System.Data.SqlClient.SqlCommand.CommandTimeout%2A> is 30 seconds.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="StatementCompleted">
      <MemberSignature Language="C#" Value="public event System.Data.StatementCompletedEventHandler StatementCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Data.StatementCompletedEventHandler StatementCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Data.SqlClient.SqlCommand.StatementCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event StatementCompleted As StatementCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Data::StatementCompletedEventHandler ^ StatementCompleted;" />
      <MemberSignature Language="F#" Value="member this.StatementCompleted : System.Data.StatementCompletedEventHandler " Usage="member this.StatementCompleted : System.Data.StatementCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.StatementCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-941">Si verifica al completamento dell'esecuzione di un'istruzione Transact-SQL.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-941">Occurs when the execution of a Transact-SQL statement completes.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="System.ICloneable.Clone">
      <MemberSignature Language="C#" Value="object ICloneable.Clone ();" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance object System.ICloneable.Clone() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlCommand.System#ICloneable#Clone" />
      <MemberSignature Language="VB.NET" Value="Function Clone () As Object Implements ICloneable.Clone" />
      <MemberSignature Language="C++ CLI" Value=" virtual System::Object ^ System.ICloneable.Clone() = ICloneable::Clone;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ICloneable.Clone</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-942">Crea un nuovo oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> che è una copia dell'istanza corrente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-942">Creates a new <see cref="T:System.Data.SqlClient.SqlCommand" /> object that is a copy of the current instance.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c00a7-943">Nuovo oggetto <see cref="T:System.Data.SqlClient.SqlCommand" /> che è una copia dell'istanza corrente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-943">A new <see cref="T:System.Data.SqlClient.SqlCommand" /> object that is a copy of this instance.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="Transaction">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlTransaction Transaction { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.SqlClient.SqlTransaction Transaction" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.Transaction" />
      <MemberSignature Language="VB.NET" Value="Public Property Transaction As SqlTransaction" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Data::SqlClient::SqlTransaction ^ Transaction { System::Data::SqlClient::SqlTransaction ^ get(); void set(System::Data::SqlClient::SqlTransaction ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Transaction : System.Data.SqlClient.SqlTransaction with get, set" Usage="System.Data.SqlClient.SqlCommand.Transaction" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlTransaction</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-944">Ottiene o imposta l'oggetto <see cref="T:System.Data.SqlClient.SqlTransaction" /> in cui viene eseguito <see cref="T:System.Data.SqlClient.SqlCommand" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-944">Gets or sets the <see cref="T:System.Data.SqlClient.SqlTransaction" /> within which the <see cref="T:System.Data.SqlClient.SqlCommand" /> executes.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-945">Oggetto <see cref="T:System.Data.SqlClient.SqlTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-945">The <see cref="T:System.Data.SqlClient.SqlTransaction" />.</span>
          </span>
          <span data-ttu-id="c00a7-946">Il valore predefinito è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-946">The default value is <see langword="null" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-947">Non è possibile impostare il <xref:System.Data.SqlClient.SqlCommand.Transaction%2A> proprietà se è già impostato su un valore specifico e il comando è in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-947">You cannot set the <xref:System.Data.SqlClient.SqlCommand.Transaction%2A> property if it is already set to a specific value, and the command is in the process of executing.</span></span> <span data-ttu-id="c00a7-948">Se si imposta la proprietà della transazione un <xref:System.Data.SqlClient.SqlTransaction> oggetto che non è connesso alla stessa <xref:System.Data.SqlClient.SqlConnection> come il <xref:System.Data.SqlClient.SqlCommand> dell'oggetto, la prossima volta che si tenta di eseguire un'istruzione viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="c00a7-948">If you set the transaction property to a <xref:System.Data.SqlClient.SqlTransaction> object that is not connected to the same <xref:System.Data.SqlClient.SqlConnection> as the <xref:System.Data.SqlClient.SqlCommand> object, an exception is thrown the next time that you attempt to execute a statement.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="UpdatedRowSource">
      <MemberSignature Language="C#" Value="public override System.Data.UpdateRowSource UpdatedRowSource { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Data.UpdateRowSource UpdatedRowSource" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlCommand.UpdatedRowSource" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property UpdatedRowSource As UpdateRowSource" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::Data::UpdateRowSource UpdatedRowSource { System::Data::UpdateRowSource get(); void set(System::Data::UpdateRowSource value); };" />
      <MemberSignature Language="F#" Value="member this.UpdatedRowSource : System.Data.UpdateRowSource with get, set" Usage="System.Data.SqlClient.SqlCommand.UpdatedRowSource" />
      <MemberType>Property</MemberType>
      <Implements>
        <InterfaceMember>P:System.Data.IDbCommand.UpdatedRowSource</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(Mono.Cecil.CustomAttributeArgument)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Data.UpdateRowSource</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c00a7-949">Ottiene o imposta il modo in cui i risultati del comando vengono applicati a <see cref="T:System.Data.DataRow" /> quando vengono usati dal metodo **Update** di <see cref="T:System.Data.Common.DbDataAdapter" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-949">Gets or sets how command results are applied to the <see cref="T:System.Data.DataRow" /> when used by the **Update** method of the <see cref="T:System.Data.Common.DbDataAdapter" />.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c00a7-950">Uno dei valori di <see cref="T:System.Data.UpdateRowSource" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="c00a7-950">One of the <see cref="T:System.Data.UpdateRowSource" /> values.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c00a7-951">Il valore predefinito <xref:System.Data.UpdateRowSource> valore è **entrambi** a meno che non viene generato automaticamente il comando (come nel caso del <xref:System.Data.SqlClient.SqlCommandBuilder>), nel qual caso il valore predefinito è **Nessuno**.</span><span class="sxs-lookup"><span data-stu-id="c00a7-951">The default <xref:System.Data.UpdateRowSource> value is **Both** unless the command is automatically generated (as in the case of the <xref:System.Data.SqlClient.SqlCommandBuilder>), in which case the default is **None**.</span></span>  
  
 <span data-ttu-id="c00a7-952">Per ulteriori informazioni sull'utilizzo di **UpdatedRowSource** proprietà, vedere [parametri DataAdapter](~/docs/framework/data/adonet/dataadapter-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="c00a7-952">For more information about using the **UpdatedRowSource** property, see [DataAdapter Parameters](~/docs/framework/data/adonet/dataadapter-parameters.md).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>