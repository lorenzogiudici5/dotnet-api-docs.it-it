<Type Name="SqlBulkCopy" FullName="System.Data.SqlClient.SqlBulkCopy">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="68f7a233c4b460fccda736cf959d4ee579b49a05" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="it-IT" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class SqlBulkCopy : IDisposable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit SqlBulkCopy extends System.Object implements class System.IDisposable" />
  <TypeSignature Language="DocId" Value="T:System.Data.SqlClient.SqlBulkCopy" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class SqlBulkCopy&#xA;Implements IDisposable" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlBulkCopy sealed : IDisposable" />
  <AssemblyInfo>
    <AssemblyName>System.Data.SqlClient</AssemblyName>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Data</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.IDisposable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary>
      <span data-ttu-id="7c3de-101">Consente di caricare in blocco in modo efficace una tabella di SQL Server con i dati provenienti da un'altra origine.</span>
      <span class="sxs-lookup">
        <span data-stu-id="7c3de-101">Lets you efficiently bulk load a SQL Server table with data from another source.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-102">Microsoft SQL Server include una popolare utilità della riga di comando denominata **bcp** per spostare i dati da una tabella a altra, se in un singolo server o tra server.</span><span class="sxs-lookup"><span data-stu-id="7c3de-102">Microsoft SQL Server includes a popular command-prompt utility named **bcp** for moving data from one table to another, whether on a single server or between servers.</span></span> <span data-ttu-id="7c3de-103">La <xref:System.Data.SqlClient.SqlBulkCopy> classe consente di scrivere soluzioni di codice gestito che offrono funzionalità simili.</span><span class="sxs-lookup"><span data-stu-id="7c3de-103">The <xref:System.Data.SqlClient.SqlBulkCopy> class lets you write managed code solutions that provide similar functionality.</span></span> <span data-ttu-id="7c3de-104">Esistono altri modi per caricare dati in una tabella di SQL Server (istruzioni INSERT, ad esempio), ma <xref:System.Data.SqlClient.SqlBulkCopy> offre un vantaggio in termini di prestazioni significativo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-104">There are other ways to load data into a SQL Server table (INSERT statements, for example), but <xref:System.Data.SqlClient.SqlBulkCopy> offers a significant performance advantage over them.</span></span>  
  
 <span data-ttu-id="7c3de-105">La classe <xref:System.Data.SqlClient.SqlBulkCopy> consente di scrivere dati solo su tabelle SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7c3de-105">The <xref:System.Data.SqlClient.SqlBulkCopy> class can be used to write data only to SQL Server tables.</span></span> <span data-ttu-id="7c3de-106">Tuttavia, l'origine dati non è limitata a SQL Server. qualsiasi origine dati è utilizzabile, purché i dati possano essere caricati in un <xref:System.Data.DataTable> istanza o di lettura con un <xref:System.Data.IDataReader> istanza.</span><span class="sxs-lookup"><span data-stu-id="7c3de-106">However, the data source is not limited to SQL Server; any data source can be used, as long as the data can be loaded to a <xref:System.Data.DataTable> instance or read with a <xref:System.Data.IDataReader> instance.</span></span>  
  
 <span data-ttu-id="7c3de-107"><xref:System.Data.SqlClient.SqlBulkCopy> avrà esito negativo quando il caricamento bulk un <xref:System.Data.DataTable> colonna di tipo <xref:System.Data.SqlTypes.SqlDateTime> in un Server SQL colonna il cui tipo è uno dei tipi di data e ora aggiunti in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="7c3de-107"><xref:System.Data.SqlClient.SqlBulkCopy> will fail when bulk loading a <xref:System.Data.DataTable> column of type <xref:System.Data.SqlTypes.SqlDateTime> into a SQL Server column whose type is one of the date/time types added in SQL Server 2008.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-108">Nell'applicazione console riportata di seguito viene illustrato come caricare i dati usando la classe <xref:System.Data.SqlClient.SqlBulkCopy>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-108">The following console application demonstrates how to load data using the <xref:System.Data.SqlClient.SqlBulkCopy> class.</span></span> <span data-ttu-id="7c3de-109">In questo esempio, un <xref:System.Data.SqlClient.SqlDataReader> viene utilizzato per copiare i dati di **Production. Product** tabella il [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] **AdventureWorks** database in una tabella simile nello stesso database.</span><span class="sxs-lookup"><span data-stu-id="7c3de-109">In this example, a <xref:System.Data.SqlClient.SqlDataReader> is used to copy data from the **Production.Product** table in the [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)]**AdventureWorks** database to a similar table in the same database.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-110">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-110">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-111">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-111">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-112">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-112">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks BulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks BulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-113">Inizializza una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-113">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (System.Data.SqlClient.SqlConnection connection);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Data.SqlClient.SqlConnection connection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connection As SqlConnection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::Data::SqlClient::SqlConnection ^ connection);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
      </Parameters>
      <Docs>
        <param name="connection">
          <span data-ttu-id="7c3de-114">Istanza <see cref="T:System.Data.SqlClient.SqlConnection" /> già aperta utilizzata per eseguire l'operazione di copia di massa.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-114">The already open <see cref="T:System.Data.SqlClient.SqlConnection" /> instance that will be used to perform the bulk copy operation.</span>
          </span>
          <span data-ttu-id="7c3de-115">Se la stringa di connessione non utilizza <see langword="Integrated Security = true" />, è possibile utilizzare <see cref="T:System.Data.SqlClient.SqlCredential" /> per passare l'ID utente e la password in modo più sicuro che specificandoli come testo della stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-115">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-116">Inizializza una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> mediante l'istanza aperta specificata dell'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-116">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class using the specified open instance of <see cref="T:System.Data.SqlClient.SqlConnection" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-117">Poiché la connessione è già aperto quando il <xref:System.Data.SqlClient.SqlBulkCopy> l'istanza viene inizializzata, la connessione rimane aperta dopo il <xref:System.Data.SqlClient.SqlBulkCopy> istanza è chiusa.</span><span class="sxs-lookup"><span data-stu-id="7c3de-117">Because the connection is already open when the <xref:System.Data.SqlClient.SqlBulkCopy> instance is initialized, the connection remains open after the <xref:System.Data.SqlClient.SqlBulkCopy> instance is closed.</span></span>  
  
 <span data-ttu-id="7c3de-118">Se il `connection` argomento è null, un <xref:System.ArgumentNullException> viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-118">If the `connection` argument is null, an <xref:System.ArgumentNullException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-119">Nell'applicazione console riportata di seguito viene illustrato come caricamento bulk dei dati tramite una connessione che è già aperta.</span><span class="sxs-lookup"><span data-stu-id="7c3de-119">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="7c3de-120">In questo esempio, un <xref:System.Data.SqlClient.SqlDataReader> viene utilizzato per copiare i dati di **Production. Product** tabella il [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] **AdventureWorks** database in una tabella simile nello stesso database.</span><span class="sxs-lookup"><span data-stu-id="7c3de-120">In this example, a <xref:System.Data.SqlClient.SqlDataReader> is used to copy data from the **Production.Product** table in the [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)]**AdventureWorks** database to a similar table in the same database.</span></span> <span data-ttu-id="7c3de-121">L'esempio ha solo scopo dimostrativo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-121">This example is for demonstration purposes only.</span></span> <span data-ttu-id="7c3de-122">Non è possibile utilizzare `SqlBulkCopy` per spostare i dati da una tabella a un'altra nello stesso database in un'applicazione di produzione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-122">You would not use `SqlBulkCopy` to move data from one table to another in the same database in a production application.</span></span> <span data-ttu-id="7c3de-123">Si noti che i dati di origine non deve trovarsi in SQL Server. è possibile utilizzare qualsiasi origine dati che può essere letti per un <xref:System.Data.IDataReader> o caricare in un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-123">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-124">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-124">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-125">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-125">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-126">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-126">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks BulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks BulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (string connectionString);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string connectionString) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connectionString As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::String ^ connectionString);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connectionString" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="connectionString">
          <span data-ttu-id="7c3de-127">Stringa che definisce la connessione che verrà aperta per essere utilizzata dall'istanza <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-127">The string defining the connection that will be opened for use by the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span>
          </span>
          <span data-ttu-id="7c3de-128">Se la stringa di connessione non utilizza <see langword="Integrated Security = true" />, è possibile utilizzare il metodo <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> o <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> e <see cref="T:System.Data.SqlClient.SqlCredential" /> per passare l'ID utente e la password in modo più sicuro che specificandoli come testo della stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-128">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> or <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> and <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-129">Inizializza e apre una nuova istanza di <see cref="T:System.Data.SqlClient.SqlConnection" /> sulla base dell'oggetto <paramref name="connectionString" /> fornito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-129">Initializes and opens a new instance of <see cref="T:System.Data.SqlClient.SqlConnection" /> based on the supplied <paramref name="connectionString" />.</span>
          </span>
          <span data-ttu-id="7c3de-130">Il costruttore utilizza l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> per inizializzare una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-130">The constructor uses the <see cref="T:System.Data.SqlClient.SqlConnection" /> to initialize a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-131">La connessione viene chiusa automaticamente alla fine dell'operazione di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="7c3de-131">The connection is automatically closed at the end of the bulk copy operation.</span></span>  
  
 <span data-ttu-id="7c3de-132">Se `connectionString` è null, un <xref:System.ArgumentNullException> viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-132">If `connectionString` is null, an <xref:System.ArgumentNullException> is thrown.</span></span> <span data-ttu-id="7c3de-133">Se `connectionString` è una stringa vuota, un <xref:System.ArgumentException> viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-133">If `connectionString` is an empty string, an <xref:System.ArgumentException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-134">Nell'applicazione console riportata di seguito viene illustrato come caricamento bulk dei dati tramite una connessione specificata sotto forma di stringa.</span><span class="sxs-lookup"><span data-stu-id="7c3de-134">The following console application demonstrates how to bulk load data by using a connection specified as a string.</span></span> <span data-ttu-id="7c3de-135">La connessione viene chiusa automaticamente quando il <xref:System.Data.SqlClient.SqlBulkCopy> istanza è chiusa.</span><span class="sxs-lookup"><span data-stu-id="7c3de-135">The connection is automatically closed when the <xref:System.Data.SqlClient.SqlBulkCopy> instance is closed.</span></span>  
  
 <span data-ttu-id="7c3de-136">In questo esempio, i dati di origine viene innanzitutto letta da una tabella di SQL Server in un <xref:System.Data.SqlClient.SqlDataReader> istanza.</span><span class="sxs-lookup"><span data-stu-id="7c3de-136">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="7c3de-137">I dati di origine non deve trovarsi in SQL Server. è possibile utilizzare qualsiasi origine dati che può essere letti per un <xref:System.Data.IDataReader> o caricare in un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-137">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-138">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-138">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-139">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-139">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-140">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-140">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (string connectionString, System.Data.SqlClient.SqlBulkCopyOptions copyOptions);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string connectionString, valuetype System.Data.SqlClient.SqlBulkCopyOptions copyOptions) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.String,System.Data.SqlClient.SqlBulkCopyOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connectionString As String, copyOptions As SqlBulkCopyOptions)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::String ^ connectionString, System::Data::SqlClient::SqlBulkCopyOptions copyOptions);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connectionString" Type="System.String" />
        <Parameter Name="copyOptions" Type="System.Data.SqlClient.SqlBulkCopyOptions" />
      </Parameters>
      <Docs>
        <param name="connectionString">
          <span data-ttu-id="7c3de-141">Stringa che definisce la connessione che verrà aperta per essere utilizzata dall'istanza <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-141">The string defining the connection that will be opened for use by the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span>
          </span>
          <span data-ttu-id="7c3de-142">Se la stringa di connessione non utilizza <see langword="Integrated Security = true" />, è possibile utilizzare il metodo <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> o <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> e <see cref="T:System.Data.SqlClient.SqlCredential" /> per passare l'ID utente e la password in modo più sicuro che specificandoli come testo della stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-142">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> or <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> and <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span>
          </span>
        </param>
        <param name="copyOptions">
          <span data-ttu-id="7c3de-143">Combinazione dei valori dell'enumerazione <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> che determina quali righe dell'origine dati verranno copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-143">A combination of values from the <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> enumeration that determines which data source rows are copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-144">Inizializza e apre una nuova istanza di <see cref="T:System.Data.SqlClient.SqlConnection" /> sulla base dell'oggetto <paramref name="connectionString" /> fornito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-144">Initializes and opens a new instance of <see cref="T:System.Data.SqlClient.SqlConnection" /> based on the supplied <paramref name="connectionString" />.</span>
          </span>
          <span data-ttu-id="7c3de-145">Il costruttore utilizza l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> per inizializzare una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-145">The constructor uses that <see cref="T:System.Data.SqlClient.SqlConnection" /> to initialize a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span>
          </span>
          <span data-ttu-id="7c3de-146">Il comportamento dell'istanza <see cref="T:System.Data.SqlClient.SqlConnection" /> è basato sulle opzioni fornite nel parametro <paramref name="copyOptions" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-146">The <see cref="T:System.Data.SqlClient.SqlConnection" /> instance behaves according to options supplied in the <paramref name="copyOptions" /> parameter.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-147">È possibile ottenere informazioni dettagliate su tutte le opzioni di copia bulk nel <xref:System.Data.SqlClient.SqlBulkCopyOptions> argomento.</span><span class="sxs-lookup"><span data-stu-id="7c3de-147">You can obtain detailed information about all the bulk copy options in the <xref:System.Data.SqlClient.SqlBulkCopyOptions> topic.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-148">L'applicazione console seguente viene illustrato come eseguire un caricamento bulk tramite una connessione specificata sotto forma di stringa.</span><span class="sxs-lookup"><span data-stu-id="7c3de-148">The following console application demonstrates how to perform a bulk load by using a connection specified as a string.</span></span> <span data-ttu-id="7c3de-149">Viene impostata un'opzione per utilizzare il valore della colonna identity della tabella di origine per il caricamento della tabella di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-149">An option is set to use the value in the identity column of the source table when you load the destination table.</span></span> <span data-ttu-id="7c3de-150">In questo esempio, i dati di origine viene innanzitutto letta da una tabella di SQL Server in un <xref:System.Data.SqlClient.SqlDataReader> istanza.</span><span class="sxs-lookup"><span data-stu-id="7c3de-150">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="7c3de-151">La tabella di origine e tabella di destinazione includono una colonna Identity.</span><span class="sxs-lookup"><span data-stu-id="7c3de-151">The source table and destination table each include an Identity column.</span></span> <span data-ttu-id="7c3de-152">Per impostazione predefinita, un nuovo valore per il **identità** colonna viene generata nella tabella di destinazione per ogni riga aggiunta.</span><span class="sxs-lookup"><span data-stu-id="7c3de-152">By default, a new value for the **Identity** column is generated in the destination table for each row added.</span></span> <span data-ttu-id="7c3de-153">In questo esempio viene impostata un'opzione quando è aperta la connessione che forza il processo di caricamento bulk di utilizzare il **identità** invece i valori dalla tabella di origine.</span><span class="sxs-lookup"><span data-stu-id="7c3de-153">In this example, an option is set when the connection is opened that forces the bulk load process to use the **Identity** values from the source table instead.</span></span> <span data-ttu-id="7c3de-154">Per vedere come l'opzione Cambia il funzionamento del blocco carico, eseguire l'esempio con il **dbo. BulkCopyDemoMatchingColumns** tabella vuota.</span><span class="sxs-lookup"><span data-stu-id="7c3de-154">To see how the option changes the way the bulk load works, run the sample with the **dbo.BulkCopyDemoMatchingColumns** table empty.</span></span> <span data-ttu-id="7c3de-155">Caricano di tutte le righe dall'origine.</span><span class="sxs-lookup"><span data-stu-id="7c3de-155">All rows load from the source.</span></span> <span data-ttu-id="7c3de-156">Quindi eseguire nuovamente l'esempio senza vuotare la tabella.</span><span class="sxs-lookup"><span data-stu-id="7c3de-156">Then run the sample again without emptying the table.</span></span> <span data-ttu-id="7c3de-157">Viene generata un'eccezione e il codice scrive un messaggio nella console di notifica che non sono state aggiunte righe a causa di violazioni di vincolo di chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="7c3de-157">An exception is thrown and the code writes a message to the console notifying you that rows weren't added because of primary key constraint violations.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-158">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-158">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-159">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-159">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-160">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-160">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.KeepIdentity#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.KeepIdentity/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.KeepIdentity#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.KeepIdentity/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (System.Data.SqlClient.SqlConnection connection, System.Data.SqlClient.SqlBulkCopyOptions copyOptions, System.Data.SqlClient.SqlTransaction externalTransaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Data.SqlClient.SqlConnection connection, valuetype System.Data.SqlClient.SqlBulkCopyOptions copyOptions, class System.Data.SqlClient.SqlTransaction externalTransaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connection As SqlConnection, copyOptions As SqlBulkCopyOptions, externalTransaction As SqlTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::Data::SqlClient::SqlConnection ^ connection, System::Data::SqlClient::SqlBulkCopyOptions copyOptions, System::Data::SqlClient::SqlTransaction ^ externalTransaction);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
        <Parameter Name="copyOptions" Type="System.Data.SqlClient.SqlBulkCopyOptions" />
        <Parameter Name="externalTransaction" Type="System.Data.SqlClient.SqlTransaction" />
      </Parameters>
      <Docs>
        <param name="connection">
          <span data-ttu-id="7c3de-161">Istanza <see cref="T:System.Data.SqlClient.SqlConnection" /> già aperta utilizzata per eseguire la copia di massa.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-161">The already open <see cref="T:System.Data.SqlClient.SqlConnection" /> instance that will be used to perform the bulk copy.</span>
          </span>
          <span data-ttu-id="7c3de-162">Se la stringa di connessione non utilizza <see langword="Integrated Security = true" />, è possibile utilizzare <see cref="T:System.Data.SqlClient.SqlCredential" /> per passare l'ID utente e la password in modo più sicuro che specificandoli come testo della stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-162">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span>
          </span>
        </param>
        <param name="copyOptions">
          <span data-ttu-id="7c3de-163">Combinazione dei valori dell'enumerazione <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> che determina quali righe dell'origine dati verranno copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-163">A combination of values from the <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> enumeration that determines which data source rows are copied to the destination table.</span>
          </span>
        </param>
        <param name="externalTransaction">
          <span data-ttu-id="7c3de-164">Istanza <see cref="T:System.Data.SqlClient.SqlTransaction" /> esistente nella quale ha luogo la copia di massa.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-164">An existing <see cref="T:System.Data.SqlClient.SqlTransaction" /> instance under which the bulk copy will occur.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-165">Inizializza una nuova istanza della classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> mediante l'istanza aperta esistente dell'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-165">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class using the supplied existing open instance of <see cref="T:System.Data.SqlClient.SqlConnection" />.</span>
          </span>
          <span data-ttu-id="7c3de-166">Il comportamento dell'istanza <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> è basato sulle opzioni fornite nel parametro <paramref name="copyOptions" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-166">The <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance behaves according to options supplied in the <paramref name="copyOptions" /> parameter.</span>
          </span>
          <span data-ttu-id="7c3de-167">Se all'oggetto <see cref="T:System.Data.SqlClient.SqlTransaction" /> viene fornito un valore non null, le operazioni di copia vengono eseguite all'interno della transazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-167">If a non-null <see cref="T:System.Data.SqlClient.SqlTransaction" /> is supplied, the copy operations will be performed within that transaction.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-168">Se le opzioni includono `UseInternalTransaction` e `externalTransaction` argomento non è null, un **eccezione InvalidArgumentException** viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-168">If options include `UseInternalTransaction` and the `externalTransaction` argument is not null, an **InvalidArgumentException** is thrown.</span></span>  
  
 <span data-ttu-id="7c3de-169">Per esempi che illustrano come usare `SqlBulkCopy` in una transazione, vedere [delle transazioni e operazioni di copia Bulk](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-169">For examples demonstrating how to use `SqlBulkCopy` in a transaction, see [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="BatchSize">
      <MemberSignature Language="C#" Value="public int BatchSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 BatchSize" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" />
      <MemberSignature Language="VB.NET" Value="Public Property BatchSize As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int BatchSize { int get(); void set(int value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-170">Numero di righe presenti in ogni batch.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-170">Number of rows in each batch.</span>
          </span>
          <span data-ttu-id="7c3de-171">Alla fine di ciascun batch, le righe presenti vengono inviate al server.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-171">At the end of each batch, the rows in the batch are sent to the server.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="7c3de-172">Intero della proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" /> oppure zero se non si è impostato alcun valore.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-172">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" /> property, or zero if no value has been set.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-173">Un batch è completato quando <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> righe sono state elaborate o non sono presenti altre righe da inviare all'origine dei dati di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-173">A batch is complete when <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> rows have been processed or there are no more rows to send to the destination data source.</span></span>  
  
 <span data-ttu-id="7c3de-174">Zero (il valore predefinito) indica che ogni <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operazione rappresenta un singolo batch.</span><span class="sxs-lookup"><span data-stu-id="7c3de-174">Zero (the default) indicates that each <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is a single batch.</span></span>  
  
 <span data-ttu-id="7c3de-175">Se il <xref:System.Data.SqlClient.SqlBulkCopy> istanza è stata dichiarata senza la <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> opzione in effetti, le righe vengono inviate al server <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> righe alla volta, ma nessuna azione correlata alla transazione viene eseguita.</span><span class="sxs-lookup"><span data-stu-id="7c3de-175">If the <xref:System.Data.SqlClient.SqlBulkCopy> instance has been declared without the <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> option in effect, rows are sent to the server <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> rows at a time, but no transaction-related action is taken.</span></span> <span data-ttu-id="7c3de-176">Se <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> è in effetti, ogni batch di righe viene inserito come una transazione separata.</span><span class="sxs-lookup"><span data-stu-id="7c3de-176">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is in effect, each batch of rows is inserted as a separate transaction.</span></span>  
  
 <span data-ttu-id="7c3de-177">Il <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> proprietà può essere impostata in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="7c3de-177">The <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> property can be set at any time.</span></span> <span data-ttu-id="7c3de-178">Se è già in corso una copia di massa, il batch corrente viene ridimensionato in base alle dimensioni di batch precedente.</span><span class="sxs-lookup"><span data-stu-id="7c3de-178">If a bulk copy is already in progress, the current batch is sized according to the previous batch size.</span></span> <span data-ttu-id="7c3de-179">I batch successivi utilizzano le nuove dimensioni.</span><span class="sxs-lookup"><span data-stu-id="7c3de-179">Subsequent batches use the new size.</span></span> <span data-ttu-id="7c3de-180">Se il <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> è inizialmente pari a zero e modificate durante una <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operazione è già in corso, tale operazione carica i dati come un singolo batch.</span><span class="sxs-lookup"><span data-stu-id="7c3de-180">If the <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> is initially zero and changed while a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is already in progress, that operation loads the data as a single batch.</span></span> <span data-ttu-id="7c3de-181">I successivi <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operazioni nello stesso <xref:System.Data.SqlClient.SqlBulkCopy> istanza usare il nuovo <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-181">Any subsequent <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operations on the same <xref:System.Data.SqlClient.SqlBulkCopy> instance use the new <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-182">Nell'applicazione console riportata di seguito viene illustrato come caricamento bulk dei dati in batch di 50 righe.</span><span class="sxs-lookup"><span data-stu-id="7c3de-182">The following console application demonstrates how to bulk load data in batches of 50 rows.</span></span> <span data-ttu-id="7c3de-183">Per un esempio che illustri come <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> funziona con una transazione, vedere [delle transazioni e operazioni di copia Bulk](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-183">For an example illustrating how <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> works with a transaction, see [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span></span>  
  
 <span data-ttu-id="7c3de-184">In questo esempio, i dati di origine viene innanzitutto letta da una tabella di SQL Server in un <xref:System.Data.SqlClient.SqlDataReader> istanza.</span><span class="sxs-lookup"><span data-stu-id="7c3de-184">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="7c3de-185">I dati di origine non deve trovarsi in SQL Server. è possibile utilizzare qualsiasi origine dati che può essere letti per un <xref:System.Data.IDataReader> o caricare in un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-185">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-186">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-186">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-187">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-187">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-188">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-188">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.BatchSize#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.BatchSize/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.BatchSize#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.BatchSize/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="BulkCopyTimeout">
      <MemberSignature Language="C#" Value="public int BulkCopyTimeout { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 BulkCopyTimeout" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Property BulkCopyTimeout As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int BulkCopyTimeout { int get(); void set(int value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-189">Numero di secondi per l'operazione da completare prima del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-189">Number of seconds for the operation to complete before it times out.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="7c3de-190">Intero della proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-190">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" /> property.</span>
          </span>
          <span data-ttu-id="7c3de-191">Il valore predefinito è 30 secondi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-191">The default is 30 seconds.</span>
          </span>
          <span data-ttu-id="7c3de-192">Il valore 0 indica nessun limite; la copia bulk attenderà un tempo illimitato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-192">A value of 0 indicates no limit; the bulk copy will wait indefinitely.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-193">Se l'operazione viene applicato alcun timeout, non viene eseguito il commit della transazione e vengono rimosse tutte le righe copiate dalla tabella di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-193">If the operation does time out, the transaction is not committed and all copied rows are removed from the destination table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-194">Nell'applicazione console riportata di seguito viene illustrato come modificare il timeout di 60 secondi quando caricamento bulk di dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-194">The following console application demonstrates how to modify the time-out to 60 seconds when bulk loading data.</span></span>  
  
 <span data-ttu-id="7c3de-195">In questo esempio, i dati di origine viene innanzitutto letta da un [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] tabella un <xref:System.Data.SqlClient.SqlDataReader> istanza.</span><span class="sxs-lookup"><span data-stu-id="7c3de-195">In this example, the source data is first read from a [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="7c3de-196">I dati di origine non sono necessario trovarsi nel [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)]; è possibile utilizzare qualsiasi origine dati che può essere letti per un <xref:System.Data.IDataReader> o caricare in un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-196">The source data does not have to be located on [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)]; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-197">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-197">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-198">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-198">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-199">Se le tabelle di origine e destinazione sono nello stesso [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] istanza, è più semplice e rapido usare un' [!INCLUDE[tsql](~/includes/tsql-md.md)] `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-199">If the source and destination tables are in the same [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] instance, it is easier and faster to use a [!INCLUDE[tsql](~/includes/tsql-md.md)]`INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.Timeout#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Timeout/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.Timeout#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Timeout/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-200">Chiude l'istanza di <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-200">Closes the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-201">Dopo aver chiamato un <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> sul <xref:System.Data.SqlClient.SqlBulkCopy> dell'oggetto, nessuna operazione avrà esito positivo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-201">After you call a <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> on the <xref:System.Data.SqlClient.SqlBulkCopy> object, no other operation will succeed.</span></span> <span data-ttu-id="7c3de-202">Le chiamate al <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> metodo genererà un' <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-202">Calls to the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="7c3de-203">La chiamata di <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> metodo dal <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> evento causa un <xref:System.InvalidOperationException> generata.</span><span class="sxs-lookup"><span data-stu-id="7c3de-203">Calling the <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> method from the <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event causes an <xref:System.InvalidOperationException> to be thrown.</span></span>  
  
 <span data-ttu-id="7c3de-204">Si noti che si aprono <xref:System.Data.SqlClient.SqlBulkCopy> le istanze vengono chiuse in modo implicito alla fine di un `using` blocco.</span><span class="sxs-lookup"><span data-stu-id="7c3de-204">Note that open <xref:System.Data.SqlClient.SqlBulkCopy> instances are closed implicitly at the end of a `using` block.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-205">Nell'esempio seguente usa la stessa <xref:System.Data.SqlClient.SqlBulkCopy> istanza a cui aggiungere gli ordini di vendita e i relativi dettagli associati a due tabelle di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-205">The following example uses the same <xref:System.Data.SqlClient.SqlBulkCopy> instance to add sales orders and their associated details to two destination tables.</span></span> <span data-ttu-id="7c3de-206">Poiché il **AdventureWorks** tabelle degli ordini di vendita sono di grandi dimensioni, il codice di esempio legge solo gli ordini effettuati da un determinato numero di account e operazioni di copia bulk tali ordini e i dettagli per le tabelle di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-206">Because the **AdventureWorks** sales order tables are large, the sample reads only orders placed by a certain account number and bulk copies those orders and details to the destination tables.</span></span> <span data-ttu-id="7c3de-207">Il <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> metodo viene utilizzato solo al termine di entrambe le operazioni di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="7c3de-207">The <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> method is used only after both bulk copy operations are complete.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-208">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-208">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-209">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-209">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-210">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-210">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.OrdersDetails#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.OrdersDetails/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.OrdersDetails#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.OrdersDetails/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ColumnMappings">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlBulkCopyColumnMappingCollection ColumnMappings { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.SqlClient.SqlBulkCopyColumnMappingCollection ColumnMappings" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.ColumnMappings" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ColumnMappings As SqlBulkCopyColumnMappingCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Data::SqlClient::SqlBulkCopyColumnMappingCollection ^ ColumnMappings { System::Data::SqlClient::SqlBulkCopyColumnMappingCollection ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlBulkCopyColumnMappingCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-211">Restituisce una raccolta di elementi <see cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-211">Returns a collection of <see cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" /> items.</span>
          </span>
          <span data-ttu-id="7c3de-212">I mapping delle colonne definiscono le relazioni tra le colonne nell'origine dati e quelle nella destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-212">Column mappings define the relationships between columns in the data source and columns in the destination.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="7c3de-213">Raccolta di mapping di colonne.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-213">A collection of column mappings.</span>
          </span>
          <span data-ttu-id="7c3de-214">Per impostazione predefinita, la raccolta è vuota.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-214">By default, it is an empty collection.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-215">Se l'origine dati e la tabella di destinazione hanno lo stesso numero di colonne e la posizione ordinale di ogni colonna di origine all'interno dell'origine dati corrisponde alla posizione ordinale della colonna di destinazione corrispondente, il <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> raccolta non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="7c3de-215">If the data source and the destination table have the same number of columns, and the ordinal position of each source column within the data source matches the ordinal position of the corresponding destination column, the <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection is unnecessary.</span></span> <span data-ttu-id="7c3de-216">Tuttavia, se il numero delle colonne sono diversi, o le posizioni ordinali non sono coerenti, è necessario utilizzare <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> per assicurarsi che i dati vengono copiati nelle colonne corrette.</span><span class="sxs-lookup"><span data-stu-id="7c3de-216">However, if the column counts differ, or the ordinal positions are not consistent, you must use <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> to make sure that data is copied into the correct columns.</span></span>  
  
 <span data-ttu-id="7c3de-217">Durante l'esecuzione di un'operazione di copia bulk, è possibile accedere questa raccolta, ma non può essere modificata.</span><span class="sxs-lookup"><span data-stu-id="7c3de-217">During the execution of a bulk copy operation, this collection can be accessed, but it cannot be changed.</span></span> <span data-ttu-id="7c3de-218">Qualsiasi tentativo di modifica genererà un <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-218">Any attempt to change it will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" />
      </Docs>
    </Member>
    <Member MemberName="DestinationTableName">
      <MemberSignature Language="C#" Value="public string DestinationTableName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DestinationTableName" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" />
      <MemberSignature Language="VB.NET" Value="Public Property DestinationTableName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ DestinationTableName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-219">Nome della tabella di destinazione nel server.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-219">Name of the destination table on the server.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="7c3de-220">Valore di stringa della proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> o null se non è stato fornito alcun valore.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-220">The string value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property, or null if none as been supplied.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-221">Se <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> non è stato impostato quando <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> viene chiamato un <xref:System.ArgumentNullException> viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-221">If <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> has not been set when <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> is called, an <xref:System.ArgumentNullException> is thrown.</span></span>  
  
 <span data-ttu-id="7c3de-222">Se <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> viene modificato mentre un <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operazione è in esecuzione, la modifica non influisce l'operazione corrente.</span><span class="sxs-lookup"><span data-stu-id="7c3de-222">If <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> is modified while a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is running, the change does not affect the current operation.</span></span> <span data-ttu-id="7c3de-223">Il nuovo <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> valore viene utilizzato al successivo un <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> metodo viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="7c3de-223">The new <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> value is used the next time a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is called.</span></span>  
  
 <span data-ttu-id="7c3de-224"><xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> è un nome in tre parti (`<database>.<owningschema>.<name>`).</span><span class="sxs-lookup"><span data-stu-id="7c3de-224"><xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> is a three-part name (`<database>.<owningschema>.<name>`).</span></span> <span data-ttu-id="7c3de-225">Se si sceglie, è possibile qualificare il nome della tabella con il database e lo schema proprietario.</span><span class="sxs-lookup"><span data-stu-id="7c3de-225">You can qualify the table name with its database and owning schema if you choose.</span></span> <span data-ttu-id="7c3de-226">Tuttavia, se il nome della tabella viene utilizzato un carattere di sottolineatura ("_") o altri caratteri speciali, è necessario eseguire l'escape circostante parentesi come in (`[<database>.<owningschema>.<name_01>]`).</span><span class="sxs-lookup"><span data-stu-id="7c3de-226">However, if the table name uses an underscore ("_") or any other special characters, you must escape the name using surrounding brackets as in (`[<database>.<owningschema>.<name_01>]`).</span></span> <span data-ttu-id="7c3de-227">Per ulteriori informazioni, vedere "Identificatori" nella documentazione Online di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7c3de-227">For more information, see "Identifiers" in SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="7c3de-228">È possibile una copia bulk dei dati in una tabella temporanea utilizzando un valore, ad esempio `tempdb..#table` o `tempdb.<owner>.#table` per il <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="7c3de-228">You can bulk-copy data to a temporary table by using a value such as `tempdb..#table` or `tempdb.<owner>.#table` for the <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-229">Nell'applicazione console riportata di seguito viene illustrato come caricamento bulk dei dati tramite una connessione che è già aperta.</span><span class="sxs-lookup"><span data-stu-id="7c3de-229">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="7c3de-230">La tabella di destinazione è una tabella di **AdventureWorks** database.</span><span class="sxs-lookup"><span data-stu-id="7c3de-230">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="7c3de-231">In questo esempio, la connessione viene innanzitutto utilizzata per leggere i dati da una tabella di SQL Server in un <xref:System.Data.SqlClient.SqlDataReader> istanza.</span><span class="sxs-lookup"><span data-stu-id="7c3de-231">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="7c3de-232">I dati di origine non deve trovarsi in SQL Server. è possibile utilizzare qualsiasi origine dati che può essere letti per un <xref:System.Data.IDataReader> o caricare in un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-232">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-233">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-233">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-234">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-234">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-235">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-235">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="EnableStreaming">
      <MemberSignature Language="C#" Value="public bool EnableStreaming { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableStreaming" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.EnableStreaming" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableStreaming As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableStreaming { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-236">Abilita o disabilita un oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> per la trasmissione del flusso di dati da un oggetto <see cref="T:System.Data.IDataReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-236">Enables or disables a <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object to stream data from an <see cref="T:System.Data.IDataReader" /> object</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="7c3de-237">
            <see langword="true" /> se un oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> può trasmettere il flusso di dati da un oggetto <see cref="T:System.Data.IDataReader" />; in caso contrario, false.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-237">
              <see langword="true" /> if a <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object can stream data from an <see cref="T:System.Data.IDataReader" /> object; otherwise, false.</span>
          </span>
          <span data-ttu-id="7c3de-238">Il valore predefinito è <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-238">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-239">Quando <xref:System.Data.SqlClient.SqlBulkCopy.EnableStreaming%2A> è `true`, <xref:System.Data.SqlClient.SqlBulkCopy> legge da un <xref:System.Data.IDataReader> utilizzando <xref:System.Data.CommandBehavior.SequentialAccess>, ottimizzazione dell'utilizzo di memoria utilizzando il <xref:System.Data.IDataReader> funzionalità di streaming.</span><span class="sxs-lookup"><span data-stu-id="7c3de-239">When <xref:System.Data.SqlClient.SqlBulkCopy.EnableStreaming%2A> is `true`, <xref:System.Data.SqlClient.SqlBulkCopy> reads from an <xref:System.Data.IDataReader> object using <xref:System.Data.CommandBehavior.SequentialAccess>, optimizing memory usage by using the <xref:System.Data.IDataReader> streaming capabilities.</span></span> <span data-ttu-id="7c3de-240">Quando la proprietà è impostata su false, il <xref:System.Data.SqlClient.SqlBulkCopy> classe carica tutti i dati restituiti dal <xref:System.Data.IDataReader> oggetto in memoria prima di inviarlo a [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] o SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="7c3de-240">When it’s set to false, the <xref:System.Data.SqlClient.SqlBulkCopy> class loads all the data returned by the <xref:System.Data.IDataReader> object into memory before sending it to [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] or SQL Azure.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="NotifyAfter">
      <MemberSignature Language="C#" Value="public int NotifyAfter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 NotifyAfter" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />
      <MemberSignature Language="VB.NET" Value="Public Property NotifyAfter As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int NotifyAfter { int get(); void set(int value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-241">Definisce il numero di righe da elaborare prima di generare un evento di notifica.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-241">Defines the number of rows to be processed before generating a notification event.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="7c3de-242">Intero della proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> oppure zero se la proprietà non è stata impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-242">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> property, or zero if the property has not been set.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-243">Questa proprietà è progettata per i componenti dell'interfaccia utente che illustrano l'avanzamento di un'operazione di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="7c3de-243">This property is designed for user interface components that illustrate the progress of a bulk copy operation.</span></span> <span data-ttu-id="7c3de-244">Indica il numero di righe da elaborare prima di generare un evento di notifica.</span><span class="sxs-lookup"><span data-stu-id="7c3de-244">It indicates the number of rows to be processed before generating a notification event.</span></span> <span data-ttu-id="7c3de-245">Il <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> proprietà può essere impostata in qualsiasi momento, anche durante un'operazione di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="7c3de-245">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property can be set at any time, even while a bulk copy operation is underway.</span></span> <span data-ttu-id="7c3de-246">Le modifiche apportate durante un'operazione di copia bulk effettive dopo la notifica successiva.</span><span class="sxs-lookup"><span data-stu-id="7c3de-246">Changes made during a bulk copy operation take effect after the next notification.</span></span> <span data-ttu-id="7c3de-247">La nuova impostazione si applica a tutte le operazioni successive nella stessa istanza.</span><span class="sxs-lookup"><span data-stu-id="7c3de-247">The new setting applies to all subsequent operations on the same instance.</span></span>  
  
 <span data-ttu-id="7c3de-248">Se <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> è impostata su un numero minore di zero, una <xref:System.ArgumentOutOfRangeException> viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-248">If <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> is set to a number less than zero, an <xref:System.ArgumentOutOfRangeException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-249">Nell'applicazione console riportata di seguito viene illustrato come caricamento bulk dei dati tramite una connessione che è già aperta.</span><span class="sxs-lookup"><span data-stu-id="7c3de-249">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="7c3de-250">Il <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> proprietà è impostata in modo che il gestore eventi viene chiamato dopo ogni 50 righe copiate nella tabella.</span><span class="sxs-lookup"><span data-stu-id="7c3de-250">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property is set so that the event handler is called after every 50 rows copied to the table.</span></span>  
  
 <span data-ttu-id="7c3de-251">In questo esempio, la connessione viene innanzitutto utilizzata per leggere i dati da una tabella di SQL Server in un <xref:System.Data.SqlClient.SqlDataReader> istanza.</span><span class="sxs-lookup"><span data-stu-id="7c3de-251">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="7c3de-252">Quindi una seconda connessione viene aperto per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-252">Then a second connection is opened to bulk copy the data.</span></span> <span data-ttu-id="7c3de-253">Si noti che i dati di origine non deve trovarsi in SQL Server. è possibile utilizzare qualsiasi origine dati che può essere letti per un <xref:System.Data.IDataReader> o caricare in un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-253">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-254">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-254">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-255">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-255">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-256">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-256">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="SqlRowsCopied">
      <MemberSignature Language="C#" Value="public event System.Data.SqlClient.SqlRowsCopiedEventHandler SqlRowsCopied;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Data.SqlClient.SqlRowsCopiedEventHandler SqlRowsCopied" />
      <MemberSignature Language="DocId" Value="E:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event SqlRowsCopied As SqlRowsCopiedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Data::SqlClient::SqlRowsCopiedEventHandler ^ SqlRowsCopied;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlRowsCopiedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-257">Si verifica ogni volta che sia stato elaborato il numero delle righe specificato dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-257">Occurs every time that the number of rows specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> property have been processed.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-258">Si noti che le impostazioni di <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> e <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> sono indipendenti.</span><span class="sxs-lookup"><span data-stu-id="7c3de-258">Note that the settings of <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> and <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> are independent.</span></span> <span data-ttu-id="7c3de-259">La ricezione di un <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> evento non implica che tutte le righe sono state inviate al server o il commit.</span><span class="sxs-lookup"><span data-stu-id="7c3de-259">Receipt of a <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event does not imply that any rows have been sent to the server or committed.</span></span>  
  
 <span data-ttu-id="7c3de-260">Non è possibile chiamare SqlBulkCopy. Close (<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A>) o SqlConnection (<xref:System.Data.SqlClient.SqlConnection.Close%2A>) da questo evento.</span><span class="sxs-lookup"><span data-stu-id="7c3de-260">You cannot call SqlBulkCopy.Close (<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A>) or SqlConnection.Close (<xref:System.Data.SqlClient.SqlConnection.Close%2A>) from this event.</span></span> <span data-ttu-id="7c3de-261">Questo determinerebbe un <xref:System.InvalidOperationException> viene generata un'eccezione e <xref:System.Data.SqlClient.SqlBulkCopy> non modificherà lo stato dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="7c3de-261">Doing this will cause an <xref:System.InvalidOperationException> being thrown, and the <xref:System.Data.SqlClient.SqlBulkCopy> object state will not change.</span></span> <span data-ttu-id="7c3de-262">Se l'utente decide di annullare l'operazione dall'evento, il <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> proprietà del <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs> può essere utilizzato.</span><span class="sxs-lookup"><span data-stu-id="7c3de-262">If the user wants to cancel the operation from the event, the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> property of the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs> can be used.</span></span> <span data-ttu-id="7c3de-263">(Vedere [delle transazioni e operazioni di copia Bulk](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md) per esempi che utilizzano il <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> proprietà.)</span><span class="sxs-lookup"><span data-stu-id="7c3de-263">(See [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md) for examples that use the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> property.)</span></span>  
  
 <span data-ttu-id="7c3de-264">Non è supportata alcuna azione, ad esempio attività di transazione nella connessione durante l'esecuzione dell'operazione di copia bulk e si consiglia di non utilizzare la stessa connessione utilizzata durante la <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> evento.</span><span class="sxs-lookup"><span data-stu-id="7c3de-264">No action, such as transaction activity, is supported in the connection during the execution of the bulk copy operation, and it is recommended that you not use the same connection used during the <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event.</span></span> <span data-ttu-id="7c3de-265">Tuttavia, è possibile aprire una connessione diversa.</span><span class="sxs-lookup"><span data-stu-id="7c3de-265">However, you can open a different connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-266">Nell'applicazione console riportata di seguito viene illustrato come caricamento bulk dei dati tramite una connessione che è già aperta.</span><span class="sxs-lookup"><span data-stu-id="7c3de-266">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="7c3de-267">Il <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> proprietà è impostata in modo che il gestore eventi viene chiamato dopo ogni 50 righe copiate nella tabella.</span><span class="sxs-lookup"><span data-stu-id="7c3de-267">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property is set so that the event handler is called after every 50 rows copied to the table.</span></span>  
  
 <span data-ttu-id="7c3de-268">In questo esempio, la connessione viene innanzitutto utilizzata per leggere i dati da una tabella di SQL Server in un <xref:System.Data.SqlClient.SqlDataReader> istanza.</span><span class="sxs-lookup"><span data-stu-id="7c3de-268">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="7c3de-269">Si noti che i dati di origine non deve trovarsi in SQL Server. è possibile utilizzare qualsiasi origine dati che può essere letti per un <xref:System.Data.IDataReader> o caricare in un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-269">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-270">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-270">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-271">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-271">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-272">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-272">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="System.IDisposable.Dispose">
      <MemberSignature Language="C#" Value="void IDisposable.Dispose ();" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.IDisposable.Dispose() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.System#IDisposable#Dispose" />
      <MemberSignature Language="VB.NET" Value="Sub Dispose () Implements IDisposable.Dispose" />
      <MemberSignature Language="C++ CLI" Value=" virtual void System.IDisposable.Dispose() = IDisposable::Dispose;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.IDisposable.Dispose</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-273">Rilascia tutte le risorse usate dall'istanza corrente della classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-273">Releases all resources used by the current instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-274">Chiamare il metodo `Dispose` dopo aver terminato di utilizzare l'oggetto <xref:System.Data.SqlClient.SqlBulkCopy>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-274">Call `Dispose` when you are finished using the <xref:System.Data.SqlClient.SqlBulkCopy>.</span></span> <span data-ttu-id="7c3de-275">Il metodo `Dispose` lascia l'oggetto <xref:System.Data.SqlClient.SqlBulkCopy> in una condizione di inutilizzabilità.</span><span class="sxs-lookup"><span data-stu-id="7c3de-275">The `Dispose` method leaves the <xref:System.Data.SqlClient.SqlBulkCopy> in an unusable state.</span></span> <span data-ttu-id="7c3de-276">Dopo la chiamata `Dispose`, è necessario rilasciare tutti i riferimenti al <xref:System.Data.SqlClient.SqlBulkCopy> in modo che il garbage collector può recuperare la memoria che di <xref:System.Data.SqlClient.SqlBulkCopy> occupata.</span><span class="sxs-lookup"><span data-stu-id="7c3de-276">After calling `Dispose`, you must release all references to the <xref:System.Data.SqlClient.SqlBulkCopy> so the garbage collector can reclaim the memory that the <xref:System.Data.SqlClient.SqlBulkCopy> was occupying.</span></span>  
  
 <span data-ttu-id="7c3de-277">Per ulteriori informazioni, vedere [la pulizia di risorse non gestite](~/docs/standard/garbage-collection/unmanaged.md) e [implementazione di un metodo Dispose](~/docs/standard/garbage-collection/implementing-dispose.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-277">For more information, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md) and [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7c3de-278">Chiamare sempre il metodo `Dispose` prima di rilasciare l'ultimo riferimento a <xref:System.Data.SqlClient.SqlBulkCopy>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-278">Always call `Dispose` before you release your last reference to the <xref:System.Data.SqlClient.SqlBulkCopy>.</span></span> <span data-ttu-id="7c3de-279">In caso contrario, le risorse utilizzate non verranno liberate finché il metodo <xref:System.Data.SqlClient.SqlBulkCopy> dell'oggetto `Finalize` non viene richiamato dal Garbage Collector.</span><span class="sxs-lookup"><span data-stu-id="7c3de-279">Otherwise, the resources it is using will not be freed until the garbage collector calls the <xref:System.Data.SqlClient.SqlBulkCopy> object's `Finalize` method.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteToServer">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-280">Copia tutte le righe da un'origine dati a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-280">Copies all rows from a data source to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-281">Se multiple active result set (MARS) è disabilitato, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> rende la connessione occupata.</span><span class="sxs-lookup"><span data-stu-id="7c3de-281">If multiple active result sets (MARS) is disabled, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> makes the connection busy.</span></span> <span data-ttu-id="7c3de-282">In caso contrario, è possibile eseguire chiamate a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> con altri comandi nella stessa connessione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-282">If MARS is enabled, you can interleave calls to <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> with other commands in the same connection.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.Common.DbDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.Common.DbDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (reader As DbDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::Common::DbDataReader ^ reader);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="7c3de-283">Oggetto <see cref="T:System.Data.Common.DbDataReader" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-283">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-284">Copia tutte le righe dalla matrice <see cref="T:System.Data.Common.DbDataReader" /> fornita in una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-284">Copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataRow[] rows);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataRow[] rows) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (rows As DataRow())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(cli::array &lt;System::Data::DataRow ^&gt; ^ rows);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" />
      </Parameters>
      <Docs>
        <param name="rows">
          <span data-ttu-id="7c3de-285">Matrice di oggetti <see cref="T:System.Data.DataRow" /> che verranno copiati nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-285">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-286">Copia tutte le righe dalla matrice <see cref="T:System.Data.DataRow" /> fornita in una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-286">Copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-287">Durante l'operazione di copia bulk, la destinazione associata <xref:System.Data.SqlClient.SqlConnection> è occupata e non possono essere eseguite altre operazioni nella connessione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-287">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="7c3de-288">Il <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> raccolta esegue il mapping tra il <xref:System.Data.DataRow> colonne alla tabella di database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-288">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataRow> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-289">Nell'applicazione console riportata di seguito viene illustrato come caricamento bulk dei dati da un <xref:System.Data.DataRow> matrice.</span><span class="sxs-lookup"><span data-stu-id="7c3de-289">The following console application demonstrates how to bulk load data from a <xref:System.Data.DataRow> array.</span></span> <span data-ttu-id="7c3de-290">La tabella di destinazione è una tabella di **AdventureWorks** database.</span><span class="sxs-lookup"><span data-stu-id="7c3de-290">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="7c3de-291">In questo esempio, un <xref:System.Data.DataTable> viene creato in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-291">In this example, a <xref:System.Data.DataTable> is created at run time.</span></span> <span data-ttu-id="7c3de-292">Viene selezionata una singola riga dal <xref:System.Data.DataTable> da copiare nella tabella di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-292">A single row is selected from the <xref:System.Data.DataTable> to copy to the destination table.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-293">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-293">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-294">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-294">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-295">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-295">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.RowArray#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.RowArray/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.RowArray#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.RowArray/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataTable table);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataTable table) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (table As DataTable)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::DataTable ^ table);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="7c3de-296">Oggetto <see cref="T:System.Data.DataTable" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-296">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-297">Copia tutte le righe dell'oggetto <see cref="T:System.Data.DataTable" /> fornito in una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-297">Copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-298">Tutte le righe di <xref:System.Data.DataTable> vengono copiate nella tabella di destinazione ad eccezione di quelli che sono stati eliminati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-298">All rows in the <xref:System.Data.DataTable> are copied to the destination table except those that have been deleted.</span></span>  
  
 <span data-ttu-id="7c3de-299">Durante l'operazione di copia bulk, la destinazione associata <xref:System.Data.SqlClient.SqlConnection> è occupata e non possono essere eseguite altre operazioni nella connessione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-299">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="7c3de-300">Il <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> raccolta esegue il mapping tra il <xref:System.Data.DataTable> colonne alla tabella di database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-300">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataTable> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-301">Nell'applicazione Console riportata di seguito viene illustrato come caricamento bulk dei dati da un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-301">The following Console application demonstrates how to bulk load data from a <xref:System.Data.DataTable>.</span></span> <span data-ttu-id="7c3de-302">La tabella di destinazione è una tabella di **AdventureWorks** database.</span><span class="sxs-lookup"><span data-stu-id="7c3de-302">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="7c3de-303">In questo esempio, un <xref:System.Data.DataTable> viene creato in fase di esecuzione ed è l'origine del `SqlBulkCopy` operazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-303">In this example, a <xref:System.Data.DataTable> is created at run time and is the source of the `SqlBulkCopy` operation.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-304">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-304">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-305">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-305">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-306">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-306">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.DataTable#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataTable/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.DataTable#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataTable/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.IDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.IDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (reader As IDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::IDataReader ^ reader);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="7c3de-307">Oggetto <see cref="T:System.Data.IDataReader" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-307">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-308">Copia tutte le righe dell'oggetto <see cref="T:System.Data.IDataReader" /> fornito in una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-308">Copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-309">L'operazione di copia ha inizio alla successiva riga disponibile nel lettore.</span><span class="sxs-lookup"><span data-stu-id="7c3de-309">The copy operation starts at the next available row in the reader.</span></span> <span data-ttu-id="7c3de-310">La maggior parte dei casi, il lettore è appena stato restituito da <xref:System.Data.IDbCommand.ExecuteReader%2A> o una chiamata simile, pertanto la successiva riga disponibile è la prima riga.</span><span class="sxs-lookup"><span data-stu-id="7c3de-310">Most of the time, the reader was just returned by <xref:System.Data.IDbCommand.ExecuteReader%2A> or a similar call, so the next available row is the first row.</span></span> <span data-ttu-id="7c3de-311">Per elaborare più risultati, chiamare <xref:System.Data.IDataReader.NextResult%2A> sul lettore di dati e chiamare <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> nuovamente.</span><span class="sxs-lookup"><span data-stu-id="7c3de-311">To process multiple results, call <xref:System.Data.IDataReader.NextResult%2A> on the data reader and call <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> again.</span></span>  
  
 <span data-ttu-id="7c3de-312">Si noti che l'utilizzo <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> viene modificato lo stato del lettore.</span><span class="sxs-lookup"><span data-stu-id="7c3de-312">Note that using <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> modifies the state of the reader.</span></span> <span data-ttu-id="7c3de-313">Il metodo chiama il metodo <xref:System.Data.IDataReader.Read%2A> fino a quando non viene restituito false, l'operazione viene interrotta o si verifica un errore.</span><span class="sxs-lookup"><span data-stu-id="7c3de-313">The method will call <xref:System.Data.IDataReader.Read%2A> until it returns false, the operation is aborted, or an error occurs.</span></span> <span data-ttu-id="7c3de-314">Ciò significa che il lettore di dati sarà in uno stato diverso, probabilmente alla fine del set di risultati, quando il <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="7c3de-314">This means that the data reader will be in a different state, probably at the end of the result set, when the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is complete.</span></span>  
  
 <span data-ttu-id="7c3de-315">Durante l'operazione di copia bulk, la destinazione associata <xref:System.Data.SqlClient.SqlConnection> è occupata e non possono essere eseguite altre operazioni nella connessione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-315">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="7c3de-316">Il <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> raccolta esegue il mapping dai dati lettore colonne alla tabella di database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-316">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the data reader columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-317">Nell'applicazione console riportata di seguito viene illustrato come caricamento bulk dei dati da un <xref:System.Data.SqlClient.SqlDataReader>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-317">The following console application demonstrates how to bulk load data from a <xref:System.Data.SqlClient.SqlDataReader>.</span></span> <span data-ttu-id="7c3de-318">La tabella di destinazione è una tabella di **AdventureWorks** database.</span><span class="sxs-lookup"><span data-stu-id="7c3de-318">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-319">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-319">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-320">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-320">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-321">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-321">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataTable table, System.Data.DataRowState rowState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (table As DataTable, rowState As DataRowState)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::DataTable ^ table, System::Data::DataRowState rowState);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="7c3de-322">Oggetto <see cref="T:System.Data.DataTable" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-322">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="rowState">
          <span data-ttu-id="7c3de-323">Valore ricavato dall'enumerazione <see cref="T:System.Data.DataRowState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-323">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span>
          </span>
          <span data-ttu-id="7c3de-324">Solo le righe corrispondenti allo stato della riga vengono copiate nella destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-324">Only rows matching the row state are copied to the destination.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-325">Copia solo le righe dell'oggetto <see cref="T:System.Data.DataTable" /> corrispondenti allo stato della riga fornito in una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-325">Copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-326">Solo le righe del <xref:System.Data.DataTable> che sono nello stato indicato nel `rowState` argomento e non sono stati eliminati vengono copiate nella tabella di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-326">Only rows in the <xref:System.Data.DataTable> that are in the states indicated in the `rowState` argument and have not been deleted are copied to the destination table.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7c3de-327">Se <xref:System.Data.DataRowState.Deleted> è specificato, qualsiasi <xref:System.Data.DataRowState.Unchanged>, <xref:System.Data.DataRowState.Added>, e <xref:System.Data.DataRowState.Modified> righe verranno copiate anche al server.</span><span class="sxs-lookup"><span data-stu-id="7c3de-327">If <xref:System.Data.DataRowState.Deleted> is specified, any <xref:System.Data.DataRowState.Unchanged>, <xref:System.Data.DataRowState.Added>, and <xref:System.Data.DataRowState.Modified> rows will also be copied to the server.</span></span> <span data-ttu-id="7c3de-328">Verrà generata alcuna eccezione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-328">No exception will be raised.</span></span>  
  
 <span data-ttu-id="7c3de-329">Durante l'operazione di copia bulk, la destinazione associata <xref:System.Data.SqlClient.SqlConnection> è occupata e non possono essere eseguite altre operazioni nella connessione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-329">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="7c3de-330">Il <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> raccolta esegue il mapping tra il <xref:System.Data.DataTable> colonne alla tabella di database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-330">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataTable> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="7c3de-331">La Console seguente viene illustrato come eseguire bulk caricare solo le righe in un <xref:System.Data.DataTable> che corrispondono a uno stato specificato.</span><span class="sxs-lookup"><span data-stu-id="7c3de-331">The following Console application demonstrates how to bulk load only the rows in a <xref:System.Data.DataTable> that match a specified state.</span></span> <span data-ttu-id="7c3de-332">In questo caso, vengono aggiunti solo le righe non modificate.</span><span class="sxs-lookup"><span data-stu-id="7c3de-332">In this case, only unchanged rows are added.</span></span> <span data-ttu-id="7c3de-333">La tabella di destinazione è una tabella di **AdventureWorks** database.</span><span class="sxs-lookup"><span data-stu-id="7c3de-333">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="7c3de-334">In questo esempio, un <xref:System.Data.DataTable> viene creato in fase di esecuzione e tre righe vengono aggiunte a esso.</span><span class="sxs-lookup"><span data-stu-id="7c3de-334">In this example, a <xref:System.Data.DataTable> is created at run time and three rows are added to it.</span></span> <span data-ttu-id="7c3de-335">Prima di <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> metodo viene eseguito, viene modificata una delle righe.</span><span class="sxs-lookup"><span data-stu-id="7c3de-335">Before the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is executed, one of the rows is edited.</span></span> <span data-ttu-id="7c3de-336">Il <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> metodo viene chiamato con un `DataRowState.Unchanged` `rowState` argomento, in modo che solo le due righe non modificate vengono copiate nella destinazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-336">The <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is called with a `DataRowState.Unchanged` `rowState` argument, so only the two unchanged rows are bulk copied to the destination.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7c3de-337">Questo esempio non verrà eseguito a meno che non state create le tabelle di lavoro come descritto in [l'installazione di esempio copia Bulk](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-337">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="7c3de-338">Questo codice viene fornito per illustrare la sintassi per l'utilizzo di **SqlBulkCopy** solo.</span><span class="sxs-lookup"><span data-stu-id="7c3de-338">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="7c3de-339">Se le tabelle di origine e destinazione sono nella stessa istanza di SQL Server, è più semplice e rapido usare Transact-SQL `INSERT … SELECT` istruzione per copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="7c3de-339">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.DataRowState#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataRowState/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.DataRowState#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataRowState/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Data.DataRowState" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteToServerAsync">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="7c3de-340">Una versione asincrona di <see cref="Overload:System.Data.SqlClient.SqlBulkCopy.WriteToServer" /> che copia tutte le righe da un'origine dati a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-340">An asynchronous version of <see cref="Overload:System.Data.SqlClient.SqlBulkCopy.WriteToServer" />, which copies all rows from a data source to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-341">Se multiple active result set (MARS) è disabilitato, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> rende la connessione occupata.</span><span class="sxs-lookup"><span data-stu-id="7c3de-341">If multiple active result sets (MARS) is disabled, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> makes the connection busy.</span></span> <span data-ttu-id="7c3de-342">In caso contrario, è possibile eseguire chiamate a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> con altri comandi nella stessa connessione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-342">If MARS is enabled, you can interleave calls to <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> with other commands in the same connection.</span></span>  
  
 <span data-ttu-id="7c3de-343">Il numero di righe che viene eseguito il rollback di uno non dipende da quanto segue:</span><span class="sxs-lookup"><span data-stu-id="7c3de-343">The number of rows that are rolled back when one fails depends on several things:</span></span>  
  
-   <span data-ttu-id="7c3de-344">Se <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> è specificato.</span><span class="sxs-lookup"><span data-stu-id="7c3de-344">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is specified.</span></span>  
  
-   <span data-ttu-id="7c3de-345">Se si ha la propria transazione.</span><span class="sxs-lookup"><span data-stu-id="7c3de-345">If you have your own transaction.</span></span>  
  
-   <span data-ttu-id="7c3de-346">Valore di <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="7c3de-346">The value of <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span></span>  
  
 <span data-ttu-id="7c3de-347">Quando si verifica un errore durante l'invio di dati al server, il batch corrente (come specificato da <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>) eseguire il rollback.</span><span class="sxs-lookup"><span data-stu-id="7c3de-347">When there is an error while sending data to the server, the current batch (as specified by <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>) will be rolled back.</span></span> <span data-ttu-id="7c3de-348">Se <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> non è specificato e la propria transazione, l'intera transazione sarà possibile eseguire il rollback (che include anche tutti i batch precedenti).</span><span class="sxs-lookup"><span data-stu-id="7c3de-348">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is not specified and you have your own transaction, the entire transaction will be rolled back (which includes all previous batches as well).</span></span>  
  
 <span data-ttu-id="7c3de-349">Utilizzare <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> conoscere il numero di righe copiato nel server.</span><span class="sxs-lookup"><span data-stu-id="7c3de-349">Use <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> to know how many rows were copied to the server.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.Common.DbDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.Common.DbDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (reader As DbDataReader) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::Common::DbDataReader ^ reader);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="7c3de-350">Oggetto <see cref="T:System.Data.Common.DbDataReader" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-350">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-351">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" /> che copia tutte le righe dalla matrice <see cref="T:System.Data.Common.DbDataReader" /> fornita a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-351">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, which copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-352">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-352">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataRow[] rows);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataRow[] rows) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (rows As DataRow()) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(cli::array &lt;System::Data::DataRow ^&gt; ^ rows);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" />
      </Parameters>
      <Docs>
        <param name="rows">
          <span data-ttu-id="7c3de-353">Matrice di oggetti <see cref="T:System.Data.DataRow" /> che verranno copiati nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-353">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-354">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> che copia tutte le righe dalla matrice <see cref="T:System.Data.DataRow" /> fornita a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-354">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, which copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-355">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-355">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-356">Per ulteriori informazioni sulla programmazione asincrona nel [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Provider di dati per [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-356">For more information about asynchronous programming in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Data Provider for [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="7c3de-357">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-357">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-358">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> e <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-358">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-359">La connessione viene eliminata o chiusa durante l'esecuzione di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-359">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> execution.</span>
          </span>
          <span data-ttu-id="7c3de-360">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> è stato chiuso durante l'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-360">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="7c3de-361">Restituito nell'oggetto attività, si è verificato un timeout del pool di connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-361">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="7c3de-362">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> viene chiuso prima dell'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-362">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="7c3de-363">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-363">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="7c3de-364">Restituito nell'oggetto attività, qualsiasi errore restituito da [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] che si è verificato durante l'apertura della connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-364">Returned in the task object, any error returned by [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (table As DataTable) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="7c3de-365">Oggetto <see cref="T:System.Data.DataTable" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-365">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-366">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> che copia tutte le righe nella matrice <see cref="T:System.Data.DataTable" /> fornita a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-366">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, which copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-367">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-367">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-368">Per ulteriori informazioni sulla programmazione asincrona nel [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Provider di dati per [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-368">For more information about asynchronous programming in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Data Provider for [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="7c3de-369">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-369">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-370">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> e <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-370">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-371">La connessione viene eliminata o chiusa durante l'esecuzione di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-371">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> execution.</span>
          </span>
          <span data-ttu-id="7c3de-372">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> è stato chiuso durante l'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-372">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="7c3de-373">Restituito nell'oggetto attività, si è verificato un timeout del pool di connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-373">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="7c3de-374">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> viene chiuso prima dell'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-374">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="7c3de-375">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-375">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="7c3de-376">Restituito nell'oggetto attività, qualsiasi errore restituito da [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] che si è verificato durante l'apertura della connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-376">Returned in the task object, any error returned by [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.IDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.IDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (reader As IDataReader) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::IDataReader ^ reader);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="7c3de-377">Oggetto <see cref="T:System.Data.IDataReader" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-377">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-378">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> che copia tutte le righe nella matrice <see cref="T:System.Data.IDataReader" /> fornita a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-378">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, which copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-379">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-379">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-380">Per ulteriori informazioni sulla programmazione asincrona nel [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Provider di dati per [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-380">For more information about asynchronous programming in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Data Provider for [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="7c3de-381">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-381">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-382">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> e <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-382">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-383">La connessione viene eliminata o chiusa durante l'esecuzione di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-383">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> execution.</span>
          </span>
          <span data-ttu-id="7c3de-384">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> è stato chiuso durante l'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-384">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="7c3de-385">Restituito nell'oggetto attività, si è verificato un timeout del pool di connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-385">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="7c3de-386">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> viene chiuso prima dell'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-386">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="7c3de-387">L'oggetto <see cref="T:System.Data.IDataReader" /> è stato chiuso prima della restituzione dell'oggetto <see cref="T:System.Threading.Tasks.Task" /> completato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-387">The <see cref="T:System.Data.IDataReader" /> was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span>
          </span>
          <span data-ttu-id="7c3de-388">La connessione associata dell'oggetto <see cref="T:System.Data.IDataReader" /> è stata chiusa prima che sia stato restituito l'oggetto <see cref="T:System.Threading.Tasks.Task" /> completato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-388">The <see cref="T:System.Data.IDataReader" />'s associated connection was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span>
          </span>
          <span data-ttu-id="7c3de-389">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-389">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="7c3de-390">Restituito nell'oggetto attività, qualsiasi errore restituito da [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] che si è verificato durante l'apertura della connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-390">Returned in the task object, any error returned by [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.Common.DbDataReader reader, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.Common.DbDataReader reader, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::Common::DbDataReader ^ reader, System::Threading::CancellationToken cancellationToken);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="7c3de-391">Oggetto <see cref="T:System.Data.Common.DbDataReader" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-391">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="7c3de-392">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-392">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="7c3de-393">Il valore <see cref="P:System.Threading.CancellationToken.None" /> in questo parametro rende il metodo equivalente a <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-393">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-394">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" /> che copia tutte le righe dalla matrice <see cref="T:System.Data.Common.DbDataReader" /> fornita a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-394">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, which copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-395">Restituisce <see cref="T:System.Threading.Tasks.Task" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-395">Returns <see cref="T:System.Threading.Tasks.Task" />.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataRow[] rows, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataRow[] rows, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[],System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(cli::array &lt;System::Data::DataRow ^&gt; ^ rows, System::Threading::CancellationToken cancellationToken);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="rows">
          <span data-ttu-id="7c3de-396">Matrice di oggetti <see cref="T:System.Data.DataRow" /> che verranno copiati nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-396">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="7c3de-397">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-397">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="7c3de-398">Il valore <see cref="P:System.Threading.CancellationToken.None" /> in questo parametro rende il metodo equivalente a <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-398">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-399">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> che copia tutte le righe dalla matrice <see cref="T:System.Data.DataRow" /> fornita a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-399">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, which copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
          <span data-ttu-id="7c3de-400">Il token di annullamento può essere usato per richiedere che l'operazione venga abbandonata prima del timeout del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-400">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="7c3de-401">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-401">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-402">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-402">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-403">Per ulteriori informazioni sulla programmazione asincrona nel [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Provider di dati per [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-403">For more information about asynchronous programming in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Data Provider for [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="7c3de-404">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-404">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-405">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> e <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-405">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-406">La connessione viene eliminata o chiusa durante l'esecuzione di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-406">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> execution.</span>
          </span>
          <span data-ttu-id="7c3de-407">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> è stato chiuso durante l'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-407">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="7c3de-408">Restituito nell'oggetto attività, si è verificato un timeout del pool di connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-408">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="7c3de-409">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> viene chiuso prima dell'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-409">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="7c3de-410">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-410">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="7c3de-411">Restituito nell'oggetto attività, qualsiasi errore restituito da [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] che si è verificato durante l'apertura della connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-411">Returned in the task object, any error returned by [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Data.DataRowState rowState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (table As DataTable, rowState As DataRowState) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Data::DataRowState rowState);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="7c3de-412">Oggetto <see cref="T:System.Data.DataTable" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-412">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="rowState">
          <span data-ttu-id="7c3de-413">Valore ricavato dall'enumerazione <see cref="T:System.Data.DataRowState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-413">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span>
          </span>
          <span data-ttu-id="7c3de-414">Solo le righe corrispondenti allo stato della riga vengono copiate nella destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-414">Only rows matching the row state are copied to the destination.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-415">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> che copia solo le righe corrispondenti allo stato della riga nella matrice <see cref="T:System.Data.DataTable" /> fornita in una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-415">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, which copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-416">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-416">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-417">Per ulteriori informazioni sulla programmazione asincrona nel [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Provider di dati per [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-417">For more information about asynchronous programming in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Data Provider for [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="7c3de-418">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-418">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-419">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> e <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-419">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-420">La connessione viene eliminata o chiusa durante l'esecuzione di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-420">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> execution.</span>
          </span>
          <span data-ttu-id="7c3de-421">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> è stato chiuso durante l'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-421">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="7c3de-422">Restituito nell'oggetto attività, si è verificato un timeout del pool di connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-422">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="7c3de-423">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> viene chiuso prima dell'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-423">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="7c3de-424">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-424">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="7c3de-425">Restituito nell'oggetto attività, qualsiasi errore restituito da [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] che si è verificato durante l'apertura della connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-425">Returned in the task object, any error returned by [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Threading::CancellationToken cancellationToken);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="7c3de-426">Oggetto <see cref="T:System.Data.DataTable" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-426">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="7c3de-427">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-427">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="7c3de-428">Il valore <see cref="P:System.Threading.CancellationToken.None" /> in questo parametro rende il metodo equivalente a <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-428">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-429">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> che copia tutte le righe nella matrice <see cref="T:System.Data.DataTable" /> fornita a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-429">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, which copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
          <span data-ttu-id="7c3de-430">Il token di annullamento può essere usato per richiedere che l'operazione venga abbandonata prima del timeout del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-430">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="7c3de-431">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-431">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-432">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-432">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-433">Per ulteriori informazioni sulla programmazione asincrona nel [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Provider di dati per [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-433">For more information about asynchronous programming in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Data Provider for [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="7c3de-434">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-434">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-435">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> e <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-435">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-436">La connessione viene eliminata o chiusa durante l'esecuzione di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-436">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> execution.</span>
          </span>
          <span data-ttu-id="7c3de-437">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> è stato chiuso durante l'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-437">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="7c3de-438">Restituito nell'oggetto attività, si è verificato un timeout del pool di connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-438">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="7c3de-439">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> viene chiuso prima dell'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-439">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="7c3de-440">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-440">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="7c3de-441">Restituito nell'oggetto attività, qualsiasi errore restituito da [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] che si è verificato durante l'apertura della connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-441">Returned in the task object, any error returned by [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.IDataReader reader, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.IDataReader reader, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::IDataReader ^ reader, System::Threading::CancellationToken cancellationToken);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="7c3de-442">Oggetto <see cref="T:System.Data.IDataReader" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-442">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="7c3de-443">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-443">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="7c3de-444">Il valore <see cref="P:System.Threading.CancellationToken.None" /> in questo parametro rende il metodo equivalente a <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-444">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-445">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> che copia tutte le righe nella matrice <see cref="T:System.Data.IDataReader" /> fornita a una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-445">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, which copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
          <span data-ttu-id="7c3de-446">Il token di annullamento può essere usato per richiedere che l'operazione venga abbandonata prima del timeout del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-446">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="7c3de-447">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-447">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-448">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-448">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-449">Per ulteriori informazioni sulla programmazione asincrona nel [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Provider di dati per [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-449">For more information about asynchronous programming in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Data Provider for [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="7c3de-450">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-450">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-451">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> e <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-451">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-452">La connessione viene eliminata o chiusa durante l'esecuzione di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-452">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> execution.</span>
          </span>
          <span data-ttu-id="7c3de-453">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> è stato chiuso durante l'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-453">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="7c3de-454">Restituito nell'oggetto attività, si è verificato un timeout del pool di connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-454">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="7c3de-455">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> viene chiuso prima dell'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-455">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="7c3de-456">L'oggetto <see cref="T:System.Data.IDataReader" /> è stato chiuso prima della restituzione dell'oggetto <see cref="T:System.Threading.Tasks.Task" /> completato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-456">The <see cref="T:System.Data.IDataReader" /> was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span>
          </span>
          <span data-ttu-id="7c3de-457">La connessione associata dell'oggetto <see cref="T:System.Data.IDataReader" /> è stata chiusa prima che sia stato restituito l'oggetto <see cref="T:System.Threading.Tasks.Task" /> completato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-457">The <see cref="T:System.Data.IDataReader" />'s associated connection was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span>
          </span>
          <span data-ttu-id="7c3de-458">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-458">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="7c3de-459">Restituito nell'oggetto attività, qualsiasi errore restituito da [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] che si è verificato durante l'apertura della connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-459">Returned in the task object, any error returned by [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Data.DataRowState rowState, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Data::DataRowState rowState, System::Threading::CancellationToken cancellationToken);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="7c3de-460">Oggetto <see cref="T:System.Data.DataTable" /> le cui righe vengono copiate nella tabella di destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-460">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="rowState">
          <span data-ttu-id="7c3de-461">Valore ricavato dall'enumerazione <see cref="T:System.Data.DataRowState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-461">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span>
          </span>
          <span data-ttu-id="7c3de-462">Solo le righe corrispondenti allo stato della riga vengono copiate nella destinazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-462">Only rows matching the row state are copied to the destination.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="7c3de-463">L'istruzione di annullamento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-463">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="7c3de-464">Il valore <see cref="P:System.Threading.CancellationToken.None" /> in questo parametro rende il metodo equivalente a <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-464">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7c3de-465">Versione asincrona di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> che copia solo le righe corrispondenti allo stato della riga nella matrice <see cref="T:System.Data.DataTable" /> fornita in una tabella di destinazione specificata dalla proprietà <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> dell'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-465">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, which copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
          <span data-ttu-id="7c3de-466">Il token di annullamento può essere usato per richiedere che l'operazione venga abbandonata prima del timeout del comando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-466">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="7c3de-467">Le eccezioni verranno segnalate tramite l'oggetto attività restituito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-467">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7c3de-468">Attività che rappresenta l'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-468">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7c3de-469">Per ulteriori informazioni sulla programmazione asincrona nel [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Provider di dati per [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], vedere [programmazione asincrona](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="7c3de-469">For more information about asynchronous programming in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Data Provider for [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)], see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="7c3de-470">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> più volte per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-470">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-471">Chiamare <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> e <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> per la stessa istanza prima del completamento dell'attività.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-471">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="7c3de-472">La connessione viene eliminata o chiusa durante l'esecuzione di <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-472">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> execution.</span>
          </span>
          <span data-ttu-id="7c3de-473">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> è stato chiuso durante l'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-473">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="7c3de-474">Restituito nell'oggetto attività, si è verificato un timeout del pool di connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-474">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="7c3de-475">Restituito nell'oggetto attività, l'oggetto <see cref="T:System.Data.SqlClient.SqlConnection" /> viene chiuso prima dell'esecuzione del metodo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-475">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="7c3de-476">
            <see langword="Context Connection=true" /> è specificato nella stringa di connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-476">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="7c3de-477">Restituito nell'oggetto attività, qualsiasi errore restituito da [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] che si è verificato durante l'apertura della connessione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="7c3de-477">Returned in the task object, any error returned by [!INCLUDE[ssNoVersion](~/includes/ssnoversion-md.md)] that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
  </Members>
</Type>