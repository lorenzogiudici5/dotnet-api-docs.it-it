<Type Name="MessageQueue" FullName="System.Messaging.MessageQueue">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="c3cea7cb79bd35bfc3544b467a76a8ca2a8133cd" />
    <Meta Name="ms.sourcegitcommit" Value="0ec122ee5f3681159b8460ab15b409fd6e3d3ae0" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="it-IT" />
    <Meta Name="ms.lasthandoff" Value="10/04/2018" />
    <Meta Name="ms.locfileid" Value="48649473" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class MessageQueue : System.ComponentModel.Component, System.Collections.IEnumerable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit MessageQueue extends System.ComponentModel.Component implements class System.Collections.IEnumerable" />
  <TypeSignature Language="DocId" Value="T:System.Messaging.MessageQueue" />
  <TypeSignature Language="VB.NET" Value="Public Class MessageQueue&#xA;Inherits Component&#xA;Implements IEnumerable" />
  <TypeSignature Language="C++ CLI" Value="public ref class MessageQueue : System::ComponentModel::Component, System::Collections::IEnumerable" />
  <TypeSignature Language="F#" Value="type MessageQueue = class&#xA;    inherit Component&#xA;    interface IEnumerable" />
  <AssemblyInfo>
    <AssemblyName>System.Messaging</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.Collections.IEnumerable</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.DefaultEvent("ReceiveCompleted")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Messaging.MessageQueueInstaller))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageQueueConverter))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Designer("Microsoft.VisualStudio.Install.MessageQueueInstallableComponentDesigner, Microsoft.VisualStudio, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.Messaging.MessagingDescription("MessageQueueDesc")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="e0ac9-101">Fornisce l'accesso a una coda su un server di Accodamento messaggi.</span>
      <span class="sxs-lookup">
        <span data-stu-id="e0ac9-101">Provides access to a queue on a Message Queuing server.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-102">La tecnologia di Accodamento messaggi consente alle applicazioni eseguite in momenti diversi di comunicare su reti eterogenee e sistemi che potrebbero essere temporaneamente offline.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-102">The Message Queuing technology allows applications running at different times to communicate across heterogeneous networks and systems that might be temporarily offline.</span></span> <span data-ttu-id="e0ac9-103">Viene inviato dalle applicazioni, ricevere o leggere i messaggi dalle code (sola lettura senza rimuoverlo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-103">Applications send, receive, or peek (read without removing) messages from queues.</span></span> <span data-ttu-id="e0ac9-104">Il servizio Accodamento messaggi è un componente facoltativo di [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] e Windows NT e deve essere installato separatamente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-104">Message Queuing is an optional component of [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] and Windows NT, and must be installed separately.</span></span>  
  
 <span data-ttu-id="e0ac9-105">Il <xref:System.Messaging.MessageQueue> classe è un wrapper per il servizio Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-105">The <xref:System.Messaging.MessageQueue> class is a wrapper around Message Queuing.</span></span> <span data-ttu-id="e0ac9-106">Sono disponibili più versioni di Accodamento messaggi e l'utilizzo di <xref:System.Messaging.MessageQueue> classe può provocare un comportamento leggermente diverso, a seconda del sistema operativo in uso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-106">There are multiple versions of Message Queuing, and using the <xref:System.Messaging.MessageQueue> class can result in slightly different behavior, depending on the operating system you are using.</span></span> <span data-ttu-id="e0ac9-107">Per informazioni sulle funzionalità specifiche di ogni versione di Microsoft Message Queuing, vedere l'argomento "What' s New in Accodamento messaggi" in Platform SDK in MSDN.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-107">For information about specific features of each version of Message Queuing, see the topic "What's New in Message Queuing" in the Platform SDK in MSDN.</span></span>  
  
 <span data-ttu-id="e0ac9-108">Il <xref:System.Messaging.MessageQueue> classe fornisce un riferimento a una coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-108">The <xref:System.Messaging.MessageQueue> class provides a reference to a Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-109">È possibile specificare un percorso nel <xref:System.Messaging.MessageQueue.%23ctor%2A> costruttore per la connessione a una risorsa esistente, oppure è possibile creare una nuova coda nel server.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-109">You can specify a path in the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor to connect to an existing resource, or you can create a new queue on the server.</span></span> <span data-ttu-id="e0ac9-110">Prima di chiamare <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, o <xref:System.Messaging.MessageQueue.Receive%2A>, è necessario associare la nuova istanza del <xref:System.Messaging.MessageQueue> classe con una coda esistente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-110">Before you can call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, you must associate the new instance of the <xref:System.Messaging.MessageQueue> class with an existing queue.</span></span> <span data-ttu-id="e0ac9-111">A questo punto, è possibile modificare le proprietà della coda, ad esempio <xref:System.Messaging.MessageQueue.Category%2A> e <xref:System.Messaging.MessageQueue.Label%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-111">At that point, you can manipulate the queue properties such as <xref:System.Messaging.MessageQueue.Category%2A> and <xref:System.Messaging.MessageQueue.Label%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-112"><xref:System.Messaging.MessageQueue> supporta due tipi di recupero dei messaggi: sincrone e asincrone.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-112"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="e0ac9-113">I metodi sincroni <xref:System.Messaging.MessageQueue.Peek%2A> e <xref:System.Messaging.MessageQueue.Receive%2A>, provoca l'intervallo di tempo specificato per un nuovo messaggio in arrivo nella coda di attesa del thread di processo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-113">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-114">I metodi asincroni <xref:System.Messaging.MessageQueue.BeginPeek%2A> e <xref:System.Messaging.MessageQueue.BeginReceive%2A>, consentire le attività principale dell'applicazione in un thread separato fino a un messaggio arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-114">The asynchronous methods, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A>, allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-115">Questi metodi funzionano con gli oggetti di callback e oggetti di stato per comunicare informazioni tra i thread.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-115">These methods work by using callback objects and state objects to communicate information between threads.</span></span>  
  
 <span data-ttu-id="e0ac9-116">Quando si crea una nuova istanza di <xref:System.Messaging.MessageQueue> (classe), non si sta creando una nuova coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-116">When you create a new instance of the <xref:System.Messaging.MessageQueue> class, you are not creating a new Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-117">In alternativa, è possibile usare la <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, e <xref:System.Messaging.MessageQueue.Purge%2A> metodi per gestire le code sul server.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-117">Instead, you can use the <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, and <xref:System.Messaging.MessageQueue.Purge%2A> methods to manage queues on the server.</span></span>  
  
 <span data-ttu-id="e0ac9-118">A differenza <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> e <xref:System.Messaging.MessageQueue.Delete%28System.String%29> sono `static` membri, in modo da chiamarle senza creare una nuova istanza di <xref:System.Messaging.MessageQueue> classe.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-118">Unlike <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> and <xref:System.Messaging.MessageQueue.Delete%28System.String%29> are `static` members, so you can call them without creating a new instance of the <xref:System.Messaging.MessageQueue> class.</span></span>  
  
 <span data-ttu-id="e0ac9-119">È possibile impostare il <xref:System.Messaging.MessageQueue> dell'oggetto <xref:System.Messaging.MessageQueue.Path%2A> proprietà con uno dei tre nomi: il nome descrittivo, il <xref:System.Messaging.MessageQueue.FormatName%2A>, o <xref:System.Messaging.MessageQueue.Label%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-119">You can set the <xref:System.Messaging.MessageQueue> object's <xref:System.Messaging.MessageQueue.Path%2A> property with one of three names: the friendly name, the <xref:System.Messaging.MessageQueue.FormatName%2A>, or the <xref:System.Messaging.MessageQueue.Label%2A>.</span></span> <span data-ttu-id="e0ac9-120">Il nome descrittivo, che viene definito per la coda <xref:System.Messaging.MessageQueue.MachineName%2A> e <xref:System.Messaging.MessageQueue.QueueName%2A> delle proprietà, viene <xref:System.Messaging.MessageQueue.MachineName%2A> \\ <xref:System.Messaging.MessageQueue.QueueName%2A> per una coda pubblica, e <xref:System.Messaging.MessageQueue.MachineName%2A> \\ `Private$` \\ <xref:System.Messaging.MessageQueue.QueueName%2A> per una coda privata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-120">The friendly name, which is defined by the queue's <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties, is <xref:System.Messaging.MessageQueue.MachineName%2A>\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a public queue, and <xref:System.Messaging.MessageQueue.MachineName%2A>\\`Private$`\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a private queue.</span></span> <span data-ttu-id="e0ac9-121">Il <xref:System.Messaging.MessageQueue.FormatName%2A> proprietà consente l'accesso offline per le code di messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-121">The <xref:System.Messaging.MessageQueue.FormatName%2A> property allows offline access to message queues.</span></span> <span data-ttu-id="e0ac9-122">Infine, è possibile usare la coda <xref:System.Messaging.MessageQueue.Label%2A> proprietà per impostare la coda <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-122">Lastly, you can use the queue's <xref:System.Messaging.MessageQueue.Label%2A> property to set the queue's <xref:System.Messaging.MessageQueue.Path%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-123">Per un elenco di valori di proprietà iniziali per un'istanza di <xref:System.Messaging.MessageQueue>, vedere il <xref:System.Messaging.MessageQueue.%23ctor%2A> costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-123">For a list of initial property values for an instance of <xref:System.Messaging.MessageQueue>, see the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-124">Esempio di codice seguente crea nuovi <xref:System.Messaging.MessageQueue> di oggetti usando vari tipi di sintassi di nome di percorso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-124">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="e0ac9-125">In ogni caso, viene inviato un messaggio nella coda cui percorso viene definita nel costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-125">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 <span data-ttu-id="e0ac9-126">Esempio di codice seguente invia un messaggio a una coda e riceve un messaggio da una coda, utilizzando una classe specifica dell'applicazione denominata `Order`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-126">The following code example sends a message to a queue, and receives a message from a queue, using an application-specific class called `Order`.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
    </remarks>
    <threadsafe>
      <span data-ttu-id="e0ac9-127">Solo il <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> metodo è thread-safe.</span>
      <span class="sxs-lookup">
        <span data-stu-id="e0ac9-127">Only the <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> method is thread safe.</span>
      </span>
    </threadsafe>
    <altmember cref="T:System.Messaging.Message" />
    <altmember cref="T:System.Messaging.DefaultPropertiesToSend" />
    <altmember cref="T:System.Messaging.MessageQueueException" />
    <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
    <altmember cref="M:System.Messaging.MessageQueue.Peek" />
    <altmember cref="M:System.Messaging.MessageQueue.Receive" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
    <altmember cref="P:System.Messaging.MessageQueue.Path" />
    <altmember cref="P:System.Messaging.MessageQueue.Label" />
    <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
    <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
    <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-128">Inizializza una nuova istanza della classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-128">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-129">Inizializza una nuova istanza della classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-129">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
          <span data-ttu-id="e0ac9-130">Dopo che il costruttore predefinito ha inizializzato la nuova istanza, sarà necessario impostare la proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> dell'istanza prima di poterla utilizzare.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-130">After the default constructor initializes the new instance, you must set the instance's <see cref="P:System.Messaging.MessageQueue.Path" /> property before you can use the instance.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-131">Utilizzare questo overload per creare una nuova istanza di <xref:System.Messaging.MessageQueue> classe che non è immediatamente associati a una coda nel server di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-131">Use this overload to create a new instance of the <xref:System.Messaging.MessageQueue> class that is not immediately tied to a queue on the Message Queuing server.</span></span> <span data-ttu-id="e0ac9-132">Prima di usare questa istanza, è necessario connetterla a una coda di Accodamento esistente impostando il <xref:System.Messaging.MessageQueue.Path%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-132">Before using this instance, you must connect it to an existing Message Queuing queue by setting the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="e0ac9-133">In alternativa, è possibile impostare il <xref:System.Messaging.MessageQueue> un riferimento di <xref:System.Messaging.MessageQueue.Create%28System.String%29> valore restituito del metodo, in modo da creare una nuova coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-133">Alternatively, you can set the <xref:System.Messaging.MessageQueue> reference to the <xref:System.Messaging.MessageQueue.Create%28System.String%29> method's return value, thereby creating a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="e0ac9-134">Il <xref:System.Messaging.MessageQueue.%23ctor%2A> costruttore crea una nuova istanza del <xref:System.Messaging.MessageQueue> classe; non viene creata una nuova coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-134">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="e0ac9-135">La tabella seguente illustra i valori iniziali delle proprietà per un'istanza di <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-135">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span>  
  
|<span data-ttu-id="e0ac9-136">Proprietà</span><span class="sxs-lookup"><span data-stu-id="e0ac9-136">Property</span></span>|<span data-ttu-id="e0ac9-137">Valore iniziale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-137">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="e0ac9-138">I valori impostati dal costruttore predefinito del <xref:System.Messaging.DefaultPropertiesToSend> classe.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-138">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="e0ac9-139">I valori impostati dal costruttore predefinito del <xref:System.Messaging.MessagePropertyFilter> classe.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-139">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span> <span data-ttu-id="e0ac9-140">Tutti i valori di filtro sono impostati su `true`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-140">All the filter values are set to `true`.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-141">Esempio di codice seguente crea un nuovo <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-141">The following code example creates a new <xref:System.Messaging.MessageQueue>.</span></span>  
  
 [!code-csharp[MessageQueue#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue path" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="e0ac9-142">Posizione della coda a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-142">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-143">Inizializza una nuova istanza della classe <see cref="T:System.Messaging.MessageQueue" /> che fa riferimento alla coda di Accodamento messaggi nel percorso specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-143">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-144">Utilizzare questo overload quando si desidera associare il nuovo <xref:System.Messaging.MessageQueue> istanza a una determinata coda Accodamento messaggi, per il quale si conosce il percorso, nome del formato o etichetta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-144">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> instance to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="e0ac9-145">Se si desidera concedere l'accesso esclusivo per la prima applicazione di cui fa riferimento alla coda, è necessario impostare il <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> proprietà `true` o utilizzare il costruttore che passa un parametro di restrizione di accesso in lettura.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-145">If you want to grant exclusive access to the first application that references the queue, you must set the <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property to `true` or use the constructor that passes a read-access restriction parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-146">Il <xref:System.Messaging.MessageQueue.%23ctor%2A> costruttore crea una nuova istanza del <xref:System.Messaging.MessageQueue> classe; non viene creata una nuova coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-146">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-147">Per creare una nuova coda in Accodamento messaggi, usare <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-147">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-148">La sintassi del `path` parametro dipende il tipo di coda cui fa riferimento, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-148">The syntax of the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="e0ac9-149">Tipo di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-149">Queue type</span></span>|<span data-ttu-id="e0ac9-150">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-150">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="e0ac9-151">coda pubblica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-151">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="e0ac9-152">coda privata</span><span class="sxs-lookup"><span data-stu-id="e0ac9-152">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="e0ac9-153">Coda del diario</span><span class="sxs-lookup"><span data-stu-id="e0ac9-153">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="e0ac9-154">Coda journal computer</span><span class="sxs-lookup"><span data-stu-id="e0ac9-154">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="e0ac9-155">Computer non recapitabili</span><span class="sxs-lookup"><span data-stu-id="e0ac9-155">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="e0ac9-156">Macchina transazionale non recapitabili</span><span class="sxs-lookup"><span data-stu-id="e0ac9-156">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="e0ac9-157">In alternativa, è possibile usare la <xref:System.Messaging.MessageQueue.FormatName%2A> o <xref:System.Messaging.MessageQueue.Label%2A> per descrivere il percorso della coda, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-157">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="e0ac9-158">Riferimenti</span><span class="sxs-lookup"><span data-stu-id="e0ac9-158">Reference</span></span>|<span data-ttu-id="e0ac9-159">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-159">Syntax</span></span>|<span data-ttu-id="e0ac9-160">Esempio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-160">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="e0ac9-161">Nome del formato</span><span class="sxs-lookup"><span data-stu-id="e0ac9-161">Format name</span></span>|<span data-ttu-id="e0ac9-162">`FormatName:` [ *nome del formato* ]</span><span class="sxs-lookup"><span data-stu-id="e0ac9-162">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="e0ac9-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="e0ac9-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="e0ac9-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="e0ac9-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="e0ac9-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="e0ac9-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="e0ac9-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="e0ac9-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="e0ac9-167">Label</span><span class="sxs-lookup"><span data-stu-id="e0ac9-167">Label</span></span>|<span data-ttu-id="e0ac9-168">`Label:` [ *etichetta* ]</span><span class="sxs-lookup"><span data-stu-id="e0ac9-168">`Label:` [ *label* ]</span></span>|<span data-ttu-id="e0ac9-169">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="e0ac9-169">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="e0ac9-170">Per funzionare offline, è necessario utilizzare la sintassi del nome di formato, non la sintassi del nome del percorso per il costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-170">To work offline, you must use the format name syntax, not the path name syntax for the constructor.</span></span> <span data-ttu-id="e0ac9-171">In caso contrario, viene generata un'eccezione perché il controller di dominio primario non è disponibile per risolvere il percorso per il nome del formato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-171">Otherwise, an exception is thrown because the primary domain controller is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="e0ac9-172">La tabella seguente illustra i valori iniziali delle proprietà per un'istanza di <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-172">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="e0ac9-173">Questi valori sono basati sulle proprietà della coda di Accodamento con il percorso specificato da di `path` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-173">These values are based on the properties of the Message Queuing queue with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="e0ac9-174">Proprietà</span><span class="sxs-lookup"><span data-stu-id="e0ac9-174">Property</span></span>|<span data-ttu-id="e0ac9-175">Valore iniziale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-175">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="e0ac9-176">0</span><span class="sxs-lookup"><span data-stu-id="e0ac9-176">0</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<xref:System.Guid.Empty>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="e0ac9-177">I valori impostati dal costruttore predefinito del <xref:System.Messaging.DefaultPropertiesToSend> classe.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-177">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="e0ac9-178">`true`, se l'impostazione del livello di privacy della coda di accodamento è "Corpo"; in caso contrario, `false`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-178">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<xref:System.String.Empty>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="e0ac9-179">Il valore della proprietà nome computer della coda di Accodamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-179">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="e0ac9-180">I valori impostati dal costruttore predefinito del <xref:System.Messaging.MessagePropertyFilter> classe.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-180">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="e0ac9-181"><xref:System.String.Empty>, se non impostato dal costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-181"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="e0ac9-182"><xref:System.String.Empty>, se non impostato dal costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-182"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="e0ac9-183">`true`, se è abilitata l'impostazione del giornale di registrazione dell'oggetto Message Queuing; in caso contrario, `false`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-183">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-184">Esempio di codice seguente crea nuovi <xref:System.Messaging.MessageQueue> di oggetti usando vari tipi di sintassi di nome di percorso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-184">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="e0ac9-185">In ogni caso, viene inviato un messaggio nella coda cui percorso viene definita nel costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-185">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-186">La proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> non è valida, probabilmente perché non è stata impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-186">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="e0ac9-187">Posizione della coda a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento, che può essere "." per il computer locale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-187">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span>
          </span>
        </param>
        <param name="sharedModeDenyReceive">
          <span data-ttu-id="e0ac9-188">
            <see langword="true" /> per concedere l'accesso esclusivo in lettura alla prima applicazione con cui viene eseguito l'accesso alla coda; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-188">
              <see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-189">Inizializza una nuova istanza della classe <see cref="T:System.Messaging.MessageQueue" /> che fa riferimento alla coda di Accodamento messaggi nel percorso specificato e con la restrizione specificata per l'accesso in lettura.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-189">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path and with the specified read-access restriction.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-190">Utilizzare questo overload quando si desidera associare il nuovo <xref:System.Messaging.MessageQueue> a una determinata coda Accodamento messaggi, per il quale si conosce il percorso, nome del formato o etichetta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-190">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="e0ac9-191">Se si desidera concedere l'accesso esclusivo per la prima applicazione di cui fa riferimento alla coda, impostare il `sharedModeDenyReceive` parametro per `true`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-191">If you want to grant exclusive access to the first application that references the queue, set the `sharedModeDenyReceive` parameter to `true`.</span></span> <span data-ttu-id="e0ac9-192">In caso contrario, impostare `sharedModeDenyReceive` al `false` o usare il costruttore che ha solo un `path` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-192">Otherwise, set `sharedModeDenyReceive` to `false` or use the constructor that has only a `path` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-193">L'impostazione `sharedModeDenyReceive` a `true` influisce su tutti gli oggetti che accedono alla coda Accodamento messaggi, comprese le altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-193">Setting `sharedModeDenyReceive` to `true` affects all objects that access the Message Queuing queue, including other applications.</span></span> <span data-ttu-id="e0ac9-194">Gli effetti del parametro non sono limitati a questa applicazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-194">The effects of the parameter are not restricted to this application.</span></span>  
  
 <span data-ttu-id="e0ac9-195">Il <xref:System.Messaging.MessageQueue.%23ctor%2A> costruttore crea una nuova istanza del <xref:System.Messaging.MessageQueue> classe; non viene creata una nuova coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-195">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor creates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-196">Per creare una nuova coda in Accodamento messaggi, usare <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-196">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-197">La sintassi del `path` parametro dipende dal tipo di coda dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-197">The syntax of the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="e0ac9-198">Tipo di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-198">Queue type</span></span>|<span data-ttu-id="e0ac9-199">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-199">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="e0ac9-200">coda pubblica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-200">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="e0ac9-201">coda privata</span><span class="sxs-lookup"><span data-stu-id="e0ac9-201">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="e0ac9-202">Coda del diario</span><span class="sxs-lookup"><span data-stu-id="e0ac9-202">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="e0ac9-203">Coda journal computer</span><span class="sxs-lookup"><span data-stu-id="e0ac9-203">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="e0ac9-204">Computer non recapitabili</span><span class="sxs-lookup"><span data-stu-id="e0ac9-204">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="e0ac9-205">Macchina transazionale non recapitabili</span><span class="sxs-lookup"><span data-stu-id="e0ac9-205">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="e0ac9-206">In alternativa, è possibile usare il nome del formato o l'etichetta di una coda di Accodamento messaggi per descrivere il percorso della coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-206">Alternatively, you can use the format name or label of a Message Queuing queue to describe the queue path.</span></span>  
  
|<span data-ttu-id="e0ac9-207">Riferimenti</span><span class="sxs-lookup"><span data-stu-id="e0ac9-207">Reference</span></span>|<span data-ttu-id="e0ac9-208">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-208">Syntax</span></span>|<span data-ttu-id="e0ac9-209">Esempio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-209">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="e0ac9-210">Nome del formato</span><span class="sxs-lookup"><span data-stu-id="e0ac9-210">Format name</span></span>|<span data-ttu-id="e0ac9-211">`FormatName:` [ *nome del formato* ]</span><span class="sxs-lookup"><span data-stu-id="e0ac9-211">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="e0ac9-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="e0ac9-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="e0ac9-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="e0ac9-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="e0ac9-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="e0ac9-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="e0ac9-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="e0ac9-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="e0ac9-216">Label</span><span class="sxs-lookup"><span data-stu-id="e0ac9-216">Label</span></span>|<span data-ttu-id="e0ac9-217">`Label:` [ *etichetta* ]</span><span class="sxs-lookup"><span data-stu-id="e0ac9-217">`Label:` [ *label* ]</span></span>|<span data-ttu-id="e0ac9-218">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="e0ac9-218">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="e0ac9-219">Per funzionare offline, è necessario usare la sintassi del nome di formato, anziché la sintassi del nome descrittivo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-219">To work offline, you must use the format name syntax, rather than the friendly name syntax.</span></span> <span data-ttu-id="e0ac9-220">In caso contrario, viene generata un'eccezione perché il controller di dominio primario (in cui risiede Active Directory) non è disponibile per risolvere il percorso per il nome del formato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-220">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="e0ac9-221">Se un <xref:System.Messaging.MessageQueue> apre una coda con il `sharedModeDenyReceive` parametro impostato su `true`, qualsiasi <xref:System.Messaging.MessageQueue> che successivamente cerca di leggere dalla coda genera una <xref:System.Messaging.MessageQueueException> a causa di una violazione di condivisione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-221">If a <xref:System.Messaging.MessageQueue> opens a queue with the `sharedModeDenyReceive` parameter set to `true`, any <xref:System.Messaging.MessageQueue> that subsequently tries to read from the queue generates a <xref:System.Messaging.MessageQueueException> because of a sharing violation.</span></span> <span data-ttu-id="e0ac9-222">Oggetto <xref:System.Messaging.MessageQueueException> viene generata anche se un <xref:System.Messaging.MessageQueue> prova ad accedere alla coda in modalità esclusiva mentre un oggetto <xref:System.Messaging.MessageQueue> dispone già dell'accesso non esclusivo alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-222">A <xref:System.Messaging.MessageQueueException> is also thrown if a <xref:System.Messaging.MessageQueue> tries to access the queue in exclusive mode while another <xref:System.Messaging.MessageQueue> already has non-exclusive access to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-223">La tabella seguente illustra i valori iniziali delle proprietà per un'istanza di <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-223">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="e0ac9-224">Questi valori sono basati sulle proprietà della coda di Accodamento messaggi, con il percorso specificato da di `path` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-224">These values are based on the properties of the Message Queuing queue, with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="e0ac9-225">Proprietà</span><span class="sxs-lookup"><span data-stu-id="e0ac9-225">Property</span></span>|<span data-ttu-id="e0ac9-226">Valore iniziale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-226">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|<span data-ttu-id="e0ac9-227">`false`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-227">`false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="e0ac9-228">0.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-228">0.</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<span data-ttu-id="e0ac9-229"><xref:System.Guid.Empty>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-229"><xref:System.Guid.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="e0ac9-230">I valori impostati dal costruttore predefinito del <xref:System.Messaging.DefaultPropertiesToSend> classe.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-230">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="e0ac9-231">`true`, se l'impostazione del livello di privacy della coda di accodamento è "Corpo"; in caso contrario, `false`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-231">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<span data-ttu-id="e0ac9-232"><xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-232"><xref:System.Messaging.XmlMessageFormatter>.</span></span>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<span data-ttu-id="e0ac9-233"><xref:System.String.Empty>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-233"><xref:System.String.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="e0ac9-234">Il valore della proprietà nome computer della coda di Accodamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-234">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<span data-ttu-id="e0ac9-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<span data-ttu-id="e0ac9-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="e0ac9-237">I valori impostati dal costruttore predefinito del <xref:System.Messaging.MessagePropertyFilter> classe.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-237">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="e0ac9-238"><xref:System.String.Empty>, se non impostato dal costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-238"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="e0ac9-239"><xref:System.String.Empty>, se non impostato dal costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-239"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|<span data-ttu-id="e0ac9-240">Valore del parametro `sharedModeDenyReceive`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-240">The value of the `sharedModeDenyReceive` parameter.</span></span>|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="e0ac9-241">`true`, se è abilitata l'impostazione del giornale di registrazione dell'oggetto Message Queuing; in caso contrario, `false`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-241">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-242">Esempio di codice seguente crea un nuovo <xref:System.Messaging.MessageQueue> con accesso esclusivo, viene impostato il percorso e invia un messaggio alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-242">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive access, sets its path, and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CPP/mqctor_denysharedreceive.cpp#1)]
 [!code-csharp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CS/mqctor_denysharedreceive.cs#1)]
 [!code-vb[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/VB/mqctor_denysharedreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-243">La proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> non è valida, probabilmente perché non è stata impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-243">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, System::Messaging::QueueAccessMode accessMode);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * System.Messaging.QueueAccessMode -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, accessMode)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="e0ac9-244">Posizione della coda a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento, che può essere "." per il computer locale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-244">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span>
          </span>
        </param>
        <param name="accessMode">
          <span data-ttu-id="e0ac9-245">Uno dei valori di <see cref="T:System.Messaging.QueueAccessMode" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-245">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-246">Inizializza una nuova istanza della classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-246">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool * bool -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive, enableCache)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
        <Parameter Name="enableCache" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="e0ac9-247">Posizione della coda a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento, che può essere "." per il computer locale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-247">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span>
          </span>
        </param>
        <param name="sharedModeDenyReceive">
          <span data-ttu-id="e0ac9-248">
            <see langword="true" /> per concedere l'accesso esclusivo in lettura alla prima applicazione con cui viene eseguito l'accesso alla coda; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-248">
              <see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <param name="enableCache">
          <span data-ttu-id="e0ac9-249">
            <see langword="true" /> per creare e utilizzare una cache di connessioni; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-249">
              <see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-250">Inizializza una nuova istanza della classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-250">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="e0ac9-251">Esempio di codice seguente crea un nuovo <xref:System.Messaging.MessageQueue> con accesso in lettura esclusivo e con connessione la memorizzazione nella cache abilitata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-251">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive read access and with connection caching enabled.</span></span>  
  
 [!code-cpp[MessageQueue4#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue4/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue4#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue4/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache, System::Messaging::QueueAccessMode accessMode);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool * bool * System.Messaging.QueueAccessMode -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive, enableCache, accessMode)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
        <Parameter Name="enableCache" Type="System.Boolean" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="e0ac9-252">Posizione della coda a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento, che può essere "." per il computer locale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-252">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span>
          </span>
        </param>
        <param name="sharedModeDenyReceive">
          <span data-ttu-id="e0ac9-253">
            <see langword="true" /> per concedere l'accesso esclusivo in lettura alla prima applicazione con cui viene eseguito l'accesso alla coda; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-253">
              <see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <param name="enableCache">
          <span data-ttu-id="e0ac9-254">
            <see langword="true" /> per creare e utilizzare una cache di connessioni; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-254">
              <see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <param name="accessMode">
          <span data-ttu-id="e0ac9-255">Uno dei valori di <see cref="T:System.Messaging.QueueAccessMode" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-255">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-256">Inizializza una nuova istanza della classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-256">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="AccessMode">
      <MemberSignature Language="C#" Value="public System.Messaging.QueueAccessMode AccessMode { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.QueueAccessMode AccessMode" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.AccessMode" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property AccessMode As QueueAccessMode" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::QueueAccessMode AccessMode { System::Messaging::QueueAccessMode get(); };" />
      <MemberSignature Language="F#" Value="member this.AccessMode : System.Messaging.QueueAccessMode" Usage="System.Messaging.MessageQueue.AccessMode" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.QueueAccessMode</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-257">Ottiene un valore che indica la modalità di accesso per la coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-257">Gets a value that indicates the access mode for the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-258">Uno dei valori di <see cref="T:System.Messaging.QueueAccessMode" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-258">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-259">La modalità di accesso predefinito per una coda è `QueueAccessMode.SendAndReceive`, se non diversamente specificato quando si chiama il costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-259">The default access mode for a queue is `QueueAccessMode.SendAndReceive`, unless you specify otherwise when calling the constructor.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Authenticate">
      <MemberSignature Language="C#" Value="public bool Authenticate { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Authenticate" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Authenticate" />
      <MemberSignature Language="VB.NET" Value="Public Property Authenticate As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Authenticate { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.Authenticate : bool with get, set" Usage="System.Messaging.MessageQueue.Authenticate" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Authenticate")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-260">Ottiene o imposta un valore che indica se la coda accetta solo messaggi autenticati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-260">Gets or sets a value that indicates whether the queue accepts only authenticated messages.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-261">
            <see langword="true" /> se la coda accetta solo messaggi autenticati; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-261">
              <see langword="true" /> if the queue accepts only authenticated messages; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="e0ac9-262">Il valore predefinito è <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-262">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-263">L'autenticazione dei messaggi fornisce un modo per garantire l'integrità del messaggio e per verificare chi ha inviato il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-263">Message authentication provides a way to ensure message integrity and to verify who sent the message.</span></span> <span data-ttu-id="e0ac9-264">Per richiedere l'autenticazione, l'applicazione mittente Imposta livello di autenticazione del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-264">To request authentication, the sending application sets the message's authentication level.</span></span>  
  
 <span data-ttu-id="e0ac9-265">Quando si imposta <xref:System.Messaging.MessageQueue.Authenticate%2A> al `true`, si limiterà l'accesso alla coda nel server, non solo a questa <xref:System.Messaging.MessageQueue> istanza.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-265">When you set <xref:System.Messaging.MessageQueue.Authenticate%2A> to `true`, you are restricting access to the queue on the server, not only to this <xref:System.Messaging.MessageQueue> instance.</span></span> <span data-ttu-id="e0ac9-266">Saranno interessati tutti i client che utilizzano la stessa coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-266">All clients working against the same Message Queuing queue will be affected.</span></span>  
  
 <span data-ttu-id="e0ac9-267">Una coda che accetta solo messaggi autenticati rifiuta un messaggio non autenticato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-267">A queue that accepts only authenticated messages will reject a non-authenticated message.</span></span> <span data-ttu-id="e0ac9-268">Per richiedere la notifica di rifiuto di messaggio, è possibile impostare un'applicazione di invio di <xref:System.Messaging.Message.AcknowledgeType%2A> proprietà del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-268">To request notification of message rejection, a sending application can set the <xref:System.Messaging.Message.AcknowledgeType%2A> property of the message.</span></span> <span data-ttu-id="e0ac9-269">Poiché non esiste alcun'altra indicazione di rifiuto di messaggio, l'applicazione mittente può perdere il messaggio a meno che non si richiede di essere inviato per la coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-269">Because no other indication of message rejection exists, the sending application can lose the message unless you request that it be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="e0ac9-270">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-270">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-271">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-271">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-272">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-272">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-273">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-273">Local computer</span></span>|<span data-ttu-id="e0ac9-274">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-274">Yes</span></span>|  
|<span data-ttu-id="e0ac9-275">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-275">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-276">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-276">Yes</span></span>|  
|<span data-ttu-id="e0ac9-277">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-277">Remote computer</span></span>|<span data-ttu-id="e0ac9-278">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-278">No</span></span>|  
|<span data-ttu-id="e0ac9-279">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-279">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-280">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-280">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-281">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.Authenticate%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-281">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Authenticate%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-282">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-282">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.UseDeadLetterQueue" />
        <altmember cref="P:System.Messaging.Message.AcknowledgeType" />
      </Docs>
    </Member>
    <Member MemberName="BasePriority">
      <MemberSignature Language="C#" Value="public short BasePriority { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int16 BasePriority" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.BasePriority" />
      <MemberSignature Language="VB.NET" Value="Public Property BasePriority As Short" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property short BasePriority { short get(); void set(short value); };" />
      <MemberSignature Language="F#" Value="member this.BasePriority : int16 with get, set" Usage="System.Messaging.MessageQueue.BasePriority" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_BasePriority")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int16</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-283">Ottiene o imposta la priorità di base utilizzata da Accodamento messaggi per effettuare il routing dei messaggi di una coda pubblica sulla rete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-283">Gets or sets the base priority Message Queuing uses to route a public queue's messages over the network.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-284">La singola priorità di base relativa a tutti i messaggi inviati alla coda (pubblica).</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-284">The single base priority for all messages sent to the (public) queue.</span>
          </span>
          <span data-ttu-id="e0ac9-285">Il valore predefinito è zero (0).</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-285">The default is zero (0).</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-286">Priorità di base di una coda di messaggi specifica il modo in cui un messaggio di transito a quella coda viene considerata durante la trasmissione attraverso la rete.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-286">A message queue's base priority specifies how a message en route to that queue is treated as it travels through the network.</span></span> <span data-ttu-id="e0ac9-287">È possibile impostare il <xref:System.Messaging.MessageQueue.BasePriority%2A> proprietà per attribuire una priorità superiore o inferiore a tutti i messaggi inviati alla coda specificata rispetto a quelli inviati ad altre code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-287">You can set the <xref:System.Messaging.MessageQueue.BasePriority%2A> property to confer a higher or lower priority to all messages sent to the specified queue than those sent to other queues.</span></span> <span data-ttu-id="e0ac9-288">Impostando questa proprietà viene modificata la coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-288">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-289">Pertanto, qualsiasi altro <xref:System.Messaging.MessageQueue> istanze sono interessate dalla modifica.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-289">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="e0ac9-290">Una coda di messaggi <xref:System.Messaging.MessageQueue.BasePriority%2A> non è correlato il <xref:System.Messaging.Message.Priority%2A> proprietà di un messaggio che specifica l'ordine in cui viene inserito un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-290">A message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> is not related to the <xref:System.Messaging.Message.Priority%2A> property of a message, which specifies the order in which an incoming message is placed in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> si applica solo alle code pubbliche i cui percorsi sono specificati utilizzando il nome di formato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> applies only to public queues whose paths are specified using the format name.</span></span> <span data-ttu-id="e0ac9-292">La priorità di base di una coda privata è sempre zero (0).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-292">The base priority of a private queue is always zero (0).</span></span>  
  
 <span data-ttu-id="e0ac9-293">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-293">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-294">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-294">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-295">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-295">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-296">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-296">Local computer</span></span>|<span data-ttu-id="e0ac9-297">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-297">Yes</span></span>|  
|<span data-ttu-id="e0ac9-298">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-298">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-299">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-299">Yes</span></span>|  
|<span data-ttu-id="e0ac9-300">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-300">Remote computer</span></span>|<span data-ttu-id="e0ac9-301">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-301">No</span></span>|  
|<span data-ttu-id="e0ac9-302">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-302">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-303">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-303">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-304">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.BasePriority%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-304">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-305">La priorità di base è stata impostata su un valore non valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-305">The base priority was set to an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-306">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-306">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginPeek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe>
          <span data-ttu-id="e0ac9-307">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-307">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <summary>
          <span data-ttu-id="e0ac9-308">Avvia un'operazione di lettura asincrona, indicando ad Accodamento messaggi di avviare la lettura di un messaggio e inviare una notifica al gestore eventi al termine dell'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-308">Initiates an asynchronous peek operation by telling Message Queuing to begin peeking a message and notify the event handler when finished.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek();" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : unit -&gt; IAsyncResult" Usage="messageQueue.BeginPeek " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-309">Avvia un'operazione di lettura asincrona per la quale non è stato specificato un intervallo di timeout. L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-309">Initiates an asynchronous peek operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-310">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-310">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-311">Nell'elaborazione asincrona, si utilizza <xref:System.Messaging.MessageQueue.BeginPeek%2A> per generare il <xref:System.Messaging.MessageQueue.PeekCompleted> evento quando un messaggio diventa disponibile nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-311">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-312"><xref:System.Messaging.MessageQueue.PeekCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-312"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-313">Usare <xref:System.Messaging.MessageQueue.BeginPeek%2A>, creare un gestore eventi che elabora i risultati dell'operazione asincrona e associarla al delegato dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-313">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="e0ac9-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Avvia un'operazione di lettura asincrona. il <xref:System.Messaging.MessageQueue> viene informato, tramite la generazione del <xref:System.Messaging.MessageQueue.PeekCompleted> evento, quando arriva un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-315">Il <xref:System.Messaging.MessageQueue> può quindi accedere al messaggio chiamando <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> o recuperando il risultato mediante la <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-315">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="e0ac9-316">Il <xref:System.Messaging.MessageQueue.BeginPeek%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-316">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-317">Poiché <xref:System.Messaging.MessageQueue.BeginPeek%2A> è asincrona, è possibile chiamare questo metodo per leggere la coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-317">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-318">Per leggere in modo sincrono la coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-318">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-319">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-319">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-320">Il <xref:System.IAsyncResult> che <xref:System.Messaging.MessageQueue.BeginPeek%2A> restituisce identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-320">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="e0ac9-321">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-321">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-322">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-322">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-323">In questo caso, si utilizza il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-323">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-324">Se <xref:System.Messaging.MessageQueue.CanRead%2A> viene `false`, viene generato l'evento di completamento, ma verrà generata un'eccezione quando si chiama <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-324">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-325">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-325">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-326">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-326">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-327">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-327">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-328">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-328">Local computer</span></span>|<span data-ttu-id="e0ac9-329">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-329">Yes</span></span>|  
|<span data-ttu-id="e0ac9-330">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-330">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-331">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-331">Yes</span></span>|  
|<span data-ttu-id="e0ac9-332">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-332">Remote computer</span></span>|<span data-ttu-id="e0ac9-333">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-333">No</span></span>|  
|<span data-ttu-id="e0ac9-334">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-334">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-335">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-335">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-336">L'esempio di codice seguente crea un gestore eventi denominato `MyPeekCompleted`, lo collega al <xref:System.Messaging.MessageQueue.PeekCompleted> delegato del gestore eventi e chiamate <xref:System.Messaging.MessageQueue.BeginPeek%2A> per avviare un'operazione di lettura asincrona in coda che si trova nel percorso ". \myQueue".</span><span class="sxs-lookup"><span data-stu-id="e0ac9-336">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="e0ac9-337">Quando un <xref:System.Messaging.MessageQueue.PeekCompleted> viene generato l'evento, l'esempio legge il messaggio e scrive il corpo sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-337">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="e0ac9-338">Nell'esempio viene quindi chiamato <xref:System.Messaging.MessageQueue.BeginPeek%2A> nuovamente per avviare una nuova operazione di lettura asincrona.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-338">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-339">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-339">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-340">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-340">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan -&gt; IAsyncResult" Usage="messageQueue.BeginPeek timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-341">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo di attesa necessario affinché un messaggio diventi disponibile.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-341">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-342">Avvia un'operazione di lettura asincrona per la quale è stato specificato un periodo di timeout. L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda o non si verifica il timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-342">Initiates an asynchronous peek operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-343">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-343">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-344">Nell'elaborazione asincrona, si utilizza <xref:System.Messaging.MessageQueue.BeginPeek%2A> per generare il <xref:System.Messaging.MessageQueue.PeekCompleted> evento quando un messaggio diventa disponibile nella coda o quando l'intervallo di tempo specificato è scaduto.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-344">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="e0ac9-345"><xref:System.Messaging.MessageQueue.PeekCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-345"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-346">Usare <xref:System.Messaging.MessageQueue.BeginPeek%2A>, creare un gestore eventi che elabora i risultati dell'operazione asincrona e associarla al delegato dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-346">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="e0ac9-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Avvia un'operazione di lettura asincrona. il <xref:System.Messaging.MessageQueue> viene informato, tramite la generazione del <xref:System.Messaging.MessageQueue.PeekCompleted> evento, quando arriva un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-348">Il <xref:System.Messaging.MessageQueue> può quindi accedere al messaggio chiamando <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> o recuperando il risultato mediante la <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-348">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="e0ac9-349">Il <xref:System.Messaging.MessageQueue.BeginPeek%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-349">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-350">Poiché <xref:System.Messaging.MessageQueue.BeginPeek%2A> è asincrona, è possibile chiamare questo metodo per leggere la coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-350">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-351">Per leggere in modo sincrono la coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-351">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-352">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-352">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-353">Il <xref:System.IAsyncResult> che <xref:System.Messaging.MessageQueue.BeginPeek%2A> restituisce identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-353">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="e0ac9-354">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-354">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-355">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-355">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-356">In questo caso, si utilizza il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-356">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-357">Questo overload specifica un timeout. Se l'intervallo specificato dal `timeout` scade parametro, questo componente genera il <xref:System.Messaging.MessageQueue.PeekCompleted> evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-357">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="e0ac9-358">Poiché è disponibile alcun messaggio, una chiamata successiva a <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-358">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="e0ac9-359">Se <xref:System.Messaging.MessageQueue.CanRead%2A> viene `false`, viene generato l'evento di completamento, ma verrà generata un'eccezione quando si chiama <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-359">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-360">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-360">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-361">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-361">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-362">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-362">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-363">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-363">Local computer</span></span>|<span data-ttu-id="e0ac9-364">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-364">Yes</span></span>|  
|<span data-ttu-id="e0ac9-365">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-365">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-366">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-366">Yes</span></span>|  
|<span data-ttu-id="e0ac9-367">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-367">Remote computer</span></span>|<span data-ttu-id="e0ac9-368">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-368">No</span></span>|  
|<span data-ttu-id="e0ac9-369">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-369">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-370">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-370">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-371">L'esempio di codice seguente crea un'operazione di lettura asincrona, usando il percorso della coda ". \myQueue".</span><span class="sxs-lookup"><span data-stu-id="e0ac9-371">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="e0ac9-372">Crea un gestore eventi `MyPeekCompleted`e lo collega al <xref:System.Messaging.MessageQueue.PeekCompleted> delegato del gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-372">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="e0ac9-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> viene chiamato con un timeout di un minuto, per avviare l'operazione di lettura asincrona.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called with a time-out of one minute, to initiate the asynchronous peek operation.</span></span> <span data-ttu-id="e0ac9-374">Quando un <xref:System.Messaging.MessageQueue.PeekCompleted> viene generato l'evento o alla scadenza del timeout, se presente, e il relativo corpo è scritto alla schermata, viene recuperato il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-374">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expires, the message is retrieved if one exists, and its body is written to the screen.</span></span> <span data-ttu-id="e0ac9-375">Quindi <xref:System.Messaging.MessageQueue.BeginPeek%2A> viene chiamata nuovamente per avviare una nuova operazione di lettura asincrona con il timeout stesso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-375">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CPP/mqbeginpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CS/mqbeginpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/VB/mqbeginpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-376">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-376">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-377">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-377">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-378">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-378">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * obj -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-379">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo di attesa necessario affinché un messaggio diventi disponibile.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-379">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="e0ac9-380">Oggetto di stato, specificato dall'applicazione, che contiene le informazioni associate all'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-380">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-381">Avvia un'operazione di lettura asincrona per la quale sono stati specificati un timeout e un oggetto di stato, che fornisce le informazioni associate per tutta la durata dell'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-381">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span>
          </span>
          <span data-ttu-id="e0ac9-382">L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda o non si verifica il timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-382">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-383">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-383">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-384">Nell'elaborazione asincrona, si utilizza <xref:System.Messaging.MessageQueue.BeginPeek%2A> per generare il <xref:System.Messaging.MessageQueue.PeekCompleted> evento quando un messaggio diventa disponibile nella coda o quando l'intervallo di tempo specificato è scaduto.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-384">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="e0ac9-385"><xref:System.Messaging.MessageQueue.PeekCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-385"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-386">Utilizzare questo overload per associare informazioni con l'operazione che verrà mantenuto per tutta la durata dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-386">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="e0ac9-387">Il gestore eventi può accedere a queste informazioni esaminando i <xref:System.IAsyncResult.AsyncState%2A> proprietà del <xref:System.IAsyncResult> associato con l'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-387">The event handler can access this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="e0ac9-388">Usare <xref:System.Messaging.MessageQueue.BeginPeek%2A>, creare un gestore eventi che elabora i risultati dell'operazione asincrona e associarla al delegato dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-388">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="e0ac9-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Avvia un'operazione di lettura asincrona. il <xref:System.Messaging.MessageQueue> viene informato, tramite la generazione del <xref:System.Messaging.MessageQueue.PeekCompleted> evento, quando arriva un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-390">Il <xref:System.Messaging.MessageQueue> può quindi accedere al messaggio chiamando <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> o recuperando il risultato mediante la <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-390">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="e0ac9-391">Il <xref:System.Messaging.MessageQueue.BeginPeek%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-391">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-392">Poiché <xref:System.Messaging.MessageQueue.BeginPeek%2A> è asincrona, è possibile chiamare questo metodo per leggere la coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-392">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-393">Per leggere in modo sincrono la coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-393">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-394">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-394">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Restituisce un <xref:System.IAsyncResult> che identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="e0ac9-396">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-396">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-397">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-397">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-398">In questo caso, si utilizza il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-398">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-399">Questo overload specifica un timeout e un oggetto di stato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-399">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="e0ac9-400">Se l'intervallo specificato dal `timeout` scade parametro, questo componente genera il <xref:System.Messaging.MessageQueue.PeekCompleted> evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-400">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="e0ac9-401">Poiché è disponibile alcun messaggio, una chiamata successiva a <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-401">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="e0ac9-402">L'oggetto di stato associa le informazioni sullo stato dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-402">The state object associates state information with the operation.</span></span> <span data-ttu-id="e0ac9-403">Ad esempio, se si chiama <xref:System.Messaging.MessageQueue.BeginPeek%2A> più volte per avviare più operazioni, è possibile identificare ogni operazione tramite un oggetto di stato separato definiti.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-403">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span> <span data-ttu-id="e0ac9-404">Per un'illustrazione di questo scenario, vedere la sezione esempio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-404">For an illustration of this scenario, see the Example section.</span></span>  
  
 <span data-ttu-id="e0ac9-405">È anche possibile usare l'oggetto di stato per passare informazioni tra i thread di processo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-405">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="e0ac9-406">Se viene avviato un thread, ma il callback è in un thread diverso in uno scenario asincrono, l'oggetto di stato viene effettuato il marshalling e passato insieme alle informazioni dall'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-406">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="e0ac9-407">Se <xref:System.Messaging.MessageQueue.CanRead%2A> viene `false`, viene generato l'evento di completamento, ma verrà generata un'eccezione quando si chiama <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-407">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-408">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-408">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-409">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-409">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-410">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-410">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-411">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-411">Local computer</span></span>|<span data-ttu-id="e0ac9-412">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-412">Yes</span></span>|  
|<span data-ttu-id="e0ac9-413">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-413">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-414">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-414">Yes</span></span>|  
|<span data-ttu-id="e0ac9-415">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-415">Remote computer</span></span>|<span data-ttu-id="e0ac9-416">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-416">No</span></span>|  
|<span data-ttu-id="e0ac9-417">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-417">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-418">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-418">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-419">L'esempio di codice seguente crea un'operazione di lettura asincrona, usando il percorso della coda ". \myQueue".</span><span class="sxs-lookup"><span data-stu-id="e0ac9-419">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="e0ac9-420">Crea un gestore eventi `MyPeekCompleted`e lo collega al <xref:System.Messaging.MessageQueue.PeekCompleted> delegato del gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-420">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="e0ac9-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> viene chiamato con un timeout di un minuto.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called, with a time-out of one minute.</span></span> <span data-ttu-id="e0ac9-422">Ogni chiamata a <xref:System.Messaging.MessageQueue.BeginPeek%2A> è associato un intero univoco che identifica la specifica operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-422">Each call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> has a unique associated integer that identifies that particular operation.</span></span> <span data-ttu-id="e0ac9-423">Quando un <xref:System.Messaging.MessageQueue.PeekCompleted> viene generato l'evento o della scadenza del timeout, viene recuperato il messaggio, se presente, e il relativo corpo e l'identificatore di tipo integer specifici dell'operazione vengono scritti allo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-423">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expired, the message, if one exists, is retrieved and its body and the operation-specific integer identifier are written to the screen.</span></span> <span data-ttu-id="e0ac9-424">Quindi <xref:System.Messaging.MessageQueue.BeginPeek%2A> viene chiamata nuovamente per avviare una nuova operazione di lettura asincrona con il timeout stesso e il valore integer associato dell'operazione semplicemente completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-424">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out and the associated integer of the just completed operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CPP/mqbeginpeek_timeoutstateobject.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CS/mqbeginpeek_timeoutstateobject.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/VB/mqbeginpeek_timeoutstateobject.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-425">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-425">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-426">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-426">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-427">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-427">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, stateObject, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-428">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo di attesa necessario affinché un messaggio diventi disponibile.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-428">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="e0ac9-429">Oggetto di stato, specificato dall'applicazione, che contiene le informazioni associate all'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-429">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <param name="callback">
          <span data-ttu-id="e0ac9-430">
            <see cref="T:System.AsyncCallback" /> che riceverà la notifica del completamento dell'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-430">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-431">Avvia un'operazione di lettura asincrona per la quale sono stati specificati un timeout e un oggetto di stato, che fornisce le informazioni associate per tutta la durata dell'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-431">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span>
          </span>
          <span data-ttu-id="e0ac9-432">Questo overload riceve mediante un callback la notifica dell'identità del gestore eventi per l'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-432">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span>
          </span>
          <span data-ttu-id="e0ac9-433">L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda o non si verifica il timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-433">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-434">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-434">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-435">Quando si utilizza questo overload, il callback specificato nel parametro di callback viene richiamato direttamente quando un messaggio diventa disponibile nella coda o quando l'intervallo di tempo specificato è scaduto. il <xref:System.Messaging.MessageQueue.PeekCompleted> non viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-435">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="e0ac9-436">Gli altri overload del <xref:System.Messaging.MessageQueue.BeginPeek%2A> si basano su questo componente per generare il <xref:System.Messaging.MessageQueue.PeekCompleted> evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-436">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="e0ac9-437"><xref:System.Messaging.MessageQueue.PeekCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-437"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-438">Il <xref:System.Messaging.MessageQueue.BeginPeek%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-438">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-439">Poiché <xref:System.Messaging.MessageQueue.BeginPeek%2A> è asincrona, è possibile chiamare questo metodo per leggere la coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-439">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-440">Per leggere in modo sincrono la coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-440">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-441">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-441">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Restituisce un <xref:System.IAsyncResult> che identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="e0ac9-443">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-443">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-444">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-444">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-445">In questo caso, si utilizza il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-445">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-446">L'oggetto di stato associa le informazioni sullo stato dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-446">The state object associates state information with the operation.</span></span> <span data-ttu-id="e0ac9-447">Ad esempio, se si chiama <xref:System.Messaging.MessageQueue.BeginPeek%2A> più volte per avviare più operazioni, è possibile identificare ogni operazione tramite un oggetto di stato separato definiti.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-447">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="e0ac9-448">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-448">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-449">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-449">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-450">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-450">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-451">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-451">Local computer</span></span>|<span data-ttu-id="e0ac9-452">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-452">Yes</span></span>|  
|<span data-ttu-id="e0ac9-453">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-453">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-454">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-454">Yes</span></span>|  
|<span data-ttu-id="e0ac9-455">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-455">Remote computer</span></span>|<span data-ttu-id="e0ac9-456">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-456">No</span></span>|  
|<span data-ttu-id="e0ac9-457">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-457">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-458">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-458">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-459">L'esempio di codice seguente crea un'operazione di lettura asincrona.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-459">The following code example creates an asynchronous peek operation.</span></span> <span data-ttu-id="e0ac9-460">Il codice riportato di seguito viene inviato un messaggio a una coda di messaggi locale, quindi chiama <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passando: un valore di timeout di 10 secondi, un numero intero univoco che identifica il messaggio in questione; e una nuova istanza della <xref:System.AsyncCallback> che identifica il gestore eventi `MyPeekCompleted`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-460">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyPeekCompleted`.</span></span> <span data-ttu-id="e0ac9-461">Quando un <xref:System.Messaging.MessageQueue.PeekCompleted> viene generato l'evento, il gestore dell'evento Visualizza il messaggio e scrive il corpo del messaggio e l'identificatore del messaggio sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-461">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the event handler peeks at the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginPeek#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginPeek/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginPeek#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginPeek/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-462">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-462">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-463">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-463">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-464">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-464">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * System.Messaging.Cursor * System.Messaging.PeekAction * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, cursor, action, state, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" />
        <Parameter Name="state" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-465">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo di attesa necessario affinché un messaggio diventi disponibile.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-465">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="e0ac9-466">Oggetto <see cref="T:System.Messaging.Cursor" /> che occupa una posizione specifica nella coda messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-466">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="action">
          <span data-ttu-id="e0ac9-467">Uno dei valori di <see cref="T:System.Messaging.PeekAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-467">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span>
          </span>
          <span data-ttu-id="e0ac9-468">Indica se leggere il messaggio corrente nella coda oppure il messaggio successivo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-468">Indicates whether to peek at the current message in the queue, or the next message.</span>
          </span>
        </param>
        <param name="state">
          <span data-ttu-id="e0ac9-469">Oggetto di stato, specificato dall'applicazione, che contiene le informazioni associate all'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-469">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <param name="callback">
          <span data-ttu-id="e0ac9-470">
            <see cref="T:System.AsyncCallback" /> che riceve la notifica del completamento dell'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-470">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-471">Avvia un'operazione di lettura asincrona che presenta il timeout specificato e che utilizza il cursore specificato, l'azione di lettura specificata e l'oggetto di stato specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-471">Initiates an asynchronous peek operation that has a specified time-out and that uses a specified cursor, a specified peek action, and a specified state object.</span>
          </span>
          <span data-ttu-id="e0ac9-472">L'oggetto di stato fornisce informazioni associate per l'intera durata dell'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-472">The state object provides associated information throughout the lifetime of the operation.</span>
          </span>
          <span data-ttu-id="e0ac9-473">Questo overload riceve mediante un callback la notifica dell'identità del gestore eventi per l'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-473">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span>
          </span>
          <span data-ttu-id="e0ac9-474">L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda o non si verifica il timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-474">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-475">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-475">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-476">Quando si utilizza questo overload, il callback specificato nel parametro di callback viene richiamato direttamente quando un messaggio diventa disponibile nella coda o quando l'intervallo di tempo specificato è scaduto.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-476">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired.</span></span> <span data-ttu-id="e0ac9-477">Il <xref:System.Messaging.MessageQueue.PeekCompleted> non viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-477">The <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="e0ac9-478">Gli altri overload del <xref:System.Messaging.MessageQueue.BeginPeek%2A> si basano su questo componente per generare il <xref:System.Messaging.MessageQueue.PeekCompleted> evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-478">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="e0ac9-479"><xref:System.Messaging.MessageQueue.PeekCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-479"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-480">Il <xref:System.Messaging.MessageQueue.BeginPeek%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-480">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-481">Poiché <xref:System.Messaging.MessageQueue.BeginPeek%2A> è asincrona, è possibile chiamare questo metodo per leggere la coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-481">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-482">Per leggere in modo sincrono la coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-482">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-483">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-483">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Restituisce un <xref:System.IAsyncResult> che identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation started by the method.</span></span> <span data-ttu-id="e0ac9-485">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-485">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-486">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-486">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-487">In questo caso, usare il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-487">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-488">L'oggetto di stato associa le informazioni sullo stato dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-488">The state object associates state information with the operation.</span></span> <span data-ttu-id="e0ac9-489">Ad esempio, se si chiama <xref:System.Messaging.MessageQueue.BeginPeek%2A> più volte per avviare più operazioni, è possibile identificare ogni operazione tramite un oggetto di stato separato definiti.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-489">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="e0ac9-490">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-490">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-491">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-491">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-492">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-492">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-493">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-493">Local computer</span></span>|<span data-ttu-id="e0ac9-494">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-494">Yes</span></span>|  
|<span data-ttu-id="e0ac9-495">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-495">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-496">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-496">Yes</span></span>|  
|<span data-ttu-id="e0ac9-497">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-497">Remote computer</span></span>|<span data-ttu-id="e0ac9-498">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-498">No</span></span>|  
|<span data-ttu-id="e0ac9-499">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-499">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-500">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-500">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="e0ac9-501">È stato specificato un valore diverso da <see langword="PeekAction.Current" /> o <see langword="PeekAction.Next" /> per il parametro <paramref name="action" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-501">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-502">Il valore del parametro <paramref name="cursor" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-502">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-503">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-503">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-504">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-504">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-505">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-505">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginReceive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe>
          <span data-ttu-id="e0ac9-506">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-506">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <summary>
          <span data-ttu-id="e0ac9-507">Avvia un'operazione di ricezione asincrona, indicando ad Accodamento messaggi di avviare la ricezione di un messaggio e inviare una notifica al gestore eventi al termine dell'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-507">Initiates an asynchronous receive operation by telling Message Queuing to begin receiving a message and notify the event handler when finished.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive();" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : unit -&gt; IAsyncResult" Usage="messageQueue.BeginReceive " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-508">Avvia un'operazione di ricezione asincrona per la quale non è stato specificato alcun timeout. L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-508">Initiates an asynchronous receive operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-509">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-509">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-510">Nell'elaborazione asincrona, si utilizza <xref:System.Messaging.MessageQueue.BeginReceive%2A> per generare il <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento quando un messaggio è stato rimosso dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-510">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message has been removed from the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-512">Usare <xref:System.Messaging.MessageQueue.BeginReceive%2A>, creare un gestore eventi che elabora i risultati dell'operazione asincrona e associarla al delegato dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-512">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="e0ac9-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Avvia un'asincrona operazione di ricezione. il <xref:System.Messaging.MessageQueue> viene informato, tramite la generazione del <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento, quando arriva un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-514">Il <xref:System.Messaging.MessageQueue> può quindi accedere al messaggio chiamando <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-514">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-515">Il <xref:System.Messaging.MessageQueue.BeginReceive%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-515">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-516">Poiché <xref:System.Messaging.MessageQueue.BeginReceive%2A> è asincrona, è possibile chiamare in modo da ricevere un messaggio dalla coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-516">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-517">Per ricevere in modo sincrono un messaggio, utilizzare il <xref:System.Messaging.MessageQueue.Receive%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-517">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-518">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-518">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-519">Il <xref:System.IAsyncResult> che <xref:System.Messaging.MessageQueue.BeginReceive%2A> restituisce identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-519">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="e0ac9-520">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-520">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-521">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-521">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-522">In questo caso, si utilizza il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-522">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-523">Se <xref:System.Messaging.MessageQueue.CanRead%2A> viene `false`, viene generato l'evento di completamento, ma verrà generata un'eccezione quando si chiama <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-523">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-524">Non usare la chiamata asincrona <xref:System.Messaging.MessageQueue.BeginReceive%2A> con transazioni.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-524">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="e0ac9-525">Se si desidera eseguire un'operazione asincrona transazionale, chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A>e inserire la transazione e (sincrona) <xref:System.Messaging.MessageQueue.Receive%2A> metodo all'interno del gestore di evento è creare per l'operazione di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-525">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="e0ac9-526">Il gestore eventi potrebbe contenere funzionalità come illustrato nel codice c# seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-526">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="e0ac9-527">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-527">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-528">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-528">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-529">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-529">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-530">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-530">Local computer</span></span>|<span data-ttu-id="e0ac9-531">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-531">Yes</span></span>|  
|<span data-ttu-id="e0ac9-532">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-532">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-533">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-533">Yes</span></span>|  
|<span data-ttu-id="e0ac9-534">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-534">Remote computer</span></span>|<span data-ttu-id="e0ac9-535">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-535">No</span></span>|  
|<span data-ttu-id="e0ac9-536">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-536">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-537">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-537">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-538">L'esempio di codice seguente vengono concatenate le richieste asincrone.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-538">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="e0ac9-539">Presuppone che ci sia una coda sul computer locale denominato "myQueue".</span><span class="sxs-lookup"><span data-stu-id="e0ac9-539">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="e0ac9-540">Il `Main` funzione inizia l'operazione asincrona che viene gestita dal `MyReceiveCompleted` routine.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-540">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="e0ac9-541">`MyReceiveCompleted` Elabora il messaggio corrente e avvia un nuovo asincrona operazione di ricezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-541">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 <span data-ttu-id="e0ac9-542">Esempio di codice seguente Accoda le richieste asincrone.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-542">The following code example queues asynchronous requests.</span></span> <span data-ttu-id="e0ac9-543">La chiamata a <xref:System.Messaging.MessageQueue.BeginReceive%2A> utilizza il <xref:System.IAsyncResult.AsyncWaitHandle%2A> nel relativo valore restituito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-543">The call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> uses the <xref:System.IAsyncResult.AsyncWaitHandle%2A> in its return value.</span></span> <span data-ttu-id="e0ac9-544">Il `Main` routine attende che tutte le operazioni asincrone essere completati prima di uscire.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-544">The `Main` routine waits for all asynchronous operations to be completed before exiting.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_wh.cpp#2)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_wh.cs#2)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_wh.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-545">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-545">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-546">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-546">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan -&gt; IAsyncResult" Usage="messageQueue.BeginReceive timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-547">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo di attesa necessario affinché un messaggio diventi disponibile.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-547">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-548">Avvia un'operazione di ricezione asincrona per la quale è stato specificato un periodo di timeout. L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda o non si verifica il timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-548">Initiates an asynchronous receive operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-549">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-549">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-550">Nell'elaborazione asincrona, si utilizza <xref:System.Messaging.MessageQueue.BeginReceive%2A> per generare il <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento quando un messaggio diventa disponibile nella coda o quando l'intervallo di tempo specificato è scaduto.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-550">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="e0ac9-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-552">Usare <xref:System.Messaging.MessageQueue.BeginReceive%2A>, creare un gestore eventi che elabora i risultati dell'operazione asincrona e associarla al delegato dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-552">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="e0ac9-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Avvia un'asincrona operazione di ricezione. il <xref:System.Messaging.MessageQueue> viene informato, tramite la generazione del <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento, quando arriva un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-554">Il <xref:System.Messaging.MessageQueue> può quindi accedere al messaggio chiamando <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> o il recupero di risultato mediante la <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-554">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="e0ac9-555">Il <xref:System.Messaging.MessageQueue.BeginReceive%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-555">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-556">Poiché <xref:System.Messaging.MessageQueue.BeginReceive%2A> è asincrona, è possibile chiamare in modo da ricevere un messaggio dalla coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-556">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-557">Per ricevere in modo sincrono un messaggio, utilizzare il <xref:System.Messaging.MessageQueue.Receive%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-557">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-558">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-558">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-559">Se <xref:System.Messaging.MessageQueue.CanRead%2A> viene `false`, viene generato l'evento di completamento, ma verrà generata un'eccezione quando si chiama <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-559">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-560">Il <xref:System.IAsyncResult> che <xref:System.Messaging.MessageQueue.BeginReceive%2A> restituisce identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-560">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="e0ac9-561">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-561">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-562">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-562">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-563">In questo caso, si utilizza il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-563">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-564">Questo overload specifica un timeout. Se l'intervallo specificato dal `timeout` scade parametro, questo componente genera il <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-564">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="e0ac9-565">Poiché è disponibile alcun messaggio, una chiamata successiva a <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-565">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="e0ac9-566">Non usare la chiamata asincrona <xref:System.Messaging.MessageQueue.BeginReceive%2A> con transazioni.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-566">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="e0ac9-567">Se si desidera eseguire un'operazione asincrona transazionale, chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A>e inserire la transazione e (sincrona) <xref:System.Messaging.MessageQueue.Receive%2A> metodo all'interno del gestore di evento è creare per l'operazione di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-567">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="e0ac9-568">Il gestore eventi potrebbe contenere funzionalità come illustrato nel codice c# seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-568">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="e0ac9-569">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-569">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-570">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-570">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-571">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-571">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-572">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-572">Local computer</span></span>|<span data-ttu-id="e0ac9-573">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-573">Yes</span></span>|  
|<span data-ttu-id="e0ac9-574">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-574">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-575">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-575">Yes</span></span>|  
|<span data-ttu-id="e0ac9-576">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-576">Remote computer</span></span>|<span data-ttu-id="e0ac9-577">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-577">No</span></span>|  
|<span data-ttu-id="e0ac9-578">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-578">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-579">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-579">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-580">L'esempio di codice seguente crea asincrono operazione di ricezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-580">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="e0ac9-581">L'esempio di codice crea un gestore eventi `MyReceiveCompleted`e lo collega al <xref:System.Messaging.MessageQueue.ReceiveCompleted> delegato del gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-581">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="e0ac9-582">Il codice riportato di seguito viene inviato un messaggio a una coda di messaggi locale, quindi chiama <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, passando un valore di timeout di 10 secondi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-582">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, passing in a time-out value of ten seconds.</span></span> <span data-ttu-id="e0ac9-583">Quando un <xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato l'evento, il gestore eventi riceve il messaggio e scrive il corpo del messaggio sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-583">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive1#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive1/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive1#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive1/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-584">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché rappresenta un numero negativo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-584">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly because it represents a negative number.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-585">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-585">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-586">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-586">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * obj -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-587">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo di attesa necessario affinché un messaggio diventi disponibile.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-587">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="e0ac9-588">Oggetto di stato, specificato dall'applicazione, che contiene le informazioni associate all'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-588">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-589">Avvia un'operazione di ricezione asincrona per la quale sono stati specificati un timeout e un oggetto di stato, che fornisce le informazioni associate per tutta la durata dell'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-589">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span>
          </span>
          <span data-ttu-id="e0ac9-590">L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda o non si verifica il timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-590">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-591">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-591">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-592">Nell'elaborazione asincrona, si utilizza <xref:System.Messaging.MessageQueue.BeginReceive%2A> per generare il <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento quando un messaggio diventa disponibile nella coda o quando l'intervallo di tempo specificato è scaduto.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-592">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="e0ac9-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-594">Utilizzare questo overload per associare informazioni con l'operazione che verrà mantenuto per tutta la durata dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-594">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="e0ac9-595">Il gestore eventi può rilevare queste informazioni esaminando i <xref:System.IAsyncResult.AsyncState%2A> proprietà del <xref:System.IAsyncResult> associato con l'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-595">The event handler can detect this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="e0ac9-596">Usare <xref:System.Messaging.MessageQueue.BeginReceive%2A>, creare un gestore eventi che elabora i risultati dell'operazione asincrona e associarla al delegato dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-596">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="e0ac9-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Avvia un'asincrona operazione di ricezione. il <xref:System.Messaging.MessageQueue> viene informato, tramite la generazione del <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento, quando arriva un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-598">Il <xref:System.Messaging.MessageQueue> può quindi accedere al messaggio chiamando <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> o il recupero di risultato mediante la <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-598">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="e0ac9-599">Il <xref:System.Messaging.MessageQueue.BeginReceive%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-599">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-600">Poiché <xref:System.Messaging.MessageQueue.BeginReceive%2A> è asincrona, è possibile chiamare in modo da ricevere un messaggio dalla coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-600">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-601">Per ricevere in modo sincrono un messaggio, utilizzare il <xref:System.Messaging.MessageQueue.Receive%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-601">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-602">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-602">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-603">Il <xref:System.IAsyncResult> che <xref:System.Messaging.MessageQueue.BeginReceive%2A> restituisce identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-603">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="e0ac9-604">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-604">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-605">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-605">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-606">In questo caso, si utilizza il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-606">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-607">Questo overload specifica un timeout e un oggetto di stato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-607">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="e0ac9-608">Se l'intervallo specificato dal `timeout` scade parametro, questo componente genera il <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-608">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="e0ac9-609">Poiché è disponibile alcun messaggio, una chiamata successiva a <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-609">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="e0ac9-610">L'oggetto di stato associa le informazioni sullo stato dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-610">The state object associates state information with the operation.</span></span> <span data-ttu-id="e0ac9-611">Ad esempio, se si chiama <xref:System.Messaging.MessageQueue.BeginReceive%2A> più volte per avviare più operazioni, è possibile identificare ogni operazione tramite un oggetto di stato separato definiti.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-611">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="e0ac9-612">È anche possibile usare l'oggetto di stato per passare informazioni tra i thread di processo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-612">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="e0ac9-613">Se viene avviato un thread, ma il callback è in un thread diverso in uno scenario asincrono, l'oggetto di stato viene effettuato il marshalling e passato insieme alle informazioni dall'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-613">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="e0ac9-614">Non usare la chiamata asincrona <xref:System.Messaging.MessageQueue.BeginReceive%2A> con transazioni.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-614">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="e0ac9-615">Se si desidera eseguire un'operazione asincrona transazionale, chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A>e inserire la transazione e (sincrona) <xref:System.Messaging.MessageQueue.Receive%2A> metodo all'interno del gestore di evento è creare per l'operazione di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-615">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="e0ac9-616">Il gestore eventi potrebbe contenere funzionalità come illustrato nel codice c# seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-616">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="e0ac9-617">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-617">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-618">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-618">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-619">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-619">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-620">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-620">Local computer</span></span>|<span data-ttu-id="e0ac9-621">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-621">Yes</span></span>|  
|<span data-ttu-id="e0ac9-622">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-622">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-623">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-623">Yes</span></span>|  
|<span data-ttu-id="e0ac9-624">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-624">Remote computer</span></span>|<span data-ttu-id="e0ac9-625">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-625">No</span></span>|  
|<span data-ttu-id="e0ac9-626">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-626">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-627">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-627">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-628">L'esempio di codice seguente crea asincrono operazione di ricezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-628">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="e0ac9-629">L'esempio di codice crea un gestore eventi `MyReceiveCompleted`e lo collega al <xref:System.Messaging.MessageQueue.ReceiveCompleted> delegato del gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-629">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="e0ac9-630">Il codice riportato di seguito viene inviato un messaggio a una coda di messaggi locale, quindi chiama <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, passando un valore di timeout di 10 secondi e un integer univoco che identifica il messaggio in questione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-630">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, passing in a time-out value of ten seconds and a unique integer that identifies that particular message.</span></span> <span data-ttu-id="e0ac9-631">Quando un <xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato l'evento, il gestore eventi riceve il messaggio e scrive il corpo del messaggio e l'identificatore del messaggio sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-631">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive2#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive2/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive2#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive2/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-632">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-632">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-633">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-633">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-634">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-634">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, stateObject, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-635">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo di attesa necessario affinché un messaggio diventi disponibile.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-635">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="e0ac9-636">Oggetto di stato, specificato dall'applicazione, che contiene le informazioni associate all'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-636">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <param name="callback">
          <span data-ttu-id="e0ac9-637">
            <see cref="T:System.AsyncCallback" /> che riceverà la notifica del completamento dell'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-637">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-638">Avvia un'operazione di ricezione asincrona per la quale sono stati specificati un timeout e un oggetto di stato, che fornisce le informazioni associate per tutta la durata dell'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-638">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span>
          </span>
          <span data-ttu-id="e0ac9-639">Questo overload riceve mediante un callback la notifica dell'identità del gestore eventi per l'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-639">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span>
          </span>
          <span data-ttu-id="e0ac9-640">L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda o non si verifica il timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-640">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-641">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-641">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-642">Quando si utilizza questo overload, il callback specificato nel parametro di callback viene richiamato direttamente quando un messaggio diventa disponibile nella coda o quando l'intervallo di tempo specificato è scaduto. il <xref:System.Messaging.MessageQueue.ReceiveCompleted> non viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-642">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="e0ac9-643">Gli altri overload del <xref:System.Messaging.MessageQueue.BeginReceive%2A> si basano su questo componente per generare il <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-643">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="e0ac9-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-645">Usare <xref:System.Messaging.MessageQueue.BeginReceive%2A>, creare un gestore eventi che elabora i risultati dell'operazione asincrona e associarla al delegato dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-645">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="e0ac9-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Avvia un'asincrona operazione di ricezione. il <xref:System.Messaging.MessageQueue> viene informato, tramite la generazione del <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento, quando arriva un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-647">Il <xref:System.Messaging.MessageQueue> può quindi accedere al messaggio chiamando <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> o il recupero di risultato mediante la <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-647">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="e0ac9-648">Il <xref:System.Messaging.MessageQueue.BeginReceive%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-648">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-649">Poiché <xref:System.Messaging.MessageQueue.BeginReceive%2A> è asincrona, è possibile chiamare in modo da ricevere un messaggio dalla coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-649">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-650">Per ricevere in modo sincrono un messaggio, utilizzare il <xref:System.Messaging.MessageQueue.Receive%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-650">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-651">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-651">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-652">Il <xref:System.IAsyncResult> che <xref:System.Messaging.MessageQueue.BeginReceive%2A> restituisce identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-652">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="e0ac9-653">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-653">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-654">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-654">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-655">In questo caso, si utilizza il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-655">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-656">L'oggetto di stato associa le informazioni sullo stato dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-656">The state object associates state information with the operation.</span></span> <span data-ttu-id="e0ac9-657">Ad esempio, se si chiama <xref:System.Messaging.MessageQueue.BeginReceive%2A> più volte per avviare più operazioni, è possibile identificare ogni operazione tramite un oggetto di stato separato definiti.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-657">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="e0ac9-658">È anche possibile usare l'oggetto di stato per passare informazioni tra i thread di processo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-658">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="e0ac9-659">Se viene avviato un thread, ma il callback è in un thread diverso in uno scenario asincrono, l'oggetto di stato viene effettuato il marshalling e passato insieme alle informazioni dall'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-659">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="e0ac9-660">Non usare la chiamata asincrona <xref:System.Messaging.MessageQueue.BeginReceive%2A> con transazioni.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-660">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="e0ac9-661">Se si desidera eseguire un'operazione asincrona transazionale, chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A>e inserire la transazione e (sincrona) <xref:System.Messaging.MessageQueue.Receive%2A> metodo all'interno del gestore di evento è creare per l'operazione di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-661">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="e0ac9-662">Il gestore eventi potrebbe contenere funzionalità come illustrato nel codice c# seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-662">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="e0ac9-663">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-663">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-664">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-664">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-665">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-665">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-666">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-666">Local computer</span></span>|<span data-ttu-id="e0ac9-667">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-667">Yes</span></span>|  
|<span data-ttu-id="e0ac9-668">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-668">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-669">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-669">Yes</span></span>|  
|<span data-ttu-id="e0ac9-670">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-670">Remote computer</span></span>|<span data-ttu-id="e0ac9-671">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-671">No</span></span>|  
|<span data-ttu-id="e0ac9-672">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-672">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-673">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-673">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-674">L'esempio di codice seguente crea asincrono operazione di ricezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-674">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="e0ac9-675">Il codice riportato di seguito viene inviato un messaggio a una coda di messaggi locale, quindi chiama <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passando: un valore di timeout di 10 secondi, un numero intero univoco che identifica il messaggio in questione; e una nuova istanza della <xref:System.AsyncCallback> che identifica il gestore eventi `MyReceiveCompleted`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-675">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyReceiveCompleted`.</span></span> <span data-ttu-id="e0ac9-676">Quando un <xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato l'evento, il gestore eventi riceve il messaggio e scrive il corpo del messaggio e l'identificatore del messaggio sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-676">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive3#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive3/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive3#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive3/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-677">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-677">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-678">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-678">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-679">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-679">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, System.Messaging.Cursor cursor, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Messaging.Cursor,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * System.Messaging.Cursor * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, cursor, state, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="state" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-680">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo di attesa necessario affinché un messaggio diventi disponibile.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-680">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="e0ac9-681">Oggetto <see cref="T:System.Messaging.Cursor" /> che occupa una posizione specifica nella coda messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-681">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="state">
          <span data-ttu-id="e0ac9-682">Oggetto di stato, specificato dall'applicazione, che contiene le informazioni associate all'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-682">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <param name="callback">
          <span data-ttu-id="e0ac9-683">
            <see cref="T:System.AsyncCallback" /> che riceve la notifica del completamento dell'operazione asincrona.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-683">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-684">Avvia un'operazione di ricezione asincrona che presenta il timeout specificato e che utilizza il cursore specificato, l'azione di lettura specificata e l'oggetto di stato specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-684">Initiates an asynchronous receive operation that has a specified time-out and uses a specified cursor and a specified state object.</span>
          </span>
          <span data-ttu-id="e0ac9-685">L'oggetto di stato fornisce informazioni associate per l'intera durata dell'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-685">The state object provides associated information throughout the lifetime of the operation.</span>
          </span>
          <span data-ttu-id="e0ac9-686">Questo overload riceve mediante un callback la notifica dell'identità del gestore eventi per l'operazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-686">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span>
          </span>
          <span data-ttu-id="e0ac9-687">L'operazione non è completa fino a quando un messaggio non viene reso disponibile nella coda o non si verifica il timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-687">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-688">
            <see cref="T:System.IAsyncResult" /> che identifica la richiesta asincrona inviata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-688">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-689">Quando si utilizza questo overload, il callback specificato nel parametro di callback viene richiamato direttamente quando un messaggio diventa disponibile nella coda o quando l'intervallo di tempo specificato è scaduto. il <xref:System.Messaging.MessageQueue.ReceiveCompleted> non viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-689">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="e0ac9-690">Gli altri overload del <xref:System.Messaging.MessageQueue.BeginReceive%2A> si basano su questo componente per generare il <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-690">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="e0ac9-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato anche se esiste già un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-692">Usare <xref:System.Messaging.MessageQueue.BeginReceive%2A>, creare un gestore eventi che elabora i risultati dell'operazione asincrona e associarla al delegato dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-692">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="e0ac9-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Avvia un'asincrona operazione di ricezione. il <xref:System.Messaging.MessageQueue> viene informato, tramite la generazione del <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento, quando arriva un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-694">Il <xref:System.Messaging.MessageQueue> può quindi accedere al messaggio chiamando <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> o il recupero di risultato mediante la <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-694">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="e0ac9-695">Il <xref:System.Messaging.MessageQueue.BeginReceive%2A> metodo viene restituito immediatamente, ma l'operazione asincrona non viene completata fino a quando non viene chiamato il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-695">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="e0ac9-696">Poiché <xref:System.Messaging.MessageQueue.BeginReceive%2A> è asincrona, è possibile chiamare in modo da ricevere un messaggio dalla coda senza bloccare il thread di esecuzione corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-696">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="e0ac9-697">Per ricevere in modo sincrono un messaggio, utilizzare il <xref:System.Messaging.MessageQueue.Receive%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-697">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-698">Al termine dell'operazione asincrona, è possibile chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A> o <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente nel gestore dell'evento per continuare a ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-698">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="e0ac9-699">Il <xref:System.IAsyncResult> che <xref:System.Messaging.MessageQueue.BeginReceive%2A> restituisce identifica l'operazione asincrona avviata dal metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-699">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="e0ac9-700">È possibile usare questo <xref:System.IAsyncResult> tutta la durata dell'operazione, anche se in genere non si usa solo <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-700">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="e0ac9-701">Tuttavia, se si avviano più operazioni asincrone, è possibile inserire i <xref:System.IAsyncResult> i valori in una matrice e specificare se si desidera attendere che tutte le operazioni o qualsiasi operazione di completamento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-701">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="e0ac9-702">In questo caso, usare il <xref:System.IAsyncResult.AsyncWaitHandle%2A> proprietà del <xref:System.IAsyncResult> per identificare l'operazione completata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-702">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="e0ac9-703">L'oggetto di stato associa le informazioni sullo stato dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-703">The state object associates state information with the operation.</span></span> <span data-ttu-id="e0ac9-704">Ad esempio, se si chiama <xref:System.Messaging.MessageQueue.BeginReceive%2A> più volte per avviare più operazioni, è possibile identificare ogni operazione tramite un oggetto di stato separato definiti.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-704">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="e0ac9-705">È anche possibile usare l'oggetto di stato per passare informazioni tra i thread di processo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-705">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="e0ac9-706">Se viene avviato un thread, ma il callback è in un thread diverso in uno scenario asincrono, l'oggetto di stato viene effettuato il marshalling e passato insieme alle informazioni dall'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-706">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="e0ac9-707">Non usare la chiamata asincrona <xref:System.Messaging.MessageQueue.BeginReceive%2A> con transazioni.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-707">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="e0ac9-708">Se si desidera eseguire un'operazione asincrona transazionale, chiamare <xref:System.Messaging.MessageQueue.BeginPeek%2A>e inserire la transazione e (sincrona) <xref:System.Messaging.MessageQueue.Receive%2A> metodo all'interno del gestore di evento è creare per l'operazione di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-708">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="e0ac9-709">Il gestore eventi potrebbe contenere funzionalità come illustrato nel codice c# seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-709">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="e0ac9-710">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-710">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-711">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-711">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-712">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-712">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-713">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-713">Local computer</span></span>|<span data-ttu-id="e0ac9-714">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-714">Yes</span></span>|  
|<span data-ttu-id="e0ac9-715">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-715">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-716">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-716">Yes</span></span>|  
|<span data-ttu-id="e0ac9-717">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-717">Remote computer</span></span>|<span data-ttu-id="e0ac9-718">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-718">No</span></span>|  
|<span data-ttu-id="e0ac9-719">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-719">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-720">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-720">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-721">Il valore del parametro <paramref name="cursor" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-721">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-722">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-722">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-723">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-723">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-724">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-724">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="CanRead">
      <MemberSignature Language="C#" Value="public bool CanRead { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanRead" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanRead" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanRead As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanRead { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CanRead : bool" Usage="System.Messaging.MessageQueue.CanRead" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanRead")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-725">Ottiene un valore che indica se è possibile leggere l'oggetto <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-725">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be read.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-726">
            <see langword="true" /> se <see cref="T:System.Messaging.MessageQueue" /> esiste e l'applicazione è in grado di eseguirne la lettura; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-726">
              <see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can read from it; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-727"><xref:System.Messaging.MessageQueue.CanRead%2A> indica se l'applicazione è in grado di leggere o ricevere messaggi dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-727"><xref:System.Messaging.MessageQueue.CanRead%2A> indicates whether the application is able to peek or receive messages from the queue.</span></span> <span data-ttu-id="e0ac9-728">Se <xref:System.Messaging.MessageQueue.CanRead%2A> viene `true`, il <xref:System.Messaging.MessageQueue> può ricevere o leggere i messaggi dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-728">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `true`, the <xref:System.Messaging.MessageQueue> can receive or peek messages from the queue.</span></span> <span data-ttu-id="e0ac9-729">In caso contrario, questo non è possibile.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-729">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="e0ac9-730"><xref:System.Messaging.MessageQueue.CanRead%2A> viene `false` se una coda è già aperta con accesso in lettura esclusivo (o se è aperto con accesso non esclusivo e ciò <xref:System.Messaging.MessageQueue> richiede l'accesso esclusivo), o se l'applicazione non ha diritti sufficienti per accedervi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-730"><xref:System.Messaging.MessageQueue.CanRead%2A> is `false` if a queue is already open with exclusive read access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="e0ac9-731">Se l'applicazione tenta di leggere da una coda quando <xref:System.Messaging.MessageQueue.CanRead%2A> è `false`, viene negato l'accesso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-731">If your application tries to read from a queue when <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="e0ac9-732">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-732">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-733">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-733">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-734">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-734">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-735">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-735">Local computer</span></span>|<span data-ttu-id="e0ac9-736">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-736">Yes</span></span>|  
|<span data-ttu-id="e0ac9-737">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-737">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-738">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-738">Yes</span></span>|  
|<span data-ttu-id="e0ac9-739">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-739">Remote computer</span></span>|<span data-ttu-id="e0ac9-740">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-740">No</span></span>|  
|<span data-ttu-id="e0ac9-741">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-741">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-742">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-742">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-743">Esempio di codice seguente consente di visualizzare il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.CanRead%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-743">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanRead%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
    <Member MemberName="CanWrite">
      <MemberSignature Language="C#" Value="public bool CanWrite { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanWrite" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanWrite" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanWrite As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanWrite { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CanWrite : bool" Usage="System.Messaging.MessageQueue.CanWrite" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanWrite")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-744">Ottiene un valore che indica se è possibile scrivere nell'oggetto <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-744">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be written to.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-745">
            <see langword="true" /> se <see cref="T:System.Messaging.MessageQueue" /> esiste e l'applicazione è in grado di eseguirne la scrittura; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-745">
              <see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can write to it; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> indica se l'applicazione è in grado di inviare messaggi alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> indicates whether the application is able to send messages to the queue.</span></span> <span data-ttu-id="e0ac9-747">Se <xref:System.Messaging.MessageQueue.CanWrite%2A> viene `true`, il <xref:System.Messaging.MessageQueue> può inviare messaggi alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-747">If <xref:System.Messaging.MessageQueue.CanWrite%2A> is `true`, the <xref:System.Messaging.MessageQueue> can send messages to the queue.</span></span> <span data-ttu-id="e0ac9-748">In caso contrario, questo non è possibile.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-748">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="e0ac9-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> viene `false` se una coda è già aperta con accesso in scrittura esclusivo (o se è aperto con accesso non esclusivo e ciò <xref:System.Messaging.MessageQueue> richiede l'accesso esclusivo), o se l'applicazione non ha diritti sufficienti per accedervi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> is `false` if a queue is already open with exclusive write access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="e0ac9-750">Se l'applicazione tenta di scrivere in una coda quando <xref:System.Messaging.MessageQueue.CanWrite%2A> è `false`, viene negato l'accesso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-750">If your application tries to write to a queue when <xref:System.Messaging.MessageQueue.CanWrite%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="e0ac9-751">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-751">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-752">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-752">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-753">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-753">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-754">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-754">Local computer</span></span>|<span data-ttu-id="e0ac9-755">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-755">Yes</span></span>|  
|<span data-ttu-id="e0ac9-756">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-756">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-757">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-757">Yes</span></span>|  
|<span data-ttu-id="e0ac9-758">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-758">Remote computer</span></span>|<span data-ttu-id="e0ac9-759">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-759">No</span></span>|  
|<span data-ttu-id="e0ac9-760">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-760">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-761">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-761">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-762">Esempio di codice seguente consente di visualizzare il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.CanWrite%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-762">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanWrite%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
      </Docs>
    </Member>
    <Member MemberName="Category">
      <MemberSignature Language="C#" Value="public Guid Category { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Category" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Category" />
      <MemberSignature Language="VB.NET" Value="Public Property Category As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Category { Guid get(); void set(Guid value); };" />
      <MemberSignature Language="F#" Value="member this.Category : Guid with get, set" Usage="System.Messaging.MessageQueue.Category" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Category")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-763">Ottiene o imposta la categoria della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-763">Gets or sets the queue category.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-764">Oggetto <see cref="T:System.Guid" /> che rappresenta la categoria della coda (identificatore del tipo di Accodamento messaggi), che consente a un'applicazione di suddividere per categoria le relative code.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-764">A <see cref="T:System.Guid" /> that represents the queue category (Message Queuing type identifier), which allows an application to categorize its queues.</span>
          </span>
          <span data-ttu-id="e0ac9-765">Il valore predefinito è <see langword="Guid.empty" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-765">The default is <see langword="Guid.empty" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-766">La categoria della coda consente a un'applicazione suddividere in categorie proprie code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-766">The queue category allows an application to categorize its queues.</span></span> <span data-ttu-id="e0ac9-767">Ad esempio, è possibile inserire tutte le code di fatturazione in un'unica categoria e tutte le code di ordini in un altro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-767">For example, you can place all Billing queues in one category and all Order queues in another.</span></span>  
  
 <span data-ttu-id="e0ac9-768">Il <xref:System.Messaging.MessageQueue.Category%2A> proprietà offre l'accesso alla proprietà ID del tipo Accodamento messaggi, ovvero di lettura/scrittura, accessibile tramite il **le proprietà della coda** finestra di dialogo nella Console di gestione di Computer.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-768">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing Type ID property (which is read/write), accessible through the **Queue Properties** dialog box in the Computer Management Console.</span></span> <span data-ttu-id="e0ac9-769">È possibile definire una nuova categoria.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-769">You can define a new category.</span></span> <span data-ttu-id="e0ac9-770">Sebbene sia possibile usare <xref:System.Guid.NewGuid%2A> per creare un valore di categoria che sia univoco all'interno <xref:System.Guid> valori, tale operazione è necessaria.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-770">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, such an action is unnecessary.</span></span> <span data-ttu-id="e0ac9-771">Il valore della categoria deve essere distinti solo da altre categorie, non da tutte le altre <xref:System.Guid> valori.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-771">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="e0ac9-772">Ad esempio, è possibile assegnare {00000000-0000-0000-0000-000000000001} come il <xref:System.Messaging.MessageQueue.Category%2A> per un set di code e {00000000-0000-0000-0000-000000000002} come il <xref:System.Messaging.MessageQueue.Category%2A> per un altro set.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-772">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="e0ac9-773">Non è necessario impostare il <xref:System.Messaging.MessageQueue.Category%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-773">It is not necessary to set the <xref:System.Messaging.MessageQueue.Category%2A>.</span></span> <span data-ttu-id="e0ac9-774">Il valore può essere `null`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-774">The value can be `null`.</span></span>  
  
 <span data-ttu-id="e0ac9-775">Impostando questa proprietà viene modificata la coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-775">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-776">Pertanto, qualsiasi altro <xref:System.Messaging.MessageQueue> istanze sono interessate dalla modifica.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-776">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="e0ac9-777">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-777">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-778">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-778">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-779">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-779">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-780">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-780">Local computer</span></span>|<span data-ttu-id="e0ac9-781">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-781">Yes</span></span>|  
|<span data-ttu-id="e0ac9-782">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-782">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-783">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-783">Yes</span></span>|  
|<span data-ttu-id="e0ac9-784">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-784">Remote computer</span></span>|<span data-ttu-id="e0ac9-785">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-785">No</span></span>|  
|<span data-ttu-id="e0ac9-786">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-786">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-787">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-787">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-788">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.Category%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-788">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Category%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-789">La categoria della coda è stata impostata su un valore non valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-789">The queue category was set to an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-790">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-790">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Id" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ClearConnectionCache">
      <MemberSignature Language="C#" Value="public static void ClearConnectionCache ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ClearConnectionCache() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ClearConnectionCache ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ClearConnectionCache();" />
      <MemberSignature Language="F#" Value="static member ClearConnectionCache : unit -&gt; unit" Usage="System.Messaging.MessageQueue.ClearConnectionCache " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-791">Svuota la cache delle connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-791">Clears the connection cache.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-792">Quando si chiama <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, i nomi dei formati memorizzati nella cache vengono rimossi e vengono chiusi gli handle aperti e memorizzato nella cache.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-792">When you call <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, the format names stored in the cache are removed and handles opened and stored in the cache are closed.</span></span>  
  
 <span data-ttu-id="e0ac9-793">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-793">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-794">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-794">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-795">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-795">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-796">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-796">Local computer</span></span>|<span data-ttu-id="e0ac9-797">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-797">Yes</span></span>|  
|<span data-ttu-id="e0ac9-798">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-798">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-799">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-799">Yes</span></span>|  
|<span data-ttu-id="e0ac9-800">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-800">Remote computer</span></span>|<span data-ttu-id="e0ac9-801">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-801">Yes</span></span>|  
|<span data-ttu-id="e0ac9-802">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-802">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-803">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-803">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-804">Nell'esempio di codice riportato di seguito viene chiamato il metodo <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-804">The following code example calls <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span></span>  
  
 [!code-csharp[MessageQueue#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="messageQueue.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-805">Libera tutte le risorse allocate da <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-805">Frees all resources allocated by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-806"><xref:System.Messaging.MessageQueue.Close%2A> libera tutte le risorse associate un <xref:System.Messaging.MessageQueue>, tra cui risorse condivise, se appropriato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-806"><xref:System.Messaging.MessageQueue.Close%2A> frees all resources associated with a <xref:System.Messaging.MessageQueue>, including shared resources if appropriate.</span></span> <span data-ttu-id="e0ac9-807">Il sistema acquisisce di nuovo queste risorse automaticamente se sono ancora disponibili, ad esempio quando si chiama il <xref:System.Messaging.MessageQueue.Send%28System.Object%29> (metodo), come nel codice c# seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-807">The system re-acquires these resources automatically if they are still available, for example when you call the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method, as in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.Send("Text 1.");  
myMessageQueue.Close();  
myMessageQueue.Send("Text 2."); //Resources are re-acquired.  
```  
  
 <span data-ttu-id="e0ac9-808">Quando si chiama <xref:System.Messaging.MessageQueue.Close%2A>, tutte le <xref:System.Messaging.MessageQueue> proprietà che accedono direttamente la coda di Accodamento messaggi vengono eliminate. Il <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, e <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> tutti rimangono invariati.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-808">When you call <xref:System.Messaging.MessageQueue.Close%2A>, all <xref:System.Messaging.MessageQueue> properties that directly access the Message Queuing queue are cleared out. The <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, and <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> all remain as they were.</span></span>  
  
 <span data-ttu-id="e0ac9-809"><xref:System.Messaging.MessageQueue.Close%2A> non sempre gratuito di lettura e scrittura handle a una coda, perché potrebbero essere condivisi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-809"><xref:System.Messaging.MessageQueue.Close%2A> does not always free the read and write handles to a queue, because they might be shared.</span></span> <span data-ttu-id="e0ac9-810">È possibile usare uno dei passaggi seguenti per garantire che <xref:System.Messaging.MessageQueue.Close%2A> libera gli handle di lettura e scrittura a una coda:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-810">You can take any of the following steps to ensure that <xref:System.Messaging.MessageQueue.Close%2A> frees the read and write handles to a queue:</span></span>  
  
-   <span data-ttu-id="e0ac9-811">Creare il <xref:System.Messaging.MessageQueue> con accesso esclusivo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-811">Create the <xref:System.Messaging.MessageQueue> with exclusive access.</span></span> <span data-ttu-id="e0ac9-812">A tale scopo, chiamare il <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> oppure <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> costruttore e set il `sharedModeDenyReceive` parametro per `true`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-812">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> or <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor, and set the `sharedModeDenyReceive` parameter to `true`.</span></span>  
  
-   <span data-ttu-id="e0ac9-813">Creare il <xref:System.Messaging.MessageQueue> con connessione la memorizzazione nella cache disabilitata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-813">Create the <xref:System.Messaging.MessageQueue> with connection caching disabled.</span></span> <span data-ttu-id="e0ac9-814">A tale scopo, chiamare il <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> costruttore e impostare il `enableConnectionCache` parametro per `false`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-814">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor and set the `enableConnectionCache` parameter to `false`.</span></span>  
  
-   <span data-ttu-id="e0ac9-815">Disabilitare la memorizzazione nella cache di connessione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-815">Disable connection caching.</span></span> <span data-ttu-id="e0ac9-816">A tale scopo, impostare il <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> proprietà `false`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-816">To do so, set the <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property to `false`.</span></span>  
  
 <span data-ttu-id="e0ac9-817">È necessario chiamare <xref:System.Messaging.MessageQueue.Close%2A> per una coda prima di eliminare la coda nel server di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-817">You should call <xref:System.Messaging.MessageQueue.Close%2A> for a queue before you delete the queue on the Message Queuing server.</span></span> <span data-ttu-id="e0ac9-818">In caso contrario, i messaggi inviati alla coda è stato possibile generare eccezioni o vengono visualizzati nella coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-818">Otherwise, messages sent to the queue could throw exceptions or appear in the dead-letter queue.</span></span>  
  
 <span data-ttu-id="e0ac9-819">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-819">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-820">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-820">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-821">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-821">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-822">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-822">Local computer</span></span>|<span data-ttu-id="e0ac9-823">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-823">Yes</span></span>|  
|<span data-ttu-id="e0ac9-824">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-824">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-825">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-825">Yes</span></span>|  
|<span data-ttu-id="e0ac9-826">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-826">Remote computer</span></span>|<span data-ttu-id="e0ac9-827">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-827">Yes</span></span>|  
|<span data-ttu-id="e0ac9-828">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-828">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-829">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-829">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-830">Esempio di codice seguente chiude una coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-830">The following code example closes a Message Queuing queue.</span></span>  
  
 [!code-cpp[MessageQueue.Close#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Close/CPP/mqclose.cpp#1)]
 [!code-csharp[MessageQueue.Close#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Close/CS/mqclose.cs#1)]
 [!code-vb[MessageQueue.Close#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Close/VB/mqclose.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Create">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-831">Crea una nuova coda nel percorso specificato su un server di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-831">Creates a new queue at the specified path on a Message Queuing server.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Create : string -&gt; System.Messaging.MessageQueue" Usage="System.Messaging.MessageQueue.Create path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="e0ac9-832">Percorso della coda da creare.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-832">The path of the queue to create.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-833">Crea una coda non transazionale di Accodamento messaggi nel percorso specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-833">Creates a non-transactional Message Queuing queue at the specified path.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-834">Oggetto <see cref="T:System.Messaging.MessageQueue" /> che rappresenta la nuova coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-834">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-835">Utilizzare questo overload per creare una coda non transazionale di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-835">Use this overload to create a non-transactional Message Queuing queue.</span></span>  
  
 <span data-ttu-id="e0ac9-836">Per creare una nuova istanza della <xref:System.Messaging.MessageQueue> classe nell'applicazione e associarlo a una coda esistente, usare il <xref:System.Messaging.MessageQueue.%23ctor%2A> costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-836">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="e0ac9-837">Per creare una nuova coda in Accodamento messaggi, chiamare <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-837">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-838">La sintassi per il `path` parametro dipende il tipo di coda cui fa riferimento, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-838">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="e0ac9-839">Tipo di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-839">Queue type</span></span>|<span data-ttu-id="e0ac9-840">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-840">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="e0ac9-841">coda pubblica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-841">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="e0ac9-842">coda privata</span><span class="sxs-lookup"><span data-stu-id="e0ac9-842">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="e0ac9-843">Usare "." per il computer locale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-843">Use "." for the local computer.</span></span> <span data-ttu-id="e0ac9-844">Per ulteriori informazioni sulla sintassi, vedere il <xref:System.Messaging.MessageQueue.Path%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-844">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="e0ac9-845">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-845">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-846">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-846">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-847">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-847">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-848">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-848">Local computer</span></span>|<span data-ttu-id="e0ac9-849">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-849">Yes</span></span>|  
|<span data-ttu-id="e0ac9-850">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-850">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-851">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-851">Yes</span></span>|  
|<span data-ttu-id="e0ac9-852">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-852">Remote computer</span></span>|<span data-ttu-id="e0ac9-853">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-853">No</span></span>|  
|<span data-ttu-id="e0ac9-854">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-854">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-855">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-855">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-856">Esempio di codice seguente crea le code pubbliche e private.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-856">The following code example creates public and private queues.</span></span> <span data-ttu-id="e0ac9-857">Invia un messaggio a code selezionate.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-857">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_path/CPP/mqcreate.cpp#1)]
 [!code-csharp[MessageQueue.Create_path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_path/CS/mqcreate.cs#1)]
 [!code-vb[MessageQueue.Create_path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_path/VB/mqcreate.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-858">Il parametro <paramref name="path" /> è <see langword="null" /> o è una stringa vuota ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-858">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-859">La coda è già presente nel percorso specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-859">A queue already exists at the specified path.</span>
          </span>
          <span data-ttu-id="e0ac9-860">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-860">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-861">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-861">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
      </Docs>
    </Member>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path, bool transactional);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path, bool transactional) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String, transactional As Boolean) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path, bool transactional);" />
      <MemberSignature Language="F#" Value="static member Create : string * bool -&gt; System.Messaging.MessageQueue" Usage="System.Messaging.MessageQueue.Create (path, transactional)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="transactional" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="e0ac9-862">Percorso della coda da creare.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-862">The path of the queue to create.</span>
          </span>
        </param>
        <param name="transactional">
          <span data-ttu-id="e0ac9-863">
            <see langword="true" /> per creare una coda transazionale; <see langword="false" /> per creare una coda non transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-863">
              <see langword="true" /> to create a transactional queue; <see langword="false" /> to create a non-transactional queue.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-864">Crea una coda transazionale o non transazionale di Accodamento messaggi nel percorso specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-864">Creates a transactional or non-transactional Message Queuing queue at the specified path.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-865">Oggetto <see cref="T:System.Messaging.MessageQueue" /> che rappresenta la nuova coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-865">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-866">È possibile utilizzare questo overload per creare una coda transazionale in Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-866">You can use this overload to create a transactional queue in Message Queuing.</span></span> <span data-ttu-id="e0ac9-867">È possibile creare una coda non transazionale, impostando il `transactional` parametro per `false` oppure chiamando l'altro overload di <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-867">You can create a non-transactional queue, by setting the `transactional` parameter to `false` or by calling the other overload of <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-868">Per creare una nuova istanza della <xref:System.Messaging.MessageQueue> classe nell'applicazione e associarlo a una coda esistente, usare il <xref:System.Messaging.MessageQueue.%23ctor%2A> costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-868">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="e0ac9-869">Per creare una nuova coda in Accodamento messaggi, chiamare <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-869">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-870">La sintassi per il `path` parametro dipende il tipo di coda cui fa riferimento, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-870">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="e0ac9-871">Tipo di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-871">Queue type</span></span>|<span data-ttu-id="e0ac9-872">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-872">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="e0ac9-873">coda pubblica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-873">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="e0ac9-874">coda privata</span><span class="sxs-lookup"><span data-stu-id="e0ac9-874">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="e0ac9-875">Usare "." per il computer locale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-875">Use "." for the local computer.</span></span> <span data-ttu-id="e0ac9-876">Per ulteriori informazioni sulla sintassi, vedere il <xref:System.Messaging.MessageQueue.Path%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-876">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="e0ac9-877">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-877">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-878">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-878">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-879">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-879">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-880">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-880">Local computer</span></span>|<span data-ttu-id="e0ac9-881">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-881">Yes</span></span>|  
|<span data-ttu-id="e0ac9-882">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-882">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-883">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-883">Yes</span></span>|  
|<span data-ttu-id="e0ac9-884">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-884">Remote computer</span></span>|<span data-ttu-id="e0ac9-885">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-885">No</span></span>|  
|<span data-ttu-id="e0ac9-886">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-886">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-887">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-887">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-888">Esempio di codice seguente crea pubbliche e private code transazionali.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-888">The following code example creates public and private transactional queues.</span></span> <span data-ttu-id="e0ac9-889">Invia un messaggio a code selezionate.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-889">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CPP/mqcreate_transactional.cpp#1)]
 [!code-csharp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CS/mqcreate_transactional.cs#1)]
 [!code-vb[MessageQueue.Create_PathTransactional#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/VB/mqcreate_transactional.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-890">Il parametro <paramref name="path" /> è <see langword="null" /> o è una stringa vuota ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-890">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-891">La coda è già presente nel percorso specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-891">A queue already exists at the specified path.</span>
          </span>
          <span data-ttu-id="e0ac9-892">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-892">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-893">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-893">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
      </Docs>
    </Member>
    <Member MemberName="CreateCursor">
      <MemberSignature Language="C#" Value="public System.Messaging.Cursor CreateCursor ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Cursor CreateCursor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.CreateCursor" />
      <MemberSignature Language="VB.NET" Value="Public Function CreateCursor () As Cursor" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Cursor ^ CreateCursor();" />
      <MemberSignature Language="F#" Value="member this.CreateCursor : unit -&gt; System.Messaging.Cursor" Usage="messageQueue.CreateCursor " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Cursor</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-894">Crea un nuovo oggetto <see cref="T:System.Messaging.Cursor" /> per la coda messaggi corrente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-894">Creates a new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-895">Nuovo oggetto <see cref="T:System.Messaging.Cursor" /> per la coda messaggi corrente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-895">A new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span>
          </span>
          <span data-ttu-id="e0ac9-896">Questo cursore viene utilizzato per mantenere una posizione specifica nella coda durante la lettura dei messaggi della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-896">This cursor is used to maintain a specific location in the queue when reading the queue's messages.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
        <altmember cref="T:System.Messaging.Cursor" />
      </Docs>
    </Member>
    <Member MemberName="CreateTime">
      <MemberSignature Language="C#" Value="public DateTime CreateTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime CreateTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CreateTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CreateTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime CreateTime { DateTime get(); };" />
      <MemberSignature Language="F#" Value="member this.CreateTime : DateTime" Usage="System.Messaging.MessageQueue.CreateTime" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CreateTime")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-897">Ottiene la data e l'ora di creazione della coda in Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-897">Gets the time and date that the queue was created in Message Queuing.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-898">Oggetto <see cref="T:System.DateTime" /> che rappresenta la data e l'ora in cui la coda è stata creata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-898">A <see cref="T:System.DateTime" /> that represents the date and time at which the queue was created.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> fa riferimento alla coda nel server di accodamento, non il <xref:System.Messaging.MessageQueue> istanza.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> refers to the queue on the Message Queuing server, not the <xref:System.Messaging.MessageQueue> instance.</span></span>  
  
 <span data-ttu-id="e0ac9-900">Se la coda esiste, questa proprietà rappresenta il tempo che la coda è stata creata, aggiornata all'ora locale del server in cui la coda esiste.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-900">If the queue exists, this property represents the time the queue was created, adjusted to the local time of the server on which the queue exists.</span></span>  
  
 <span data-ttu-id="e0ac9-901">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-901">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-902">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-902">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-903">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-903">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-904">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-904">Local computer</span></span>|<span data-ttu-id="e0ac9-905">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-905">Yes</span></span>|  
|<span data-ttu-id="e0ac9-906">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-906">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-907">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-907">Yes</span></span>|  
|<span data-ttu-id="e0ac9-908">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-908">Remote computer</span></span>|<span data-ttu-id="e0ac9-909">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-909">No</span></span>|  
|<span data-ttu-id="e0ac9-910">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-910">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-911">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-911">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-912">Esempio di codice seguente consente di visualizzare il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.CreateTime%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-912">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CreateTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-913">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-913">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.LastModifyTime" />
      </Docs>
    </Member>
    <Member MemberName="DefaultPropertiesToSend">
      <MemberSignature Language="C#" Value="public System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberSignature Language="VB.NET" Value="Public Property DefaultPropertiesToSend As DefaultPropertiesToSend" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::DefaultPropertiesToSend ^ DefaultPropertiesToSend { System::Messaging::DefaultPropertiesToSend ^ get(); void set(System::Messaging::DefaultPropertiesToSend ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DefaultPropertiesToSend : System.Messaging.DefaultPropertiesToSend with get, set" Usage="System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_DefaultPropertiesToSend")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Content)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.DefaultPropertiesToSend</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-914">Ottiene o imposta i valori di proprietà dei messaggi da utilizzare per impostazione predefinita quando vengono inviati messaggi alla coda dall'applicazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-914">Gets or sets the message property values to be used by default when the application sends messages to the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-915">Oggetto <see cref="T:System.Messaging.DefaultPropertiesToSend" /> contenente i valori predefiniti delle proprietà dei messaggi di Accodamento messaggi utilizzati quando l'applicazione invia alla coda oggetti diversi dalle istanze di <see cref="T:System.Messaging.Message" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-915">A <see cref="T:System.Messaging.DefaultPropertiesToSend" /> that contains the default Message Queuing message property values used when the application sends objects other than <see cref="T:System.Messaging.Message" /> instances to the queue.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-916">Quando si invia un oggetto che non è di tipo <xref:System.Messaging.Message> alla coda, il <xref:System.Messaging.MessageQueue> inserisce l'oggetto in un messaggio di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-916">When you send any object that is not of type <xref:System.Messaging.Message> to the queue, the <xref:System.Messaging.MessageQueue> inserts the object into a Message Queuing message.</span></span> <span data-ttu-id="e0ac9-917">A quel punto, il <xref:System.Messaging.MessageQueue> si applica al messaggio i valori di proprietà specificati nel <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-917">At that time, the <xref:System.Messaging.MessageQueue> applies to the message the property values you specify in the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property.</span></span> <span data-ttu-id="e0ac9-918">Viceversa, se si invia un <xref:System.Messaging.Message> alla coda, queste proprietà sono già specificate per l'istanza di se stesso, pertanto <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> viene ignorato per il <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-918">Conversely, if you send a <xref:System.Messaging.Message> to the queue, these properties are already specified for the instance itself, so <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> is ignored for the <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="e0ac9-919">Anche se si impostano le proprietà tramite il <xref:System.Messaging.MessageQueue> oggetti, il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> fa riferimento alle proprietà dei messaggi che vengono inviati alla coda, non alla coda stessa.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-919">Although you set the properties through the <xref:System.Messaging.MessageQueue> object, the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> refers to the properties of the messages that are sent to the queue, not the queue itself.</span></span>  
  
 <span data-ttu-id="e0ac9-920">I valori predefiniti per le proprietà vengono visualizzati nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-920">The default values for the properties are shown in the following table.</span></span>  
  
|<span data-ttu-id="e0ac9-921">Proprietà</span><span class="sxs-lookup"><span data-stu-id="e0ac9-921">Property</span></span>|<span data-ttu-id="e0ac9-922">Valore predefinito</span><span class="sxs-lookup"><span data-stu-id="e0ac9-922">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.DefaultPropertiesToSend.AcknowledgeType%2A>|`AcknowledgeType.None`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AdministrationQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AppSpecific%2A>|<span data-ttu-id="e0ac9-923">zero (0)</span><span class="sxs-lookup"><span data-stu-id="e0ac9-923">Zero (0)</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.AttachSenderId%2A>|`true`|  
|<xref:System.Messaging.DefaultPropertiesToSend.EncryptionAlgorithm%2A>|`EncryptionAlgorithm.RC2`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Extension%2A>|<span data-ttu-id="e0ac9-924">Una matrice di byte di lunghezza zero</span><span class="sxs-lookup"><span data-stu-id="e0ac9-924">A zero-length array of bytes</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.HashAlgorithm%2A>|`HashAlgorithm.MD5`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Label%2A>|<span data-ttu-id="e0ac9-925">una stringa vuota ("")</span><span class="sxs-lookup"><span data-stu-id="e0ac9-925">Empty string ("")</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.Priority%2A>|`MessagePriority.Normal`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Recoverable%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.ResponseQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToBeReceived%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToReachQueue%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TransactionStatusQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="e0ac9-926">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-926">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-927">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-927">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-928">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-928">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-929">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-929">Local computer</span></span>|<span data-ttu-id="e0ac9-930">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-930">Yes</span></span>|  
|<span data-ttu-id="e0ac9-931">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-931">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-932">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-932">Yes</span></span>|  
|<span data-ttu-id="e0ac9-933">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-933">Remote computer</span></span>|<span data-ttu-id="e0ac9-934">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-934">Yes</span></span>|  
|<span data-ttu-id="e0ac9-935">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-935">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-936">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-936">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-937">Esempio di codice seguente usa la priorità di un messaggio per determinare le proprietà predefinite per l'invio del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-937">The following code example uses the priority of a message to determine default properties to send for the message.</span></span>  
  
 [!code-cpp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CPP/mqdefaultpropertiestosend.cpp#1)]
 [!code-csharp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CS/mqdefaultpropertiestosend.cs#1)]
 [!code-vb[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/VB/mqdefaultpropertiestosend.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-938">Non è possibile impostare le proprietà predefinite per la coda, probabilmente perché una proprietà non è valida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-938">The default properties could not be set for the queue, possibly because one of the properties is not valid.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.AcknowledgeTypes" />
        <altmember cref="T:System.Messaging.EncryptionAlgorithm" />
        <altmember cref="T:System.Messaging.HashAlgorithm" />
        <altmember cref="F:System.Messaging.Message.InfiniteTimeout" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Delete : string -&gt; unit" Usage="System.Messaging.MessageQueue.Delete path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="e0ac9-939">Posizione della coda da eliminare.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-939">The location of the queue to be deleted.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-940">Elimina una coda su un server di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-940">Deletes a queue on a Message Queuing server.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-941">La sintassi per il `path` parametro dipende dal tipo di coda dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-941">The syntax for the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="e0ac9-942">Tipo di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-942">Queue type</span></span>|<span data-ttu-id="e0ac9-943">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-943">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="e0ac9-944">coda pubblica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-944">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="e0ac9-945">coda privata</span><span class="sxs-lookup"><span data-stu-id="e0ac9-945">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="e0ac9-946">Per ulteriori informazioni sulla sintassi, vedere il <xref:System.Messaging.MessageQueue.Path%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-946">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="e0ac9-947">In alternativa, è possibile usare la <xref:System.Messaging.MessageQueue.FormatName%2A> o <xref:System.Messaging.MessageQueue.Label%2A> per descrivere il percorso della coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-947">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="e0ac9-948">Riferimenti</span><span class="sxs-lookup"><span data-stu-id="e0ac9-948">Reference</span></span>|<span data-ttu-id="e0ac9-949">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-949">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="e0ac9-950">Nome del formato</span><span class="sxs-lookup"><span data-stu-id="e0ac9-950">Format name</span></span>|<span data-ttu-id="e0ac9-951">FormatName: [ *nome del formato* ]</span><span class="sxs-lookup"><span data-stu-id="e0ac9-951">FormatName:[ *format name* ]</span></span>|  
|<span data-ttu-id="e0ac9-952">Label</span><span class="sxs-lookup"><span data-stu-id="e0ac9-952">Label</span></span>|<span data-ttu-id="e0ac9-953">Etichetta: [ *etichetta* ]</span><span class="sxs-lookup"><span data-stu-id="e0ac9-953">Label:[ *label* ]</span></span>|  
  
 <span data-ttu-id="e0ac9-954">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-954">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-955">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-955">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-956">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-956">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-957">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-957">Local computer</span></span>|<span data-ttu-id="e0ac9-958">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-958">Yes</span></span>|  
|<span data-ttu-id="e0ac9-959">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-959">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-960">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-960">Yes</span></span>|  
|<span data-ttu-id="e0ac9-961">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-961">Remote computer</span></span>|<span data-ttu-id="e0ac9-962">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-962">No</span></span>|  
|<span data-ttu-id="e0ac9-963">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-963">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-964">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-964">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-965">Esempio di codice seguente elimina una coda di accodamento, se presente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-965">The following code example deletes a Message Queuing queue, if it exists.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-966">Il parametro <paramref name="path" /> è <see langword="null" /> o è una stringa vuota ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-966">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-967">La sintassi del parametro <paramref name="path" /> non è valida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-967">The syntax for the <paramref name="path" /> parameter is not valid.</span>
          </span>
          <span data-ttu-id="e0ac9-968">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-968">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-969">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-969">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="DenySharedReceive">
      <MemberSignature Language="C#" Value="public bool DenySharedReceive { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool DenySharedReceive" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberSignature Language="VB.NET" Value="Public Property DenySharedReceive As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool DenySharedReceive { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.DenySharedReceive : bool with get, set" Usage="System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_DenySharedReceive")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-970">Ottiene o imposta un valore che indica se l'oggetto <see cref="T:System.Messaging.MessageQueue" /> dispone dell'accesso esclusivo per la ricezione dei messaggi dalla coda di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-970">Gets or sets a value that indicates whether this <see cref="T:System.Messaging.MessageQueue" /> has exclusive access to receive messages from the Message Queuing queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-971">
            <see langword="true" /> se <see cref="T:System.Messaging.MessageQueue" /> dispone dei diritti esclusivi per ricevere messaggi dalla coda; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-971">
              <see langword="true" /> if this <see cref="T:System.Messaging.MessageQueue" /> has exclusive rights to receive messages from the queue; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="e0ac9-972">Il valore predefinito è <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-972">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> Specifica la modalità condivisa della coda fa riferimento questo <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> specifies the shared mode of the queue referenced by this <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="e0ac9-974">Impostare <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> al `true` per indicare che solo ciò <xref:System.Messaging.MessageQueue> devono avere accesso a leggere o ricevere messaggi dalla coda con l'oggetto specificato <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-974">Set <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> to `true` to indicate that only this <xref:System.Messaging.MessageQueue> should have access to peek or receive messages from the queue with the specified <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="e0ac9-975">Se un'altra <xref:System.Messaging.MessageQueue> o un'altra applicazione è associata a tale istanza, la stessa risorsa coda o dell'applicazione non sarà in grado di leggere o ricevere messaggi, ma comunque possibile inviarli.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-975">If another <xref:System.Messaging.MessageQueue> or another application is associated with the same queue resource, that instance or application will not be able to peek or receive messages, but it can still send them.</span></span>  
  
 <span data-ttu-id="e0ac9-976">Se <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> è `false`, la coda è disponibile per più applicazioni per l'invio, la lettura o la ricezione di messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-976">If <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> is `false`, the queue is available to multiple applications for sending, peeking, or receiving messages.</span></span>  
  
 <span data-ttu-id="e0ac9-977">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-977">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-978">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-978">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-979">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-979">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-980">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-980">Local computer</span></span>|<span data-ttu-id="e0ac9-981">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-981">Yes</span></span>|  
|<span data-ttu-id="e0ac9-982">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-982">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-983">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-983">Yes</span></span>|  
|<span data-ttu-id="e0ac9-984">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-984">Remote computer</span></span>|<span data-ttu-id="e0ac9-985">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-985">Yes</span></span>|  
|<span data-ttu-id="e0ac9-986">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-986">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-987">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-987">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-988">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-988">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="abstract member Dispose : bool -&gt; unit&#xA;override this.Dispose : bool -&gt; unit" Usage="messageQueue.Dispose disposing" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing">
          <span data-ttu-id="e0ac9-989">
            <see langword="true" /> per rilasciare sia le risorse gestite sia quelle non gestite; <see langword="false" /> per rilasciare solo le risorse non gestite.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-989">
              <see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-990">Elimina le risorse, diverse dalla memoria, usate dall'oggetto <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-990">Disposes of the resources (other than memory) used by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-991">Chiamare il metodo <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> dopo aver terminato di utilizzare l'oggetto <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-991">Call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> when you are finished using the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="e0ac9-992">Il metodo <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> lascia l'oggetto <xref:System.Messaging.MessageQueue> in una condizione di inutilizzabilità.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-992">The <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> method leaves the <xref:System.Messaging.MessageQueue> in an unusable state.</span></span> <span data-ttu-id="e0ac9-993">Dopo avere chiamato <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, è necessario rilasciare tutti i riferimenti al <xref:System.Messaging.MessageQueue> in modo che la memoria occupata può essere recuperata da garbage collection.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-993">After calling <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, you must release all references to the <xref:System.Messaging.MessageQueue> so the memory it was occupying can be reclaimed by garbage collection.</span></span>  
  
 <span data-ttu-id="e0ac9-994">È necessario chiamare <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> prima di rilasciare l'ultimo riferimento al <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-994">You should call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> before you release your last reference to the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="e0ac9-995">In caso contrario, le risorse di <xref:System.Messaging.MessageQueue> non è verranno liberate finché le chiamate di procedura di garbage collection di <xref:System.Messaging.MessageQueue> distruttore dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-995">Otherwise, the resources the <xref:System.Messaging.MessageQueue> is using will not be freed until garbage collection calls the <xref:System.Messaging.MessageQueue> object's destructor.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <Member MemberName="EnableConnectionCache">
      <MemberSignature Language="C#" Value="public static bool EnableConnectionCache { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property bool EnableConnectionCache" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property EnableConnectionCache As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool EnableConnectionCache { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableConnectionCache : bool with get, set" Usage="System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-996">Ottiene o imposta un valore che indica se l'applicazione gestirà una cache di connessioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-996">Gets or sets a value that indicates whether a cache of connections will be maintained by the application.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-997">
            <see langword="true" /> per creare e utilizzare una cache di connessioni; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-997">
              <see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-998">Una cache di connessione è un elenco di riferimenti alle strutture che contengono leggere o scrivere gli handle di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-998">A connection cache is a list of references to structures that contain read or write handles to queues.</span></span> <span data-ttu-id="e0ac9-999">Quando <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> viene `true`, il <xref:System.Messaging.MessageQueue> sfrutta gli handle della cache ogni volta che si chiama <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, o <xref:System.Messaging.MessageQueue.Receive%2A>, invece di aprire gli handle di nuovo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-999">When <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> is `true`, the <xref:System.Messaging.MessageQueue> borrows handles from the cache each time you call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, rather than open new handles.</span></span> <span data-ttu-id="e0ac9-1000">Ciò può migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1000">This can improve performance.</span></span> <span data-ttu-id="e0ac9-1001">Uso di una cache di connessione isola anche il <xref:System.Messaging.MessageQueue> da modifiche della topologia di rete.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1001">Using a connection cache also insulates the <xref:System.Messaging.MessageQueue> from changes in the network topology.</span></span>  
  
 <span data-ttu-id="e0ac9-1002">Se si crea una nuova connessione a una coda quando la cache di connessione è piena, il <xref:System.Messaging.MessageQueue> sovrascrive la struttura di accesso meno recente con la nuova connessione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1002">If you create a new connection to a queue when the connection cache is full, the <xref:System.Messaging.MessageQueue> overwrites the least recently accessed structure with the new connection.</span></span> <span data-ttu-id="e0ac9-1003">È possibile cancellare la cache completamente chiamando <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, ad esempio, se i nomi dei formati delle code si lavora con sono stati modificati in modo che la precedente leggere e scrivere gli handle non sono più validi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1003">You can clear the cache entirely by calling <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, for example, if the format names of the queues you are working with have changed so that the previous read and write handles are no longer valid.</span></span>  
  
 <span data-ttu-id="e0ac9-1004">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1004">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1005">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1005">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1006">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1006">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1007">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1007">Local computer</span></span>|<span data-ttu-id="e0ac9-1008">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1008">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1009">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1009">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1010">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1010">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1011">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1011">Remote computer</span></span>|<span data-ttu-id="e0ac9-1012">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1012">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1013">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1013">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1014">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1014">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1015">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1015">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="EncryptionRequired">
      <MemberSignature Language="C#" Value="public System.Messaging.EncryptionRequired EncryptionRequired { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.EncryptionRequired EncryptionRequired" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberSignature Language="VB.NET" Value="Public Property EncryptionRequired As EncryptionRequired" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::EncryptionRequired EncryptionRequired { System::Messaging::EncryptionRequired get(); void set(System::Messaging::EncryptionRequired value); };" />
      <MemberSignature Language="F#" Value="member this.EncryptionRequired : System.Messaging.EncryptionRequired with get, set" Usage="System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_EncryptionRequired")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.EncryptionRequired</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1016">Ottiene o imposta un valore che indica se la coda accetta solo messaggi non privati (non crittografati).</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1016">Gets or sets a value that indicates whether the queue accepts only non-private (non-encrypted) messages.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1017">Uno dei valori di <see cref="T:System.Messaging.EncryptionRequired" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1017">One of the <see cref="T:System.Messaging.EncryptionRequired" /> values.</span>
          </span>
          <span data-ttu-id="e0ac9-1018">Il valore predefinito è <see langword="None" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1018">The default is <see langword="None" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1019">Quando si specifica che la crittografia è necessaria per i messaggi inviati a una coda, vengono crittografati solo i corpi dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1019">When you specify that encryption is required for the messages sent to a queue, only the message bodies are encrypted.</span></span> <span data-ttu-id="e0ac9-1020">Gli altri membri (ad esempio, il <xref:System.Messaging.Message.Label%2A> e <xref:System.Messaging.Message.SenderId%2A> proprietà) non può essere crittografata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1020">The other members (for example, the <xref:System.Messaging.Message.Label%2A> and <xref:System.Messaging.Message.SenderId%2A> properties) cannot be encrypted.</span></span>  
  
 <span data-ttu-id="e0ac9-1021">Impostando questa proprietà viene modificata la coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1021">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-1022">Pertanto, qualsiasi altro <xref:System.Messaging.MessageQueue> istanze sono interessate dalla modifica.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1022">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="e0ac9-1023">La crittografia di un messaggio rende privato il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1023">Encrypting a message makes the message private.</span></span> <span data-ttu-id="e0ac9-1024">È possibile specificare il requisito di crittografia della coda per essere `None`, `Body`, o `Optional` impostando il <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> proprietà in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1024">You can specify the queue's encryption requirement to be `None`, `Body`, or `Optional` by setting the <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property appropriately.</span></span> <span data-ttu-id="e0ac9-1025">Il <xref:System.Messaging.Message.UseEncryption%2A> impostazione del messaggio deve corrispondere ai requisiti di crittografia della coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1025">The <xref:System.Messaging.Message.UseEncryption%2A> setting of the message must correspond to the encryption requirement of the queue.</span></span> <span data-ttu-id="e0ac9-1026">Se il messaggio non è crittografato ma la coda specifica `Body`, oppure se il messaggio è crittografato, ma la coda specifica `None`, il rifiuto del messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1026">If the message is not encrypted but the queue specifies `Body`, or if the message is encrypted but the queue specifies `None`, the message is rejected by the queue.</span></span> <span data-ttu-id="e0ac9-1027">Se l'applicazione mittente lo richiede un messaggio di riconoscimento negativo in questo caso, il servizio Accodamento messaggi indica il rifiuto del messaggio all'applicazione mittente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1027">If the sending application requests a negative acknowledgment message in this event, Message Queuing indicates the message's rejection to the sending application.</span></span> <span data-ttu-id="e0ac9-1028">Se il <xref:System.Messaging.Message.UseDeadLetterQueue%2A> è di proprietà `true`, viene inviato un messaggio che si verifica un errore di crittografia per la coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1028">If the <xref:System.Messaging.Message.UseDeadLetterQueue%2A> property is `true`, a message that fails encryption is sent to the dead-letter queue.</span></span> <span data-ttu-id="e0ac9-1029">In caso contrario, il messaggio va perso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1029">Otherwise, the message is lost.</span></span>  
  
 <span data-ttu-id="e0ac9-1030">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1030">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1031">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1031">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1032">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1032">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1033">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1033">Local computer</span></span>|<span data-ttu-id="e0ac9-1034">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1034">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1035">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1035">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1036">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1036">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1037">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1037">Remote computer</span></span>|<span data-ttu-id="e0ac9-1038">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1038">No</span></span>|  
|<span data-ttu-id="e0ac9-1039">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1039">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1040">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1040">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1041">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1041">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1042">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1042">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.Acknowledgment" />
        <altmember cref="P:System.Messaging.Message.UseEncryption" />
      </Docs>
    </Member>
    <Member MemberName="EndPeek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndPeek (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndPeek(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndPeek(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndPeek (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndPeek(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndPeek : IAsyncResult -&gt; System.Messaging.Message" Usage="messageQueue.EndPeek asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult">
          <span data-ttu-id="e0ac9-1043">
            <see cref="T:System.IAsyncResult" /> che identifica l'operazione di visualizzazione asincrona da completare e da cui recuperare un risultato finale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1043">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous peek operation to finish and from which to retrieve an end result.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1044">Completa l'operazione di visualizzazione asincrona specificata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1044">Completes the specified asynchronous peek operation.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1045">
            <see cref="T:System.Messaging.Message" /> associato all'operazione asincrona completata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1045">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1046">Quando la <xref:System.Messaging.MessageQueue.PeekCompleted> evento viene generato, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> completa l'operazione che è stata avviata dal <xref:System.Messaging.MessageQueue.BeginPeek%2A> chiamare.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1046">When the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginPeek%2A> call.</span></span> <span data-ttu-id="e0ac9-1047">A tale scopo, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> legge il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1047">To do so, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> peeks the message.</span></span>  
  
 <span data-ttu-id="e0ac9-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> può specificare un timeout, provocando la <xref:System.Messaging.MessageQueue.PeekCompleted> evento da generare se si verifica il timeout prima che venga visualizzato un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="e0ac9-1049">Quando si verifica un timeout senza un messaggio che arriva nella coda, una chiamata successiva a <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> genera un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1049">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="e0ac9-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> viene usato per leggere il messaggio che ha causato il <xref:System.Messaging.MessageQueue.PeekCompleted> generazione dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to read the message that caused the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="e0ac9-1051">Se si desidera continuare a leggere i messaggi in modo asincrono, è possibile chiamare nuovamente <xref:System.Messaging.MessageQueue.BeginPeek%2A> dopo la chiamata <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1051">If you want to continue to asynchronously peek messages, you can again call <xref:System.Messaging.MessageQueue.BeginPeek%2A> after calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-1052">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1052">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1053">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1053">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1054">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1054">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1055">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1055">Local computer</span></span>|<span data-ttu-id="e0ac9-1056">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1056">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1057">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1057">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1058">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1058">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1059">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1059">Remote computer</span></span>|<span data-ttu-id="e0ac9-1060">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1060">No</span></span>|  
|<span data-ttu-id="e0ac9-1061">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1061">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1062">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1062">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1063">L'esempio di codice seguente crea un gestore eventi denominato `MyPeekCompleted`, lo collega al <xref:System.Messaging.MessageQueue.PeekCompleted> delegato del gestore eventi e chiamate <xref:System.Messaging.MessageQueue.BeginPeek%2A> per avviare un'operazione di lettura asincrona in coda che si trova nel percorso ". \myQueue".</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1063">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="e0ac9-1064">Quando un <xref:System.Messaging.MessageQueue.PeekCompleted> viene generato l'evento, l'esempio legge il messaggio e scrive il corpo sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1064">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="e0ac9-1065">Nell'esempio viene quindi chiamato <xref:System.Messaging.MessageQueue.BeginPeek%2A> nuovamente per avviare una nuova operazione di lettura asincrona.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1065">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-1066">Il valore del parametro <paramref name="asyncResult" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1066">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1067">La sintassi del parametro <paramref name="asyncResult" /> non è valida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1067">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1068">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1068">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
      </Docs>
    </Member>
    <Member MemberName="EndReceive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndReceive (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndReceive(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndReceive(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndReceive (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndReceive(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndReceive : IAsyncResult -&gt; System.Messaging.Message" Usage="messageQueue.EndReceive asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult">
          <span data-ttu-id="e0ac9-1069">
            <see cref="T:System.IAsyncResult" /> che identifica l'operazione di ricezione asincrona da completare e da cui recuperare un risultato finale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1069">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous receive operation to finish and from which to retrieve an end result.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1070">Completa l'operazione di ricezione asincrona specificata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1070">Completes the specified asynchronous receive operation.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1071">
            <see cref="T:System.Messaging.Message" /> associato all'operazione asincrona completata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1071">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1072">Quando la <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento viene generato, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> completa l'operazione che è stata avviata dal <xref:System.Messaging.MessageQueue.BeginReceive%2A> chiamare.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1072">When the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginReceive%2A> call.</span></span> <span data-ttu-id="e0ac9-1073">A tale scopo, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> riceve il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1073">To do so, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> receives the message.</span></span>  
  
 <span data-ttu-id="e0ac9-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> può specificare un timeout, provocando la <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento da generare se si verifica il timeout prima che venga visualizzato un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="e0ac9-1075">Quando si verifica un timeout senza un messaggio che arriva nella coda, una chiamata successiva a <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> genera un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1075">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="e0ac9-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> Consente di leggere (rimozione dalla coda) il messaggio che ha causato il <xref:System.Messaging.MessageQueue.ReceiveCompleted> generazione dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to read (removing from the queue) the message that caused the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="e0ac9-1077">Se si desidera continuare a ricevere in modo asincrono i messaggi, è possibile chiamare nuovamente <xref:System.Messaging.MessageQueue.BeginReceive%2A> dopo la chiamata <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1077">If you want to continue to asynchronously receive messages, you can again call <xref:System.Messaging.MessageQueue.BeginReceive%2A> after calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="e0ac9-1078">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1078">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1079">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1079">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1080">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1080">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1081">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1081">Local computer</span></span>|<span data-ttu-id="e0ac9-1082">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1082">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1083">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1083">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1084">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1084">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1085">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1085">Remote computer</span></span>|<span data-ttu-id="e0ac9-1086">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1086">No</span></span>|  
|<span data-ttu-id="e0ac9-1087">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1087">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1088">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1088">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1089">L'esempio di codice seguente vengono concatenate le richieste asincrone.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1089">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="e0ac9-1090">Presuppone che ci sia una coda sul computer locale denominato "myQueue".</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1090">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="e0ac9-1091">Il `Main` funzione inizia l'operazione asincrona che viene gestita dal `MyReceiveCompleted` routine.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1091">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="e0ac9-1092">`MyReceiveCompleted` Elabora il messaggio corrente e avvia un nuovo asincrona operazione di ricezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1092">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-1093">Il valore del parametro <paramref name="asyncResult" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1093">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1094">La sintassi del parametro <paramref name="asyncResult" /> non è valida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1094">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1095">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1095">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (path As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Exists : string -&gt; bool" Usage="System.Messaging.MessageQueue.Exists path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="e0ac9-1096">Posizione della coda da trovare.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1096">The location of the queue to find.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1097">Determina se una coda di Accodamento messaggi è presente nel percorso specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1097">Determines whether a Message Queuing queue exists at the specified path.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1098">
            <see langword="true" /> se esiste una coda con il percorso specificato; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1098">
              <see langword="true" /> if a queue with the specified path exists; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1099">Il <xref:System.Messaging.MessageQueue.Exists%28System.String%29> metodo determina se una coda di Accodamento messaggi è presente nel percorso specificato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1099">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method determines whether a Message Queuing queue exists at a specified path.</span></span> <span data-ttu-id="e0ac9-1100">Non esiste alcun metodo per determinare se esiste una coda con un nome di formato specificato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1100">No method exists to determine whether a queue with a specified format name exists.</span></span> <span data-ttu-id="e0ac9-1101">Per altre informazioni sulla sintassi del nome di formato e altre forme di sintassi del percorso, vedere il <xref:System.Messaging.MessageQueue.Path%2A> proprietà.)</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1101">For more information about the format name syntax and other path syntax forms, see the <xref:System.Messaging.MessageQueue.Path%2A> property.)</span></span>  
  
 <span data-ttu-id="e0ac9-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> è un'operazione costosa.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> is an expensive operation.</span></span> <span data-ttu-id="e0ac9-1103">Usarla solo quando è necessario all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1103">Use it only when it is necessary within the application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="e0ac9-1104">Il <xref:System.Messaging.MessageQueue.Exists%28System.String%29> metodo non supporta il <xref:System.Messaging.MessageQueue.FormatName%2A> prefisso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1104">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method does not support the <xref:System.Messaging.MessageQueue.FormatName%2A> prefix.</span></span>  
  
 <span data-ttu-id="e0ac9-1105">La sintassi per il `path` parametro dipende dal tipo di coda, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1105">The syntax for the `path` parameter depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="e0ac9-1106">Tipo di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1106">Queue type</span></span>|<span data-ttu-id="e0ac9-1107">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1107">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="e0ac9-1108">coda pubblica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1108">Public queue</span></span>|`MachineName`\\`QueueName`|  
  
 <span data-ttu-id="e0ac9-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> non può essere chiamato per verificare l'esistenza di una coda privata remota.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> cannot be called to verify the existence of a remote private queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1110">Per ulteriori informazioni sulla sintassi, vedere il <xref:System.Messaging.MessageQueue.Path%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1110">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="e0ac9-1111">In alternativa, è possibile usare il <xref:System.Messaging.MessageQueue.Label%2A> per descrivere il percorso della coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1111">Alternatively, you can use the <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="e0ac9-1112">Riferimenti</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1112">Reference</span></span>|<span data-ttu-id="e0ac9-1113">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1113">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="e0ac9-1114">Label</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1114">Label</span></span>|<span data-ttu-id="e0ac9-1115">Etichetta: [ `label` ]</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1115">Label:[ `label` ]</span></span>|  
  
 <span data-ttu-id="e0ac9-1116">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1116">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1117">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1117">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1118">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1118">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1119">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1119">Local computer</span></span>|<span data-ttu-id="e0ac9-1120">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1120">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1121">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1121">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1122">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1122">No</span></span>|  
|<span data-ttu-id="e0ac9-1123">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1123">Remote computer</span></span>|<span data-ttu-id="e0ac9-1124">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1124">No</span></span>|  
|<span data-ttu-id="e0ac9-1125">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1125">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1126">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1126">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1127">Esempio di codice seguente verifica se esiste una coda di Accodamento messaggi e quindi di eliminarlo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1127">The following code example verifies whether a Message Queuing queue exists, and then deletes it.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1128">La sintassi di <paramref name="path" /> non è valida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1128">The <paramref name="path" /> syntax is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1129">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1129">An error occurred when accessing a Message Queuing method.</span>
          </span>
          <span data-ttu-id="e0ac9-1130">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1130">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-1131">Il metodo <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> viene chiamato su una coda privata remota.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1131">The <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> method is being called on a remote private queue</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-1132">Nell'applicazione è stata utilizzata la sintassi dei nomi di formato durante la verifica dell'esistenza della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1132">The application used format name syntax when verifying queue existence.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="FormatName">
      <MemberSignature Language="C#" Value="public string FormatName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string FormatName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.FormatName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property FormatName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ FormatName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.FormatName : string" Usage="System.Messaging.MessageQueue.FormatName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_FormatName")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1133">Ottiene il nome univoco generato per la coda da Accodamento messaggi al momento della creazione della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1133">Gets the unique queue name that Message Queuing generated at the time of the queue's creation.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1134">Nome della coda, univoco nella rete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1134">The name for the queue, which is unique on the network.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1135">Il <xref:System.Messaging.MessageQueue.FormatName%2A> proprietà contiene il nome di formato della coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1135">The <xref:System.Messaging.MessageQueue.FormatName%2A> property contains the format name of the queue.</span></span> <span data-ttu-id="e0ac9-1136">In Accodamento messaggi utilizza il nome di formato per identificare la coda da aprire e come accedervi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1136">Message Queuing uses the format name to identify which queue to open and how to access it.</span></span> <span data-ttu-id="e0ac9-1137">A differenza la maggior parte delle caratteristiche di una coda, il nome di formato non è una proprietà di coda dell'applicazione Accodamento messaggi, in modo che non è possibile accedervi tramite lo strumento di gestione di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1137">Unlike most of a queue's characteristics, the format name is not a Message Queuing application queue property, so you cannot access it through the Message Queuing management tool.</span></span> <span data-ttu-id="e0ac9-1138">Il nome di formato è semplicemente un nome univoco per la coda, che il servizio Accodamento messaggi genera quando si crea la coda o che l'applicazione genera in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1138">The format name is simply a unique name for the queue, which Message Queuing generates when it creates the queue or which the application generates later.</span></span>  
  
 <span data-ttu-id="e0ac9-1139">Se si specifica un percorso usando la sintassi del nome percorso (ad esempio `myComputer\myQueue`) invece di usare la sintassi del nome di formato durante la lettura o scrittura per la coda, traduce il controller di dominio primario (che usa Active Directory) il <xref:System.Messaging.MessageQueue.Path%2A> nell'associati <xref:System.Messaging.MessageQueue.FormatName%2A> prima di accedere alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1139">If you specify a path using the path name syntax (such as `myComputer\myQueue`) rather than using the format name syntax when you read or write to the queue, the primary domain controller (which uses Active Directory) translates the <xref:System.Messaging.MessageQueue.Path%2A> into the associated <xref:System.Messaging.MessageQueue.FormatName%2A> before accessing the queue.</span></span> <span data-ttu-id="e0ac9-1140">Se l'applicazione è offline, è necessario utilizzare la sintassi di nome di formato. in caso contrario, il controller di dominio primario non sarà disponibile per eseguire la conversione del percorso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1140">If your application is working offline, you must use the format name syntax; otherwise, the primary domain controller will not be available to perform the path translation.</span></span>  
  
 <span data-ttu-id="e0ac9-1141">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1141">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1142">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1142">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1143">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1143">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1144">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1144">Local computer</span></span>|<span data-ttu-id="e0ac9-1145">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1145">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1146">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1146">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1147">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1147">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1148">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1148">Remote computer</span></span>|<span data-ttu-id="e0ac9-1149">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1149">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1150">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1150">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1151">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1151">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1152">Esempio di codice seguente consente di visualizzare il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.FormatName%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1152">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.FormatName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1153">La proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> non è impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1153">The <see cref="P:System.Messaging.MessageQueue.Path" /> is not set.</span>
          </span>
          <span data-ttu-id="e0ac9-1154">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1154">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-1155">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1155">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="T:System.Messaging.MessageQueue" />
      </Docs>
    </Member>
    <Member MemberName="Formatter">
      <MemberSignature Language="C#" Value="public System.Messaging.IMessageFormatter Formatter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.IMessageFormatter Formatter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Formatter" />
      <MemberSignature Language="VB.NET" Value="Public Property Formatter As IMessageFormatter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::IMessageFormatter ^ Formatter { System::Messaging::IMessageFormatter ^ get(); void set(System::Messaging::IMessageFormatter ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Formatter : System.Messaging.IMessageFormatter with get, set" Usage="System.Messaging.MessageQueue.Formatter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageFormatterConverter))</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Formatter")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.IMessageFormatter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1156">Ottiene o imposta il formattatore utilizzato per serializzare o deserializzare un oggetto dal corpo di un messaggio letto o scritto in una coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1156">Gets or sets the formatter used to serialize an object into or deserialize an object from the body of a message read from or written to the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1157">
            <see cref="T:System.Messaging.IMessageFormatter" /> che produce un flusso da scrivere o leggere dal corpo del messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1157">The <see cref="T:System.Messaging.IMessageFormatter" /> that produces a stream to be written to or read from the message body.</span>
          </span>
          <span data-ttu-id="e0ac9-1158">Il valore predefinito è <see cref="T:System.Messaging.XmlMessageFormatter" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1158">The default is <see cref="T:System.Messaging.XmlMessageFormatter" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1159">Il <xref:System.Messaging.MessageQueue.Formatter%2A> proprietà contiene un'istanza di un oggetto formattatore, che consente di trasformare i messaggi quando l'applicazione legge o scrive nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1159">The <xref:System.Messaging.MessageQueue.Formatter%2A> property contains an instance of a formatter object, which transforms messages when your application reads or writes to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1160">Quando l'applicazione invia messaggi alla coda, il formattatore serializza l'oggetto in un flusso e lo inserisce nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1160">When the application sends message to the queue, the formatter serializes the object into a stream and inserts it into the message body.</span></span> <span data-ttu-id="e0ac9-1161">Durante la lettura da una coda, il formattatore deserializza i dati del messaggio nel <xref:System.Messaging.Message.Body%2A> proprietà di un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1161">When reading from a queue, the formatter deserializes the message data into the <xref:System.Messaging.Message.Body%2A> property of a <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="e0ac9-1162">Il <xref:System.Messaging.XmlMessageFormatter> è regime di controllo, in modo che non è necessario avere lo stesso oggetto di tipo per il mittente e ricevitore quando si usa questo formato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1162">The <xref:System.Messaging.XmlMessageFormatter> is loosely coupled, so it is not necessary to have the same object type on the sender and receiver when using this format.</span></span> <span data-ttu-id="e0ac9-1163">Il <xref:System.Messaging.ActiveXMessageFormatter> e <xref:System.Messaging.BinaryMessageFormatter> serializzare i dati in una rappresentazione binaria.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1163">The <xref:System.Messaging.ActiveXMessageFormatter> and <xref:System.Messaging.BinaryMessageFormatter> serialize the data into binary representation.</span></span> <span data-ttu-id="e0ac9-1164">Il <xref:System.Messaging.ActiveXMessageFormatter> viene usato per inviare o ricevere i componenti COM.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1164">The <xref:System.Messaging.ActiveXMessageFormatter> is used when sending or receiving COM components.</span></span>  
  
 <span data-ttu-id="e0ac9-1165"><xref:System.Messaging.BinaryMessageFormatter> e <xref:System.Messaging.ActiveXMessageFormatter> ottenere velocità maggiori rispetto la <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1165"><xref:System.Messaging.BinaryMessageFormatter> and <xref:System.Messaging.ActiveXMessageFormatter> provide faster throughput than the <xref:System.Messaging.XmlMessageFormatter>.</span></span> <span data-ttu-id="e0ac9-1166">Il <xref:System.Messaging.ActiveXMessageFormatter> consente l'interoperabilità con applicazioni di Accodamento messaggi di Visual Basic 6.0.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1166">The <xref:System.Messaging.ActiveXMessageFormatter> allows interoperability with Visual Basic 6.0 Message Queuing applications.</span></span>  
  
 <span data-ttu-id="e0ac9-1167">Quando l'applicazione invia messaggi alla coda, il <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> si applica solo a quei messaggi che usano le proprietà di messaggio predefinite, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1167">When your application sends messages to the queue, the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> applies only to those messages that use the default message properties, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span></span> <span data-ttu-id="e0ac9-1168">Se si invia un <xref:System.Messaging.Message> Accodamento messaggi alla coda, verrà utilizzato il formattatore definito nel <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> proprietà da serializzare il corpo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1168">If you send a <xref:System.Messaging.Message> to the queue, Message Queuing uses the formatter defined in the <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property to serialize the body instead.</span></span>  
  
 <span data-ttu-id="e0ac9-1169">Il <xref:System.Messaging.MessageQueue> classe utilizza sempre un <xref:System.Messaging.Message> per ricevere o leggere un messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1169">The <xref:System.Messaging.MessageQueue> class will always use a <xref:System.Messaging.Message> to receive or peek a message from the queue.</span></span> <span data-ttu-id="e0ac9-1170">Il messaggio viene deserializzato utilizzando il <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1170">The message is deserialized using the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="e0ac9-1171">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1171">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1172">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1172">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1173">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1173">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1174">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1174">Local computer</span></span>|<span data-ttu-id="e0ac9-1175">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1175">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1176">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1176">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1177">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1177">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1178">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1178">Remote computer</span></span>|<span data-ttu-id="e0ac9-1179">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1179">No</span></span>|  
|<span data-ttu-id="e0ac9-1180">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1180">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1181">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1181">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1182">Esempio di codice seguente vengono illustrate la formattazione di un corpo del messaggio utilizzando <xref:System.Messaging.BinaryMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1182">The following code example demonstrates formatting a message body using <xref:System.Messaging.BinaryMessageFormatter>.</span></span>  
  
 [!code-cpp[MessagingBinaryFormatter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessagingBinaryFormatter/CPP/message_binaryformatter.cpp#1)]
 [!code-csharp[MessagingBinaryFormatter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessagingBinaryFormatter/CS/message_binaryformatter.cs#1)]
 [!code-vb[MessagingBinaryFormatter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessagingBinaryFormatter/VB/message_binaryformatter.vb#1)]  
  
 <span data-ttu-id="e0ac9-1183">Esempio di codice seguente vengono illustrate la formattazione di un corpo del messaggio utilizzando <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1183">The following code example demonstrates formatting a message body using <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 [!code-cpp[Message.Body#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Body/CPP/message_sendreceive.cpp#1)]
 [!code-csharp[Message.Body#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Body/CS/message_sendreceive.cs#1)]
 [!code-vb[Message.Body#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Body/VB/message_sendreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Messaging.XmlMessageFormatter" />
        <altmember cref="T:System.Messaging.ActiveXMessageFormatter" />
        <altmember cref="T:System.Messaging.BinaryMessageFormatter" />
        <altmember cref="P:System.Messaging.Message.Formatter" />
      </Docs>
    </Member>
    <Member MemberName="GetAllMessages">
      <MemberSignature Language="C#" Value="public System.Messaging.Message[] GetAllMessages ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message[] GetAllMessages() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetAllMessages" />
      <MemberSignature Language="VB.NET" Value="Public Function GetAllMessages () As Message()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::Messaging::Message ^&gt; ^ GetAllMessages();" />
      <MemberSignature Language="F#" Value="member this.GetAllMessages : unit -&gt; System.Messaging.Message[]" Usage="messageQueue.GetAllMessages " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1184">Restituisce tutti i messaggi presenti nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1184">Returns all the messages that are in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1185">Matrice di tipo <see cref="T:System.Messaging.Message" /> che rappresenta tutti i messaggi nella coda nello stesso ordine in cui vengono visualizzati nella coda di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1185">An array of type <see cref="T:System.Messaging.Message" /> that represents all the messages in the queue, in the same order as they appear in the Message Queuing queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> Restituisce uno snapshot statico di messaggi nella coda, non dinamici collegamenti a tali messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a static snapshot of the messages in the queue, not dynamic links to those messages.</span></span> <span data-ttu-id="e0ac9-1187">Pertanto, è possibile utilizzare la matrice per modificare i messaggi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1187">Therefore, you cannot use the array to modify the messages in the queue.</span></span> <span data-ttu-id="e0ac9-1188">Se si desidera un'interazione dinamica e in tempo reale con la coda (ad esempio la possibilità di eliminare i messaggi), chiamare il <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> metodo, che restituisce un elenco dinamico di messaggi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1188">If you want real-time, dynamic interaction with the queue (such as the ability to delete messages), call the <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> method, which returns a dynamic list of the messages in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1189">Poiché <xref:System.Messaging.MessageQueue.GetAllMessages%2A> restituisce una copia dei messaggi nella coda al momento della chiamata al metodo, la matrice non riflette nuovi messaggi che arrivano nella coda o messaggi che vengono rimossi dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1189">Because <xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a copy of the messages in the queue at the time the method was called, the array does not reflect new messages that arrive in the queue or messages that are removed from the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> Recupera solo le proprietà non filtrate dal <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> retrieves only those properties not filtered out by the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span>  
  
 <span data-ttu-id="e0ac9-1191">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1191">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1192">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1192">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1193">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1193">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1194">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1194">Local computer</span></span>|<span data-ttu-id="e0ac9-1195">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1195">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1196">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1196">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1197">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1197">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1198">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1198">Remote computer</span></span>|<span data-ttu-id="e0ac9-1199">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1199">No</span></span>|  
|<span data-ttu-id="e0ac9-1200">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1200">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1201">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1201">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1202">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1202">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#21](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#21)]
 [!code-csharp[MessageQueue2#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1203">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1203">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetEnumerator">
      <MemberSignature Language="C#" Value="public System.Collections.IEnumerator GetEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Collections.IEnumerator GetEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetEnumerator () As IEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Collections::IEnumerator ^ GetEnumerator();" />
      <MemberSignature Language="F#" Value="abstract member GetEnumerator : unit -&gt; System.Collections.IEnumerator&#xA;override this.GetEnumerator : unit -&gt; System.Collections.IEnumerator" Usage="messageQueue.GetEnumerator " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Collections.IEnumerable.GetEnumerator</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("This method returns a MessageEnumerator that implements RemoveCurrent family of methods incorrectly. Please use GetMessageEnumerator2 instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.IEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1204">Enumera i messaggi in una coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1204">Enumerates the messages in a queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1205">L'oggetto <see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> è deprecato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1205">
              <see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> is deprecated.</span>
          </span>
          <span data-ttu-id="e0ac9-1206">È consigliabile utilizzare invece <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1206">
              <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1207">Oggetto <see cref="T:System.Collections.IEnumerator" /> che fornisce una connessione dinamica ai messaggi della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1207">A <see cref="T:System.Collections.IEnumerator" /> that provides a dynamic connection to the messages in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1208">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1208">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1209">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1209">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1210">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1210">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1211">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1211">Local computer</span></span>|<span data-ttu-id="e0ac9-1212">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1212">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1213">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1213">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1214">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1214">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1215">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1215">Remote computer</span></span>|<span data-ttu-id="e0ac9-1216">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1216">No</span></span>|  
|<span data-ttu-id="e0ac9-1217">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1217">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1218">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1218">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1219">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1219">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#22](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#22)]
 [!code-csharp[MessageQueue2#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMachineId">
      <MemberSignature Language="C#" Value="public static Guid GetMachineId (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig valuetype System.Guid GetMachineId(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMachineId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMachineId (machineName As String) As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static Guid GetMachineId(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetMachineId : string -&gt; Guid" Usage="System.Messaging.MessageQueue.GetMachineId machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName">
          <span data-ttu-id="e0ac9-1220">Nome del computer contenente la coda, non preceduto dalle due barre rovesciate (\\\\).</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1220">The name of the computer that contains the queue, without the two preceding backslashes (\\\\).</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1221">Ottiene l'identificatore del computer in cui viene posizionata la coda cui <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1221">Gets the identifier of the computer on which the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> is located.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1222">Oggetto <see cref="T:System.Guid" /> che rappresenta un identificatore univoco del computer in cui viene posizionata la coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1222">A <see cref="T:System.Guid" /> that represents a unique identifier for the computer on which the queue is located.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1223">È possibile usare l'identificatore del computer per due scopi, tra gli altri: per il journal del computer di leggere e impostare i certificati di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1223">You can use a computer's identifier for two purposes, among others: to read the computer journal and to set security certificates.</span></span> <span data-ttu-id="e0ac9-1224">Tuttavia, non è possibile chiamare <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> per un computer remoto quando si lavora offline perché l'applicazione deve avere accesso al servizio directory nel controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1224">However, you cannot call <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> for a remote computer when you are working offline because the application must have access to the directory service on the domain controller.</span></span>  
  
 <span data-ttu-id="e0ac9-1225">L'identificatore del computer (o identificatore del computer) è un <xref:System.Guid> creati quando un computer viene aggiunto alla sezione aziendale di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1225">The computer identifier (or machine identifier) is a <xref:System.Guid> that Message Queuing creates when a computer is added to the enterprise.</span></span> <span data-ttu-id="e0ac9-1226">Il servizio Accodamento messaggi combina l'identificatore del computer con il `Machine` e `Journal` parole chiave per creare il nome formato del journal del computer, che presenta la sintassi `Machine=<computeridentifier>;Journal`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1226">Message Queuing combines the computer identifier with the `Machine` and `Journal` keywords to create the machine journal's format name, which has the syntax `Machine=<computeridentifier>;Journal`.</span></span> <span data-ttu-id="e0ac9-1227">I messaggi il journal del computer, è anche noto come coda del journal, è una coda di sistema che vengono archiviate copie delle generati dall'applicazione quando la <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> è di proprietà `true`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1227">The machine journal, which is also known as the journal queue, is a system queue that stores copies of application-generated messages when the <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property is `true`.</span></span>  
  
 <span data-ttu-id="e0ac9-1228">Questa sintassi per la registrazione è valida solo quando si crea il nome di formato per la coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1228">This syntax for the journal is only valid when constructing the format name for the queue.</span></span> <span data-ttu-id="e0ac9-1229">La sintassi del nome di percorso viene `MachineName` \\ `Journal$`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1229">The path name syntax is `MachineName`\\`Journal$`.</span></span>  
  
 <span data-ttu-id="e0ac9-1230">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1230">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1231">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1231">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1232">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1232">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1233">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1233">Local computer</span></span>|<span data-ttu-id="e0ac9-1234">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1234">No</span></span>|  
|<span data-ttu-id="e0ac9-1235">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1235">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1236">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1236">No</span></span>|  
|<span data-ttu-id="e0ac9-1237">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1237">Remote computer</span></span>|<span data-ttu-id="e0ac9-1238">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1238">No</span></span>|  
|<span data-ttu-id="e0ac9-1239">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1239">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1240">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1240">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1241">Nell'esempio di codice riportato di seguito viene chiamato il metodo <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1241">The following code example calls <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span></span>  
  
 [!code-csharp[MessageQueue#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1242">Non è stato possibile recuperare l'identificatore del computer, probabilmente perché il servizio directory non è disponibile, ad esempio se si sta lavorando in modalità offline.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1242">The computer identifier could not be retrieved, possibly because the directory service is not available; for example, if you are working offline.</span>
          </span>
          <span data-ttu-id="e0ac9-1243">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1243">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-1244">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1244">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator();" />
      <MemberSignature Language="F#" Value="member this.GetMessageEnumerator : unit -&gt; System.Messaging.MessageEnumerator" Usage="messageQueue.GetMessageEnumerator " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("This method returns a MessageEnumerator that implements RemoveCurrent family of methods incorrectly. Please use GetMessageEnumerator2 instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1245">Crea un oggetto enumeratore per tutti i messaggi contenuti nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1245">Creates an enumerator object for all the messages in the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1246">L'oggetto <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> è deprecato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1246">
              <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> is deprecated.</span>
          </span>
          <span data-ttu-id="e0ac9-1247">È consigliabile utilizzare invece <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1247">
              <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1248">
            <see cref="T:System.Messaging.MessageEnumerator" /> contenente i messaggi presenti nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1248">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> Crea un elenco dinamico di tutti i messaggi in una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="e0ac9-1250">È possibile rimuovere dalla coda il messaggio nella posizione corrente dell'enumeratore chiamando <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> per il <xref:System.Messaging.MessageEnumerator> che <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> restituisce.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1250">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> returns.</span></span>  
  
 <span data-ttu-id="e0ac9-1251">Poiché il cursore è associato l'elenco dinamico di messaggi nella coda, l'enumerazione riflette tutte le modifiche apportate ai messaggi nella coda, se il messaggio è oltre la posizione corrente del cursore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1251">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="e0ac9-1252">Ad esempio, l'enumeratore può accedere automaticamente un messaggio con priorità inferiore inserito oltre la posizione del cursore corrente, ma non un messaggio con priorità più alta inseriti prima di quella posizione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1252">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="e0ac9-1253">Tuttavia, è possibile reimpostare l'enumerazione, spostare il cursore all'inizio dell'elenco, chiamando <xref:System.Messaging.MessageEnumerator.Reset%2A> per il <xref:System.Messaging.MessageEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1253">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="e0ac9-1254">L'ordine dei messaggi nell'enumerazione riflette l'ordine nella coda, in modo che i messaggi con priorità più alta vengono visualizzati prima di quelli con priorità inferiore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1254">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="e0ac9-1255">Se si desidera uno snapshot statico i messaggi in coda piuttosto che una connessione dinamica ad essi, chiamare <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1255">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="e0ac9-1256">Questo metodo restituisce una matrice di <xref:System.Messaging.Message> gli oggetti che rappresentano i messaggi al momento della chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1256">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="e0ac9-1257">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1257">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1258">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1258">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1259">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1259">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1260">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1260">Local computer</span></span>|<span data-ttu-id="e0ac9-1261">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1261">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1262">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1262">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1263">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1263">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1264">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1264">Remote computer</span></span>|<span data-ttu-id="e0ac9-1265">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1265">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1266">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1266">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1267">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1267">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1268">Esempio di codice seguente ottiene un elenco dinamico di messaggi in una coda e conta tutti i messaggi con il <xref:System.Messaging.Message.Priority%2A> impostata su <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1268">The following code example gets a dynamic list of messages in a queue and counts all messages with the <xref:System.Messaging.Message.Priority%2A> property set to <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CPP/mqgetmessageenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CS/mqgetmessageenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/VB/mqgetmessageenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator2">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator2 ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator2() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator2 () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator2();" />
      <MemberSignature Language="F#" Value="member this.GetMessageEnumerator2 : unit -&gt; System.Messaging.MessageEnumerator" Usage="messageQueue.GetMessageEnumerator2 " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1269">Crea un oggetto enumeratore per tutti i messaggi contenuti nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1269">Creates an enumerator object for all the messages in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1270">
            <see cref="T:System.Messaging.MessageEnumerator" /> contenente i messaggi presenti nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1270">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> Crea un elenco dinamico di tutti i messaggi in una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="e0ac9-1272">È possibile rimuovere dalla coda il messaggio nella posizione corrente dell'enumeratore chiamando <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> per il <xref:System.Messaging.MessageEnumerator> che <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> restituisce.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1272">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> returns.</span></span>  
  
 <span data-ttu-id="e0ac9-1273">Poiché il cursore è associato l'elenco dinamico di messaggi nella coda, l'enumerazione riflette tutte le modifiche apportate ai messaggi nella coda, se il messaggio è oltre la posizione corrente del cursore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1273">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="e0ac9-1274">Ad esempio, l'enumeratore può accedere automaticamente un messaggio con priorità inferiore inserito oltre la posizione del cursore corrente, ma non un messaggio con priorità più alta inseriti prima di quella posizione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1274">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="e0ac9-1275">Tuttavia, è possibile reimpostare l'enumerazione, spostare il cursore all'inizio dell'elenco, chiamando <xref:System.Messaging.MessageEnumerator.Reset%2A> per il <xref:System.Messaging.MessageEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1275">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="e0ac9-1276">L'ordine dei messaggi nell'enumerazione riflette l'ordine nella coda, in modo che i messaggi con priorità più alta vengono visualizzati prima di quelli con priorità inferiore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1276">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="e0ac9-1277">Se si desidera uno snapshot statico i messaggi in coda piuttosto che una connessione dinamica ad essi, chiamare <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1277">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="e0ac9-1278">Questo metodo restituisce una matrice di <xref:System.Messaging.Message> gli oggetti che rappresentano i messaggi al momento della chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1278">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="e0ac9-1279">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1279">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1280">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1280">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1281">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1281">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1282">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1282">Local computer</span></span>|<span data-ttu-id="e0ac9-1283">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1283">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1284">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1284">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1285">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1285">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1286">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1286">Remote computer</span></span>|<span data-ttu-id="e0ac9-1287">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1287">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1288">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1288">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1289">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1289">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetMessageQueueEnumerator">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1290">Crea un oggetto enumeratore per un elenco dinamico delle code pubbliche presenti sulla rete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1290">Creates an enumerator object for a dynamic listing of the public queues on the network.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator () As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator();" />
      <MemberSignature Language="F#" Value="static member GetMessageQueueEnumerator : unit -&gt; System.Messaging.MessageQueueEnumerator" Usage="System.Messaging.MessageQueue.GetMessageQueueEnumerator " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1291">Fornisce la semantica del cursore forward-only per enumerare tutte le code pubbliche sulla rete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1291">Provides forward-only cursor semantics to enumerate through all public queues on the network.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1292">Oggetto <see cref="T:System.Messaging.MessageQueueEnumerator" /> che fornisce un elenco dinamico di tutte le code di messaggi pubbliche sulla rete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1292">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of all the public message queues on the network.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1293">Questo overload del metodo <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> restituisce un'enumerazione di tutte le code pubbliche sulla rete.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1293">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns an enumeration of all the public queues that are on the network.</span></span>  
  
 <span data-ttu-id="e0ac9-1294">Poiché il cursore è associato a un elenco dinamico, l'enumerazione riflette tutte le modifiche apportate a un elenco di coda per le code eliminati o aggiunti oltre la posizione del cursore corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1294">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue list for queues deleted or added beyond the cursor's current position.</span></span> <span data-ttu-id="e0ac9-1295">Aggiunta o eliminazione di code che si trova prima della posizione corrente del cursore non vengono riflesse.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1295">Additions or deletion of queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="e0ac9-1296">Ad esempio, l'enumeratore può accedere automaticamente una coda aggiunto oltre la posizione del cursore, ma non quello inserito prima di tale posizione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1296">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="e0ac9-1297">Tuttavia, è possibile reimpostare l'enumerazione, spostare il cursore all'inizio dell'elenco, chiamando <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> per il <xref:System.Messaging.MessageQueueEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1297">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="e0ac9-1298">Non è stato definito nessun ordine delle code in una rete.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1298">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="e0ac9-1299">Un enumeratore non vengono ordinate, ad esempio, per computer, un'etichetta, lo stato di tipo pubblico o privato o altri criteri accessibili.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1299">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="e0ac9-1300">Se si desidera uno snapshot statico delle code sulla rete anziché una connessione dinamica ad essi, chiamare <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> o <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1300">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-1301">Ognuno di questi due metodi restituisce una matrice di <xref:System.Messaging.MessageQueue> gli oggetti che rappresentano le code al momento della chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1301">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span>  
  
 <span data-ttu-id="e0ac9-1302">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1302">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1303">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1303">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1304">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1304">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1305">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1305">Local computer</span></span>|<span data-ttu-id="e0ac9-1306">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1306">No</span></span>|  
|<span data-ttu-id="e0ac9-1307">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1307">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1308">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1308">No</span></span>|  
|<span data-ttu-id="e0ac9-1309">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1309">Remote computer</span></span>|<span data-ttu-id="e0ac9-1310">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1310">No</span></span>|  
|<span data-ttu-id="e0ac9-1311">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1311">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1312">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1312">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1313">Esempio di codice seguente esegue l'iterazione attraverso tutte le code di messaggi nella rete e viene esaminato il percorso per ogni coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1313">The following code example iterates through all the message queues in the network, and examines the path for each queue.</span></span> <span data-ttu-id="e0ac9-1314">Infine, Visualizza il numero di code pubbliche sulla rete.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1314">Finally, it displays the number of public queues on the network.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CPP/mqgetmessagequeueenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CS/mqgetmessagequeueenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/VB/mqgetmessagequeueenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator (criteria As MessageQueueCriteria) As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberSignature Language="F#" Value="static member GetMessageQueueEnumerator : System.Messaging.MessageQueueCriteria -&gt; System.Messaging.MessageQueueEnumerator" Usage="System.Messaging.MessageQueue.GetMessageQueueEnumerator criteria" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria">
          <span data-ttu-id="e0ac9-1315">Oggetto <see cref="T:System.Messaging.MessageQueueCriteria" /> contenente i criteri utilizzati per filtrare le code di messaggi disponibili.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1315">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the available message queues.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1316">Fornisce la semantica del cursore forward-only per enumerare tutte le code pubbliche sulla rete che soddisfano i criteri specificati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1316">Provides forward-only cursor semantics to enumerate through all public queues on the network that meet the specified criteria.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1317">Oggetto <see cref="T:System.Messaging.MessageQueueEnumerator" /> che fornisce un elenco dinamico delle code di messaggi pubbliche sulla rete che soddisfano le restrizioni specificate dal parametro <paramref name="criteria" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1317">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of the public message queues on the network that satisfy the restrictions specified by the <paramref name="criteria" /> parameter.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1318">Questo overload del metodo <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> restituisce un elenco di tutte le code pubbliche sulla rete che soddisfano i criteri definiti nei criteri dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1318">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns a listing of all the public queues on the network that satisfy criteria defined in the application criteria.</span></span> <span data-ttu-id="e0ac9-1319">È possibile specificare i criteri da includere, ad esempio, accodare la creazione o modifica l'ora, nome del computer, etichetta, categoria o qualsiasi combinazione di questi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1319">You can specify the criteria to include, for example, queue creation or modification time, computer name, label, category, or any combination of these.</span></span>  
  
 <span data-ttu-id="e0ac9-1320">Poiché il cursore è associato a un elenco dinamico, l'enumerazione riflette tutte le modifiche apportate a una coda che si trova oltre la posizione del cursore corrente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1320">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue that occurs beyond the cursor's current position.</span></span> <span data-ttu-id="e0ac9-1321">Non vengono riflesse le modifiche apportate a code che si trova prima della posizione corrente del cursore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1321">Changes to queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="e0ac9-1322">Ad esempio, l'enumeratore può accedere automaticamente una coda aggiunto oltre la posizione del cursore, ma non quello inserito prima di tale posizione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1322">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="e0ac9-1323">Tuttavia, è possibile reimpostare l'enumerazione, spostare il cursore all'inizio dell'elenco, chiamando <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> per il <xref:System.Messaging.MessageQueueEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1323">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="e0ac9-1324">Non è stato definito nessun ordine delle code in una rete.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1324">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="e0ac9-1325">Un enumeratore non vengono ordinate, ad esempio, per computer, un'etichetta, lo stato di tipo pubblico o privato o altri criteri accessibili.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1325">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="e0ac9-1326">Se si desidera uno snapshot statico delle code sulla rete anziché una connessione dinamica ad essi, specificare i criteri per <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> oppure chiamare <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1326">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, specify criteria for <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or call <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-1327">Ognuno di questi due metodi restituisce una matrice di <xref:System.Messaging.MessageQueue> gli oggetti che rappresentano le code al momento della chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1327">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span> <span data-ttu-id="e0ac9-1328">La chiamata <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, o <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> offre gli stessi risultati di chiamata <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> con i criteri di filtro del <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, e <xref:System.Messaging.MessageQueue.MachineName%2A>, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1328">Calling <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> provides the same results as calling <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> with the filtering criteria of <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>, respectively.</span></span>  
  
 <span data-ttu-id="e0ac9-1329">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1329">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1330">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1330">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1331">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1331">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1332">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1332">Local computer</span></span>|<span data-ttu-id="e0ac9-1333">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1333">No</span></span>|  
|<span data-ttu-id="e0ac9-1334">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1334">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1335">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1335">No</span></span>|  
|<span data-ttu-id="e0ac9-1336">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1336">Remote computer</span></span>|<span data-ttu-id="e0ac9-1337">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1337">No</span></span>|  
|<span data-ttu-id="e0ac9-1338">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1338">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1339">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1339">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1340">Esempio di codice seguente esegue l'iterazione attraverso le code di messaggi e visualizza il percorso di ogni coda, che è stato creato nell'ultimo giorno e che esista nel computer "MyComputer".</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1340">The following code example iterates through message queues and displays the path of each queue that was created in the last day and that exists on the computer "MyComputer".</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CPP/mqgetmessagequeueenumerator_criteria.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CS/mqgetmessagequeueenumerator_criteria.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/VB/mqgetmessagequeueenumerator_criteria.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetPrivateQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPrivateQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPrivateQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPrivateQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPrivateQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPrivateQueuesByMachine(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetPrivateQueuesByMachine : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPrivateQueuesByMachine machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName">
          <span data-ttu-id="e0ac9-1341">Computer da cui recuperare le code private.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1341">The computer from which to retrieve the private queues.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1342">Recupera tutte le code private sul computer specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1342">Retrieves all the private queues on the specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1343">Matrice di oggetti <see cref="T:System.Messaging.MessageQueue" /> che fanno riferimento alle code private recuperate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1343">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved private queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> Consente di recuperare uno snapshot statico di code in un computer specifico.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues on a specified computer.</span></span>  
  
 <span data-ttu-id="e0ac9-1345">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1345">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1346">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1346">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1347">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1347">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1348">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1348">Local computer</span></span>|<span data-ttu-id="e0ac9-1349">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1349">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1350">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1350">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1351">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1351">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1352">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1352">Remote computer</span></span>|<span data-ttu-id="e0ac9-1353">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1353">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1354">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1354">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1355">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1355">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1356">Esempio di codice seguente recupera gli elenchi di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1356">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1357">Il parametro <paramref name="machineName" /> è <see langword="null" /> o una stringa vuota ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1357">The <paramref name="machineName" /> parameter is <see langword="null" /> or an empty string ("").</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1358">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1358">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetPublicQueues">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1359">Recupera tutte le code pubbliche sulla rete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1359">Retrieves all the public queues on the network.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues () As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues();" />
      <MemberSignature Language="F#" Value="static member GetPublicQueues : unit -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueues " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1360">Recupera tutte le code pubbliche sulla rete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1360">Retrieves all the public queues on the network.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1361">Matrice di oggetti <see cref="T:System.Messaging.MessageQueue" /> che fanno riferimento alle code pubbliche recuperate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1361">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1362">Utilizzare questo overload se si desidera un elenco completo di tutte le code pubbliche sulla rete.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1362">Use this overload if you want a complete list of all the public queues on the network.</span></span> <span data-ttu-id="e0ac9-1363">Se si desidera limitare l'elenco in base a determinati criteri, ad esempio <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, o l'ora dell'ultima modifica Usa un altro overload di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1363">If you want to restrict the list by certain criteria, such as <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, or last modified time use another overload of this method.</span></span> <span data-ttu-id="e0ac9-1364">(In alternativa, è possibile usare <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, o <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1364">(Alternatively, you can use <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span></span>  
  
 <span data-ttu-id="e0ac9-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> Consente di recuperare uno snapshot statico di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="e0ac9-1366">Per interagire con un elenco dinamico delle code, usare <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1366">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-1367">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1367">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1368">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1368">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1369">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1369">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1370">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1370">Local computer</span></span>|<span data-ttu-id="e0ac9-1371">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1371">No</span></span>|  
|<span data-ttu-id="e0ac9-1372">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1372">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1373">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1373">No</span></span>|  
|<span data-ttu-id="e0ac9-1374">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1374">Remote computer</span></span>|<span data-ttu-id="e0ac9-1375">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1375">No</span></span>|  
|<span data-ttu-id="e0ac9-1376">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1376">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1377">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1377">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1378">Esempio di codice seguente recupera gli elenchi di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1378">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1379">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1379">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues (criteria As MessageQueueCriteria) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueues : System.Messaging.MessageQueueCriteria -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueues criteria" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria">
          <span data-ttu-id="e0ac9-1380">Oggetto <see cref="T:System.Messaging.MessageQueueCriteria" /> contenente i criteri utilizzati per filtrare le code.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1380">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the queues.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1381">Recupera tutte le code pubbliche sulla rete che soddisfano i criteri specificati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1381">Retrieves all the public queues on the network that meet the specified criteria.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1382">Matrice di oggetti <see cref="T:System.Messaging.MessageQueue" /> che fanno riferimento alle code pubbliche recuperate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1382">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1383">Se si desidera filtrare tutte le code pubbliche sulla rete per l'etichetta, categoria o nome del computer, il <xref:System.Messaging.MessageQueue> classe contiene metodi specifici che offrono tale funzionalità (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, e <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>rispettivamente).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1383">If you want to filter all the public queues on the network by label, category, or computer name, the <xref:System.Messaging.MessageQueue> class contains specific methods that provide that functionality (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, and <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, respectively).</span></span> <span data-ttu-id="e0ac9-1384">Utilizzare questo overload per ottenere un elenco di tutte le code pubbliche sulla rete che soddisfano più di uno di questi criteri (ad esempio, se si desidera specificare un'etichetta e una categoria).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1384">Use this overload to get a list of all the public queues on the network that meet more than one of these criteria (for example, if you want to specify both a label and a category).</span></span> <span data-ttu-id="e0ac9-1385">È possibile anche filtrare in base ai criteri di messaggio diverso da <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, e <xref:System.Messaging.MessageQueue.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1385">You can also filter by message criteria other than <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="e0ac9-1386">Ad esempio, utilizzare questo overload per filtrare in base l'ora dell'ultima modifica della coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1386">For example, you use this overload to filter by a queue's last-modified time.</span></span> <span data-ttu-id="e0ac9-1387">È sufficiente creare una nuova istanza della <xref:System.Messaging.MessageQueueCriteria> classe, impostare le proprietà appropriate nell'istanza e passare l'istanza come il `criteria` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1387">Simply create a new instance of the <xref:System.Messaging.MessageQueueCriteria> class, set the appropriate properties in the instance, and pass the instance as the `criteria` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> Consente di recuperare uno snapshot statico di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="e0ac9-1389">Per interagire con un elenco dinamico delle code, usare <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1389">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-1390">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1390">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1391">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1391">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1392">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1392">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1393">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1393">Local computer</span></span>|<span data-ttu-id="e0ac9-1394">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1394">No</span></span>|  
|<span data-ttu-id="e0ac9-1395">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1395">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1396">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1396">No</span></span>|  
|<span data-ttu-id="e0ac9-1397">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1397">Remote computer</span></span>|<span data-ttu-id="e0ac9-1398">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1398">No</span></span>|  
|<span data-ttu-id="e0ac9-1399">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1399">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1400">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1400">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1401">Esempio di codice seguente recupera gli elenchi di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1401">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1402">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1402">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueCriteria" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByCategory">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByCategory (Guid category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByCategory(valuetype System.Guid category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByCategory(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByCategory (category As Guid) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByCategory(Guid category);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByCategory : Guid -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByCategory category" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="category" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="category">
          <span data-ttu-id="e0ac9-1403">Oggetto <see cref="T:System.Guid" /> che raggruppa il set di code da recuperare.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1403">A <see cref="T:System.Guid" /> that groups the set of queues to be retrieved.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1404">Recupera tutte le code pubbliche sulla rete appartenenti alla categoria specificata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1404">Retrieves all the public queues on the network that belong to the specified category.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1405">Matrice di oggetti <see cref="T:System.Messaging.MessageQueue" /> che fanno riferimento alle code pubbliche recuperate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1405">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1406">Usare questo metodo per filtrare le code pubbliche per categoria.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1406">Use this method to filter the public queues by category.</span></span> <span data-ttu-id="e0ac9-1407">Il <xref:System.Messaging.MessageQueue.Category%2A> proprietà offre l'accesso alla proprietà ID tipo di Accodamento messaggi, ovvero di lettura/scrittura, di una determinata coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1407">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing type ID property (which is read/write) of a particular queue.</span></span> <span data-ttu-id="e0ac9-1408">Sebbene sia possibile usare <xref:System.Guid.NewGuid%2A> per creare un valore di categoria che sia univoco all'interno <xref:System.Guid> valori, non è necessario.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1408">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, it is not necessary.</span></span> <span data-ttu-id="e0ac9-1409">Il valore della categoria deve essere distinti solo da altre categorie, non da tutte le altre <xref:System.Guid> valori.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1409">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="e0ac9-1410">Ad esempio, è possibile assegnare {00000000-0000-0000-0000-000000000001} come il <xref:System.Messaging.MessageQueue.Category%2A> per un set di code e {00000000-0000-0000-0000-000000000002} come il <xref:System.Messaging.MessageQueue.Category%2A> per un altro set.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1410">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="e0ac9-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> Consente di recuperare uno snapshot statico di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="e0ac9-1412">Per interagire con un elenco dinamico delle code, usare <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1412">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="e0ac9-1413">È possibile specificare la categoria come parte di <xref:System.Messaging.MessageQueueCriteria> è passato al metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1413">You can specify the category as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="e0ac9-1414">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1414">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1415">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1415">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1416">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1416">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1417">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1417">Local computer</span></span>|<span data-ttu-id="e0ac9-1418">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1418">No</span></span>|  
|<span data-ttu-id="e0ac9-1419">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1419">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1420">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1420">No</span></span>|  
|<span data-ttu-id="e0ac9-1421">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1421">Remote computer</span></span>|<span data-ttu-id="e0ac9-1422">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1422">No</span></span>|  
|<span data-ttu-id="e0ac9-1423">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1423">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1424">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1424">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1425">Esempio di codice seguente recupera gli elenchi di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1425">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1426">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1426">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByLabel">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByLabel (string label);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByLabel(string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByLabel(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByLabel (label As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByLabel(System::String ^ label);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByLabel : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByLabel label" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="label">
          <span data-ttu-id="e0ac9-1427">Etichetta che raggruppa il set di code da recuperare.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1427">A label that groups the set of queues to be retrieved.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1428">Recupera tutte le code pubbliche sulla rete contenenti l'etichetta specificata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1428">Retrieves all the public queues on the network that carry the specified label.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1429">Matrice di oggetti <see cref="T:System.Messaging.MessageQueue" /> che fanno riferimento alle code pubbliche recuperate.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1429">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1430">Usare questo metodo per filtrare le code pubbliche da etichetta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1430">Use this method to filter the public queues by label.</span></span>  
  
 <span data-ttu-id="e0ac9-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> Consente di recuperare uno snapshot statico di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="e0ac9-1432">Per interagire con un elenco dinamico delle code, usare <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1432">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="e0ac9-1433">È possibile specificare l'etichetta come parte di <xref:System.Messaging.MessageQueueCriteria> è passato al metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1433">You can specify the label as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="e0ac9-1434">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1434">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1435">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1435">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1436">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1436">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1437">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1437">Local computer</span></span>|<span data-ttu-id="e0ac9-1438">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1438">No</span></span>|  
|<span data-ttu-id="e0ac9-1439">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1439">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1440">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1440">No</span></span>|  
|<span data-ttu-id="e0ac9-1441">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1441">Remote computer</span></span>|<span data-ttu-id="e0ac9-1442">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1442">No</span></span>|  
|<span data-ttu-id="e0ac9-1443">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1443">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1444">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1444">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1445">Esempio di codice seguente recupera gli elenchi di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1445">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1446">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1446">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-1447">Il valore del parametro <paramref name="label" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1447">The <paramref name="label" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByMachine(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByMachine : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByMachine machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName">
          <span data-ttu-id="e0ac9-1448">Nome del computer contenente il set di code pubbliche da recuperare.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1448">The name of the computer that contains the set of public queues to be retrieved.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1449">Recupera tutte le code pubbliche che risiedono sul computer specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1449">Retrieves all the public queues that reside on the specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1450">Matrice di oggetti <see cref="T:System.Messaging.MessageQueue" /> che fanno riferimento alle code pubbliche sul computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1450">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the public queues on the computer.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1451">Usare questo metodo per filtrare le code pubbliche da computer.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1451">Use this method to filter the public queues by computer.</span></span>  
  
 <span data-ttu-id="e0ac9-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> Consente di recuperare uno snapshot statico di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="e0ac9-1453">Per interagire con un elenco dinamico delle code, usare <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1453">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="e0ac9-1454">È possibile specificare il nome del computer come parte di <xref:System.Messaging.MessageQueueCriteria> è passato al metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1454">You can specify the computer name as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="e0ac9-1455">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1455">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1456">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1456">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1457">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1457">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1458">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1458">Local computer</span></span>|<span data-ttu-id="e0ac9-1459">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1459">No</span></span>|  
|<span data-ttu-id="e0ac9-1460">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1460">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1461">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1461">No</span></span>|  
|<span data-ttu-id="e0ac9-1462">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1462">Remote computer</span></span>|<span data-ttu-id="e0ac9-1463">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1463">No</span></span>|  
|<span data-ttu-id="e0ac9-1464">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1464">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1465">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1465">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1466">Esempio di codice seguente recupera gli elenchi di code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1466">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1467">La sintassi del parametro <paramref name="machineName" /> non è corretta.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1467">The <paramref name="machineName" /> parameter has incorrect syntax.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1468">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1468">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetSecurityContext">
      <MemberSignature Language="C#" Value="public static System.Messaging.SecurityContext GetSecurityContext ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.SecurityContext GetSecurityContext() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetSecurityContext" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetSecurityContext () As SecurityContext" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::SecurityContext ^ GetSecurityContext();" />
      <MemberSignature Language="F#" Value="static member GetSecurityContext : unit -&gt; System.Messaging.SecurityContext" Usage="System.Messaging.MessageQueue.GetSecurityContext " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.SecurityContext</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1469">Recupera il contesto di sicurezza che MSMQ associa all'utente corrente (identità del thread) nel momento in cui viene eseguita questa chiamata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1469">Retrieves the security context that MSMQ associates with the current user (thread identity) at the time of this call.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1470">Oggetto <see cref="T:System.Messaging.SecurityContext" /> contenente il contesto di sicurezza.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1470">A <see cref="T:System.Messaging.SecurityContext" /> object that contains the security context.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
        <altmember cref="P:System.Messaging.Message.SecurityContext" />
      </Docs>
    </Member>
    <Member MemberName="Id">
      <MemberSignature Language="C#" Value="public Guid Id { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Id" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Id" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Id As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Id { Guid get(); };" />
      <MemberSignature Language="F#" Value="member this.Id : Guid" Usage="System.Messaging.MessageQueue.Id" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_GuidId")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1471">Ottiene l'identificatore univoco di Accodamento messaggi per la coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1471">Gets the unique Message Queuing identifier of the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1472">Proprietà <see cref="P:System.Messaging.MessageQueue.Id" /> che rappresenta l'identificatore del messaggio generato dall'applicazione Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1472">A <see cref="P:System.Messaging.MessageQueue.Id" /> that represents the message identifier generated by the Message Queuing application.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1473">Accodamento messaggi imposta il <xref:System.Messaging.MessageQueue.Id%2A> proprietà durante la creazione della coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1473">Message Queuing sets the <xref:System.Messaging.MessageQueue.Id%2A> property when it creates the queue.</span></span> <span data-ttu-id="e0ac9-1474">Questa proprietà è disponibile solo per le code pubbliche.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1474">This property is only available for public queues.</span></span>  
  
 <span data-ttu-id="e0ac9-1475">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1475">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1476">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1476">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1477">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1477">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1478">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1478">Local computer</span></span>|<span data-ttu-id="e0ac9-1479">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1479">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1480">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1480">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1481">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1481">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1482">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1482">Remote computer</span></span>|<span data-ttu-id="e0ac9-1483">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1483">No</span></span>|  
|<span data-ttu-id="e0ac9-1484">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1484">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1485">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1485">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1486">Esempio di codice seguente consente di visualizzare il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.Id%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1486">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Id%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1487">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1487">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteQueueSize">
      <MemberSignature Language="C#" Value="public static readonly long InfiniteQueueSize;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly int64 InfiniteQueueSize" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteQueueSize As Long " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly long InfiniteQueueSize;" />
      <MemberSignature Language="F#" Value=" staticval mutable InfiniteQueueSize : int64" Usage="System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1488">Specifica che non sono previste restrizioni relative alle dimensioni di una coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1488">Specifies that no size restriction exists for a queue.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1489">Questo membro viene spesso utilizzato durante l'impostazione <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> o <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1489">This member is frequently used when setting <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> or <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1490">Esempio di codice seguente viene illustrato l'utilizzo del <xref:System.Messaging.MessageQueue.InfiniteQueueSize> membro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1490">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteQueueSize> member.</span></span>  
  
 [!code-csharp[MessageQueue#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteTimeout">
      <MemberSignature Language="C#" Value="public static readonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly valuetype System.TimeSpan InfiniteTimeout" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteTimeout As TimeSpan " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="F#" Value=" staticval mutable InfiniteTimeout : TimeSpan" Usage="System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1491">Specifica che non è previsto un timeout per i metodi che leggono o ricevono messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1491">Specifies that no time-out exists for methods that peek or receive messages.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1492"><xref:System.Messaging.MessageQueue> supporta due tipi di recupero dei messaggi: sincrone e asincrone.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1492"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="e0ac9-1493">I metodi sincroni <xref:System.Messaging.MessageQueue.Peek%2A> e <xref:System.Messaging.MessageQueue.Receive%2A>, provoca l'intervallo di tempo specificato per un nuovo messaggio in arrivo nella coda di attesa del thread di processo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1493">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-1494">Se l'intervallo di tempo specificato è <xref:System.Messaging.MessageQueue.InfiniteTimeout>, il thread di processo rimane bloccato fino a quando non è disponibile un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1494">If the specified time interval is <xref:System.Messaging.MessageQueue.InfiniteTimeout>, the process thread remains blocked until a new message is available.</span></span> <span data-ttu-id="e0ac9-1495">D'altra parte, <xref:System.Messaging.MessageQueue.BeginPeek%2A> e <xref:System.Messaging.MessageQueue.BeginReceive%2A> (i metodi asincroni), consentire le attività principale dell'applicazione in un thread separato fino a un messaggio arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1495">On the other hand, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A> (the asynchronous methods), allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1496">Esempio di codice seguente viene illustrato l'utilizzo del <xref:System.Messaging.MessageQueue.InfiniteTimeout> membro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1496">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteTimeout> member.</span></span>  
  
 [!code-csharp[MessageQueue#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Label">
      <MemberSignature Language="C#" Value="public string Label { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Label" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Label" />
      <MemberSignature Language="VB.NET" Value="Public Property Label As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Label { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Label : string with get, set" Usage="System.Messaging.MessageQueue.Label" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Label")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1497">Ottiene o imposta la descrizione della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1497">Gets or sets the queue description.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1498">Etichetta della coda di messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1498">The label for the message queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1499">Il valore predefinito è una stringa vuota ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1499">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1500">La lunghezza massima di un'etichetta di messaggio della coda è 124 caratteri.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1500">The maximum length of a message queue label is 124 characters.</span></span>  
  
 <span data-ttu-id="e0ac9-1501">Il <xref:System.Messaging.MessageQueue.Label%2A> proprietà non deve essere univoco tra tutte le code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1501">The <xref:System.Messaging.MessageQueue.Label%2A> property does not need to be unique across all queues.</span></span> <span data-ttu-id="e0ac9-1502">Tuttavia, se più code condividono lo stesso <xref:System.Messaging.MessageQueue.Label%2A>, non è possibile usare il <xref:System.Messaging.MessageQueue.Send%28System.Object%29> metodo trasmettere un messaggio a tutti i tipi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1502">However, if multiple queues share the same <xref:System.Messaging.MessageQueue.Label%2A>, you cannot use the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method to broadcast a message to all of them.</span></span> <span data-ttu-id="e0ac9-1503">Se si usa la sintassi dell'etichetta per il <xref:System.Messaging.MessageQueue.Path%2A> proprietà quando si invia il messaggio, verrà generata un'eccezione se il <xref:System.Messaging.MessageQueue.Label%2A> non è univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1503">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="e0ac9-1504">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1504">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1505">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1505">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1506">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1506">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1507">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1507">Local computer</span></span>|<span data-ttu-id="e0ac9-1508">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1508">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1509">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1509">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1510">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1510">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1511">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1511">Remote computer</span></span>|<span data-ttu-id="e0ac9-1512">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1512">No</span></span>|  
|<span data-ttu-id="e0ac9-1513">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1513">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1514">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1514">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1515">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.Label%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1515">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Label%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1516">L'etichetta è stata impostata su un valore non valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1516">The label was set to an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1517">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1517">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="LastModifyTime">
      <MemberSignature Language="C#" Value="public DateTime LastModifyTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime LastModifyTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.LastModifyTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LastModifyTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime LastModifyTime { DateTime get(); };" />
      <MemberSignature Language="F#" Value="member this.LastModifyTime : DateTime" Usage="System.Messaging.MessageQueue.LastModifyTime" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_LastModifyTime")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1518">Ottiene la data e l'ora dell'ultima modifica delle proprietà di una coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1518">Gets the last time the properties of a queue were modified.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1519">Oggetto <see cref="T:System.DateTime" /> che indica la data e l'ora dell'ultima modifica delle proprietà della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1519">A <see cref="T:System.DateTime" /> that indicates when the queue properties were last modified.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1520">Ora dell'ultima modifica include quando la coda è stata creata e l'eventuale <xref:System.Messaging.MessageQueue> proprietà che modifica la coda di accodamento, ad esempio <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1520">The last modification time includes when the queue was created and any <xref:System.Messaging.MessageQueue> property that modifies the Message Queuing queue, such as <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span></span> <span data-ttu-id="e0ac9-1521">Il valore della <xref:System.Messaging.MessageQueue.LastModifyTime%2A> proprietà rappresenta l'ora di sistema del computer locale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1521">The value of the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property represents the system time of the local computer.</span></span>  
  
 <span data-ttu-id="e0ac9-1522">È necessario chiamare <xref:System.Messaging.MessageQueue.Refresh%2A> prima di ottenere il <xref:System.Messaging.MessageQueue.LastModifyTime%2A> proprietà; in caso contrario, l'ora di modifica associato a questo <xref:System.Messaging.MessageQueue> potrebbero non essere aggiornate.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1522">You must call <xref:System.Messaging.MessageQueue.Refresh%2A> before getting the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property; otherwise, the modification time associated with this <xref:System.Messaging.MessageQueue> might not be current.</span></span>  
  
 <span data-ttu-id="e0ac9-1523">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1523">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1524">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1524">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1525">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1525">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1526">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1526">Local computer</span></span>|<span data-ttu-id="e0ac9-1527">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1527">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1528">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1528">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1529">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1529">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1530">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1530">Remote computer</span></span>|<span data-ttu-id="e0ac9-1531">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1531">No</span></span>|  
|<span data-ttu-id="e0ac9-1532">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1532">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1533">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1533">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1534">Esempio di codice seguente consente di visualizzare il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.LastModifyTime%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1534">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1535">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1535">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.CreateTime" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MachineName : string with get, set" Usage="System.Messaging.MessageQueue.MachineName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MachineName")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1536">Ottiene o imposta il nome del computer in cui si trova la coda di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1536">Gets or sets the name of the computer where the Message Queuing queue is located.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1537">Nome del computer in cui si trova la coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1537">The name of the computer where the queue is located.</span>
          </span>
          <span data-ttu-id="e0ac9-1538">Il valore predefinito di Accodamento messaggi è "." per indicare il computer locale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1538">The Message Queuing default is ".", the local computer.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1539">Il <xref:System.Messaging.MessageQueue.MachineName%2A> è un componente integrale della sintassi del nome descrittivo della coda <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1539">The <xref:System.Messaging.MessageQueue.MachineName%2A> is an integral component of the friendly name syntax of the queue <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="e0ac9-1540">La tabella seguente illustra la sintassi da utilizzare per una coda di un tipo specificato quando si desidera identificare il percorso della coda utilizzando il relativo nome descrittivo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1540">The following table shows the syntax you should use for a queue of a specified type when you want to identify the queue path using its friendly name.</span></span>  
  
|<span data-ttu-id="e0ac9-1541">Tipo di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1541">Queue type</span></span>|<span data-ttu-id="e0ac9-1542">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1542">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="e0ac9-1543">coda pubblica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1543">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="e0ac9-1544">coda privata</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1544">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="e0ac9-1545">Coda del diario</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1545">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="e0ac9-1546">Coda journal computer</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1546">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="e0ac9-1547">Computer non recapitabili</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1547">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="e0ac9-1548">Macchina transazionale non recapitabili</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1548">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="e0ac9-1549">Usare "." per il computer locale quando si specifica il <xref:System.Messaging.MessageQueue.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1549">Use "." for the local computer when specifying the <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="e0ac9-1550">Solo il nome del computer è riconosciuto per questa proprietà, ad esempio, `Server0`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1550">Only the computer name is recognized for this property, for example, `Server0`.</span></span> <span data-ttu-id="e0ac9-1551">Il <xref:System.Messaging.MessageQueue.MachineName%2A> proprietà non supporta il formato dell'indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1551">The <xref:System.Messaging.MessageQueue.MachineName%2A> property does not support the IP address format.</span></span>  
  
 <span data-ttu-id="e0ac9-1552">Se si definiscono i <xref:System.Messaging.MessageQueue.Path%2A> in termini del <xref:System.Messaging.MessageQueue.MachineName%2A>, l'applicazione genera un'eccezione quando si lavora offline perché il controller di dominio è obbligatorio per la conversione del percorso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1552">If you define the <xref:System.Messaging.MessageQueue.Path%2A> in terms of the <xref:System.Messaging.MessageQueue.MachineName%2A>, the application throws an exception when working offline because the domain controller is required for path translation.</span></span> <span data-ttu-id="e0ac9-1553">Pertanto, è necessario usare il <xref:System.Messaging.MessageQueue.FormatName%2A> per il <xref:System.Messaging.MessageQueue.Path%2A> sintassi quando si lavora offline.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1553">Therefore, you must use the <xref:System.Messaging.MessageQueue.FormatName%2A> for the <xref:System.Messaging.MessageQueue.Path%2A> syntax when working offline.</span></span>  
  
 <span data-ttu-id="e0ac9-1554">Il <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, e <xref:System.Messaging.MessageQueue.QueueName%2A> sono correlate.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1554">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="e0ac9-1555">Modifica il <xref:System.Messaging.MessageQueue.MachineName%2A> proprietà causa la <xref:System.Messaging.MessageQueue.Path%2A> proprietà da modificare.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1555">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="e0ac9-1556">Si basa dalla nuova <xref:System.Messaging.MessageQueue.MachineName%2A> e il <xref:System.Messaging.MessageQueue.QueueName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1556">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="e0ac9-1557">Modifica il <xref:System.Messaging.MessageQueue.Path%2A> (ad esempio, per usare la sintassi del nome di formato) Reimposta le <xref:System.Messaging.MessageQueue.MachineName%2A> e <xref:System.Messaging.MessageQueue.QueueName%2A> proprietà per fare riferimento alla nuova coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1557">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span> <span data-ttu-id="e0ac9-1558">Se il <xref:System.Messaging.MessageQueue.QueueName%2A> la proprietà è vuota, il <xref:System.Messaging.MessageQueue.Path%2A> è impostata nella coda Journal del computer specificato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1558">If the <xref:System.Messaging.MessageQueue.QueueName%2A> property is empty, the <xref:System.Messaging.MessageQueue.Path%2A> is set to the Journal queue of the computer you specify.</span></span>  
  
 <span data-ttu-id="e0ac9-1559">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1559">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1560">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1560">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1561">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1561">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1562">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1562">Local computer</span></span>|<span data-ttu-id="e0ac9-1563">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1563">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1564">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1564">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1565">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1565">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1566">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1566">Remote computer</span></span>|<span data-ttu-id="e0ac9-1567">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1567">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1568">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1568">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1569">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1569">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1570">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.MachineName%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1570">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MachineName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1571">Il nome del computer non è valido, probabilmente perché la sintassi non è corretta.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1571">The name of the computer is not valid, possibly because the syntax is incorrect.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1572">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1572">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="MaximumJournalSize">
      <MemberSignature Language="C#" Value="public long MaximumJournalSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumJournalSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumJournalSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumJournalSize { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumJournalSize : int64 with get, set" Usage="System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumJournalSize")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.SizeConverter))</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1573">Ottiene o imposta la dimensione massima della coda del giornale di registrazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1573">Gets or sets the maximum size of the journal queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1574">Dimensione massima, espressa in kilobyte, della coda del journal.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1574">The maximum size, in kilobytes, of the journal queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1575">L'impostazione predefinita di Accodamento messaggi specifica che non esiste alcun limite.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1575">The Message Queuing default specifies that no limit exists.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1576"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> fornisce l'accesso per il limite di archiviazione di Accodamento messaggi journal.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1576"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> provides access to the Message Queuing journal storage limit.</span></span> <span data-ttu-id="e0ac9-1577">È pertinente solo quando <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> è `true`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1577">It is relevant only when <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> is `true`.</span></span> <span data-ttu-id="e0ac9-1578">Impostando questa proprietà viene modificata la coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1578">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-1579">Pertanto, qualsiasi altro <xref:System.Messaging.MessageQueue> istanze sono interessate dalla modifica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1579">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="e0ac9-1580">Se si archiviano i messaggi in una coda del diario o non recapitabilità, è necessario cancellare periodicamente la coda da cui rimuovere i messaggi che non sono più necessari.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1580">If you store messages in a journal or dead-letter queue, you should periodically clear the queue to remove messages that are no longer needed.</span></span> <span data-ttu-id="e0ac9-1581">I messaggi in tale coda vengono conteggiati la quota per il computer in cui risiede la coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1581">Messages in such a queue count toward the message quota for the computer where the queue resides.</span></span> <span data-ttu-id="e0ac9-1582">(L'amministratore imposta la quota del computer).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1582">(The administrator sets the computer quota.)</span></span>  
  
 <span data-ttu-id="e0ac9-1583">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1583">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1584">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1584">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1585">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1585">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1586">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1586">Local computer</span></span>|<span data-ttu-id="e0ac9-1587">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1587">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1588">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1588">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1589">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1589">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1590">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1590">Remote computer</span></span>|<span data-ttu-id="e0ac9-1591">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1591">No</span></span>|  
|<span data-ttu-id="e0ac9-1592">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1592">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1593">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1593">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1594">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1594">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1595">La dimensione massima della coda del journal è stata impostata su un valore non valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1595">The maximum journal queue size was set to an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1596">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1596">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MaximumQueueSize">
      <MemberSignature Language="C#" Value="public long MaximumQueueSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumQueueSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumQueueSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumQueueSize { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumQueueSize : int64 with get, set" Usage="System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumQueueSize")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.SizeConverter))</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1597">Ottiene o imposta la dimensione massima della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1597">Gets or sets the maximum size of the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1598">La dimensione massima, espressa in kilobyte (KB), della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1598">The maximum size, in kilobytes, of the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1599">L'impostazione predefinita di Accodamento messaggi specifica che non esiste alcun limite.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1599">The Message Queuing default specifies that no limit exists.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1600">Il <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> fornisce l'accesso al limite di archiviazione dei messaggi di Accodamento messaggi, separato dalla quota di messaggi del computer che l'amministratore definisce.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1600">The <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> provides access to the Message Queuing message storage limit, which is separate from the computer's message quota that the administrator defines.</span></span> <span data-ttu-id="e0ac9-1601">Per altre informazioni sulla quota messaggi, vedere <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1601">For more information about the message quota, see <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-1602">Impostando questa proprietà viene modificata la coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1602">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-1603">Pertanto, qualsiasi altro <xref:System.Messaging.MessageQueue> istanze sono interessate dalla modifica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1603">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="e0ac9-1604">Se viene effettuato un tentativo di superare le dimensioni massime della coda o la quota del messaggio di computer, i messaggi potrebbero essere persi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1604">If an attempt is made to exceed either the maximum queue size or the computer message quota, messages might be lost.</span></span> <span data-ttu-id="e0ac9-1605">Quando viene raggiunta la quota della coda, Accodamento messaggi di notifica la coda di amministrazione dell'applicazione mittente per indicare che la coda è piena, restituendo un messaggio di riconoscimento negativo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1605">When the queue quota is reached, Message Queuing notifies the administration queue of the sending application to indicate that the queue is full, by returning a negative acknowledgment message.</span></span> <span data-ttu-id="e0ac9-1606">Il servizio Accodamento messaggi continua a inviare i riconoscimenti negativi fino a quando le dimensioni totali dei messaggi nella coda scende sotto il limite.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1606">Message Queuing continues to send negative acknowledgments until the total size of the messages in the queue drops below the limit.</span></span>  
  
 <span data-ttu-id="e0ac9-1607">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1607">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1608">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1608">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1609">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1609">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1610">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1610">Local computer</span></span>|<span data-ttu-id="e0ac9-1611">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1611">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1612">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1612">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1613">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1613">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1614">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1614">Remote computer</span></span>|<span data-ttu-id="e0ac9-1615">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1615">No</span></span>|  
|<span data-ttu-id="e0ac9-1616">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1616">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1617">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1617">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1618">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1618">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1619">La dimensione massima della coda contiene un valore negativo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1619">The maximum queue size contains a negative value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1620">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1620">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MessageReadPropertyFilter">
      <MemberSignature Language="C#" Value="public System.Messaging.MessagePropertyFilter MessageReadPropertyFilter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.MessagePropertyFilter MessageReadPropertyFilter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberSignature Language="VB.NET" Value="Public Property MessageReadPropertyFilter As MessagePropertyFilter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::MessagePropertyFilter ^ MessageReadPropertyFilter { System::Messaging::MessagePropertyFilter ^ get(); void set(System::Messaging::MessagePropertyFilter ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MessageReadPropertyFilter : System.Messaging.MessagePropertyFilter with get, set" Usage="System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MessageReadPropertyFilter")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Content)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessagePropertyFilter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1621">Ottiene o imposta il filtro di proprietà per la ricezione o la visualizzazione dei messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1621">Gets or sets the property filter for receiving or peeking messages.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1622">
            <see cref="T:System.Messaging.MessagePropertyFilter" /> utilizzato dalla coda per filtrare l'insieme di proprietà ricevute o visualizzate per ciascun messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1622">The <see cref="T:System.Messaging.MessagePropertyFilter" /> used by the queue to filter the set of properties it receives or peeks for each message.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1623">Questo filtro è un set di valori booleani che limita le proprietà del messaggio che il <xref:System.Messaging.MessageQueue> ricevute o visualizzate.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1623">This filter is a set of Boolean values restricting the message properties that the <xref:System.Messaging.MessageQueue> receives or peeks.</span></span> <span data-ttu-id="e0ac9-1624">Quando il <xref:System.Messaging.MessageQueue> riceve o preleva un messaggio dalla coda del server, recupera solo le proprietà per cui la <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> valore `true`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1624">When the <xref:System.Messaging.MessageQueue> receives or peeks a message from the server queue, it retrieves only those properties for which the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> value is `true`.</span></span>  
  
 <span data-ttu-id="e0ac9-1625">Di seguito è riportato i valori iniziali delle proprietà per il <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1625">The following shows initial property values for the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span> <span data-ttu-id="e0ac9-1626">Queste impostazioni sono identiche alla chiamata <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> su un <xref:System.Messaging.MessagePropertyFilter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1626">These settings are identical to calling <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> on a <xref:System.Messaging.MessagePropertyFilter>.</span></span>  
  
|<span data-ttu-id="e0ac9-1627">Proprietà</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1627">Property</span></span>|<span data-ttu-id="e0ac9-1628">Valore predefinito</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1628">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessagePropertyFilter.Acknowledgment%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AcknowledgeType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AdministrationQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AppSpecific%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ArrivedTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AttachSenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Authenticated%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderName%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Body%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.ConnectorType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.CorrelationId%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultBodySize%2A>|<span data-ttu-id="e0ac9-1629">1024 byte</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1629">1024 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultExtensionSize%2A>|<span data-ttu-id="e0ac9-1630">255 byte</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1630">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultLabelSize%2A>|<span data-ttu-id="e0ac9-1631">255 byte</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1631">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationSymmetricKey%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DigitalSignature%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.EncryptionAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Extension%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.HashAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Id%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.IsFirstInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.IsLastInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Label%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.MessageType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Priority%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Recoverable%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ResponseQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderCertificate%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderVersion%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SentTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SourceMachine%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToBeReceived%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToReachQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionStatusQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="e0ac9-1632">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1632">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1633">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1633">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1634">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1634">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1635">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1635">Local computer</span></span>|<span data-ttu-id="e0ac9-1636">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1636">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1637">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1637">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1638">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1638">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1639">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1639">Remote computer</span></span>|<span data-ttu-id="e0ac9-1640">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1640">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1641">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1641">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1642">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1642">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1643">Il codice seguente viene illustrato come utilizzare il <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> per limitare le proprietà del messaggio ricevute.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1643">The following code example uses the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> to restrict the message properties received.</span></span>  
  
 [!code-cpp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CPP/mqmessagereadpropertyfilter.cpp#1)]
 [!code-csharp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CS/mqmessagereadpropertyfilter.cs#1)]
 [!code-vb[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/VB/mqmessagereadpropertyfilter.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1644">Il filtro è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1644">The filter is <see langword="null" />.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="MulticastAddress">
      <MemberSignature Language="C#" Value="public string MulticastAddress { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MulticastAddress" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MulticastAddress" />
      <MemberSignature Language="VB.NET" Value="Public Property MulticastAddress As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MulticastAddress { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MulticastAddress : string with get, set" Usage="System.Messaging.MessageQueue.MulticastAddress" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MulticastAddress")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1645">Introdotto in MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1645">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="e0ac9-1646">Ottiene o imposta l'indirizzo multicast associato alla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1646">Gets or sets the multicast address associated with the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1647">Oggetto <see cref="T:System.String" /> che contiene un indirizzo multicast valido (nel formato riportato di seguito) o <see langword="null" />, a indicare che alla coda non è associato alcun indirizzo multicast.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1647">A <see cref="T:System.String" /> that contains a valid multicast address (in the form shown below) or <see langword="null" />, which indicates that the queue is not associated with a multicast address.</span>
          </span>  
  
```  
&lt;address&gt;:&lt;port&gt;  
```</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1648">Il <xref:System.Messaging.MessageQueue.MulticastAddress%2A> proprietà viene utilizzata per associare una coda non transazionale a un indirizzo multicast che può essere usato quando l'invio di messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1648">The <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property is used to associate a non-transactional queue with a multicast address that can be used when sending messages.</span></span> <span data-ttu-id="e0ac9-1649">È una coda transazionale non è possibile associare un indirizzo multicast.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1649">You cannot associate a transactional queue with a multicast address.</span></span> <span data-ttu-id="e0ac9-1650">Quando l'applicazione mittente invia messaggi a un indirizzo multicast, il servizio Accodamento messaggi invia una copia del messaggio per ogni coda associata a quell'indirizzo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1650">When the sending application sends messages to a multicast address, Message Queuing sends a copy of the message to every queue associated with that address.</span></span>  
  
 <span data-ttu-id="e0ac9-1651">Indirizzi IP multicast indirizzi devono essere nell'intervallo di classe D tra 224.0.0.0 e 239.255.255.255, che corrisponde all'impostazione su 1110 i primi quattro bit più significativi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1651">IP multicast addresses must be in the class D range from 224.0.0.0 to 239.255.255.255, which corresponds to setting the first four high-order bits equal to 1110.</span></span> <span data-ttu-id="e0ac9-1652">Tuttavia, solo alcuni intervalli di indirizzi in questo intervallo sono riservati e disponibile per l'invio di messaggi multicast.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1652">However, only certain ranges of addresses in this range are unreserved and available for sending multicast messages.</span></span> <span data-ttu-id="e0ac9-1653">Per un elenco aggiornato degli indirizzi multicast riservati, vedere la [indirizzi Multicast Internet numero autorità IANA (Internet Assigned)](http://go.microsoft.com/fwlink/?linkid=3859) pagina Web.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1653">For the latest list of reserved multicast addresses, see the [Internet Assigned Number Authority (IANA) Internet Multicast Addresses](http://go.microsoft.com/fwlink/?linkid=3859) Web page.</span></span> <span data-ttu-id="e0ac9-1654">Non sono previste restrizioni al numero di porta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1654">There are no restrictions on the port number.</span></span>  
  
 <span data-ttu-id="e0ac9-1655">Se diversi computer di origine sono l'invio di messaggi multicast e si vuole una coda specifica per ricevere messaggi da un solo computer di origine, ogni computer di origine deve inviare messaggi a una diversa combinazione di numero di porta e indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1655">If several source computers are sending multicast messages and you want a specific queue to receive messages from only one source computer, each source computer must send messages to a different combination of IP address and port number.</span></span>  
  
 <span data-ttu-id="e0ac9-1656">Per annullare l'associazione di una coda e un indirizzo multicast, impostare il <xref:System.Messaging.MessageQueue.MulticastAddress%2A> proprietà in una stringa di lunghezza zero.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1656">To dissociate a queue from a multicast address, set the <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property to a zero-length string.</span></span> <span data-ttu-id="e0ac9-1657">Non impostarlo su `null`, come l'operazione comporterà un <xref:System.ArgumentNullException>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1657">Do not set it to `null`, as this will result in a <xref:System.ArgumentNullException>.</span></span>  
  
 <span data-ttu-id="e0ac9-1658">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1658">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1659">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1659">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1660">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1660">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1661">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1661">Local computer</span></span>|<span data-ttu-id="e0ac9-1662">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1662">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1663">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1663">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1664">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1664">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1665">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1665">Remote computer</span></span>|<span data-ttu-id="e0ac9-1666">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1666">No</span></span>|  
|<span data-ttu-id="e0ac9-1667">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1667">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1668">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1668">No</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="e0ac9-1669">MSMQ 3.0 non è installato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1669">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="Path">
      <MemberSignature Language="C#" Value="public string Path { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Path" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Path" />
      <MemberSignature Language="VB.NET" Value="Public Property Path As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Path { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Path : string with get, set" Usage="System.Messaging.MessageQueue.Path" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Path")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.RefreshProperties(System.ComponentModel.RefreshProperties.All)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.RefreshProperties</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1670">Ottiene o imposta il percorso della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1670">Gets or sets the queue's path.</span>
          </span>
          <span data-ttu-id="e0ac9-1671">Impostando la proprietà <see cref="P:System.Messaging.MessageQueue.Path" />, <see cref="T:System.Messaging.MessageQueue" /> punta a una nuova coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1671">Setting the <see cref="P:System.Messaging.MessageQueue.Path" /> causes the <see cref="T:System.Messaging.MessageQueue" /> to point to a new queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-1672">Coda a cui <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1672">The queue that is referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="e0ac9-1673">Il valore predefinito dipende dal costruttore <see cref="M:System.Messaging.MessageQueue.#ctor" /> utilizzato e può essere <see langword="null" /> oppure può essere specificato dal parametro <paramref name="path" /> del costruttore.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1673">The default depends on which <see cref="M:System.Messaging.MessageQueue.#ctor" /> constructor you use; it is either <see langword="null" /> or is specified by the constructor's <paramref name="path" /> parameter.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1674">La sintassi per il <xref:System.Messaging.MessageQueue.Path%2A> proprietà dipende dal tipo di coda dei messaggi, punti, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1674">The syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue it points to, as shown in the following table.</span></span>  
  
|<span data-ttu-id="e0ac9-1675">Tipo di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1675">Queue type</span></span>|<span data-ttu-id="e0ac9-1676">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1676">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="e0ac9-1677">coda pubblica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1677">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="e0ac9-1678">coda privata</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1678">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="e0ac9-1679">Coda del diario</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1679">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="e0ac9-1680">Coda journal computer</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1680">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="e0ac9-1681">Computer non recapitabili</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1681">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="e0ac9-1682">Macchina transazionale non recapitabili</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1682">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="e0ac9-1683">Usare "." per rappresentare il computer locale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1683">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="e0ac9-1684">Il <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, e <xref:System.Messaging.MessageQueue.QueueName%2A> sono correlate.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1684">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="e0ac9-1685">Modifica il <xref:System.Messaging.MessageQueue.MachineName%2A> proprietà causa la <xref:System.Messaging.MessageQueue.Path%2A> proprietà da modificare.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1685">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="e0ac9-1686">Si basa dalla nuova <xref:System.Messaging.MessageQueue.MachineName%2A> e il <xref:System.Messaging.MessageQueue.QueueName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1686">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="e0ac9-1687">Modifica il <xref:System.Messaging.MessageQueue.Path%2A> (ad esempio, per usare la sintassi del nome di formato) Reimposta le <xref:System.Messaging.MessageQueue.MachineName%2A> e <xref:System.Messaging.MessageQueue.QueueName%2A> proprietà per fare riferimento alla nuova coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1687">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1688">In alternativa, è possibile usare la <xref:System.Messaging.MessageQueue.FormatName%2A> o <xref:System.Messaging.MessageQueue.Label%2A> per descrivere il percorso della coda, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1688">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="e0ac9-1689">Riferimenti</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1689">Reference</span></span>|<span data-ttu-id="e0ac9-1690">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1690">Syntax</span></span>|<span data-ttu-id="e0ac9-1691">Esempio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1691">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="e0ac9-1692">Nome del formato</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1692">Format name</span></span>|<span data-ttu-id="e0ac9-1693">`FormatName:` [ *nome del formato* ]</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1693">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="e0ac9-1694">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1694">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span>|  
|<span data-ttu-id="e0ac9-1695">Label</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1695">Label</span></span>|<span data-ttu-id="e0ac9-1696">`Label:` [ *etichetta* ]</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1696">`Label:` [ *label* ]</span></span>|<span data-ttu-id="e0ac9-1697">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1697">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="e0ac9-1698">Se si usa la sintassi dell'etichetta per il <xref:System.Messaging.MessageQueue.Path%2A> proprietà quando si invia il messaggio, verrà generata un'eccezione se il <xref:System.Messaging.MessageQueue.Label%2A> non è univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1698">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="e0ac9-1699">Per funzionare offline, è necessario usare la sintassi del nome di formato, anziché la sintassi del nome descrittivo della prima tabella.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1699">To work offline, you must use the format name syntax, rather than the friendly name syntax in the first table.</span></span> <span data-ttu-id="e0ac9-1700">In caso contrario, viene generata un'eccezione perché il controller di dominio primario (in cui risiede Active Directory) non è disponibile per risolvere il percorso per il nome del formato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1700">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="e0ac9-1701">L'impostazione di un nuovo percorso chiude la coda di messaggi e rilascia tutti gli handle.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1701">Setting a new path closes the message queue and releases all handles.</span></span>  
  
 <span data-ttu-id="e0ac9-1702">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1702">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1703">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1703">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1704">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1704">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1705">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1705">Local computer</span></span>|<span data-ttu-id="e0ac9-1706">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1706">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1707">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1707">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1708">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1708">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1709">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1709">Remote computer</span></span>|<span data-ttu-id="e0ac9-1710">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1710">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1711">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1711">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1712">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1712">Yes</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="e0ac9-1713">In modalità gruppo di lavoro è possibile usare solo le code private.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1713">In workgroup mode you can only use private queues.</span></span> <span data-ttu-id="e0ac9-1714">Specificare il percorso utilizzando la sintassi di coda privata `MachineName` \\ `Private$` \\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1714">You specify the path using the private queue syntax `MachineName`\\`Private$`\\`QueueName`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1715">Esempio di codice seguente crea nuovi <xref:System.Messaging.MessageQueue> di oggetti usando vari tipi di sintassi di nome di percorso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1715">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="e0ac9-1716">In ogni caso, viene inviato un messaggio nella coda cui percorso viene definita nel costruttore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1716">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1717">Il percorso non è valido, probabilmente perché la sintassi non è valida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1717">The path is not valid, possibly because the syntax is not valid.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Peek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe>
          <span data-ttu-id="e0ac9-1718">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1718">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <summary>
          <span data-ttu-id="e0ac9-1719">Restituisce una copia del primo messaggio della coda senza rimuoverlo da quest'ultima.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1719">Returns a copy of the first message in the queue without removing the message from the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek();" />
      <MemberSignature Language="F#" Value="member this.Peek : unit -&gt; System.Messaging.Message" Usage="messageQueue.Peek " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1720">Termina senza rimuovere (legge) il primo messaggio nella coda a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1720">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="e0ac9-1721">Poiché il metodo <see cref="M:System.Messaging.MessageQueue.Peek" /> è sincrono, blocca il thread corrente finché non viene reso disponibile un messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1721">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1722">
            <see cref="T:System.Messaging.Message" /> che rappresenta il primo messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1722">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1723">Utilizzare questo overload per leggere una coda o in attesa fino a quando non è disponibile un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1723">Use this overload to peek a queue, or to wait until a message exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1724">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo legge, ma non rimuove, il primo messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1724">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="e0ac9-1725">Di conseguenza, le chiamate ripetute a <xref:System.Messaging.MessageQueue.Peek%2A> restituiscono lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1725">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-1726">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo, d'altra parte, legge e rimuove il primo messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1726">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="e0ac9-1727">Chiamate ripetute a <xref:System.Messaging.MessageQueue.Receive%2A>, pertanto restituire diversi tipi di messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1727">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="e0ac9-1728">I messaggi vengono ordinati in Accodamento messaggi nella coda in base all'ora di arrivo e priorità.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1728">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="e0ac9-1729">Un messaggio più recente viene inserito prima di quello precedente solo se si tratta di una priorità più alta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1729">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="e0ac9-1730">Utilizzare il metodo <xref:System.Messaging.MessageQueue.Peek%2A> quando è possibile bloccare il thread corrente durante l'attesa dell'arrivo di un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1730">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-1731">Poiché questo overload non specifica un timeout, l'applicazione potrebbe attendere all'infinito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1731">Because this overload does not specify a time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="e0ac9-1732">Se si desidera che l'elaborazione dell'applicazione continui senza attendere, utilizzare il metodo asincrono <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1732">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span> <span data-ttu-id="e0ac9-1733">In alternativa, è possibile specificare un timeout per un messaggio in arrivo nella coda tramite l'overload del metodo <xref:System.Messaging.MessageQueue.Peek%2A> che specifica un timeout.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1733">Alternatively, you can specify a time-out for a message to arrive in the queue by using the overload of <xref:System.Messaging.MessageQueue.Peek%2A> that specifies a time-out.</span></span>  
  
 <span data-ttu-id="e0ac9-1734">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1734">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1735">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1735">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1736">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1736">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1737">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1737">Local computer</span></span>|<span data-ttu-id="e0ac9-1738">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1738">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1739">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1739">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1740">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1740">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1741">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1741">Remote computer</span></span>|<span data-ttu-id="e0ac9-1742">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1742">No</span></span>|  
|<span data-ttu-id="e0ac9-1743">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1743">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1744">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1744">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1745">Gli esempi seguenti usano il <xref:System.Messaging.MessageQueue.Peek%2A> metodo in una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1745">The following examples use the <xref:System.Messaging.MessageQueue.Peek%2A> method on a queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1746">Nel primo esempio, l'applicazione attende un messaggio diventa disponibile nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1746">In the first example, the application waits until a message becomes available in the queue.</span></span> <span data-ttu-id="e0ac9-1747">Si noti che il primo esempio non acceda il messaggio che arriva; semplicemente sospende l'elaborazione fino a quando non arriva un messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1747">Note that the first example does not access the message that arrives; it merely pauses processing until a message arrives.</span></span> <span data-ttu-id="e0ac9-1748">Se già presente un messaggio nella coda, verrà restituito immediatamente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1748">If a message already exists in the queue, it will return immediately.</span></span>  
  
 <span data-ttu-id="e0ac9-1749">Nel secondo esempio, un messaggio che contiene un parametro definito dall'applicazione `Order` classe viene inviato alla coda e successivamente viene letto dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1749">In the second example, a message that contains an application-defined `Order` class is sent to the queue, and then peeked from the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CPP/mqpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Peek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CS/mqpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.Peek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_noparms/VB/mqpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1750">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1750">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-1751">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1751">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.Peek : TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.Peek timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-1752">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo massimo di attesa affinché un messaggio venga inserito nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1752">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1753">Termina senza rimuovere (legge) il primo messaggio nella coda a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1753">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="e0ac9-1754">Poiché il metodo <see cref="M:System.Messaging.MessageQueue.Peek" /> è sincrono, blocca il thread corrente finché non viene reso disponibile un messaggio o non si verifica il timeout specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1754">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1755">
            <see cref="T:System.Messaging.Message" /> che rappresenta il primo messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1755">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1756">Utilizzare questo overload per leggere una coda o a un determinato periodo di tempo fino a quando non è disponibile un messaggio nella coda di attesa.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1756">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="e0ac9-1757">Il metodo restituisce immediatamente se un messaggio esiste già nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1757">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1758">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo legge, ma non rimuove, il primo messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1758">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="e0ac9-1759">Di conseguenza, le chiamate ripetute a <xref:System.Messaging.MessageQueue.Peek%2A> restituiscono lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1759">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-1760">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo, d'altra parte, legge e rimuove il primo messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1760">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="e0ac9-1761">Chiamate ripetute a <xref:System.Messaging.MessageQueue.Receive%2A>, pertanto restituire diversi tipi di messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1761">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="e0ac9-1762">I messaggi vengono ordinati in Accodamento messaggi nella coda in base all'ora di arrivo e priorità.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1762">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="e0ac9-1763">Un messaggio più recente viene inserito prima di quello precedente solo se si tratta di una priorità più alta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1763">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="e0ac9-1764">Utilizzare il metodo <xref:System.Messaging.MessageQueue.Peek%2A> quando è possibile bloccare il thread corrente durante l'attesa dell'arrivo di un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1764">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-1765">Il thread verrà bloccato fino al periodo specificato di tempo o per un periodo illimitato se si indicato <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1765">The thread will be blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="e0ac9-1766">Se si desidera che l'elaborazione dell'applicazione continui senza attendere, utilizzare il metodo asincrono <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1766">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-1767">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1767">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1768">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1768">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1769">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1769">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1770">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1770">Local computer</span></span>|<span data-ttu-id="e0ac9-1771">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1771">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1772">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1772">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1773">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1773">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1774">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1774">Remote computer</span></span>|<span data-ttu-id="e0ac9-1775">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1775">No</span></span>|  
|<span data-ttu-id="e0ac9-1776">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1776">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1777">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1777">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1778">Il codice seguente viene illustrato come utilizzare il <xref:System.Messaging.MessageQueue.Peek%2A> metodo con un timeout pari a zero per verificare se la coda è vuota.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1778">The following code example uses the <xref:System.Messaging.MessageQueue.Peek%2A> method with a time-out of zero to check whether the queue is empty.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CPP/mqpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Peek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CS/mqpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.Peek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_timeout/VB/mqpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1779">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1779">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1780">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1780">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-1781">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1781">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action);" />
      <MemberSignature Language="F#" Value="member this.Peek : TimeSpan * System.Messaging.Cursor * System.Messaging.PeekAction -&gt; System.Messaging.Message" Usage="messageQueue.Peek (timeout, cursor, action)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-1782">Oggetto <see cref="T:System.TimeSpan" /> che indica il tempo massimo di attesa affinché un messaggio venga inserito nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1782">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="e0ac9-1783">Oggetto <see cref="T:System.Messaging.Cursor" /> che occupa una posizione specifica nella coda messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1783">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="action">
          <span data-ttu-id="e0ac9-1784">Uno dei valori di <see cref="T:System.Messaging.PeekAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1784">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span>
          </span>
          <span data-ttu-id="e0ac9-1785">Indica se leggere il messaggio corrente nella coda oppure il messaggio successivo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1785">Indicates whether to peek at the current message in the queue, or the next message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1786">Termina senza rimuovere (legge) il messaggio corrente o successivo della coda, utilizzando il cursore specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1786">Returns without removing (peeks) the current or next message in the queue, using the specified cursor.</span>
          </span>
          <span data-ttu-id="e0ac9-1787">Poiché il metodo <see cref="M:System.Messaging.MessageQueue.Peek" /> è sincrono, blocca il thread corrente finché non viene reso disponibile un messaggio o non si verifica il timeout specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1787">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1788">Oggetto <see cref="T:System.Messaging.Message" /> che rappresenta un messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1788">A <see cref="T:System.Messaging.Message" /> that represents a message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1789">Utilizzare questo overload per leggere una coda o a un determinato periodo di tempo fino a quando non è disponibile un messaggio nella coda di attesa.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1789">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="e0ac9-1790">Il metodo restituisce immediatamente se un messaggio esiste già nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1790">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1791">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo legge, ma non rimuove, un messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1791">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, a message from the queue.</span></span> <span data-ttu-id="e0ac9-1792">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo, d'altra parte, legge e lo rimuove un messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1792">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes a message from the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1793">Utilizzare il metodo <xref:System.Messaging.MessageQueue.Peek%2A> quando è possibile bloccare il thread corrente durante l'attesa dell'arrivo di un messaggio nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1793">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-1794">Il thread è bloccato fino al periodo specificato di tempo o per un periodo illimitato se si indicato <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1794">The thread is blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="e0ac9-1795">Se si desidera che l'elaborazione dell'applicazione continui senza attendere, utilizzare il metodo asincrono <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1795">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-1796">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1796">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1797">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1797">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1798">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1798">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1799">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1799">Local computer</span></span>|<span data-ttu-id="e0ac9-1800">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1800">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1801">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1801">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1802">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1802">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1803">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1803">Remote computer</span></span>|<span data-ttu-id="e0ac9-1804">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1804">No</span></span>|  
|<span data-ttu-id="e0ac9-1805">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1805">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1806">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1806">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="e0ac9-1807">È stato specificato un valore diverso da <see langword="PeekAction.Current" /> o <see langword="PeekAction.Next" /> per il parametro <paramref name="action" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1807">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-1808">Il valore del parametro <paramref name="cursor" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1808">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1809">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1809">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
          <span data-ttu-id="e0ac9-1810">Probabilmente <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1810">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1811">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1811">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-1812">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1812">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.PeekAction" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1813">Legge un messaggio che corrisponde a un determinato identificatore di correlazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1813">Peeks a message that matches a given correlation identifier.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId);" />
      <MemberSignature Language="F#" Value="member this.PeekByCorrelationId : string -&gt; System.Messaging.Message" Usage="messageQueue.PeekByCorrelationId correlationId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="e0ac9-1814">Oggetto <see cref="P:System.Messaging.Message.CorrelationId" /> del messaggio da leggere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1814">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1815">Legge il messaggio che corrisponde all'identificatore di correlazione specificato e, se nella coda non è disponibile correntemente alcun messaggio con l'identificatore di correlazione specificato, genererà immediatamente un'eccezione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1815">Peeks the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1816">
            <see cref="T:System.Messaging.Message" /> il cui <see cref="P:System.Messaging.Message.CorrelationId" /> corrisponde al parametro <paramref name="correlationId" /> trasmesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1816">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1817">Questo metodo effettua ricerche nella coda cui fa riferimento il <xref:System.Messaging.MessageQueue> per un messaggio la cui <xref:System.Messaging.Message.CorrelationId%2A> corrisponde al valore specificato `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1817">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-1818">Se viene trovato alcun messaggio che corrisponde alla `correlationID` parametro, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1818">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="e0ac9-1819">Il <xref:System.Messaging.Message.CorrelationId%2A> proprietà viene utilizzata per collegare un messaggio inviato alla coda di messaggi di risposta, un report o riconoscimento associati.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1819">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="e0ac9-1820">Altri due metodi consentono di leggere i messaggi in una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1820">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="e0ac9-1821">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> metodo viene utilizzato per recuperare un messaggio, specificando il relativo identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1821">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="e0ac9-1822">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1822">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1823">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1823">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1824">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1824">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1825">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1825">Local computer</span></span>|<span data-ttu-id="e0ac9-1826">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1826">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1827">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1827">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1828">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1828">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1829">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1829">Remote computer</span></span>|<span data-ttu-id="e0ac9-1830">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1830">No</span></span>|  
|<span data-ttu-id="e0ac9-1831">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1831">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1832">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1832">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1833">Esempio di codice seguente invia e riceve un messaggio contenente un ordine a e da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1833">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="e0ac9-1834">In particolare richiede una conferma positiva quando il messaggio originale raggiunge o viene recuperato dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1834">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-1835">Il valore del parametro <paramref name="correlationId" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1835">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-1836">Impossibile trovare il messaggio con il parametro <paramref name="correlationId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1836">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1837">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1837">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.PeekByCorrelationId : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.PeekByCorrelationId (correlationId, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="e0ac9-1838">Oggetto <see cref="P:System.Messaging.Message.CorrelationId" /> del messaggio da leggere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1838">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="e0ac9-1839">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1839">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1840">Legge il messaggio che corrisponde all'identificatore di correlazione specificato e attende che un messaggio con l'identificatore di correlazione specificato sia disponibile nella coda o che il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1840">Peeks the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1841">
            <see cref="T:System.Messaging.Message" /> il cui <see cref="P:System.Messaging.Message.CorrelationId" /> corrisponde al parametro <paramref name="correlationId" /> trasmesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1841">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1842">Questo metodo effettua ricerche nella coda cui fa riferimento il <xref:System.Messaging.MessageQueue> per un messaggio la cui <xref:System.Messaging.Message.CorrelationId%2A> corrisponde al valore specificato `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1842">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-1843">Se viene trovato alcun messaggio che corrisponde alla `correlationID` parametro e nessun nuovo messaggio arriva nella coda entro il periodo specificato da di `timeout` parametro, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1843">If no message is found that matches the `correlationID` parameter, and no new message arrives in the queue within the period specified by the `timeout` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="e0ac9-1844">Il `timeout` parametro specifica il totale tempo di esecuzione per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1844">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="e0ac9-1845">Piuttosto, specifica il tempo di attesa per un nuovo messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1845">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-1846">Ogni volta che arriva un nuovo messaggio, questo metodo esamina la <xref:System.Messaging.Message.CorrelationId%2A> del nuovo messaggio per verificare se corrisponde il `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1846">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-1847">In caso contrario, questo metodo avvia nuovamente il periodo di timeout e attende l'arrivo di un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1847">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="e0ac9-1848">Pertanto, se i nuovi messaggi continuano ad arrivare entro il periodo di timeout, è possibile che questo metodo venga eseguito all'infinito, fino a quando non scade il periodo di timeout senza eventuali nuovi messaggi in arrivo o fino a quando non arriva un messaggio la cui proprietà <xref:System.Messaging.Message.CorrelationId%2A> corrisponde alla `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1848">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-1849">Il <xref:System.Messaging.Message.CorrelationId%2A> proprietà viene utilizzata per collegare un messaggio inviato alla coda di messaggi di risposta, un report o riconoscimento associati.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1849">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="e0ac9-1850">Altri due metodi consentono di leggere i messaggi in una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1850">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="e0ac9-1851">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> metodo viene utilizzato per recuperare un messaggio, specificando il relativo identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1851">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="e0ac9-1852">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1852">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1853">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1853">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1854">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1854">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1855">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1855">Local computer</span></span>|<span data-ttu-id="e0ac9-1856">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1856">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1857">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1857">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1858">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1858">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1859">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1859">Remote computer</span></span>|<span data-ttu-id="e0ac9-1860">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1860">No</span></span>|  
|<span data-ttu-id="e0ac9-1861">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1861">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1862">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1862">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1863">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1863">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#5](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#5)]
 [!code-csharp[MessageQueue2#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-1864">Il valore del parametro <paramref name="correlationId" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1864">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1865">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1865">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-1866">Il messaggio con l'oggetto <paramref name="correlationId" /> specificato non è presente nella coda e non è arrivato prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1866">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1867">Un messaggio non è arrivato prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1867">A message did not arrive before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-1868">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1868">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-1869">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1869">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1870">Restituisce una copia del messaggio con l'identificatore di messaggio specificato, senza rimuovere il messaggio dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1870">Returns a copy of the message that has the specified message identifier without removing the message from the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id);" />
      <MemberSignature Language="F#" Value="member this.PeekById : string -&gt; System.Messaging.Message" Usage="messageQueue.PeekById id" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="e0ac9-1871">Oggetto <see cref="P:System.Messaging.Message.Id" /> del messaggio da leggere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1871">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1872">Legge il messaggio il cui identificatore corrisponde al parametro <paramref name="id" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1872">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1873">
            <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.Id" /> corrisponde al parametro <paramref name="id" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1873">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1874">Usare <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> per leggere, senza rimozione dalla coda, un messaggio contenente un identificatore di messaggio conosciuto.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1874">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="e0ac9-1875">L'identificatore di un messaggio è univoco all'interno dell'azienda di Accodamento messaggi, in modo che esisterà al massimo un messaggio nella coda che corrisponde al determinato `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1875">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="e0ac9-1876">Questo overload genera un'eccezione se la coda non è attualmente contiene il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1876">This overload throws an exception if the queue does not currently contain the message.</span></span>  
  
 <span data-ttu-id="e0ac9-1877">Consentono di leggere i messaggi in una coda di altri due metodi: <xref:System.Messaging.MessageQueue.Peek%2A> e <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1877">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-1878">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce il primo messaggio nella coda. <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> restituisce un riconoscimento, un report o un messaggio di risposta generati dall'applicazione che è stato creato come risultato di un messaggio inviato alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1878">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1879">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1879">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1880">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1880">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1881">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1881">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1882">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1882">Local computer</span></span>|<span data-ttu-id="e0ac9-1883">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1883">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1884">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1884">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1885">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1885">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1886">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1886">Remote computer</span></span>|<span data-ttu-id="e0ac9-1887">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1887">No</span></span>|  
|<span data-ttu-id="e0ac9-1888">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1888">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1889">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1889">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1890">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1890">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#6](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#6)]
 [!code-csharp[MessageQueue2#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-1891">Il valore del parametro <paramref name="id" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1891">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-1892">Non è disponibile alcun messaggio con il parametro <paramref name="id" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1892">No message with the specified <paramref name="id" /> exists.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1893">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1893">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.PeekById : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.PeekById (id, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="e0ac9-1894">Oggetto <see cref="P:System.Messaging.Message.Id" /> del messaggio da leggere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1894">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="e0ac9-1895">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1895">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1896">Legge il messaggio il cui identificatore corrisponde al parametro <paramref name="id" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1896">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span>
          </span>
          <span data-ttu-id="e0ac9-1897">Attende che il messaggio venga visualizzato nella coda o che si verifichi il timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1897">Waits until the message appears in the queue or a time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1898">
            <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.Id" /> corrisponde al parametro <paramref name="id" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1898">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1899">Usare <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> per leggere, senza rimozione dalla coda, un messaggio contenente un identificatore di messaggio conosciuto.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1899">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="e0ac9-1900">L'identificatore di un messaggio è univoco all'interno dell'azienda di Accodamento messaggi, in modo che esisterà al massimo un messaggio nella coda che corrisponde al determinato `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1900">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="e0ac9-1901">Questo overload genera un'eccezione se la coda non è attualmente contiene il messaggio e un nuovo messaggio è arrivato prima che si verifichi il timeout.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1901">This overload throws an exception if the queue does not currently contain the message and a new message does not arrive before the time-out occurs.</span></span>  
  
 <span data-ttu-id="e0ac9-1902">Il `timeout` parametro specifica il totale tempo di esecuzione per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1902">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="e0ac9-1903">Piuttosto, specifica il tempo di attesa per un nuovo messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1903">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-1904">Ogni volta che arriva un nuovo messaggio, questo metodo esamina la <xref:System.Messaging.Message.Id%2A> del nuovo messaggio per verificare se corrisponde il `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1904">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="e0ac9-1905">In caso contrario, questo metodo avvia nuovamente il periodo di timeout e attende l'arrivo di un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1905">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="e0ac9-1906">Pertanto, se i nuovi messaggi continuano ad arrivare entro il periodo di timeout, è possibile che questo metodo venga eseguito all'infinito, fino a quando non scade il periodo di timeout senza eventuali nuovi messaggi in arrivo o fino a quando non arriva un messaggio la cui proprietà <xref:System.Messaging.Message.Id%2A> corrisponde alla `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1906">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-1907">Consentono di leggere i messaggi in una coda di altri due metodi: <xref:System.Messaging.MessageQueue.Peek%2A> e <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1907">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-1908">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce il primo messaggio nella coda. <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> restituisce un riconoscimento, un report o un messaggio di risposta generati dall'applicazione che è stato creato come risultato di un messaggio inviato alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1908">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1909">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1909">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1910">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1910">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1911">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1911">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1912">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1912">Local computer</span></span>|<span data-ttu-id="e0ac9-1913">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1913">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1914">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1914">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1915">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1915">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1916">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1916">Remote computer</span></span>|<span data-ttu-id="e0ac9-1917">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1917">No</span></span>|  
|<span data-ttu-id="e0ac9-1918">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1918">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1919">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1919">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1920">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1920">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#7](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#7)]
 [!code-csharp[MessageQueue2#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-1921">Il valore del parametro <paramref name="id" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1921">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-1922">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1922">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-1923">Il messaggio con l'oggetto <paramref name="id" /> specificato non è presente nella coda e non è arrivato prima della scadenza del periodo di tempo specificato dal parametro <paramref name="timeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1923">The message with the specified <paramref name="id" /> does not exist in the queue and did not arrive before the period specified by the <paramref name="timeout" /> parameter expired.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1924">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1924">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1925">Introdotto in MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1925">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="e0ac9-1926">Legge un messaggio specifico nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1926">Peeks at a specific message from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1927">Il messaggio può essere specificato da un identificatore di ricerca o in base alla relativa posizione all'inizio o alla fine della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1927">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(long lookupId);" />
      <MemberSignature Language="F#" Value="member this.PeekByLookupId : int64 -&gt; System.Messaging.Message" Usage="messageQueue.PeekByLookupId lookupId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="lookupId">
          <span data-ttu-id="e0ac9-1928">Proprietà <see cref="P:System.Messaging.Message.LookupId" /> del messaggio da leggere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1928">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1929">Introdotto in MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1929">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="e0ac9-1930">Legge il messaggio che corrisponde all'identificatore di ricerca specificato da una coda non transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1930">Peeks at the message that matches the given lookup identifier from a non-transactional queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1931">Oggetto <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.LookupId" /> corrisponde al parametro <paramref name="lookupId" /> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1931">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1932">Usare questo metodo per leggere un messaggio con un identificatore di ricerca noti senza rimuoverlo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1932">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="e0ac9-1933">Questo metodo genera un'eccezione immediatamente se il messaggio non è presente nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1933">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1934">Il <xref:System.Messaging.Message.LookupId%2A> proprietà di un messaggio è univoca per la coda in cui si trova il messaggio, in modo che esisterà al massimo un messaggio nella coda che corrisponde al determinato `lookupId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1934">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-1935">Per leggere un messaggio con un identificatore di ricerca specificato e rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1935">To read a message with a specified lookup identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-1936">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1936">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1937">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1937">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1938">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1938">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1939">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1939">Local computer</span></span>|<span data-ttu-id="e0ac9-1940">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1940">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1941">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1941">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1942">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1942">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1943">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1943">Remote computer</span></span>|<span data-ttu-id="e0ac9-1944">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1944">No</span></span>|  
|<span data-ttu-id="e0ac9-1945">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1945">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1946">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1946">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="e0ac9-1947">MSMQ 3.0 non è installato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1947">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-1948">Impossibile trovare il messaggio con il parametro <paramref name="lookupId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1948">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1949">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1949">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (System.Messaging.MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Messaging.MessageLookupAction,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (action As MessageLookupAction, lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(System::Messaging::MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="F#" Value="member this.PeekByLookupId : System.Messaging.MessageLookupAction * int64 -&gt; System.Messaging.Message" Usage="messageQueue.PeekByLookupId (action, lookupId)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" />
        <Parameter Name="lookupId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="action">
          <span data-ttu-id="e0ac9-1950">Uno dei valori di <see cref="T:System.Messaging.MessageLookupAction" />, che specifica come deve essere letto il messaggio nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1950">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1951">Specificare uno dei valori seguenti:</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1951">Specify one of the following:</span>
          </span>
          <span data-ttu-id="e0ac9-1952">
            <see langword="MessageLookupAction.Current" />: legge il messaggio specificato da <c>lookupId</c>.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1952">
              <see langword="MessageLookupAction.Current" />: Peeks at the message specified by <c>lookupId</c>.</span>
          </span>
          <span data-ttu-id="e0ac9-1953">
            <see langword="MessageLookupAction.Next" />: legge il messaggio che segue il messaggio specificato da <c>lookupId</c>.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1953">
              <see langword="MessageLookupAction.Next" />: Peeks at the message following the message specified by <c>lookupId</c>.</span>
          </span>
          <span data-ttu-id="e0ac9-1954">
            <see langword="MessageLookupAction.Previous" />: legge il messaggio che precede il messaggio specificato da <c>lookupId</c>.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1954">
              <see langword="MessageLookupAction.Previous" />: Peeks at the message preceding the message specified by <c>lookupId</c>.</span>
          </span>
          <span data-ttu-id="e0ac9-1955">
            <see langword="MessageLookupAction.First" />: legge il primo messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1955">
              <see langword="MessageLookupAction.First" />: Peeks at the first message in the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1956">È necessario che il parametro <c>lookupId</c> sia impostato su 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1956">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
          <span data-ttu-id="e0ac9-1957">
            <see langword="MessageLookupAction.Last" />: legge l'ultimo messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1957">
              <see langword="MessageLookupAction.Last" />: Peeks at the last message in the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1958">È necessario che il parametro <c>lookupId</c> sia impostato su 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1958">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
        </param>
        <param name="lookupId">
          <span data-ttu-id="e0ac9-1959">Proprietà <see cref="P:System.Messaging.Message.LookupId" /> del messaggio da leggere oppure 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1959">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at, or 0.</span>
          </span>
          <span data-ttu-id="e0ac9-1960">0 viene utilizzato quando si accede al primo o all'ultimo messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1960">0 is used when accessing the first or last message in the queue.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-1961">Introdotto in MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1961">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="e0ac9-1962">Legge un messaggio specifico nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1962">Peeks at a specific message from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1963">Il messaggio può essere specificato da un identificatore di ricerca o in base alla relativa posizione all'inizio o alla fine della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1963">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-1964">Oggetto <see cref="T:System.Messaging.Message" /> specificato dai parametri <paramref name="action" /> e <paramref name="lookupId" /> passati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1964">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1965">Usare questo metodo per leggere un messaggio con un identificatore di ricerca noti senza rimuoverlo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1965">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="e0ac9-1966">Questo metodo genera un'eccezione immediatamente se il messaggio non è presente nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1966">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1967">Il <xref:System.Messaging.Message.LookupId%2A> proprietà di un messaggio è univoca per la coda in cui si trova il messaggio, in modo che esisterà al massimo un messaggio nella coda che corrisponde al determinato `lookupId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1967">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-1968">Per leggere un messaggio con un identificatore specificato e rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1968">To read a message with a specified identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-1969">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1969">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1970">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1970">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-1971">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1971">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-1972">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1972">Local computer</span></span>|<span data-ttu-id="e0ac9-1973">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1973">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1974">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1974">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1975">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1975">Yes</span></span>|  
|<span data-ttu-id="e0ac9-1976">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1976">Remote computer</span></span>|<span data-ttu-id="e0ac9-1977">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1977">No</span></span>|  
|<span data-ttu-id="e0ac9-1978">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1978">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-1979">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1979">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="e0ac9-1980">MSMQ 3.0 non è installato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1980">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-1981">Impossibile trovare il messaggio con il parametro <paramref name="lookupId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1981">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-1982">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1982">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-1983">Il parametro <paramref name="action" /> non è uno dei membri di <see cref="T:System.Messaging.MessageLookupAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1983">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.PeekCompletedEventHandler PeekCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.PeekCompletedEventHandler PeekCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.PeekCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event PeekCompleted As PeekCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::PeekCompletedEventHandler ^ PeekCompleted;" />
      <MemberSignature Language="F#" Value="member this.PeekCompleted : System.Messaging.PeekCompletedEventHandler " Usage="member this.PeekCompleted : System.Messaging.PeekCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_PeekCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.PeekCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1984">Viene generato quando un messaggio viene letto senza essere rimosso dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1984">Occurs when a message is read without being removed from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-1985">Si tratta del risultato dell'operazione asincrona <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1985">This is a result of the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1986"><xref:System.Messaging.MessageQueue.BeginPeek%2A> viene utilizzato per generare l'elaborazione asincrona di <xref:System.Messaging.MessageQueue.PeekCompleted> evento quando un messaggio sia disponibile nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1986"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1987"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> viene usato per completare l'operazione avviata da una chiamata a <xref:System.Messaging.MessageQueue.BeginPeek%2A> e visualizza il messaggio quando il <xref:System.Messaging.MessageQueue.PeekCompleted> viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1987"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> and peek the message when the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="e0ac9-1988">Quando si crea un delegato <xref:System.Messaging.PeekCompletedEventHandler>, si identifica il metodo che gestirà l'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1988">When you create a <xref:System.Messaging.PeekCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="e0ac9-1989">Per associare l'evento al gestore eventi in uso, aggiungere all'evento un'istanza del delegato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1989">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="e0ac9-1990">Il gestore eventi viene chiamato ogni volta che si verifica l'evento, a meno che non venga rimosso il delegato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1990">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="e0ac9-1991">Per altre informazioni sui delegati del gestore eventi, vedere [la gestione e generazione di eventi](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1991">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-1992">L'esempio di codice seguente crea un gestore eventi denominato `MyPeekCompleted`, lo collega al <xref:System.Messaging.MessageQueue.PeekCompleted> delegato del gestore eventi e chiamate <xref:System.Messaging.MessageQueue.BeginPeek%2A> per avviare un'operazione di lettura asincrona in coda che si trova nel percorso ". \myQueue".</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1992">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="e0ac9-1993">Quando un <xref:System.Messaging.MessageQueue.PeekCompleted> viene generato l'evento, l'esempio legge il messaggio e scrive il corpo sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1993">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="e0ac9-1994">Nell'esempio viene quindi chiamato <xref:System.Messaging.MessageQueue.BeginPeek%2A> nuovamente per avviare una nuova operazione di lettura asincrona</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1994">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Purge">
      <MemberSignature Language="C#" Value="public void Purge ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Purge() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Purge" />
      <MemberSignature Language="VB.NET" Value="Public Sub Purge ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Purge();" />
      <MemberSignature Language="F#" Value="member this.Purge : unit -&gt; unit" Usage="messageQueue.Purge " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-1995">Elimina tutti i messaggi contenuti nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-1995">Deletes all the messages contained in the queue.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-1996">Viene eliminata la coda di Accodamento messaggi impostare il flag di modifica della coda, che interessa il <xref:System.Messaging.MessageQueue.LastModifyTime%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1996">Purging the queue causes Message Queuing to set the queue modification flag, which affects the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span> <span data-ttu-id="e0ac9-1997">I messaggi vengono eliminati dalla coda vengono andrà persi. essi non vengono inviati per la coda di messaggi non recapitabili o nella coda journal.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1997">Messages that are purged from the queue are lost; they are not sent to the dead-letter queue or the journal queue.</span></span>  
  
 <span data-ttu-id="e0ac9-1998">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1998">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-1999">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-1999">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2000">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2000">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2001">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2001">Local computer</span></span>|<span data-ttu-id="e0ac9-2002">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2002">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2003">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2003">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2004">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2004">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2005">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2005">Remote computer</span></span>|<span data-ttu-id="e0ac9-2006">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2006">No</span></span>|  
|<span data-ttu-id="e0ac9-2007">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2007">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2008">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2008">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2009">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.Purge%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2009">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Purge%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#29](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#29)]
 [!code-csharp[MessageQueue2#29](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#29)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2010">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2010">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="M:System.Messaging.MessageQueue.Refresh" />
      </Docs>
    </Member>
    <Member MemberName="QueueName">
      <MemberSignature Language="C#" Value="public string QueueName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string QueueName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.QueueName" />
      <MemberSignature Language="VB.NET" Value="Public Property QueueName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ QueueName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.QueueName : string with get, set" Usage="System.Messaging.MessageQueue.QueueName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_QueueName")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2011">Ottiene o imposta il nome descrittivo che identifica la coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2011">Gets or sets the friendly name that identifies the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-2012">Nome che identifica la coda a cui questo oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2012">The name that identifies the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2013">Il valore non può essere <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2013">The value cannot be <see langword="null" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2014">È possibile combinare le <xref:System.Messaging.MessageQueue.QueueName%2A> con il <xref:System.Messaging.MessageQueue.MachineName%2A> per creare una semplice <xref:System.Messaging.MessageQueue.Path%2A> nome per la coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2014">You can combine the <xref:System.Messaging.MessageQueue.QueueName%2A> with the <xref:System.Messaging.MessageQueue.MachineName%2A> to create a friendly <xref:System.Messaging.MessageQueue.Path%2A> name for the queue.</span></span> <span data-ttu-id="e0ac9-2015">La sintassi per le variazioni del nome descrittivo del <xref:System.Messaging.MessageQueue.Path%2A> proprietà dipende dal tipo di coda, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2015">The syntax for the friendly name variation of the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="e0ac9-2016">Tipo di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2016">Queue type</span></span>|<span data-ttu-id="e0ac9-2017">Sintassi</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2017">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="e0ac9-2018">coda pubblica</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2018">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="e0ac9-2019">coda privata</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2019">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="e0ac9-2020">Coda del diario</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2020">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
  
 <span data-ttu-id="e0ac9-2021">Usare "." per rappresentare il computer locale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2021">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="e0ac9-2022">Modifica il <xref:System.Messaging.MessageQueue.QueueName%2A> influisce sulle proprietà di <xref:System.Messaging.MessageQueue.Path%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2022">Changing the <xref:System.Messaging.MessageQueue.QueueName%2A> property affects the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="e0ac9-2023">Se si imposta la <xref:System.Messaging.MessageQueue.QueueName%2A> senza impostare il <xref:System.Messaging.MessageQueue.MachineName%2A> proprietà, il <xref:System.Messaging.MessageQueue.Path%2A> diventa di proprietà.\\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2023">If you set the <xref:System.Messaging.MessageQueue.QueueName%2A> without setting the <xref:System.Messaging.MessageQueue.MachineName%2A> property, the <xref:System.Messaging.MessageQueue.Path%2A> property becomes .\\`QueueName`.</span></span> <span data-ttu-id="e0ac9-2024">In caso contrario, il <xref:System.Messaging.MessageQueue.Path%2A> diviene `MachineName` \\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2024">Otherwise, the <xref:System.Messaging.MessageQueue.Path%2A> becomes `MachineName`\\`QueueName`.</span></span>  
  
 <span data-ttu-id="e0ac9-2025">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2025">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2026">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2026">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2027">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2027">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2028">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2028">Local computer</span></span>|<span data-ttu-id="e0ac9-2029">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2029">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2030">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2030">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2031">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2031">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2032">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2032">Remote computer</span></span>|<span data-ttu-id="e0ac9-2033">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2033">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2034">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2034">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2035">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2035">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2036">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.QueueName%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2036">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.QueueName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2037">Il nome della coda è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2037">The queue name is <see langword="null" />.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="ReadHandle">
      <MemberSignature Language="C#" Value="public IntPtr ReadHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int ReadHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.ReadHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ReadHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr ReadHandle { IntPtr get(); };" />
      <MemberSignature Language="F#" Value="member this.ReadHandle : nativeint" Usage="System.Messaging.MessageQueue.ReadHandle" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReadHandle")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2038">Ottiene l'handle nativo utilizzato per leggere i messaggi dalla coda di messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2038">Gets the native handle used to read messages from the message queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-2039">Handle all'oggetto coda nativo utilizzato per leggere e ricevere messaggi dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2039">A handle to the native queue object that you use for peeking and receiving messages from the queue.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2040">Il <xref:System.Messaging.MessageQueue.ReadHandle%2A> fornisce un handle nativo di Windows all'oggetto coda di messaggi che viene usato per leggere e ricevere messaggi dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2040">The <xref:System.Messaging.MessageQueue.ReadHandle%2A> provides a native Windows handle to the message queue object that is used for peeking and receiving messages from the queue.</span></span> <span data-ttu-id="e0ac9-2041">Se si modifica il percorso della coda, l'handle viene chiusa e riaperta con un nuovo valore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2041">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="e0ac9-2042">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2042">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2043">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2043">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2044">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2044">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2045">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2045">Local computer</span></span>|<span data-ttu-id="e0ac9-2046">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2046">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2047">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2047">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2048">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2048">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2049">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2049">Remote computer</span></span>|<span data-ttu-id="e0ac9-2050">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2050">No</span></span>|  
|<span data-ttu-id="e0ac9-2051">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2051">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2052">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2052">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2053">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2053">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Receive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe>
          <span data-ttu-id="e0ac9-2054">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2054">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <summary>
          <span data-ttu-id="e0ac9-2055">Riceve il primo messaggio della coda rimuovendolo da quest'ultima.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2055">Receives the first message in the queue, removing it from the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive();" />
      <MemberSignature Language="F#" Value="member this.Receive : unit -&gt; System.Messaging.Message" Usage="messageQueue.Receive " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2056">Riceve il primo messaggio disponibile nella coda a cui <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2056">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2057">Questa chiamata è sincrona e blocca il thread corrente di esecuzione finché non è disponibile un messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2057">This call is synchronous, and blocks the current thread of execution until a message is available.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2058">Oggetto <see cref="T:System.Messaging.Message" /> che fa riferimento al primo messaggio disponibile nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2058">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2059">Utilizzare questo overload per ricevere un messaggio da una coda o attendere fino a quando non sono presenti messaggi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2059">Use this overload to receive a message from a queue, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2060">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo consente la lettura di un messaggio sincrona, rimuovendolo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2060">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="e0ac9-2061">Le chiamate successive a <xref:System.Messaging.MessageQueue.Receive%2A> restituirà i messaggi successivi nella coda o i nuovi messaggi con priorità più alta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2061">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="e0ac9-2062">Per leggere il primo messaggio in una coda senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2062">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="e0ac9-2063">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2063">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2064">Usare una chiamata a <xref:System.Messaging.MessageQueue.Receive%2A> quando è accettabile per il thread corrente resti bloccato mentre si attende un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2064">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2065">Poiché questo overload del metodo di <xref:System.Messaging.MessageQueue.Receive%2A> metodo specifica un timeout infinito, l'applicazione potrebbe attendere all'infinito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2065">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="e0ac9-2066">Se l'elaborazione dell'applicazione continui senza attendere che il messaggio, è consigliabile usare il metodo asincrono, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2066">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2067">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2067">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2068">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2068">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2069">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2069">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2070">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2070">Local computer</span></span>|<span data-ttu-id="e0ac9-2071">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2071">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2072">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2072">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2073">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2073">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2074">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2074">Remote computer</span></span>|<span data-ttu-id="e0ac9-2075">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2075">No</span></span>|  
|<span data-ttu-id="e0ac9-2076">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2076">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2077">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2077">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2078">Esempio di codice seguente riceve un messaggio da una coda e restituisce informazioni su tale messaggio sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2078">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2079">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2079">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive transaction" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="transaction">
          <span data-ttu-id="e0ac9-2080">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2080">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2081">Riceve il primo messaggio disponibile nella coda transazionale a cui <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2081">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2082">Questa chiamata è sincrona e blocca il thread corrente di esecuzione finché non è disponibile un messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2082">This call is synchronous, and blocks the current thread of execution until a message is available.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2083">Oggetto <see cref="T:System.Messaging.Message" /> che fa riferimento al primo messaggio disponibile nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2083">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2084">Utilizzare questo overload per ricevere un messaggio da una coda transazionale utilizzando il contesto di transazione interna definito dal `transaction` parametro, o attendere fino a quando non sono presenti messaggi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2084">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2085">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo consente la lettura di un messaggio sincrona, rimuovendolo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2085">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="e0ac9-2086">Le chiamate successive a <xref:System.Messaging.MessageQueue.Receive%2A> restituirà i messaggi successivi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2086">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2087">Poiché questo metodo viene chiamato su una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2087">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2088">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2088">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2089">Per leggere il primo messaggio in una coda senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2089">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="e0ac9-2090">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2090">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2091">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2091">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="e0ac9-2092">In quanto <xref:System.Messaging.MessageQueue.Peek%2A> non rimuove i messaggi nella coda, non vi sarà alcuna operazione di rollback da una chiamata a <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2092">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2093">Usare una chiamata a <xref:System.Messaging.MessageQueue.Receive%2A> quando è accettabile per il thread corrente resti bloccato mentre si attende un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2093">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2094">Poiché questo overload del metodo di <xref:System.Messaging.MessageQueue.Receive%2A> metodo specifica un timeout infinito, l'applicazione potrebbe attendere all'infinito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2094">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="e0ac9-2095">Se l'elaborazione dell'applicazione continui senza attendere che il messaggio, è consigliabile usare il metodo asincrono, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2095">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2096">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2096">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2097">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2097">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2098">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2098">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2099">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2099">Local computer</span></span>|<span data-ttu-id="e0ac9-2100">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2100">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2101">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2101">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2102">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2102">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2103">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2103">Remote computer</span></span>|<span data-ttu-id="e0ac9-2104">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2104">No</span></span>|  
|<span data-ttu-id="e0ac9-2105">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2105">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2106">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2106">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2107">Esempio di codice seguente si connette a una coda transazionale nel computer locale e invia un messaggio alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2107">The following code example connects to a transactional queue on the local computer and sends a message to the queue.</span></span> <span data-ttu-id="e0ac9-2108">Viene quindi ricevuto il messaggio che contiene un ordine.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2108">It then receives the message that contains an order.</span></span> <span data-ttu-id="e0ac9-2109">Se si verifica una coda non transazionale, verrà generata eccezione e il rollback della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2109">If it encounters a non-transactional queue, it will throw and exception and rollback the transaction.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_transaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CPP/mqreceive_transaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_transaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CS/mqreceive_transaction.cs#1)]
 [!code-vb[MessageQueue.Receive_transaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_transaction/VB/mqreceive_transaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2110">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2110">An error occurred when accessing a Message Queuing method.</span>
          </span>
          <span data-ttu-id="e0ac9-2111">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2111">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2112">La coda non è transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2112">The queue is non-transactional.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-2113">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2113">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive transactionType" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-2114">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2114">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2115">Riceve il primo messaggio disponibile nella coda a cui <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2115">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2116">Questa chiamata è sincrona e blocca il thread corrente di esecuzione finché non è disponibile un messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2116">This call is synchronous, and blocks the current thread of execution until a message is available.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2117">Oggetto <see cref="T:System.Messaging.Message" /> che fa riferimento al primo messaggio disponibile nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2117">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2118">Utilizzare questo overload per ricevere un messaggio da una coda usando un contesto di transazione definito dal `transactionType` parametro, o attendere fino a quando non sono presenti messaggi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2118">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2119">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per ricevere il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2119">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="e0ac9-2120">Specificare `Single` se si desidera ricevere il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2120">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-2121">È possibile specificare `None` se si desidera ricevere un messaggio da una coda transazionale all'esterno di un contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2121">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="e0ac9-2122">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo consente la lettura di un messaggio sincrona, rimuovendolo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2122">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="e0ac9-2123">Le chiamate successive a <xref:System.Messaging.MessageQueue.Receive%2A> restituirà i messaggi successivi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2123">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2124">Se questo metodo viene chiamato per ricevere un messaggio da una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2124">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2125">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2125">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2126">Per leggere il primo messaggio in una coda senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2126">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="e0ac9-2127">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2127">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2128">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2128">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="e0ac9-2129">In quanto <xref:System.Messaging.MessageQueue.Peek%2A> non rimuove i messaggi nella coda, non vi sarà alcuna operazione di rollback da una chiamata a <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2129">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2130">Usare una chiamata a <xref:System.Messaging.MessageQueue.Receive%2A> quando è accettabile per il thread corrente resti bloccato mentre si attende un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2130">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2131">Poiché questo overload del metodo di <xref:System.Messaging.MessageQueue.Receive%2A> metodo specifica un timeout infinito, l'applicazione potrebbe attendere all'infinito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2131">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="e0ac9-2132">Se l'elaborazione dell'applicazione continui senza attendere che il messaggio, è consigliabile usare il metodo asincrono, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2132">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2133">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2133">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2134">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2134">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2135">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2135">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2136">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2136">Local computer</span></span>|<span data-ttu-id="e0ac9-2137">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2137">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2138">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2138">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2139">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2139">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2140">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2140">Remote computer</span></span>|<span data-ttu-id="e0ac9-2141">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2141">No</span></span>|  
|<span data-ttu-id="e0ac9-2142">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2142">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2143">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2143">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2144">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2144">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#9](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#9)]
 [!code-csharp[MessageQueue2#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2145">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2145">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-2146">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2146">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-2147">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2147">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.Receive timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2148">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2148">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2149">Riceve il primo messaggio disponibile nella coda cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento e attende che un messaggio sia disponibile nella coda o che il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2149">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2150">Oggetto <see cref="T:System.Messaging.Message" /> che fa riferimento al primo messaggio disponibile nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2150">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2151">Utilizzare questo overload per ricevere e restituire un messaggio in un periodo di tempo specificato se nella coda non sono disponibili messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2151">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2152">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo consente la lettura sincrona di un messaggio, rimuoverlo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2152">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, removing it from the queue.</span></span> <span data-ttu-id="e0ac9-2153">Le chiamate successive a <xref:System.Messaging.MessageQueue.Receive%2A> restituirà i messaggi successivi nella coda o i nuovi messaggi con priorità più alta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2153">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="e0ac9-2154">Per leggere il primo messaggio in una coda senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2154">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="e0ac9-2155">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2155">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2156">Usare una chiamata a <xref:System.Messaging.MessageQueue.Receive%2A> quando è accettabile per il thread corrente resti bloccato mentre si attende un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2156">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2157">Il thread verrà bloccato per il periodo di tempo specificato o per un periodo illimitato se è stato specificato il valore <xref:System.Messaging.MessageQueue.InfiniteTimeout> per il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2157">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="e0ac9-2158">Se l'elaborazione dell'applicazione continui senza attendere un messaggio, è consigliabile usare il metodo asincrono, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2158">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2159">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2159">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2160">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2160">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2161">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2161">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2162">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2162">Local computer</span></span>|<span data-ttu-id="e0ac9-2163">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2163">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2164">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2164">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2165">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2165">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2166">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2166">Remote computer</span></span>|<span data-ttu-id="e0ac9-2167">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2167">No</span></span>|  
|<span data-ttu-id="e0ac9-2168">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2168">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2169">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2169">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2170">Esempio di codice seguente riceve un messaggio da una coda e restituisce informazioni su tale messaggio sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2170">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span> <span data-ttu-id="e0ac9-2171">Nell'esempio viene sospeso l'esecuzione fino a cinque secondi durante l'attesa di un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2171">The example pauses execution for up to five seconds while waiting for a message to arrive in the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CPP/mqreceive_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Receive_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CS/mqreceive_timeout.cs#1)]
 [!code-vb[MessageQueue.Receive_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_timeout/VB/mqreceive_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2172">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2172">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2173">Un messaggio non è arrivato nella coda prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2173">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2174">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2174">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2175">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2175">An error occurred when accessing a Message Queuing method</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-2176">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2176">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2177">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2177">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="e0ac9-2178">Oggetto <see cref="T:System.Messaging.Cursor" /> che occupa una posizione specifica nella coda messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2178">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2179">Riceve il messaggio corrente nella coda, utilizzando il cursore specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2179">Receives the current message in the queue, using a specified cursor.</span>
          </span>
          <span data-ttu-id="e0ac9-2180">Se non è disponibile alcun messaggio, il metodo aspetta finché non risulta disponibile un messaggio o finché non scade il periodo di timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2180">If no message is available, this method waits until either a message is available, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2181">Oggetto <see cref="T:System.Messaging.Message" /> che fa riferimento al primo messaggio disponibile nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2181">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2182">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2182">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2183">Un messaggio non è arrivato nella coda prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2183">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2184">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2184">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2185">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2185">An error occurred when accessing a Message Queuing method</span>
          </span>
          <span data-ttu-id="e0ac9-2186">Utilizzare questo overload per ricevere e restituire un messaggio in un periodo di tempo specificato se nella coda non sono disponibili messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2186">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-2187">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2187">The method is not thread safe.</span>
          </span>
        </threadsafe>
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2188">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2188">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="e0ac9-2189">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2189">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2190">Riceve il primo messaggio disponibile nella coda transazionale cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento e attende che un messaggio sia disponibile nella coda o che il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2190">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2191">Oggetto <see cref="T:System.Messaging.Message" /> che fa riferimento al primo messaggio disponibile nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2191">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2192">Utilizzare questo overload per ricevere un messaggio da una coda transazionale utilizzando il contesto di transazione interna definito dal `transaction` parametro e restituire all'interno di un determinato periodo di tempo se non sono presenti messaggi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2192">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2193">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo consente la lettura di un messaggio sincrona, rimuovendolo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2193">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="e0ac9-2194">Le chiamate successive a <xref:System.Messaging.MessageQueue.Receive%2A> restituirà i messaggi successivi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2194">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2195">Poiché questo metodo viene chiamato su una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2195">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2196">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2196">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2197">Per leggere il primo messaggio in una coda senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2197">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="e0ac9-2198">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2198">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2199">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2199">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="e0ac9-2200">In quanto <xref:System.Messaging.MessageQueue.Peek%2A> non rimuove i messaggi nella coda, non vi sarà alcuna operazione di rollback da una chiamata a <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2200">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2201">Usare una chiamata a <xref:System.Messaging.MessageQueue.Receive%2A> quando è accettabile per il thread corrente resti bloccato mentre si attende un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2201">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2202">Il thread verrà bloccato per il periodo di tempo specificato o per un periodo illimitato se è stato specificato il valore <xref:System.Messaging.MessageQueue.InfiniteTimeout> per il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2202">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="e0ac9-2203">Se l'elaborazione dell'applicazione continui senza attendere un messaggio, è consigliabile usare il metodo asincrono, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2203">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2204">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2204">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2205">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2205">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2206">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2206">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2207">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2207">Local computer</span></span>|<span data-ttu-id="e0ac9-2208">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2208">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2209">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2209">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2210">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2210">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2211">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2211">Remote computer</span></span>|<span data-ttu-id="e0ac9-2212">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2212">No</span></span>|  
|<span data-ttu-id="e0ac9-2213">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2213">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2214">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2214">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2215">Esempio di codice seguente viene illustrato l'utilizzo di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2215">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CPP/mqreceive_timeouttransaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CS/mqreceive_timeouttransaction.cs#1)]
 [!code-vb[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/VB/mqreceive_timeouttransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2216">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2216">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2217">Un messaggio non è arrivato nella coda prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2217">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2218">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2218">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2219">La coda non è transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2219">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="e0ac9-2220">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2220">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2221">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2221">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-2222">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2222">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2223">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2223">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-2224">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2224">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2225">Riceve il primo messaggio disponibile nella coda a cui <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2225">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2226">Questa chiamata è sincrona e attende che un messaggio venga reso disponibile nella coda o il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2226">This call is synchronous, and waits until either a message is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2227">Oggetto <see cref="T:System.Messaging.Message" /> che fa riferimento al primo messaggio disponibile nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2227">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2228">Utilizzare questo overload per ricevere un messaggio da una coda usando un contesto di transazione definito dal `transactionType` parametro e restituire in un determinato periodo di tempo se non sono presenti messaggi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2228">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2229">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per ricevere il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2229">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="e0ac9-2230">Specificare `Single` se si desidera ricevere il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2230">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-2231">È possibile specificare `None` se si desidera ricevere un messaggio da una coda transazionale all'esterno di un contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2231">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="e0ac9-2232">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo consente la lettura di un messaggio sincrona, rimuovendolo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2232">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="e0ac9-2233">Le chiamate successive a <xref:System.Messaging.MessageQueue.Receive%2A> restituirà i messaggi successivi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2233">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2234">Se questo metodo viene chiamato per ricevere un messaggio da una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2234">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2235">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2235">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2236">Per leggere il primo messaggio in una coda senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2236">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="e0ac9-2237">Il <xref:System.Messaging.MessageQueue.Peek%2A> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2237">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2238">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2238">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="e0ac9-2239">In quanto <xref:System.Messaging.MessageQueue.Peek%2A> non rimuove i messaggi nella coda, non vi sarà alcuna operazione di rollback da una chiamata a <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2239">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2240">Usare una chiamata a <xref:System.Messaging.MessageQueue.Receive%2A> quando è accettabile per il thread corrente resti bloccato mentre si attende un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2240">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2241">Il thread verrà bloccato per il periodo di tempo specificato o per un periodo illimitato se è stato specificato il valore <xref:System.Messaging.MessageQueue.InfiniteTimeout> per il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2241">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="e0ac9-2242">Se l'elaborazione dell'applicazione continui senza attendere un messaggio, è consigliabile usare il metodo asincrono, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2242">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2243">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2243">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2244">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2244">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2245">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2245">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2246">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2246">Local computer</span></span>|<span data-ttu-id="e0ac9-2247">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2247">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2248">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2248">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2249">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2249">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2250">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2250">Remote computer</span></span>|<span data-ttu-id="e0ac9-2251">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2251">No</span></span>|  
|<span data-ttu-id="e0ac9-2252">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2252">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2253">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2253">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2254">Esempio di codice seguente viene illustrato l'utilizzo di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2254">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue2#8](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#8)]
 [!code-csharp[MessageQueue2#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2255">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2255">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-2256">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2256">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2257">Un messaggio non è arrivato nella coda prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2257">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2258">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2258">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2259">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2259">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-2260">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2260">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2261">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2261">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="e0ac9-2262">Oggetto <see cref="T:System.Messaging.Cursor" /> che occupa una posizione specifica nella coda messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2262">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="e0ac9-2263">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2263">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2264">Riceve il messaggio corrente nella coda, utilizzando il cursore specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2264">Receives the current message in the queue, using a specified cursor.</span>
          </span>
          <span data-ttu-id="e0ac9-2265">Se non è disponibile alcun messaggio, il metodo aspetta finché non risulta disponibile un messaggio o finché non scade il periodo di timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2265">If no message is available, this method waits until either a message is available, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2266">Oggetto <see cref="T:System.Messaging.Message" /> che fa riferimento a un messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2266">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2267">Utilizzare questo overload per ricevere un messaggio da una coda transazionale utilizzando il contesto di transazione interna definito dal `transaction` parametro e restituire all'interno di un determinato periodo di tempo se non sono presenti messaggi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2267">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2268">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo consente la lettura di un messaggio sincrona, rimuovendolo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2268">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="e0ac9-2269">Le chiamate successive a <xref:System.Messaging.MessageQueue.Receive%2A> restituiscono i messaggi successivi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2269">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2270">Poiché questo metodo viene chiamato su una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2270">Because this method is called on a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2271">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2271">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2272">Per leggere un messaggio in una coda senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2272">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="e0ac9-2273">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2273">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="e0ac9-2274">In quanto <xref:System.Messaging.MessageQueue.Peek%2A> non rimuove i messaggi nella coda, non c'è niente di rollback da una chiamata a <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2274">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2275">Usare una chiamata a <xref:System.Messaging.MessageQueue.Receive%2A> quando è accettabile per il thread corrente resti bloccato mentre si attende un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2275">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2276">Il thread è bloccato per il periodo di tempo specificato o per un periodo illimitato se è stato specificato il valore <xref:System.Messaging.MessageQueue.InfiniteTimeout> per il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2276">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="e0ac9-2277">Se l'elaborazione dell'applicazione continui senza attendere un messaggio, è consigliabile usare il metodo asincrono, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2277">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2278">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2278">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2279">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2279">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2280">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2280">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2281">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2281">Local computer</span></span>|<span data-ttu-id="e0ac9-2282">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2282">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2283">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2283">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2284">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2284">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2285">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2285">Remote computer</span></span>|<span data-ttu-id="e0ac9-2286">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2286">No</span></span>|  
|<span data-ttu-id="e0ac9-2287">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2287">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2288">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2288">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2289">Il valore del parametro <paramref name="cursor" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2289">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2290">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2290">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2291">Il valore del parametro <paramref name="transaction" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2291">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2292">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2292">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
          <span data-ttu-id="e0ac9-2293">Probabilmente <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2293">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2294">Un messaggio non è arrivato nella coda prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2294">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2295">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2295">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2296">La coda non è transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2296">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="e0ac9-2297">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2297">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2298">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2298">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-2299">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2299">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2300">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2300">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="e0ac9-2301">Oggetto <see cref="T:System.Messaging.Cursor" /> che occupa una posizione specifica nella coda messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2301">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-2302">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2302">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values that describes the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2303">Riceve il messaggio corrente nella coda, utilizzando il cursore specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2303">Receives the current message in the queue, using a specified cursor.</span>
          </span>
          <span data-ttu-id="e0ac9-2304">Se non è disponibile alcun messaggio, il metodo aspetta finché non risulta disponibile un messaggio o finché non scade il periodo di timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2304">If no message is available, this method waits until either a message is available, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2305">Oggetto <see cref="T:System.Messaging.Message" /> che fa riferimento a un messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2305">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2306">Utilizzare questo overload per ricevere un messaggio da una coda usando un contesto di transazione definito dal `transactionType` parametro e restituire in un determinato periodo di tempo se non sono presenti messaggi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2306">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2307">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per ricevere il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2307">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="e0ac9-2308">Specificare `Single` se si desidera ricevere il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2308">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-2309">È possibile specificare `None` se si desidera ricevere un messaggio da una coda transazionale all'esterno di un contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2309">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="e0ac9-2310">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo consente la lettura di un messaggio sincrona, rimuovendolo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2310">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="e0ac9-2311">Le chiamate successive a <xref:System.Messaging.MessageQueue.Receive%2A> restituiscono i messaggi successivi nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2311">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2312">Se questo metodo viene chiamato per ricevere un messaggio da una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2312">If this method is called to receive a message from a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2313">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2313">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2314">Per leggere un messaggio in una coda senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.Peek%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2314">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="e0ac9-2315">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2315">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="e0ac9-2316">In quanto <xref:System.Messaging.MessageQueue.Peek%2A> non rimuove i messaggi nella coda, non c'è niente di rollback da una chiamata a <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2316">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2317">Usare una chiamata a <xref:System.Messaging.MessageQueue.Receive%2A> quando è accettabile per il thread corrente resti bloccato mentre si attende un messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2317">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2318">Il thread è bloccato per il periodo di tempo specificato o per un periodo illimitato se è stato specificato il valore <xref:System.Messaging.MessageQueue.InfiniteTimeout> per il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2318">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="e0ac9-2319">Se l'elaborazione dell'applicazione continui senza attendere un messaggio, è consigliabile usare il metodo asincrono, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2319">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="e0ac9-2320">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2320">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2321">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2321">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2322">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2322">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2323">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2323">Local computer</span></span>|<span data-ttu-id="e0ac9-2324">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2324">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2325">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2325">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2326">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2326">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2327">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2327">Remote computer</span></span>|<span data-ttu-id="e0ac9-2328">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2328">No</span></span>|  
|<span data-ttu-id="e0ac9-2329">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2329">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2330">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2330">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2331">Il valore del parametro <paramref name="cursor" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2331">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2332">Il valore specificato per il parametro <paramref name="timeout" /> non è valido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2332">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
          <span data-ttu-id="e0ac9-2333">Probabilmente <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2333">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-2334">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2334">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2335">Un messaggio non è arrivato nella coda prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2335">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2336">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2336">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2337">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2337">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="e0ac9-2338">Il metodo non è thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2338">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2339">Riceve un messaggio che corrisponde a un determinato identificatore di correlazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2339">Receives a message that matches a given correlation identifier.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId correlationId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="e0ac9-2340">Oggetto <see cref="P:System.Messaging.Message.CorrelationId" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2340">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2341">Riceve il messaggio che corrisponde all'identificatore di correlazione specificato (da una coda non transazionale) e genera subito un'eccezione se nella coda non è disponibile alcun messaggio con l'identificatore di correlazione specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2341">Receives the message that matches the given correlation identifier (from a non-transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2342">
            <see cref="T:System.Messaging.Message" /> il cui <see cref="P:System.Messaging.Message.CorrelationId" /> corrisponde al parametro <paramref name="correlationId" /> trasmesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2342">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2343">Questo metodo effettua ricerche nella coda non transazionale a cui fanno riferimento le <xref:System.Messaging.MessageQueue> per un messaggio la cui <xref:System.Messaging.Message.CorrelationId%2A> corrisponde al valore specificato `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2343">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2344">Se viene trovato alcun messaggio che corrisponde alla `correlationID` parametro, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2344">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="e0ac9-2345">In caso contrario, il messaggio viene rimosso dalla coda e restituito all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2345">Otherwise, the message is removed from the queue and returned to the application.</span></span>  
  
 <span data-ttu-id="e0ac9-2346">Il <xref:System.Messaging.Message.CorrelationId%2A> proprietà viene utilizzata per collegare un messaggio inviato alla coda di messaggi di risposta, un report o riconoscimento associati.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2346">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="e0ac9-2347">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2347">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2348">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> metodo recupera un messaggio, specificando il relativo identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2348">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method retrieves a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="e0ac9-2349">Per leggere un messaggio con un identificatore di correlazione specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2349">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2350">Il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2350">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2351">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2351">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2352">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2352">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2353">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2353">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2354">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2354">Local computer</span></span>|<span data-ttu-id="e0ac9-2355">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2355">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2356">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2356">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2357">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2357">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2358">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2358">Remote computer</span></span>|<span data-ttu-id="e0ac9-2359">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2359">No</span></span>|  
|<span data-ttu-id="e0ac9-2360">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2360">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2361">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2361">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2362">Esempio di codice seguente invia e riceve un messaggio contenente un ordine a e da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2362">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="e0ac9-2363">In particolare richiede una conferma positiva quando il messaggio originale raggiunge o viene recuperato dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2363">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2364">Il valore del parametro <paramref name="correlationId" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2364">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2365">Impossibile trovare il messaggio con il parametro <paramref name="correlationId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2365">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2366">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2366">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="e0ac9-2367">Oggetto <see cref="P:System.Messaging.Message.CorrelationId" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2367">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="e0ac9-2368">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2368">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2369">Riceve il messaggio che corrisponde all'identificatore di correlazione specificato (da una coda transazionale) e genera subito un'eccezione se nella coda non è disponibile alcun messaggio con l'identificatore di correlazione specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2369">Receives the message that matches the given correlation identifier (from a transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2370">
            <see cref="T:System.Messaging.Message" /> il cui <see cref="P:System.Messaging.Message.CorrelationId" /> corrisponde al parametro <paramref name="correlationId" /> trasmesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2370">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2371">Questo metodo effettua ricerche nella coda transazionale a cui fanno riferimento le <xref:System.Messaging.MessageQueue> per un messaggio la cui <xref:System.Messaging.Message.CorrelationId%2A> corrisponde al valore specificato `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2371">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2372">Se viene trovato alcun messaggio che corrisponde alla `correlationID` parametro, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2372">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="e0ac9-2373">In caso contrario, il messaggio viene rimosso dalla coda e restituito all'applicazione utilizzando il contesto di transazione interna definito dal `transaction` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2373">Otherwise, the message is removed from the queue and returned to the application using the internal transaction context defined by the `transaction` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2374">Poiché questo metodo viene chiamato su una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2374">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2375">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2375">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2376">Il <xref:System.Messaging.Message.CorrelationId%2A> proprietà viene utilizzata per collegare un messaggio inviato alla coda di messaggi di risposta, un report o riconoscimento associati.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2376">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="e0ac9-2377">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2377">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2378">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> metodo viene utilizzato per recuperare un messaggio, specificando il relativo identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2378">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="e0ac9-2379">Per leggere un messaggio con un identificatore di correlazione specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2379">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2380">Il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2380">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2381">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2381">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-2382">Poiché <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> non rimuove i messaggi nella coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2382">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2383">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2383">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2384">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2384">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2385">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2385">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2386">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2386">Local computer</span></span>|<span data-ttu-id="e0ac9-2387">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2387">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2388">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2388">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2389">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2389">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2390">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2390">Remote computer</span></span>|<span data-ttu-id="e0ac9-2391">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2391">No</span></span>|  
|<span data-ttu-id="e0ac9-2392">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2392">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2393">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2393">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2394">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2394">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#14](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#14)]
 [!code-csharp[MessageQueue2#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2395">Il valore del parametro <paramref name="correlationId" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2395">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2396">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2396">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2397">Il valore del parametro <paramref name="transaction" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2397">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2398">Impossibile trovare il messaggio con il parametro <paramref name="correlationId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2398">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2399">La coda non è transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2399">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="e0ac9-2400">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2400">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2401">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2401">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="e0ac9-2402">Oggetto <see cref="P:System.Messaging.Message.CorrelationId" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2402">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-2403">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2403">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2404">Riceve il messaggio che corrisponde all'identificatore di correlazione specificato e genera subito un'eccezione se nella coda non è disponibile alcun messaggio con l'identificatore di correlazione specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2404">Receives the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2405">
            <see cref="T:System.Messaging.Message" /> il cui <see cref="P:System.Messaging.Message.CorrelationId" /> corrisponde al parametro <paramref name="correlationId" /> trasmesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2405">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2406">Questo metodo effettua ricerche nella coda cui fa riferimento il <xref:System.Messaging.MessageQueue> per un messaggio la cui <xref:System.Messaging.Message.CorrelationId%2A> corrisponde al valore specificato `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2406">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2407">Se viene trovato alcun messaggio che corrisponde alla `correlationID` parametro, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2407">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="e0ac9-2408">In caso contrario, il messaggio viene rimosso dalla coda e restituito all'applicazione usando un contesto di transazione definito dal `transactionType` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2408">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2409">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per ricevere il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2409">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="e0ac9-2410">Specificare `Single` se si desidera ricevere il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2410">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-2411">È possibile specificare `None` se si desidera ricevere un messaggio da una coda transazionale all'esterno di un contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2411">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="e0ac9-2412">Se questo metodo viene chiamato per ricevere un messaggio da una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2412">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2413">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2413">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2414">Il <xref:System.Messaging.Message.CorrelationId%2A> proprietà viene utilizzata per collegare un messaggio inviato alla coda di messaggi di risposta, un report o riconoscimento associati.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2414">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="e0ac9-2415">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2415">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2416">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> metodo viene utilizzato per recuperare un messaggio, specificando il relativo identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2416">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="e0ac9-2417">Per leggere un messaggio con un identificatore di correlazione specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2417">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2418">Il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2418">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2419">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2419">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-2420">Poiché <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> non rimuove i messaggi nella coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2420">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2421">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2421">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2422">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2422">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2423">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2423">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2424">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2424">Local computer</span></span>|<span data-ttu-id="e0ac9-2425">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2425">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2426">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2426">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2427">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2427">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2428">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2428">Remote computer</span></span>|<span data-ttu-id="e0ac9-2429">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2429">No</span></span>|  
|<span data-ttu-id="e0ac9-2430">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2430">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2431">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2431">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2432">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2432">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#11](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#11)]
 [!code-csharp[MessageQueue2#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2433">Il valore del parametro <paramref name="correlationId" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2433">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2434">Impossibile trovare il messaggio con il parametro <paramref name="correlationId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2434">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-2435">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2435">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2436">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2436">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="e0ac9-2437">Oggetto <see cref="P:System.Messaging.Message.CorrelationId" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2437">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2438">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2438">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2439">Riceve il messaggio che corrisponde all'identificatore di correlazione specificato (da una coda non transazionale) e attende che un messaggio con l'identificatore di correlazione specificato sia disponibile nella coda oppure che il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2439">Receives the message that matches the given correlation identifier (from a non-transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2440">
            <see cref="T:System.Messaging.Message" /> il cui <see cref="P:System.Messaging.Message.CorrelationId" /> corrisponde al parametro <paramref name="correlationId" /> trasmesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2440">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2441">Questo metodo effettua ricerche nella coda non transazionale a cui fanno riferimento le <xref:System.Messaging.MessageQueue> per un messaggio la cui <xref:System.Messaging.Message.CorrelationId%2A> corrisponde al valore specificato `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2441">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2442">Questo metodo restituisce immediatamente se il messaggio con l'identificatore di correlazione specificato mediante il `correlationId` parametro si trova nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2442">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue.</span></span> <span data-ttu-id="e0ac9-2443">In caso contrario, il metodo attende il periodo di tempo per un nuovo messaggio in arrivo specificato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2443">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="e0ac9-2444">Se un nuovo messaggio non perviene prima il timeout scada, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2444">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="e0ac9-2445">Il `timeout` parametro specifica il totale tempo di esecuzione per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2445">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="e0ac9-2446">Piuttosto, specifica il tempo di attesa per un nuovo messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2446">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2447">Ogni volta che arriva un nuovo messaggio, questo metodo esamina la <xref:System.Messaging.Message.CorrelationId%2A> del nuovo messaggio per verificare se corrisponde il `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2447">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2448">In caso contrario, questo metodo avvia nuovamente il periodo di timeout e attende l'arrivo di un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2448">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="e0ac9-2449">Pertanto, se i nuovi messaggi continuano ad arrivare entro il periodo di timeout, è possibile che questo metodo venga eseguito all'infinito, fino a quando non scade il periodo di timeout senza eventuali nuovi messaggi in arrivo o fino a quando non arriva un messaggio la cui proprietà <xref:System.Messaging.Message.CorrelationId%2A> corrisponde alla `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2449">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2450">Il <xref:System.Messaging.Message.CorrelationId%2A> proprietà viene utilizzata per collegare un messaggio inviato alla coda di messaggi di risposta, un report o riconoscimento associati.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2450">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="e0ac9-2451">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2451">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2452">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> metodo viene utilizzato per recuperare un messaggio, specificando il relativo identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2452">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="e0ac9-2453">Per leggere un messaggio con un identificatore di correlazione specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2453">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2454">Il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2454">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2455">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2455">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2456">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2456">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2457">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2457">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2458">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2458">Local computer</span></span>|<span data-ttu-id="e0ac9-2459">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2459">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2460">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2460">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2461">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2461">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2462">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2462">Remote computer</span></span>|<span data-ttu-id="e0ac9-2463">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2463">No</span></span>|  
|<span data-ttu-id="e0ac9-2464">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2464">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2465">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2465">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2466">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2466">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#10](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#10)]
 [!code-csharp[MessageQueue2#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2467">Il valore del parametro <paramref name="correlationId" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2467">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2468">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2468">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2469">Il messaggio con l'oggetto <paramref name="correlationId" /> specificato non è presente nella coda e non è arrivato prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2469">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2470">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2470">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2471">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2471">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="e0ac9-2472">Oggetto <see cref="P:System.Messaging.Message.CorrelationId" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2472">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2473">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2473">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="e0ac9-2474">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2474">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2475">Riceve il messaggio che corrisponde all'identificatore di correlazione specificato (da una coda transazionale) e attende che un messaggio con l'identificatore di correlazione specificato sia disponibile nella coda oppure che il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2475">Receives the message that matches the given correlation identifier (from a transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2476">
            <see cref="T:System.Messaging.Message" /> il cui <see cref="P:System.Messaging.Message.CorrelationId" /> corrisponde al parametro <paramref name="correlationId" /> trasmesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2476">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2477">Questo metodo effettua ricerche nella coda transazionale a cui fanno riferimento le <xref:System.Messaging.MessageQueue> per un messaggio la cui <xref:System.Messaging.Message.CorrelationId%2A> corrisponde al valore specificato `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2477">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2478">Questo metodo restituisce immediatamente se il messaggio con l'identificatore di correlazione specificato mediante il `correlationId` parametro è presente nella coda, utilizzando il contesto di transazione interna definito dal `transaction` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2478">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="e0ac9-2479">In caso contrario, il metodo attende il periodo di tempo per un nuovo messaggio in arrivo specificato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2479">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="e0ac9-2480">Se un nuovo messaggio non perviene prima il timeout scada, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2480">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="e0ac9-2481">Il `timeout` parametro specifica il totale tempo di esecuzione per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2481">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="e0ac9-2482">Piuttosto, specifica il tempo di attesa per un nuovo messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2482">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2483">Ogni volta che arriva un nuovo messaggio, questo metodo esamina la <xref:System.Messaging.Message.CorrelationId%2A> del nuovo messaggio per verificare se corrisponde il `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2483">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2484">In caso contrario, questo metodo avvia nuovamente il periodo di timeout e attende l'arrivo di un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2484">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="e0ac9-2485">Pertanto, se i nuovi messaggi continuano ad arrivare entro il periodo di timeout, è possibile che questo metodo venga eseguito all'infinito, fino a quando non scade il periodo di timeout senza eventuali nuovi messaggi in arrivo o fino a quando non arriva un messaggio la cui proprietà <xref:System.Messaging.Message.CorrelationId%2A> corrisponde alla `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2485">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2486">Poiché questo metodo viene chiamato su una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2486">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2487">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2487">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2488">Il <xref:System.Messaging.Message.CorrelationId%2A> proprietà viene utilizzata per collegare un messaggio inviato alla coda di messaggi di risposta, un report o riconoscimento associati.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2488">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="e0ac9-2489">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2489">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2490">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> metodo viene utilizzato per recuperare un messaggio, specificando il relativo identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2490">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="e0ac9-2491">Per leggere un messaggio con un identificatore di correlazione specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2491">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2492">Il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2492">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2493">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2493">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-2494">Poiché <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> non rimuove i messaggi nella coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2494">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2495">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2495">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2496">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2496">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2497">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2497">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2498">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2498">Local computer</span></span>|<span data-ttu-id="e0ac9-2499">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2499">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2500">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2500">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2501">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2501">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2502">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2502">Remote computer</span></span>|<span data-ttu-id="e0ac9-2503">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2503">No</span></span>|  
|<span data-ttu-id="e0ac9-2504">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2504">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2505">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2505">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2506">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2506">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#13](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#13)]
 [!code-csharp[MessageQueue2#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2507">Il valore del parametro <paramref name="correlationId" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2507">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2508">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2508">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2509">Il valore del parametro <paramref name="transaction" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2509">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2510">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2510">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2511">Il messaggio con l'oggetto <paramref name="correlationId" /> specificato non è presente nella coda e non è arrivato prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2511">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2512">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2512">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2513">La coda non è transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2513">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="e0ac9-2514">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2514">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2515">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2515">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="e0ac9-2516">Oggetto <see cref="P:System.Messaging.Message.CorrelationId" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2516">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2517">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2517">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-2518">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2518">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2519">Riceve il messaggio che corrisponde all'identificatore di correlazione specificato e attende che un messaggio con l'identificatore di correlazione specificato sia disponibile nella coda o che il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2519">Receives the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2520">
            <see cref="T:System.Messaging.Message" /> il cui <see cref="P:System.Messaging.Message.CorrelationId" /> corrisponde al parametro <paramref name="correlationId" /> trasmesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2520">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2521">Questo metodo effettua ricerche nella coda cui fa riferimento il <xref:System.Messaging.MessageQueue> per un messaggio la cui <xref:System.Messaging.Message.CorrelationId%2A> corrisponde al valore specificato `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2521">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2522">Questo metodo restituisce immediatamente se il messaggio con l'identificatore di correlazione specificato mediante il `correlationId` parametro è presente nella coda, utilizzando un contesto di transazione definito dalla `transactionType` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2522">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="e0ac9-2523">In caso contrario, il metodo attende il periodo di tempo per un nuovo messaggio in arrivo specificato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2523">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="e0ac9-2524">Se un nuovo messaggio non perviene prima il timeout scada, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2524">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="e0ac9-2525">Il `timeout` parametro specifica il totale tempo di esecuzione per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2525">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="e0ac9-2526">Piuttosto, specifica il tempo di attesa per un nuovo messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2526">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2527">Ogni volta che arriva un nuovo messaggio, questo metodo esamina la <xref:System.Messaging.Message.CorrelationId%2A> del nuovo messaggio per verificare se corrisponde il `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2527">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2528">In caso contrario, questo metodo avvia nuovamente il periodo di timeout e attende l'arrivo di un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2528">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="e0ac9-2529">Pertanto, se i nuovi messaggi continuano ad arrivare entro il periodo di timeout, è possibile che questo metodo venga eseguito all'infinito, fino a quando non scade il periodo di timeout senza eventuali nuovi messaggi in arrivo o fino a quando non arriva un messaggio la cui proprietà <xref:System.Messaging.Message.CorrelationId%2A> corrisponde alla `correlationId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2529">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span> <span data-ttu-id="e0ac9-2530">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per ricevere il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2530">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="e0ac9-2531">Specificare `Single` se si desidera ricevere il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2531">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-2532">È possibile specificare `None` se si desidera ricevere un messaggio da una coda transazionale all'esterno di un contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2532">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="e0ac9-2533">Se questo metodo viene chiamato per ricevere un messaggio da una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2533">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2534">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2534">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2535">Il <xref:System.Messaging.Message.CorrelationId%2A> proprietà viene utilizzata per collegare un messaggio inviato alla coda di messaggi di risposta, un report o riconoscimento associati.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2535">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="e0ac9-2536">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2536">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2537">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> metodo viene utilizzato per recuperare un messaggio, specificando il relativo identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2537">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="e0ac9-2538">Per leggere un messaggio con un identificatore di correlazione specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2538">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2539">Il <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2539">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2540">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2540">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-2541">Poiché <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> non rimuove i messaggi nella coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2541">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2542">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2542">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2543">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2543">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2544">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2544">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2545">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2545">Local computer</span></span>|<span data-ttu-id="e0ac9-2546">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2546">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2547">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2547">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2548">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2548">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2549">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2549">Remote computer</span></span>|<span data-ttu-id="e0ac9-2550">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2550">No</span></span>|  
|<span data-ttu-id="e0ac9-2551">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2551">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2552">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2552">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2553">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2553">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#12](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#12)]
 [!code-csharp[MessageQueue2#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2554">Il valore del parametro <paramref name="correlationId" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2554">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2555">Impossibile trovare il messaggio con il parametro <paramref name="correlationId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2555">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2556">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2556">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-2557">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2557">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2558">Il messaggio con l'oggetto <paramref name="correlationId" /> specificato non è presente nella coda e non è arrivato prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2558">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2559">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2559">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2560">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2560">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2561">Riceve il messaggio corrispondente all'identificatore specificato rimuovendolo dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2561">Receives the message that matches the given identifier, removing it from the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById id" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="e0ac9-2562">Oggetto <see cref="P:System.Messaging.Message.Id" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2562">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2563">Riceve il messaggio che corrisponde all'identificatore specificato da una coda non transazionale e genera subito un'eccezione se nella coda non è disponibile alcun messaggio con l'identificatore specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2563">Receives the message that matches the given identifier from a non-transactional queue and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2564">Oggetto <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.Id" /> corrisponde al parametro <paramref name="id" /> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2564">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2565">Utilizzare questo metodo per leggere un messaggio con un identificatore noto e lo rimuove dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2565">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="e0ac9-2566">Questo metodo genera un'eccezione immediatamente se il messaggio non è presente nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2566">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2567">Il <xref:System.Messaging.Message.Id%2A> proprietà di un messaggio è univoca all'interno dell'azienda di Accodamento messaggi, esisterà al massimo un messaggio nella coda che corrisponde al determinato `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2567">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2568">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2568">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2569">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> metodo viene utilizzato per recuperare un riconoscimento, un report o un messaggio di risposta generati dall'applicazione che è stato creato come risultato di un messaggio inviato alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2569">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2570">Per leggere un messaggio con un identificatore specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2570">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2571">Il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2571">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2572">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2572">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2573">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2573">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2574">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2574">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2575">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2575">Local computer</span></span>|<span data-ttu-id="e0ac9-2576">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2576">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2577">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2577">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2578">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2578">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2579">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2579">Remote computer</span></span>|<span data-ttu-id="e0ac9-2580">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2580">No</span></span>|  
|<span data-ttu-id="e0ac9-2581">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2581">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2582">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2582">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2583">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2583">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#16](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#16)]
 [!code-csharp[MessageQueue2#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2584">Il valore del parametro <paramref name="id" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2584">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2585">Impossibile trovare il messaggio con il parametro <paramref name="id" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2585">The message with the specified <paramref name="id" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2586">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2586">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="e0ac9-2587">Oggetto <see cref="P:System.Messaging.Message.Id" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2587">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="e0ac9-2588">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2588">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2589">Riceve il messaggio che corrisponde all'identificatore specificato (da una coda transazionale) e genera subito un'eccezione se nella coda non è disponibile alcun messaggio con l'identificatore specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2589">Receives the message that matches the given identifier (from a transactional queue) and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2590">Oggetto <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.Id" /> corrisponde al parametro <paramref name="id" /> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2590">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2591">Usare questo metodo per leggere un messaggio con un identificatore noto e lo rimuove dalla coda, utilizzando il contesto di transazione interna definito dal `transaction` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2591">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="e0ac9-2592">Questo metodo genera un'eccezione immediatamente se il messaggio non è presente nella coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2592">This method throws an exception immediately if the message is not in the queue</span></span>  
  
 <span data-ttu-id="e0ac9-2593">Il <xref:System.Messaging.Message.Id%2A> proprietà di un messaggio è univoca all'interno dell'azienda di Accodamento messaggi, esisterà al massimo un messaggio nella coda che corrisponde al determinato `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2593">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2594">Poiché questo metodo viene chiamato su una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2594">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2595">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2595">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2596">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2596">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2597">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> metodo viene utilizzato per recuperare un riconoscimento, un report o un messaggio di risposta generati dall'applicazione che è stato creato come risultato di un messaggio inviato alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2597">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2598">Per leggere un messaggio con un identificatore specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2598">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2599">Il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2599">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2600">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2600">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-2601">Poiché <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> non rimuove i messaggi nella coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2601">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2602">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2602">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2603">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2603">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2604">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2604">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2605">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2605">Local computer</span></span>|<span data-ttu-id="e0ac9-2606">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2606">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2607">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2607">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2608">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2608">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2609">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2609">Remote computer</span></span>|<span data-ttu-id="e0ac9-2610">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2610">No</span></span>|  
|<span data-ttu-id="e0ac9-2611">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2611">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2612">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2612">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2613">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2613">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#17](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#17)]
 [!code-csharp[MessageQueue2#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2614">Il valore del parametro <paramref name="id" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2614">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2615">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2615">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2616">Il valore del parametro <paramref name="transaction" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2616">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2617">Impossibile trovare il messaggio con il parametro <paramref name="id" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2617">The message with the specified <paramref name="id" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2618">La coda non è transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2618">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="e0ac9-2619">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2619">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2620">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2620">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="e0ac9-2621">Oggetto <see cref="P:System.Messaging.Message.Id" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2621">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-2622">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2622">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2623">Riceve il messaggio corrispondente all'identificatore specificato e genera subito un'eccezione se nella coda non è disponibile alcun messaggio con l'identificatore specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2623">Receives the message that matches the given identifier and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2624">Oggetto <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.Id" /> corrisponde al parametro <paramref name="id" /> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2624">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2625">Utilizzare questo metodo per leggere un messaggio con un identificatore noto e lo rimuove dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2625">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="e0ac9-2626">Questo metodo genera un'eccezione immediatamente se il messaggio non è presente nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2626">This method throws an exception immediately if the message is not in the queue.</span></span> <span data-ttu-id="e0ac9-2627">In caso contrario, il messaggio viene rimosso dalla coda e restituito all'applicazione usando un contesto di transazione definito dal `transactionType` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2627">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2628">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per ricevere il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2628">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="e0ac9-2629">Specificare `Single` se si desidera ricevere il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2629">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-2630">È possibile specificare `None` se si desidera ricevere un messaggio da una coda transazionale all'esterno di un contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2630">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="e0ac9-2631">Il <xref:System.Messaging.Message.Id%2A> proprietà di un messaggio è univoca all'interno dell'azienda di Accodamento messaggi, esisterà al massimo un messaggio nella coda che corrisponde al determinato `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2631">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="e0ac9-2632">Se il messaggio con l'identificatore specificato si trova in una coda diverso da quello associato a questo <xref:System.Messaging.MessageQueue> istanza, il messaggio non sarà reperibile.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2632">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="e0ac9-2633">Se questo metodo viene chiamato per ricevere un messaggio da una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2633">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2634">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2634">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2635">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2635">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2636">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> metodo viene utilizzato per recuperare un riconoscimento, un report o un messaggio di risposta generati dall'applicazione che è stato creato come risultato di un messaggio inviato alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2636">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2637">Per leggere un messaggio con un identificatore specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2637">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2638">Il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2638">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2639">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2639">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-2640">Poiché <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> non rimuove i messaggi nella coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2640">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2641">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2641">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2642">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2642">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2643">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2643">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2644">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2644">Local computer</span></span>|<span data-ttu-id="e0ac9-2645">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2645">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2646">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2646">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2647">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2647">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2648">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2648">Remote computer</span></span>|<span data-ttu-id="e0ac9-2649">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2649">No</span></span>|  
|<span data-ttu-id="e0ac9-2650">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2650">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2651">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2651">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2652">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2652">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#15](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#15)]
 [!code-csharp[MessageQueue2#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2653">Il valore del parametro <paramref name="id" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2653">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2654">Impossibile trovare il messaggio con il parametro <paramref name="id" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2654">The message with the specified <paramref name="id" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-2655">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2655">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2656">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2656">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="e0ac9-2657">Oggetto <see cref="P:System.Messaging.Message.Id" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2657">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2658">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2658">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2659">Riceve il messaggio corrispondente all'identificatore specificato (da una coda non transazionale) e attende che un messaggio con l'identificatore specificato sia disponibile nella coda o che il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2659">Receives the message that matches the given identifier (from a non-transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2660">Oggetto <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.Id" /> corrisponde al parametro <paramref name="id" /> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2660">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2661">Utilizzare questo metodo per leggere un messaggio con un identificatore noto e lo rimuove dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2661">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="e0ac9-2662">Questo metodo restituisce immediatamente se il messaggio con l'identificatore specificato mediante il `id` parametro si trova nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2662">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="e0ac9-2663">In caso contrario, il metodo attende il periodo di tempo per un nuovo messaggio in arrivo specificato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2663">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="e0ac9-2664">Se un nuovo messaggio non perviene prima il timeout scada, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2664">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="e0ac9-2665">Il `timeout` parametro specifica il totale tempo di esecuzione per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2665">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="e0ac9-2666">Piuttosto, specifica il tempo di attesa per un nuovo messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2666">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2667">Ogni volta che arriva un nuovo messaggio, questo metodo esamina la <xref:System.Messaging.Message.Id%2A> del nuovo messaggio per verificare se corrisponde il `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2667">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="e0ac9-2668">In caso contrario, questo metodo avvia nuovamente il periodo di timeout e attende l'arrivo di un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2668">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="e0ac9-2669">Pertanto, se i nuovi messaggi continuano ad arrivare entro il periodo di timeout, è possibile che questo metodo venga eseguito all'infinito, fino a quando non scade il periodo di timeout senza eventuali nuovi messaggi in arrivo o fino a quando non arriva un messaggio la cui proprietà <xref:System.Messaging.Message.Id%2A> corrisponde alla `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2669">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2670">Il <xref:System.Messaging.Message.Id%2A> proprietà di un messaggio è univoca all'interno dell'azienda di Accodamento messaggi, esisterà al massimo un messaggio nella coda che corrisponde al determinato `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2670">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2671">Utilizzare questo overload del metodo <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> quando è accettabile per il thread corrente resti bloccato fino a quando i nuovi messaggi continuano a arrivano nella coda entro il periodo di timeout specificato il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2671">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="e0ac9-2672">Il thread verrà bloccato per il periodo di tempo specificato o per un periodo illimitato se è stato specificato il valore <xref:System.Messaging.MessageQueue.InfiniteTimeout> per il `timeout` parametro, o se i nuovi messaggi continuano a arrivano nella coda entro il periodo di timeout specificato il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2672">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2673">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2673">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2674">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> metodo viene utilizzato per recuperare un riconoscimento, un report o un messaggio di risposta generati dall'applicazione che è stato creato come risultato di un messaggio inviato alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2674">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2675">Per leggere un messaggio con un identificatore specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2675">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2676">Il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2676">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2677">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2677">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2678">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2678">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2679">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2679">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2680">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2680">Local computer</span></span>|<span data-ttu-id="e0ac9-2681">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2681">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2682">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2682">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2683">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2683">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2684">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2684">Remote computer</span></span>|<span data-ttu-id="e0ac9-2685">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2685">No</span></span>|  
|<span data-ttu-id="e0ac9-2686">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2686">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2687">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2687">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2688">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2688">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#20](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#20)]
 [!code-csharp[MessageQueue2#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2689">Il valore del parametro <paramref name="id" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2689">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2690">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2690">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2691">Un messaggio con il parametro <paramref name="id" /> specificato non è arrivato nella coda prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2691">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2692">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2692">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2693">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2693">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="e0ac9-2694">Oggetto <see cref="P:System.Messaging.Message.Id" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2694">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2695">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2695">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="e0ac9-2696">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2696">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2697">Riceve il messaggio corrispondente all'identificatore specificato (da una coda transazionale) e attende che un messaggio con l'identificatore specificato sia disponibile nella coda o che il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2697">Receives the message that matches the given identifier (from a transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2698">Oggetto <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.Id" /> corrisponde al parametro <paramref name="id" /> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2698">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2699">Usare questo metodo per leggere un messaggio con un identificatore noto e lo rimuove dalla coda, utilizzando il contesto di transazione interna definito dal `transaction` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2699">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="e0ac9-2700">Questo metodo restituisce immediatamente se il messaggio con l'identificatore specificato mediante il `id` parametro si trova nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2700">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="e0ac9-2701">In caso contrario, il metodo attende il periodo di tempo per un nuovo messaggio in arrivo specificato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2701">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="e0ac9-2702">Se un nuovo messaggio non perviene prima il timeout scada, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2702">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="e0ac9-2703">Il `timeout` parametro specifica il totale tempo di esecuzione per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2703">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="e0ac9-2704">Piuttosto, specifica il tempo di attesa per un nuovo messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2704">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2705">Ogni volta che arriva un nuovo messaggio, questo metodo esamina la <xref:System.Messaging.Message.Id%2A> del nuovo messaggio per verificare se corrisponde il `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2705">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="e0ac9-2706">In caso contrario, questo metodo avvia nuovamente il periodo di timeout e attende l'arrivo di un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2706">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="e0ac9-2707">Pertanto, se i nuovi messaggi continuano ad arrivare entro il periodo di timeout, è possibile che questo metodo venga eseguito all'infinito, fino a quando non scade il periodo di timeout senza eventuali nuovi messaggi in arrivo o fino a quando non arriva un messaggio la cui proprietà <xref:System.Messaging.Message.Id%2A> corrisponde alla `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2707">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2708">Il <xref:System.Messaging.Message.Id%2A> proprietà di un messaggio è univoca all'interno dell'azienda di Accodamento messaggi, esisterà al massimo un messaggio nella coda che corrisponde al determinato `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2708">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2709">Utilizzare questo overload del metodo <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> quando è accettabile per il thread corrente resti bloccato fino a quando i nuovi messaggi continuano a arrivano nella coda entro il periodo di timeout specificato il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2709">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="e0ac9-2710">Il thread verrà bloccato per il periodo di tempo specificato o per un periodo illimitato se è stato specificato il valore <xref:System.Messaging.MessageQueue.InfiniteTimeout> per il `timeout` parametro, o se i nuovi messaggi continuano a arrivano nella coda all'interno del periodo di timeout specificato il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2710">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the timeout period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2711">Poiché questo metodo viene chiamato su una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2711">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2712">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2712">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2713">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2713">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2714">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> metodo viene utilizzato per recuperare un riconoscimento, un report o un messaggio di risposta generati dall'applicazione che è stato creato come risultato di un messaggio inviato alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2714">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2715">Per leggere un messaggio con un identificatore specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2715">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2716">Il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo restituiscono lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2716">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2717">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2717">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-2718">Poiché <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> non rimuove i messaggi nella coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2718">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2719">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2719">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2720">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2720">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2721">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2721">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2722">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2722">Local computer</span></span>|<span data-ttu-id="e0ac9-2723">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2723">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2724">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2724">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2725">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2725">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2726">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2726">Remote computer</span></span>|<span data-ttu-id="e0ac9-2727">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2727">No</span></span>|  
|<span data-ttu-id="e0ac9-2728">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2728">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2729">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2729">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2730">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2730">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#18](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#18)]
 [!code-csharp[MessageQueue2#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2731">Il valore del parametro <paramref name="id" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2731">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="e0ac9-2732">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2732">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2733">Il valore del parametro <paramref name="transaction" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2733">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2734">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2734">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2735">Un messaggio con il parametro <paramref name="id" /> specificato non è arrivato nella coda prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2735">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2736">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2736">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2737">La coda non è transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2737">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="e0ac9-2738">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2738">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2739">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2739">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="e0ac9-2740">Oggetto <see cref="P:System.Messaging.Message.Id" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2740">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="e0ac9-2741">Oggetto <see cref="T:System.TimeSpan" /> che indica l'intervallo di attesa prima che un nuovo messaggio venga reso disponibile per il controllo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2741">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-2742">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2742">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2743">Riceve il messaggio che corrisponde all'identificatore specificato e attende che un messaggio con l'identificatore specificato sia disponibile nella coda o che il timeout scada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2743">Receives the message that matches the given identifier and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2744">Oggetto <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.Id" /> corrisponde al parametro <paramref name="id" /> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2744">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2745">Utilizzare questo metodo per leggere un messaggio con un identificatore noto e lo rimuove dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2745">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="e0ac9-2746">Questo metodo restituisce immediatamente se il messaggio con l'identificatore specificato mediante il `id` parametro è presente nella coda, utilizzando un contesto di transazione definito dalla `transactionType` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2746">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="e0ac9-2747">In caso contrario, il metodo attende il periodo di tempo per un nuovo messaggio in arrivo specificato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2747">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="e0ac9-2748">Se un nuovo messaggio non perviene prima il timeout scada, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2748">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="e0ac9-2749">Il `timeout` parametro specifica il totale tempo di esecuzione per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2749">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="e0ac9-2750">Piuttosto, specifica il tempo di attesa per un nuovo messaggio in arrivo nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2750">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="e0ac9-2751">Ogni volta che arriva un nuovo messaggio, questo metodo esamina la <xref:System.Messaging.Message.Id%2A> del nuovo messaggio per verificare se corrisponde il `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2751">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="e0ac9-2752">In caso contrario, questo metodo avvia nuovamente il periodo di timeout e attende l'arrivo di un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2752">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="e0ac9-2753">Pertanto, se i nuovi messaggi continuano ad arrivare entro il periodo di timeout, è possibile che questo metodo venga eseguito all'infinito, fino a quando non scade il periodo di timeout senza eventuali nuovi messaggi in arrivo o fino a quando non arriva un messaggio la cui proprietà <xref:System.Messaging.Message.Id%2A> corrisponde alla `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2753">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2754">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per ricevere il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2754">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="e0ac9-2755">Specificare `Single` se si desidera ricevere il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2755">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-2756">È possibile specificare `None` se si desidera ricevere un messaggio da una coda transazionale all'esterno di un contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2756">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="e0ac9-2757">Il <xref:System.Messaging.Message.Id%2A> proprietà di un messaggio è univoca all'interno dell'azienda di Accodamento messaggi, esisterà al massimo un messaggio nella coda che corrisponde al determinato `id` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2757">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="e0ac9-2758">Se il messaggio con l'identificatore specificato si trova in una coda diverso da quello associato a questo <xref:System.Messaging.MessageQueue> istanza, il messaggio non sarà reperibile.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2758">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="e0ac9-2759">Utilizzare questo overload del metodo <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> quando è accettabile per il thread corrente resti bloccato fino a quando i nuovi messaggi continuano a arrivano nella coda entro il periodo di timeout specificato il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2759">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="e0ac9-2760">Il thread verrà bloccato per il periodo di tempo specificato o per un periodo illimitato se è stato specificato il valore <xref:System.Messaging.MessageQueue.InfiniteTimeout> per il `timeout` parametro, o se i nuovi messaggi continuano a arrivano nella coda entro il periodo di timeout specificato il `timeout` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2760">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2761">Se questo metodo viene chiamato per ricevere un messaggio da una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2761">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2762">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2762">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2763">Altri due metodi consentono di ricevere messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2763">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="e0ac9-2764">Il <xref:System.Messaging.MessageQueue.Receive%2A> metodo restituisce il primo messaggio nella coda e il <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> metodo viene utilizzato per recuperare un riconoscimento, un report o un messaggio di risposta generati dall'applicazione che è stato creato come risultato di un messaggio inviato alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2764">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2765">Per leggere un messaggio con un identificatore specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2765">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="e0ac9-2766">Il <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> metodo restituisce sempre il primo messaggio nella coda, in modo che le successive chiamate al metodo di restituiranno lo stesso messaggio, a meno che un messaggio con priorità più alta arriva nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2766">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="e0ac9-2767">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2767">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="e0ac9-2768">Poiché <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> non rimuove i messaggi nella coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2768">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2769">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2769">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2770">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2770">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2771">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2771">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2772">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2772">Local computer</span></span>|<span data-ttu-id="e0ac9-2773">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2773">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2774">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2774">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2775">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2775">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2776">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2776">Remote computer</span></span>|<span data-ttu-id="e0ac9-2777">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2777">No</span></span>|  
|<span data-ttu-id="e0ac9-2778">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2778">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2779">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2779">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2780">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2780">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#19](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#19)]
 [!code-csharp[MessageQueue2#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2781">Il valore del parametro <paramref name="id" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2781">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-2782">Il valore specificato per il parametro <paramref name="timeout" /> non è valido, probabilmente perché <paramref name="timeout" /> è minore di <see cref="F:System.TimeSpan.Zero" /> o maggiore di <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2782">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2783">Un messaggio con il parametro <paramref name="id" /> specificato non è arrivato nella coda prima della scadenza del timeout.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2783">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="e0ac9-2784">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2784">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2785">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2785">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-2786">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2786">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2787">Introdotto in MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2787">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="e0ac9-2788">Riceve un messaggio specifico della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2788">Receives a specific message from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2789">Il messaggio può essere specificato da un identificatore di ricerca o in base alla relativa posizione all'inizio o alla fine della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2789">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(long lookupId);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : int64 -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId lookupId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="lookupId">
          <span data-ttu-id="e0ac9-2790">Oggetto <see cref="P:System.Messaging.Message.LookupId" /> del messaggio da ricevere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2790">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2791">Introdotto in MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2791">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="e0ac9-2792">Riceve il messaggio che corrisponde all'identificatore di ricerca specificato da una coda non transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2792">Receives the message that matches the given lookup identifier from a non-transactional queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2793">Oggetto <see cref="T:System.Messaging.Message" /> la cui proprietà <see cref="P:System.Messaging.Message.LookupId" /> corrisponde al parametro <paramref name="lookupId" /> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2793">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2794">Usare questo metodo per leggere un messaggio con un identificatore di ricerca note e rimuoverlo dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2794">Use this method to read a message with a known lookup identifier and remove it from the queue.</span></span> <span data-ttu-id="e0ac9-2795">Questo metodo genera un'eccezione immediatamente se il messaggio non è presente nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2795">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2796">Il <xref:System.Messaging.Message.LookupId%2A> proprietà di un messaggio è univoca per la coda in cui si trova il messaggio, in modo che esisterà al massimo un messaggio nella coda che corrisponde al determinato `lookupId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2796">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2797">Per leggere un messaggio con un identificatore di ricerca specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2797">To read a message with a specified lookup identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="e0ac9-2798">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2798">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2799">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2799">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2800">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2800">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2801">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2801">Local computer</span></span>|<span data-ttu-id="e0ac9-2802">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2802">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2803">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2803">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2804">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2804">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2805">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2805">Remote computer</span></span>|<span data-ttu-id="e0ac9-2806">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2806">No</span></span>|  
|<span data-ttu-id="e0ac9-2807">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2807">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2808">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2808">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="e0ac9-2809">MSMQ 3.0 non è installato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2809">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2810">Impossibile trovare il messaggio con il parametro <paramref name="lookupId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2810">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2811">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2811">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : System.Messaging.MessageLookupAction * int64 * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId (action, lookupId, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" />
        <Parameter Name="lookupId" Type="System.Int64" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="action">
          <span data-ttu-id="e0ac9-2812">Uno dei valori di <see cref="T:System.Messaging.MessageLookupAction" />, che specifica come deve essere letto il messaggio nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2812">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2813">Specificare uno dei valori seguenti:</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2813">Specify one of the following:</span>
          </span>
          <span data-ttu-id="e0ac9-2814">
            <see langword="MessageLookupAction.Current" />: riceve il messaggio specificato da <c>lookupId</c> e lo rimuove dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2814">
              <see langword="MessageLookupAction.Current" />: Receives the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2815">
            <see langword="MessageLookupAction.Next" />: riceve il messaggio che segue il messaggio specificato da <c>lookupId</c> e lo rimuove dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2815">
              <see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2816">
            <see langword="MessageLookupAction.Previous" />: riceve il messaggio che precede il messaggio specificato da <c>lookupId</c> e lo rimuove dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2816">
              <see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2817">
            <see langword="MessageLookupAction.First" />: riceve il primo messaggio della coda e lo rimuove da quest'ultima.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2817">
              <see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2818">È necessario che il parametro <c>lookupId</c> sia impostato su 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2818">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
          <span data-ttu-id="e0ac9-2819">
            <see langword="MessageLookupAction.Last" />: riceve l'ultimo messaggio della coda e lo rimuove da quest'ultima.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2819">
              <see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2820">È necessario che il parametro <c>lookupId</c> sia impostato su 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2820">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
        </param>
        <param name="lookupId">
          <span data-ttu-id="e0ac9-2821">Oggetto <see cref="P:System.Messaging.Message.LookupId" /> del messaggio da ricevere oppure 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2821">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span>
          </span>
          <span data-ttu-id="e0ac9-2822">0 viene utilizzato quando si accede al primo o all'ultimo messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2822">0 is used when accessing the first or last message in the queue.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="e0ac9-2823">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2823">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2824">Introdotto in MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2824">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="e0ac9-2825">Riceve un messaggio specifico da una coda transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2825">Receives a specific message from a transactional queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2826">Il messaggio può essere specificato da un identificatore di ricerca o in base alla relativa posizione all'inizio o alla fine della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2826">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2827">Oggetto <see cref="T:System.Messaging.Message" /> specificato dai parametri <paramref name="lookupId" /> e <paramref name="action" /> passati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2827">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="lookupId" /> and <paramref name="action" /> parameters passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2828">Usare questo metodo per leggere un messaggio con un identificatore di ricerca note e lo rimuove dalla coda, utilizzando un contesto di transazione definito dal `transaction` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2828">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="e0ac9-2829">Questo metodo genera un'eccezione immediatamente se il messaggio non è presente nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2829">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2830">Il <xref:System.Messaging.Message.LookupId%2A> proprietà di un messaggio è univoca per la coda in cui si trova il messaggio, in modo che esisterà al massimo un messaggio nella coda che corrisponde al determinato `lookupId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2830">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2831">Poiché questo metodo viene chiamato su una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2831">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2832">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2832">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2833">Per leggere un messaggio con un identificatore specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2833">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="e0ac9-2834">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2834">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="e0ac9-2835">Poiché <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> non rimuove i messaggi dalla coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2835">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2836">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2836">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2837">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2837">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2838">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2838">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2839">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2839">Local computer</span></span>|<span data-ttu-id="e0ac9-2840">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2840">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2841">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2841">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2842">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2842">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2843">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2843">Remote computer</span></span>|<span data-ttu-id="e0ac9-2844">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2844">No</span></span>|  
|<span data-ttu-id="e0ac9-2845">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2845">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2846">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2846">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="e0ac9-2847">MSMQ 3.0 non è installato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2847">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2848">Impossibile trovare il messaggio con il parametro <paramref name="lookupId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2848">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2849">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2849">An error occurred when accessing a Message Queuing method.</span>
          </span>
          <span data-ttu-id="e0ac9-2850">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2850">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2851">La coda non è transazionale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2851">The queue is non-transactional.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-2852">Il parametro <paramref name="action" /> non è uno dei membri di <see cref="T:System.Messaging.MessageLookupAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2852">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : System.Messaging.MessageLookupAction * int64 * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId (action, lookupId, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" />
        <Parameter Name="lookupId" Type="System.Int64" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="action">
          <span data-ttu-id="e0ac9-2853">Uno dei valori di <see cref="T:System.Messaging.MessageLookupAction" />, che specifica come deve essere letto il messaggio nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2853">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2854">Specificare uno dei valori seguenti:</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2854">Specify one of the following:</span>
          </span>
          <span data-ttu-id="e0ac9-2855">
            <see langword="MessageLookupAction.Current" />: riceve il messaggio specificato da <c>lookupId</c> e lo rimuove dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2855">
              <see langword="MessageLookupAction.Current" />: Receives the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2856">
            <see langword="MessageLookupAction.Next" />: riceve il messaggio che segue il messaggio specificato da <c>lookupId</c> e lo rimuove dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2856">
              <see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2857">
            <see langword="MessageLookupAction.Previous" />: riceve il messaggio che precede il messaggio specificato da <c>lookupId</c> e lo rimuove dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2857">
              <see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2858">
            <see langword="MessageLookupAction.First" />: riceve il primo messaggio della coda e lo rimuove da quest'ultima.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2858">
              <see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2859">È necessario che il parametro <c>lookupId</c> sia impostato su 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2859">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
          <span data-ttu-id="e0ac9-2860">
            <see langword="MessageLookupAction.Last" />: riceve l'ultimo messaggio della coda e lo rimuove da quest'ultima.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2860">
              <see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2861">È necessario che il parametro <c>lookupId</c> sia impostato su 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2861">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
        </param>
        <param name="lookupId">
          <span data-ttu-id="e0ac9-2862">Oggetto <see cref="P:System.Messaging.Message.LookupId" /> del messaggio da ricevere oppure 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2862">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span>
          </span>
          <span data-ttu-id="e0ac9-2863">0 viene utilizzato quando si accede al primo o all'ultimo messaggio della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2863">0 is used when accessing the first or last message in the queue.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-2864">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2864">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2865">Introdotto in MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2865">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="e0ac9-2866">Riceve un messaggio specifico della coda, utilizzando il contesto di transazione specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2866">Receives a specific message from the queue, using the specified transaction context.</span>
          </span>
          <span data-ttu-id="e0ac9-2867">Il messaggio può essere specificato da un identificatore di ricerca o in base alla relativa posizione all'inizio o alla fine della coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2867">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="e0ac9-2868">Oggetto <see cref="T:System.Messaging.Message" /> specificato dai parametri <paramref name="action" /> e <paramref name="lookupId" /> passati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2868">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2869">Usare questo metodo per leggere un messaggio con un identificatore di ricerca note e lo rimuove dalla coda, utilizzando un contesto di transazione definito dal `transactionType` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2869">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="e0ac9-2870">Questo metodo genera un'eccezione immediatamente se il messaggio non è presente nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2870">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2871">Il <xref:System.Messaging.Message.LookupId%2A> proprietà di un messaggio è univoca per la coda in cui si trova il messaggio, in modo che esisterà al massimo un messaggio nella coda che corrisponde al determinato `lookupId` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2871">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2872">Per leggere un messaggio con un identificatore specificato senza rimuoverlo dalla coda, usare il <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2872">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="e0ac9-2873">Nessun contesto di transazione associata a un messaggio restituito da una chiamata a <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2873">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="e0ac9-2874">Poiché <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> non rimuove i messaggi dalla coda, non vi sarà alcuna operazione per eseguire il rollback della transazione sono state interrotte.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2874">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="e0ac9-2875">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per ricevere il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2875">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="e0ac9-2876">Specificare `Single` se si desidera ricevere il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2876">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-2877">È possibile specificare `None` se si desidera ricevere un messaggio da una coda transazionale all'esterno di un contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2877">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="e0ac9-2878">Se questo metodo viene chiamato per ricevere un messaggio da una coda transazionale, il messaggio ricevuto viene restituito alla coda se la transazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2878">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="e0ac9-2879">Il messaggio non verrà rimosso definitivamente dalla coda fino a quando non viene eseguito il commit della transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2879">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="e0ac9-2880">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2880">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2881">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2881">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2882">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2882">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2883">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2883">Local computer</span></span>|<span data-ttu-id="e0ac9-2884">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2884">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2885">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2885">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2886">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2886">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2887">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2887">Remote computer</span></span>|<span data-ttu-id="e0ac9-2888">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2888">No</span></span>|  
|<span data-ttu-id="e0ac9-2889">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2889">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2890">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2890">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="e0ac9-2891">MSMQ 3.0 non è installato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2891">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="e0ac9-2892">Impossibile trovare il messaggio con il parametro <paramref name="lookupId" /> specificato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2892">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2893">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2893">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-2894">Il parametro <paramref name="action" /> non è uno dei membri di <see cref="T:System.Messaging.MessageLookupAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2894">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span>
          </span>
          <span data-ttu-id="e0ac9-2895">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2895">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2896">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2896">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event ReceiveCompleted As ReceiveCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::ReceiveCompletedEventHandler ^ ReceiveCompleted;" />
      <MemberSignature Language="F#" Value="member this.ReceiveCompleted : System.Messaging.ReceiveCompletedEventHandler " Usage="member this.ReceiveCompleted : System.Messaging.ReceiveCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReceiveCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.ReceiveCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2897">Viene generato quando un messaggio è stato rimosso dalla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2897">Occurs when a message has been removed from the queue.</span>
          </span>
          <span data-ttu-id="e0ac9-2898">Questo evento viene generato dall'operazione asincrona <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2898">This event is raised by the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2899"><xref:System.Messaging.MessageQueue.BeginReceive%2A> viene utilizzato per generare l'elaborazione asincrona di <xref:System.Messaging.MessageQueue.ReceiveCompleted> evento quando un messaggio sia disponibile nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2899"><xref:System.Messaging.MessageQueue.BeginReceive%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2900"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> viene usato per completare l'operazione avviata da una chiamata a <xref:System.Messaging.MessageQueue.BeginReceive%2A> e visualizza il messaggio quando il <xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2900"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> and peek the message when the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="e0ac9-2901">Quando si crea un delegato <xref:System.Messaging.ReceiveCompletedEventHandler>, si identifica il metodo che gestirà l'evento.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2901">When you create a <xref:System.Messaging.ReceiveCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="e0ac9-2902">Per associare l'evento al gestore eventi in uso, aggiungere all'evento un'istanza del delegato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2902">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="e0ac9-2903">Il gestore eventi viene chiamato ogni volta che si verifica l'evento, a meno che non venga rimosso il delegato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2903">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="e0ac9-2904">Per altre informazioni sui delegati del gestore eventi, vedere [la gestione e generazione di eventi](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2904">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2905">L'esempio di codice seguente crea un gestore eventi denominato `MyReceiveCompleted`, lo collega al <xref:System.Messaging.MessageQueue.ReceiveCompleted> delegato del gestore eventi e chiamate <xref:System.Messaging.MessageQueue.BeginReceive%2A> per avviare un'operazione di ricezione asincrona in coda che si trova nel percorso ". \myQueue".</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2905">The following code example creates an event handler named `MyReceiveCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> to initiate an asynchronous receive operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="e0ac9-2906">Quando un <xref:System.Messaging.MessageQueue.ReceiveCompleted> viene generato l'evento, l'esempio riceve il messaggio e scrive il corpo sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2906">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the example receives the message and writes its body to the screen.</span></span> <span data-ttu-id="e0ac9-2907">Nell'esempio viene quindi chiamato <xref:System.Messaging.MessageQueue.BeginReceive%2A> nuovamente per avviare una nuova asincrona operazione di ricezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2907">The example then calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> again to initiate a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CPP/mqreceivecompletedeventhandler.cpp#1)]
 [!code-csharp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CS/mqreceivecompletedeventhandler.cs#1)]
 [!code-vb[MessageQueue.ReceiveCompleted#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/VB/mqreceivecompletedeventhandler.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Refresh">
      <MemberSignature Language="C#" Value="public void Refresh ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Refresh() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Refresh" />
      <MemberSignature Language="VB.NET" Value="Public Sub Refresh ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Refresh();" />
      <MemberSignature Language="F#" Value="member this.Refresh : unit -&gt; unit" Usage="messageQueue.Refresh " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2908">Aggiorna le proprietà presentate da <see cref="T:System.Messaging.MessageQueue" /> per riflettere lo stato corrente della risorsa.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2908">Refreshes the properties presented by the <see cref="T:System.Messaging.MessageQueue" /> to reflect the current state of the resource.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2909"><xref:System.Messaging.MessageQueue.Refresh%2A> Consente di sincronizzare le proprietà di un <xref:System.Messaging.MessageQueue> con la risorsa server Accodamento messaggi associata.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2909"><xref:System.Messaging.MessageQueue.Refresh%2A> synchronizes the properties of a <xref:System.Messaging.MessageQueue> with its associated Message Queuing server resource.</span></span> <span data-ttu-id="e0ac9-2910">Se qualsiasi proprietà, come <xref:System.Messaging.MessageQueue.Label%2A> o <xref:System.Messaging.MessageQueue.Category%2A>, è stato modificato nel server dal momento la <xref:System.Messaging.MessageQueue> è stata creata, <xref:System.Messaging.MessageQueue.Refresh%2A> aggiornamenti il <xref:System.Messaging.MessageQueue> con le nuove informazioni.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2910">If any property, such as <xref:System.Messaging.MessageQueue.Label%2A> or <xref:System.Messaging.MessageQueue.Category%2A>, has changed on the server since the time the <xref:System.Messaging.MessageQueue> was created, <xref:System.Messaging.MessageQueue.Refresh%2A> updates the <xref:System.Messaging.MessageQueue> with the new information.</span></span>  
  
 <span data-ttu-id="e0ac9-2911">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2911">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2912">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2912">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2913">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2913">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2914">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2914">Local computer</span></span>|<span data-ttu-id="e0ac9-2915">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2915">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2916">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2916">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2917">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2917">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2918">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2918">Remote computer</span></span>|<span data-ttu-id="e0ac9-2919">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2919">No</span></span>|  
|<span data-ttu-id="e0ac9-2920">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2920">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2921">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2921">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2922">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.Refresh%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2922">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Refresh%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#28](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#28)]
 [!code-csharp[MessageQueue2#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ResetPermissions">
      <MemberSignature Language="C#" Value="public void ResetPermissions ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ResetPermissions() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ResetPermissions" />
      <MemberSignature Language="VB.NET" Value="Public Sub ResetPermissions ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ResetPermissions();" />
      <MemberSignature Language="F#" Value="member this.ResetPermissions : unit -&gt; unit" Usage="messageQueue.ResetPermissions " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2923">Reimposta l'elenco delle autorizzazioni sui valori predefiniti del sistema operativo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2923">Resets the permission list to the operating system's default values.</span>
          </span>
          <span data-ttu-id="e0ac9-2924">Rimuove tutte le autorizzazioni relative alla coda aggiunte all'elenco predefinito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2924">Removes any queue permissions you have appended to the default list.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2925">Quando si chiama <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, si restituisce l'elenco di autorizzazioni sui valori predefiniti.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2925">When you call <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, you return the permission list to its default values.</span></span> <span data-ttu-id="e0ac9-2926">In genere, si concede tutte le autorizzazioni al creatore della coda e concede al gruppo Everyone diritti seguenti:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2926">Generally, this grants the queue creator all permissions, and gives the group Everyone the following rights:</span></span>  
  
-   <span data-ttu-id="e0ac9-2927">Ottenere le proprietà della coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2927">Get the properties of the queue.</span></span>  
  
-   <span data-ttu-id="e0ac9-2928">Ottenere le autorizzazioni delle code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2928">Get queue permissions.</span></span>  
  
-   <span data-ttu-id="e0ac9-2929">Scrivere nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2929">Write to the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-2930">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2930">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2931">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2931">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2932">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2932">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2933">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2933">Local computer</span></span>|<span data-ttu-id="e0ac9-2934">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2934">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2935">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2935">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2936">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2936">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2937">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2937">Remote computer</span></span>|<span data-ttu-id="e0ac9-2938">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2938">No</span></span>|  
|<span data-ttu-id="e0ac9-2939">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2939">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2940">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2940">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2941">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2941">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#27](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#27)]
 [!code-csharp[MessageQueue2#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2942">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2942">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Send">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-2943">Invia un oggetto a una coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2943">Sends an object to a queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj);" />
      <MemberSignature Language="F#" Value="member this.Send : obj -&gt; unit" Usage="messageQueue.Send obj" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="e0ac9-2944">Oggetto da inviare alla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2944">The object to send to the queue.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2945">Invia un oggetto alla coda non transazionale a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2945">Sends an object to non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2946">Utilizzare questo overload per inviare un messaggio che contiene il `obj` parametro per la coda cui fa riferimento il <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2946">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="e0ac9-2947">L'oggetto inviato nella coda può essere un <xref:System.Messaging.Message> o qualsiasi oggetto gestito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2947">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="e0ac9-2948">Se si invia un oggetto diverso da un <xref:System.Messaging.Message>, l'oggetto viene serializzato e inserito nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2948">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="e0ac9-2949">Se si utilizza questo overload per inviare un messaggio a una coda transazionale, il messaggio verrà inviato per la coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2949">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="e0ac9-2950">Se si desidera che il messaggio da parte di una transazione che contiene altri messaggi, usare un overload che accetta un <xref:System.Messaging.MessageQueueTransaction> o <xref:System.Messaging.MessageQueueTransactionType> come parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2950">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-2951">Se non si impostano i <xref:System.Messaging.MessageQueue.Formatter%2A> proprietà prima di chiamare <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, per impostazione predefinita il formattatore di <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2951">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="e0ac9-2952">Il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> proprietà si applica a qualsiasi oggetto diverso da un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2952">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="e0ac9-2953">Se si specifica, ad esempio, un'etichetta o una priorità usando il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membro, questi valori vengono applicati a qualsiasi messaggio che contiene un oggetto che non è di tipo <xref:System.Messaging.Message> quando l'applicazione li invia alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2953">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="e0ac9-2954">Durante l'invio di un <xref:System.Messaging.Message>, impostare i valori delle proprietà per il <xref:System.Messaging.Message> hanno la precedenza sulle <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> e il messaggio <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> avrà la precedenza su della coda <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2954">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="e0ac9-2955">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2955">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2956">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2956">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2957">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2957">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2958">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2958">Local computer</span></span>|<span data-ttu-id="e0ac9-2959">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2959">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2960">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2960">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2961">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2961">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2962">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2962">Remote computer</span></span>|<span data-ttu-id="e0ac9-2963">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2963">No</span></span>|  
|<span data-ttu-id="e0ac9-2964">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2964">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2965">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2965">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2966">Esempio di codice seguente si connette a una coda di messaggi e invia un messaggio alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2966">The following code example connects to a message queue and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_obj#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_obj/CPP/mqsend_generic.cpp#1)]
 [!code-csharp[MessageQueue.Send_obj#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_obj/CS/mqsend_generic.cs#1)]
 [!code-vb[MessageQueue.Send_obj#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_obj/VB/mqsend_generic.vb#1)]  
  
 <span data-ttu-id="e0ac9-2967">L'esempio di codice seguente invia definito dall'applicazione `Order` classe a una coda e quindi riceve un messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2967">The following code example sends an application-defined `Order` class to a queue and then receives a message from that queue.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2968">La proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> non è stata impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2968">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="e0ac9-2969">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2969">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-2970">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2970">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * System.Messaging.MessageQueueTransaction -&gt; unit" Usage="messageQueue.Send (obj, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="e0ac9-2971">Oggetto da inviare alla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2971">The object to send to the queue.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="e0ac9-2972">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2972">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-2973">Invia un oggetto alla coda transazionale a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2973">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-2974">Utilizzare questo overload per inviare un messaggio che contiene il `obj` parametro alla coda transazionale a cui fa riferimento il <xref:System.Messaging.MessageQueue>, utilizzando un contesto di transazione interna definito dal `transaction` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2974">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="e0ac9-2975">L'oggetto inviato nella coda può essere un <xref:System.Messaging.Message> o qualsiasi oggetto gestito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2975">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="e0ac9-2976">Se si invia un oggetto diverso da un <xref:System.Messaging.Message>, l'oggetto viene serializzato e inserito nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2976">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="e0ac9-2977">Se si utilizza questo overload per inviare un messaggio a una coda non transazionale, il messaggio potrebbe essere inviato per la coda di messaggi non recapitabili senza generare un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2977">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="e0ac9-2978">Se non si impostano i <xref:System.Messaging.MessageQueue.Formatter%2A> proprietà prima di chiamare <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, per impostazione predefinita il formattatore di <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2978">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="e0ac9-2979">Il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> proprietà si applica a qualsiasi oggetto diverso da un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2979">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="e0ac9-2980">Se si specifica, ad esempio, un'etichetta o una priorità usando il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membro, questi valori vengono applicati a qualsiasi messaggio che contiene un oggetto che non è di tipo <xref:System.Messaging.Message> quando l'applicazione li invia alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2980">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="e0ac9-2981">Durante l'invio di un <xref:System.Messaging.Message>, impostare i valori delle proprietà per il <xref:System.Messaging.Message> hanno la precedenza sulle <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> e il messaggio <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> avrà la precedenza su della coda <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2981">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="e0ac9-2982"><xref:System.Messaging.MessageQueueTransaction> il threading apartment, pertanto se lo stato di apartment è `STA`, è possibile utilizzare la transazione in più thread.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2982"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="e0ac9-2983">Visual Basic imposta lo stato del thread principale per `STA`, pertanto è necessario applicare il <xref:System.MTAThreadAttribute> nel `Main` subroutine.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2983">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="e0ac9-2984">In caso contrario, l'invio di un messaggio transazionale mediante un altro thread genererà un'eccezione <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2984">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="e0ac9-2985">Si applica il <xref:System.MTAThreadAttribute> usando il frammento seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2985">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="e0ac9-2986">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2986">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-2987">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2987">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-2988">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2988">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-2989">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2989">Local computer</span></span>|<span data-ttu-id="e0ac9-2990">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2990">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2991">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2991">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2992">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2992">Yes</span></span>|  
|<span data-ttu-id="e0ac9-2993">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2993">Remote computer</span></span>|<span data-ttu-id="e0ac9-2994">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2994">No</span></span>|  
|<span data-ttu-id="e0ac9-2995">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2995">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-2996">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2996">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-2997">Esempio di codice seguente invia una stringa a una coda transazionale e quindi riceve un messaggio dalla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-2997">The following code example sends a string to a transactional queue and then receives a message from that queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CPP/mqsend_objtransaction.cpp#1)]
 [!code-csharp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CS/mqsend_objtransaction.cs#1)]
 [!code-vb[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/VB/mqsend_objtransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-2998">Il valore del parametro <paramref name="transaction" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2998">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-2999">La proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> non è stata impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-2999">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="e0ac9-3000">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3000">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-3001">Nell'applicazione Accodamento messaggi è stato segnalato un utilizzo non corretto delle transazioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3001">The Message Queuing application indicated an incorrect transaction use.</span>
          </span>
          <span data-ttu-id="e0ac9-3002">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3002">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-3003">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3003">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * System.Messaging.MessageQueueTransactionType -&gt; unit" Usage="messageQueue.Send (obj, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="e0ac9-3004">Oggetto da inviare alla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3004">The object to send to the queue.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-3005">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3005">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-3006">Invia un oggetto alla coda a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3006">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3007">Utilizzare questo overload per inviare un messaggio che contiene il `obj` parametro alla coda a cui fa riferimento il <xref:System.Messaging.MessageQueue>, utilizzando un contesto di transazione definito dal `transactionType` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3007">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="e0ac9-3008">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per inviare il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3008">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="e0ac9-3009">Specificare `Single` se si desidera inviare il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3009">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-3010">È possibile specificare `None` se si desidera inviare un messaggio transazionale a un thread non transazionale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3010">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="e0ac9-3011">L'oggetto inviato nella coda può essere un <xref:System.Messaging.Message> o qualsiasi oggetto gestito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3011">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="e0ac9-3012">Se si invia un oggetto diverso da un <xref:System.Messaging.Message>, l'oggetto viene serializzato e inserito nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3012">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="e0ac9-3013">Se non si impostano i <xref:System.Messaging.MessageQueue.Formatter%2A> proprietà prima di chiamare <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, per impostazione predefinita il formattatore di <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3013">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="e0ac9-3014">Il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> proprietà si applica a qualsiasi oggetto diverso da un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3014">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="e0ac9-3015">Se si specifica, ad esempio, un'etichetta o una priorità usando il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membro, questi valori vengono applicati a qualsiasi messaggio che contiene un oggetto che non è di tipo <xref:System.Messaging.Message> quando l'applicazione li invia alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3015">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="e0ac9-3016">Durante l'invio di un <xref:System.Messaging.Message>, impostare i valori delle proprietà per il <xref:System.Messaging.Message> hanno la precedenza sulle <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> e il messaggio <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> avrà la precedenza su della coda <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3016">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="e0ac9-3017">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3017">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3018">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3018">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3019">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3019">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3020">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3020">Local computer</span></span>|<span data-ttu-id="e0ac9-3021">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3021">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3022">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3022">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3023">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3023">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3024">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3024">Remote computer</span></span>|<span data-ttu-id="e0ac9-3025">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3025">No</span></span>|  
|<span data-ttu-id="e0ac9-3026">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3026">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3027">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3027">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3028">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3028">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#2)]
 [!code-csharp[MessageQueue2#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-3029">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3029">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3030">La proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> non è stata impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3030">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="e0ac9-3031">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3031">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-3032">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3032">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string -&gt; unit" Usage="messageQueue.Send (obj, label)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="e0ac9-3033">Oggetto da inviare alla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3033">The object to send to the queue.</span>
          </span>
        </param>
        <param name="label">
          <span data-ttu-id="e0ac9-3034">L'etichetta del messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3034">The label of the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-3035">Invia un oggetto alla coda non transazionale a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento e specifica un'etichetta per il messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3035">Sends an object to the non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3036">Utilizzare questo overload per inviare un messaggio che contiene il `obj` parametro per la coda cui fa riferimento il <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3036">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="e0ac9-3037">Con questo overload, è possibile specificare l'etichetta di stringa che identifica il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3037">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="e0ac9-3038">L'oggetto inviato nella coda può essere un <xref:System.Messaging.Message>, una struttura, un oggetto dati o qualsiasi oggetto gestito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3038">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="e0ac9-3039">Se si invia un oggetto diverso da un <xref:System.Messaging.Message>, l'oggetto viene serializzato e inserito nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3039">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="e0ac9-3040">L'etichetta del messaggio è distinto dall'etichetta della coda di messaggi, ma entrambi sono dipendenti dall'applicazione e non hanno alcun significato di ereditarietà per il servizio Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3040">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="e0ac9-3041">Se si utilizza questo overload per inviare un messaggio a una coda transazionale, il messaggio verrà inviato per la coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3041">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="e0ac9-3042">Se si desidera che il messaggio da parte di una transazione che contiene altri messaggi, usare un overload che accetta un <xref:System.Messaging.MessageQueueTransaction> o <xref:System.Messaging.MessageQueueTransactionType> come parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3042">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-3043">Il <xref:System.Messaging.MessageQueue.Path%2A> proprietà per questo <xref:System.Messaging.MessageQueue> istanza deve essere specificata prima di inviare il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3043">The <xref:System.Messaging.MessageQueue.Path%2A> property for this <xref:System.Messaging.MessageQueue> instance must be specified before you send the message.</span></span> <span data-ttu-id="e0ac9-3044">Se non si impostano i <xref:System.Messaging.MessageQueue.Formatter%2A> proprietà prima di chiamare <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, per impostazione predefinita il formattatore di <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3044">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="e0ac9-3045">Il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> proprietà si applica a qualsiasi oggetto diverso da un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3045">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="e0ac9-3046">Se si specifica, ad esempio, un'etichetta o una priorità usando il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membro, questi valori vengono applicati a qualsiasi messaggio che contiene un oggetto che non è di tipo <xref:System.Messaging.Message> quando l'applicazione li invia alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3046">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="e0ac9-3047">Durante l'invio di un <xref:System.Messaging.Message>, impostare i valori delle proprietà per il <xref:System.Messaging.Message> hanno la precedenza sulle <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> e il messaggio <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> avrà la precedenza su della coda <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3047">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="e0ac9-3048">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3048">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3049">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3049">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3050">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3050">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3051">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3051">Local computer</span></span>|<span data-ttu-id="e0ac9-3052">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3052">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3053">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3053">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3054">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3054">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3055">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3055">Remote computer</span></span>|<span data-ttu-id="e0ac9-3056">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3056">No</span></span>|  
|<span data-ttu-id="e0ac9-3057">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3057">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3058">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3058">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3059">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3059">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue2#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-3060">Il valore del parametro <paramref name="label" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3060">The <paramref name="label" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3061">La proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> non è stata impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3061">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="e0ac9-3062">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3062">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-3063">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3063">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string * System.Messaging.MessageQueueTransaction -&gt; unit" Usage="messageQueue.Send (obj, label, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="e0ac9-3064">Oggetto da inviare alla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3064">The object to send to the queue.</span>
          </span>
        </param>
        <param name="label">
          <span data-ttu-id="e0ac9-3065">L'etichetta del messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3065">The label of the message.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="e0ac9-3066">Oggetto <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3066">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-3067">Invia un oggetto alla coda transazionale a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento e specifica un'etichetta per il messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3067">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3068">Utilizzare questo overload per inviare un messaggio che contiene il `obj` parametro alla coda transazionale a cui fa riferimento il <xref:System.Messaging.MessageQueue>, utilizzando un contesto di transazione interna definito dal `transaction` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3068">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="e0ac9-3069">Con questo overload, è possibile specificare l'etichetta di stringa che identifica il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3069">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="e0ac9-3070">L'oggetto inviato nella coda può essere un <xref:System.Messaging.Message>, una struttura, un oggetto dati o qualsiasi oggetto gestito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3070">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="e0ac9-3071">Se si invia un oggetto diverso da un <xref:System.Messaging.Message>, l'oggetto viene serializzato e inserito nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3071">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="e0ac9-3072">L'etichetta del messaggio è distinto dall'etichetta della coda di messaggi, ma entrambi sono dipendenti dall'applicazione e non hanno alcun significato di ereditarietà per il servizio Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3072">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="e0ac9-3073">Se si utilizza questo overload per inviare un messaggio a una coda non transazionale, il messaggio potrebbe essere inviato per la coda di messaggi non recapitabili senza generare un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3073">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="e0ac9-3074">Se non si impostano i <xref:System.Messaging.MessageQueue.Formatter%2A> proprietà prima di chiamare <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, per impostazione predefinita il formattatore di <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3074">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="e0ac9-3075">Il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> proprietà si applica a qualsiasi oggetto diverso da un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3075">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="e0ac9-3076">Se si specifica, ad esempio, un'etichetta o una priorità usando il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membro, questi valori vengono applicati a qualsiasi messaggio che contiene un oggetto che non è di tipo <xref:System.Messaging.Message> quando l'applicazione li invia alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3076">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="e0ac9-3077">Durante l'invio di un <xref:System.Messaging.Message>, impostare i valori delle proprietà per il <xref:System.Messaging.Message> hanno la precedenza sulle <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> e il messaggio <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> avrà la precedenza su della coda <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> proprietà</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3077">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property</span></span>  
  
 <span data-ttu-id="e0ac9-3078"><xref:System.Messaging.MessageQueueTransaction> il threading apartment, pertanto se lo stato di apartment è `STA`, è possibile utilizzare la transazione in più thread.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3078"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="e0ac9-3079">Visual Basic imposta lo stato del thread principale per `STA`, pertanto è necessario applicare il <xref:System.MTAThreadAttribute> nel `Main` subroutine.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3079">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="e0ac9-3080">In caso contrario, l'invio di un messaggio transazionale mediante un altro thread genererà un'eccezione <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3080">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="e0ac9-3081">Si applica il <xref:System.MTAThreadAttribute> usando il frammento seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3081">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="e0ac9-3082">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3082">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3083">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3083">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3084">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3084">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3085">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3085">Local computer</span></span>|<span data-ttu-id="e0ac9-3086">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3086">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3087">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3087">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3088">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3088">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3089">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3089">Remote computer</span></span>|<span data-ttu-id="e0ac9-3090">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3090">No</span></span>|  
|<span data-ttu-id="e0ac9-3091">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3091">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3092">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3092">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3093">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3093">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#4](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#4)]
 [!code-csharp[MessageQueue2#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-3094">Il valore del parametro <paramref name="label" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3094">The <paramref name="label" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="e0ac9-3095">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3095">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-3096">Il valore del parametro <paramref name="transaction" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3096">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3097">La proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> non è stata impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3097">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="e0ac9-3098">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3098">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-3099">Nell'applicazione Accodamento messaggi è stato segnalato un utilizzo non corretto delle transazioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3099">The Message Queuing application indicated an incorrect transaction usage.</span>
          </span>
          <span data-ttu-id="e0ac9-3100">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3100">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-3101">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3101">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string * System.Messaging.MessageQueueTransactionType -&gt; unit" Usage="messageQueue.Send (obj, label, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="e0ac9-3102">Oggetto da inviare alla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3102">The object to send to the queue.</span>
          </span>
        </param>
        <param name="label">
          <span data-ttu-id="e0ac9-3103">L'etichetta del messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3103">The label of the message.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="e0ac9-3104">Uno dei valori di <see cref="T:System.Messaging.MessageQueueTransactionType" /> che descrive il tipo di contesto di transazione da associare al messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3104">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-3105">Invia un oggetto alla coda a cui l'oggetto <see cref="T:System.Messaging.MessageQueue" /> fa riferimento e specifica un'etichetta per il messaggio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3105">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3106">Utilizzare questo overload per inviare un messaggio che contiene il `obj` parametro alla coda a cui fa riferimento il <xref:System.Messaging.MessageQueue>, utilizzando un contesto di transazione definito dal `transactionType` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3106">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="e0ac9-3107">Specificare `Automatic` per il `transactionType` parametro se è già presente un contesto di transazione esterno associato al thread che si desidera usare per inviare il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3107">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="e0ac9-3108">Specificare `Single` se si desidera inviare il messaggio come una singola transazione interna.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3108">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="e0ac9-3109">È possibile specificare `None` se si desidera inviare un messaggio transazionale a un thread non transazionale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3109">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="e0ac9-3110">L'oggetto inviato nella coda può essere un <xref:System.Messaging.Message> o qualsiasi oggetto gestito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3110">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="e0ac9-3111">Se si invia un oggetto diverso da un <xref:System.Messaging.Message>, l'oggetto viene serializzato e inserito nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3111">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span> <span data-ttu-id="e0ac9-3112">Con questo overload, è possibile specificare l'etichetta di stringa che identifica il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3112">With this overload, you can specify the string label that identifies the message.</span></span>  
  
 <span data-ttu-id="e0ac9-3113">L'etichetta del messaggio è distinto dall'etichetta della coda di messaggi, ma entrambi sono dipendenti dall'applicazione e non hanno alcun significato di ereditarietà per il servizio Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3113">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="e0ac9-3114">Se non si impostano i <xref:System.Messaging.MessageQueue.Formatter%2A> proprietà prima di chiamare <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, per impostazione predefinita il formattatore di <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3114">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="e0ac9-3115">Il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> proprietà si applica a qualsiasi oggetto diverso da un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3115">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="e0ac9-3116">Se si specifica, ad esempio, un'etichetta o una priorità usando il <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membro, questi valori vengono applicati a qualsiasi messaggio che contiene un oggetto che non è di tipo <xref:System.Messaging.Message> quando l'applicazione li invia alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3116">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="e0ac9-3117">Durante l'invio di un <xref:System.Messaging.Message>, impostare i valori delle proprietà per il <xref:System.Messaging.Message> hanno la precedenza sulle <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>e il messaggio <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> avrà la precedenza su della coda <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3117">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="e0ac9-3118">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3118">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3119">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3119">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3120">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3120">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3121">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3121">Local computer</span></span>|<span data-ttu-id="e0ac9-3122">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3122">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3123">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3123">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3124">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3124">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3125">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3125">Remote computer</span></span>|<span data-ttu-id="e0ac9-3126">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3126">No</span></span>|  
|<span data-ttu-id="e0ac9-3127">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3127">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3128">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3128">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3129">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3129">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#3](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#3)]
 [!code-csharp[MessageQueue2#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="e0ac9-3130">Il valore del parametro <paramref name="label" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3130">The <paramref name="label" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueTransaction">
          <span data-ttu-id="e0ac9-3131">Nell'applicazione Accodamento messaggi è stato segnalato un utilizzo non corretto delle transazioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3131">The Message Queuing application indicated an incorrect transaction usage.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="e0ac9-3132">Il parametro <paramref name="transactionType" /> non è uno dei membri di <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3132">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3133">La proprietà <see cref="P:System.Messaging.MessageQueue.Path" /> non è stata impostata.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3133">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="e0ac9-3134">oppure</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3134">-or-</span>
          </span>
          <span data-ttu-id="e0ac9-3135">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3135">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetPermissions">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-3136">Aggiunge le autorizzazioni al set di autorizzazioni corrente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3136">Adds permissions to the current set.</span>
          </span>
          <span data-ttu-id="e0ac9-3137">Controlla gli utenti che dispongono dei diritti di accesso alle proprietà della coda e ai messaggi presenti nella coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3137">This controls who has access rights to queue properties and messages in the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.AccessControlList dacl);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.AccessControlList dacl) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.AccessControlList)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (dacl As AccessControlList)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::AccessControlList ^ dacl);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : System.Messaging.AccessControlList -&gt; unit" Usage="messageQueue.SetPermissions dacl" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="dacl" Type="System.Messaging.AccessControlList" />
      </Parameters>
      <Docs>
        <param name="dacl">
          <span data-ttu-id="e0ac9-3138">Oggetto <see cref="T:System.Messaging.AccessControlList" /> contenente una o più voci di controllo di accesso che specificano le terze parti trusted e le autorizzazioni da concedere.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3138">A <see cref="T:System.Messaging.AccessControlList" /> that contains one or more access control entries that specify the trustees and the permissions to grant.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-3139">Assegna i diritti di accesso alla coda in base al contenuto di un elenco di controllo di accesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3139">Assigns access rights to the queue based on the contents of an access control list.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3140">Utilizzare questo overload per concedere, negare o revocare i diritti di utilizzando una raccolta di voci di controllo di accesso per specificare le informazioni di trustee e le autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3140">Use this overload to grant, deny, or revoke rights by using a collection of access control entries to specify trustee and permissions information.</span></span> <span data-ttu-id="e0ac9-3141">Ciò consente, ad esempio, concedere autorizzazioni a più utenti contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3141">This is used, for example, to grant permissions to multiple users at the same time.</span></span>  
  
 <span data-ttu-id="e0ac9-3142">Il fiduciario specificato quando si costruisce la `ace` parametro può essere un singolo utente, un gruppo di utenti o un computer.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3142">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="e0ac9-3143">Se il fiduciario è un singolo utente, usare il formato `DOMAIN` \\ `user`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3143">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="e0ac9-3144">È possibile specificare "." per il dominio trusted indicare il computer locale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3144">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="e0ac9-3145">Le autorizzazioni assegnate tramite <xref:System.Messaging.MessageQueue.SetPermissions%2A> aggiungere le autorizzazioni per l'elenco esistente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3145">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="e0ac9-3146">Per impostazione predefinita, l'autore di una coda pubblica o privata abbia il pieno controllo e il gruppo di dominio Everyone dispone dell'autorizzazione per ottenere le proprietà della coda, ottenere le autorizzazioni e scrivere nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3146">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="e0ac9-3147">Quando si chiama <xref:System.Messaging.MessageQueue.SetPermissions%2A>, le informazioni utente e le autorizzazioni vengono aggiunte alla fine dell'elenco esistente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3147">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="e0ac9-3148">Il sistema esamina ciascuna <xref:System.Messaging.AccessControlEntry> in sequenza fino a quando non si verifica uno degli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3148">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="e0ac9-3149">Un accesso negato <xref:System.Messaging.AccessControlEntry> nega in modo esplicito uno qualsiasi dei diritti di accesso richiesto a una delle fiduciari elencati nel token di accesso del thread.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3149">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="e0ac9-3150">Uno o più Autorizzazione dell'accesso <xref:System.Messaging.AccessControlEntry> elementi per tutti i diritti di accesso richiesto di concessione fiduciari elencati nel token di accesso del thread in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3150">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="e0ac9-3151">Tutti i <xref:System.Messaging.AccessControlEntry> articoli sono stati verificati e vi è ancora presente almeno un diritto di accesso che non è stato esplicitamente concesso, nel qual caso, l'accesso viene implicitamente negato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3151">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="e0ac9-3152">Quando si costruisce il `dacl` parametro, si aggiungono <xref:System.Messaging.AccessControlEntry> alle istanze di <xref:System.Messaging.AccessControlList> raccolta.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3152">When you construct the `dacl` parameter, you add <xref:System.Messaging.AccessControlEntry> instances to your <xref:System.Messaging.AccessControlList> collection.</span></span> <span data-ttu-id="e0ac9-3153">Quando si crea ogni voce di controllo di accesso, è possibile specificare i diritti di accesso generici o standard.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3153">When you construct each access control entry, you can specify generic or standard access rights.</span></span> <span data-ttu-id="e0ac9-3154">I diritti a una coda possono essere qualsiasi combinazione delle operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3154">The rights to a queue can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="e0ac9-3155">Eliminare</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3155">Delete</span></span>  
  
-   <span data-ttu-id="e0ac9-3156">Sicurezza da lettura</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3156">Read Security</span></span>  
  
-   <span data-ttu-id="e0ac9-3157">Protezione da scrittura</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3157">Write Security</span></span>  
  
-   <span data-ttu-id="e0ac9-3158">Sincronizzare</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3158">Synchronize</span></span>  
  
-   <span data-ttu-id="e0ac9-3159">Modifica proprietario</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3159">Modify Owner</span></span>  
  
-   <span data-ttu-id="e0ac9-3160">Lettura</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3160">Read</span></span>  
  
-   <span data-ttu-id="e0ac9-3161">Write</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3161">Write</span></span>  
  
-   <span data-ttu-id="e0ac9-3162">Esegui</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3162">Execute</span></span>  
  
-   <span data-ttu-id="e0ac9-3163">Obbligatorio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3163">Required</span></span>  
  
-   <span data-ttu-id="e0ac9-3164">Tutti</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3164">All</span></span>  
  
-   <span data-ttu-id="e0ac9-3165">nessuno</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3165">None</span></span>  
  
 <span data-ttu-id="e0ac9-3166">Tali diritti sono un set di flag di bit che è possibile combinare utilizzando l'operatore OR bit per bit.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3166">These rights are a set of bit flags that you can combine using the OR bitwise operator.</span></span>  
  
-   <span data-ttu-id="e0ac9-3167">Controllo completo</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3167">Full Control</span></span>  
  
-   <span data-ttu-id="e0ac9-3168">Eliminare messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3168">Delete Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3169">Ricezione messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3169">Receive Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3170">Visualizza il messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3170">Peek Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3171">Ricevi messaggio Journal</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3171">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3172">Ottenere le proprietà della coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3172">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="e0ac9-3173">Impostare le proprietà della coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3173">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="e0ac9-3174">Ottenere le autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3174">Get Permissions</span></span>  
  
-   <span data-ttu-id="e0ac9-3175">Impostare le autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3175">Set Permissions</span></span>  
  
-   <span data-ttu-id="e0ac9-3176">Assumere la proprietà di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3176">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="e0ac9-3177">WriteMessage</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3177">Write Message</span></span>  
  
 <span data-ttu-id="e0ac9-3178">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3178">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3179">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3179">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3180">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3180">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3181">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3181">Local computer</span></span>|<span data-ttu-id="e0ac9-3182">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3182">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3183">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3183">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3184">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3184">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3185">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3185">Remote computer</span></span>|<span data-ttu-id="e0ac9-3186">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3186">No</span></span>|  
|<span data-ttu-id="e0ac9-3187">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3187">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3188">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3188">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3189">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3189">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span></span>      
  
 [!code-cpp[MessageQueue2#26](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#26)]
 [!code-csharp[MessageQueue2#26](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#26)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3190">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3190">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.AccessControlList" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.MessageQueueAccessControlEntry ace);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.MessageQueueAccessControlEntry ace) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.MessageQueueAccessControlEntry)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (ace As MessageQueueAccessControlEntry)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::MessageQueueAccessControlEntry ^ ace);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : System.Messaging.MessageQueueAccessControlEntry -&gt; unit" Usage="messageQueue.SetPermissions ace" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ace" Type="System.Messaging.MessageQueueAccessControlEntry" />
      </Parameters>
      <Docs>
        <param name="ace">
          <span data-ttu-id="e0ac9-3191">Oggetto <see cref="T:System.Messaging.MessageQueueAccessControlEntry" /> che specifica un utente, un tipo di accesso e un tipo di autorizzazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3191">A <see cref="T:System.Messaging.MessageQueueAccessControlEntry" /> that specifies a user, an access type, and a permission type.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-3192">Assegna i diritti di accesso alla coda in base al contenuto di una voce di controllo di accesso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3192">Assigns access rights to the queue based on the contents of an access control entry.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3193">Utilizzare questo overload per concedere, negare o revocare i diritti tramite una voce di controllo di accesso per specificare le informazioni sui diritti e fiduciario.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3193">Use this overload to grant, deny, or revoke rights by using an access control entry to specify trustee and rights information.</span></span>  
  
 <span data-ttu-id="e0ac9-3194">Il fiduciario specificato quando si costruisce la `ace` parametro può essere un singolo utente, un gruppo di utenti o un computer.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3194">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="e0ac9-3195">Se il fiduciario è un singolo utente, usare il formato `DOMAIN` \\ `user`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3195">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="e0ac9-3196">È possibile specificare "." per il dominio trusted indicare il computer locale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3196">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="e0ac9-3197">Le autorizzazioni assegnate tramite <xref:System.Messaging.MessageQueue.SetPermissions%2A> aggiungere le autorizzazioni per l'elenco esistente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3197">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="e0ac9-3198">Per impostazione predefinita, l'autore di una coda pubblica o privata abbia il pieno controllo e il gruppo di dominio Everyone dispone dell'autorizzazione per ottenere le proprietà della coda, ottenere le autorizzazioni e scrivere nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3198">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="e0ac9-3199">Quando si chiama <xref:System.Messaging.MessageQueue.SetPermissions%2A>, le informazioni utente e le autorizzazioni vengono aggiunte alla fine dell'elenco esistente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3199">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="e0ac9-3200">Il sistema esamina ciascuna <xref:System.Messaging.AccessControlEntry> in sequenza fino a quando non si verifica uno degli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3200">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="e0ac9-3201">Un accesso negato <xref:System.Messaging.AccessControlEntry> nega in modo esplicito uno qualsiasi dei diritti di accesso richiesto a una delle fiduciari elencati nel token di accesso del thread.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3201">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="e0ac9-3202">Uno o più Autorizzazione dell'accesso <xref:System.Messaging.AccessControlEntry> elementi per tutti i diritti di accesso richiesto di concessione fiduciari elencati nel token di accesso del thread in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3202">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="e0ac9-3203">Tutti i <xref:System.Messaging.AccessControlEntry> articoli sono stati verificati e vi è ancora presente almeno un diritto di accesso che non è stato esplicitamente concesso, nel qual caso, l'accesso viene implicitamente negato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3203">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="e0ac9-3204">I diritti a una coda, specificata nella `rights` parametro quando si costruisce il <xref:System.Messaging.MessageQueueAccessControlEntry>, può essere qualsiasi combinazione delle opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3204">The rights to a queue, which you specify in the `rights` parameter when you construct your <xref:System.Messaging.MessageQueueAccessControlEntry>, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="e0ac9-3205">Controllo completo</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3205">Full Control</span></span>  
  
-   <span data-ttu-id="e0ac9-3206">Eliminare messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3206">Delete Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3207">Ricezione messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3207">Receive Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3208">Visualizza il messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3208">Peek Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3209">Ricevi messaggio Journal</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3209">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3210">Ottenere le proprietà della coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3210">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="e0ac9-3211">Impostare le proprietà della coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3211">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="e0ac9-3212">Ottenere le autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3212">Get Permissions</span></span>  
  
-   <span data-ttu-id="e0ac9-3213">Impostare le autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3213">Set Permissions</span></span>  
  
-   <span data-ttu-id="e0ac9-3214">Assumere la proprietà di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3214">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="e0ac9-3215">WriteMessage</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3215">Write Message</span></span>  
  
 <span data-ttu-id="e0ac9-3216">Il `rights` parametro specificato nel costruttore per il `ace` parametro è un flag del <xref:System.Messaging.MessageQueueAccessRights> enumerazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3216">The `rights` parameter you specify in the constructor for the `ace` parameter is a flag of the <xref:System.Messaging.MessageQueueAccessRights> enumeration.</span></span> <span data-ttu-id="e0ac9-3217">Rappresenta un set di flag di bit che è possibile combinare l'uso dell'operatore OR bit per bit o quando si compila il `rights` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3217">It represents a set of bit flags that you can combine using the bitwise operator OR when you build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-3218">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3218">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3219">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3219">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3220">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3220">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3221">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3221">Local computer</span></span>|<span data-ttu-id="e0ac9-3222">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3222">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3223">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3223">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3224">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3224">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3225">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3225">Remote computer</span></span>|<span data-ttu-id="e0ac9-3226">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3226">No</span></span>|  
|<span data-ttu-id="e0ac9-3227">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3227">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3228">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3228">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3229">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3229">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#24](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#24)]
 [!code-csharp[MessageQueue2#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3230">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3230">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.MessageQueueAccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : string * System.Messaging.MessageQueueAccessRights -&gt; unit" Usage="messageQueue.SetPermissions (user, rights)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
      </Parameters>
      <Docs>
        <param name="user">
          <span data-ttu-id="e0ac9-3231">Singolo utente, gruppo o computer che ottiene ulteriori diritti per la coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3231">The individual, group, or computer that gets additional rights to the queue.</span>
          </span>
        </param>
        <param name="rights">
          <span data-ttu-id="e0ac9-3232">Elemento <see cref="T:System.Messaging.MessageQueueAccessRights" /> che indica il set di diritti per la coda assegnati da Accodamento messaggi al parametro <c>user</c> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3232">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <c>user</c> passed in.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-3233">Fornisce a un computer, a un gruppo o a un utente i diritti di accesso specificati.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3233">Gives a computer, group, or user the specified access rights.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3234">Utilizzare questo overload per concedere i diritti specificati per un singolo utente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3234">Use this overload to grant specified rights to an individual user.</span></span> <span data-ttu-id="e0ac9-3235">L'utente può essere qualsiasi fiduciario valido, che include i singoli utenti, gruppi di utenti o un computer.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3235">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="e0ac9-3236">Se l'utente è una persona, usare il formato `DOMAIN` \\ `user` per il `user` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3236">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="e0ac9-3237">È possibile specificare "." per il `user` parametro per indicare il computer locale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3237">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="e0ac9-3238">Le autorizzazioni assegnate tramite <xref:System.Messaging.MessageQueue.SetPermissions%2A> aggiungere le autorizzazioni per l'elenco esistente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3238">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="e0ac9-3239">Per impostazione predefinita, l'autore di una coda pubblica o privata abbia il pieno controllo e il gruppo di dominio Everyone dispone dell'autorizzazione per ottenere le proprietà della coda, ottenere le autorizzazioni e scrivere nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3239">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="e0ac9-3240">Quando si chiama <xref:System.Messaging.MessageQueue.SetPermissions%2A>, le informazioni utente e le autorizzazioni vengono aggiunte alla fine dell'elenco esistente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3240">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="e0ac9-3241">Il sistema esamina ciascuna <xref:System.Messaging.AccessControlEntry> in sequenza fino a quando non si verifica uno degli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3241">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="e0ac9-3242">Un accesso negato <xref:System.Messaging.AccessControlEntry> nega in modo esplicito uno qualsiasi dei diritti di accesso richiesto a una delle fiduciari elencati nel token di accesso del thread.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3242">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="e0ac9-3243">Uno o più Autorizzazione dell'accesso <xref:System.Messaging.AccessControlEntry> elementi per tutti i diritti di accesso richiesto di concessione fiduciari elencati nel token di accesso del thread in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3243">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="e0ac9-3244">Tutti i <xref:System.Messaging.AccessControlEntry> articoli sono stati verificati e vi è ancora presente almeno un diritto di accesso che non è stato esplicitamente concesso, nel qual caso, l'accesso viene implicitamente negato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3244">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="e0ac9-3245">I diritti a una coda, specificato nella `rights` parametro, può essere qualsiasi combinazione delle opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3245">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="e0ac9-3246">Controllo completo</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3246">Full Control</span></span>  
  
-   <span data-ttu-id="e0ac9-3247">Eliminare messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3247">Delete Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3248">Ricezione messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3248">Receive Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3249">Visualizza il messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3249">Peek Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3250">Ricevi messaggio Journal</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3250">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3251">Ottenere le proprietà della coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3251">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="e0ac9-3252">Impostare le proprietà della coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3252">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="e0ac9-3253">Ottenere le autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3253">Get Permissions</span></span>  
  
-   <span data-ttu-id="e0ac9-3254">Impostare le autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3254">Set Permissions</span></span>  
  
-   <span data-ttu-id="e0ac9-3255">Assumere la proprietà di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3255">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="e0ac9-3256">WriteMessage</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3256">Write Message</span></span>  
  
 <span data-ttu-id="e0ac9-3257">Il <xref:System.Messaging.MessageQueueAccessRights> enumerazione rappresenta un set di flag di bit che è possibile combinare l'uso dell'operatore OR bit per bit o per compilare il `rights` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3257">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-3258">Con questo overload, è possibile concedere solo autorizzazioni. non è possibile revocare o negare loro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3258">With this overload, you can only grant permissions; you cannot revoke or deny them.</span></span> <span data-ttu-id="e0ac9-3259">È necessario usare un overload diverso per concedere in modo esplicito qualsiasi <xref:System.Messaging.AccessControlEntryType> diverso da `Allow`.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3259">You must use a different overload to explicitly grant any <xref:System.Messaging.AccessControlEntryType> other than `Allow`.</span></span>  
  
 <span data-ttu-id="e0ac9-3260">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3260">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3261">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3261">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3262">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3262">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3263">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3263">Local computer</span></span>|<span data-ttu-id="e0ac9-3264">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3264">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3265">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3265">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3266">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3266">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3267">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3267">Remote computer</span></span>|<span data-ttu-id="e0ac9-3268">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3268">No</span></span>|  
|<span data-ttu-id="e0ac9-3269">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3269">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3270">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3270">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3271">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3271">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#23](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#23)]
 [!code-csharp[MessageQueue2#23](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#23)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="e0ac9-3272">L'elemento <paramref name="user" /> è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3272">The <paramref name="user" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3273">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3273">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights, System.Messaging.AccessControlEntryType entryType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights, valuetype System.Messaging.AccessControlEntryType entryType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights,System.Messaging.AccessControlEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights, entryType As AccessControlEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights, System::Messaging::AccessControlEntryType entryType);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : string * System.Messaging.MessageQueueAccessRights * System.Messaging.AccessControlEntryType -&gt; unit" Usage="messageQueue.SetPermissions (user, rights, entryType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
        <Parameter Name="entryType" Type="System.Messaging.AccessControlEntryType" />
      </Parameters>
      <Docs>
        <param name="user">
          <span data-ttu-id="e0ac9-3274">Singolo utente, gruppo o computer che ottiene ulteriori diritti per la coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3274">The individual, group, or computer that gets additional rights to the queue.</span>
          </span>
        </param>
        <param name="rights">
          <span data-ttu-id="e0ac9-3275">Elemento <see cref="T:System.Messaging.MessageQueueAccessRights" /> che indica il set di diritti per la coda assegnati da Accodamento messaggi al parametro <c>user</c> passato.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3275">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <c>user</c> passed in.</span>
          </span>
        </param>
        <param name="entryType">
          <span data-ttu-id="e0ac9-3276">Elemento <see cref="T:System.Messaging.AccessControlEntryType" /> che specifica se concedere, negare o revocare le autorizzazioni specificate dal parametro <c>rights</c>.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3276">A <see cref="T:System.Messaging.AccessControlEntryType" /> that specifies whether to grant, deny, or revoke the permissions specified by the <c>rights</c> parameter.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="e0ac9-3277">Concede a un computer, a un utente o a un gruppo di utenti i diritti di accesso specificati con il tipo di controllo di accesso specificato (concessione, rifiuto, revoca o impostazione).</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3277">Gives a computer, group, or user the specified access rights, with the specified access control type (allow, deny, revoke, or set).</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3278">Utilizzare questo overload per concedere, negare o revocare i diritti specificati per un singolo utente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3278">Use this overload to grant, deny, or revoke specified rights for an individual user.</span></span> <span data-ttu-id="e0ac9-3279">L'utente può essere qualsiasi fiduciario valido, che include i singoli utenti, gruppi di utenti o un computer.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3279">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="e0ac9-3280">Se l'utente è una persona, usare il formato `DOMAIN` \\ `user` per il `user` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3280">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="e0ac9-3281">È possibile specificare "." per il `user` parametro per indicare il computer locale.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3281">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="e0ac9-3282">Le autorizzazioni assegnate tramite <xref:System.Messaging.MessageQueue.SetPermissions%2A> aggiungere le autorizzazioni per l'elenco esistente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3282">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="e0ac9-3283">Per impostazione predefinita, l'autore di una coda pubblica o privata abbia il pieno controllo e il gruppo di dominio Everyone dispone dell'autorizzazione per ottenere le proprietà della coda, ottenere le autorizzazioni e scrivere nella coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3283">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="e0ac9-3284">Quando si chiama <xref:System.Messaging.MessageQueue.SetPermissions%2A>, le informazioni utente e le autorizzazioni vengono aggiunte alla fine dell'elenco esistente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3284">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="e0ac9-3285">Il sistema esamina ciascuna <xref:System.Messaging.AccessControlEntry> in sequenza fino a quando non si verifica uno degli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3285">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="e0ac9-3286">Un accesso negato <xref:System.Messaging.AccessControlEntry> nega in modo esplicito uno qualsiasi dei diritti di accesso richiesto a una delle fiduciari elencati nel token di accesso del thread.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3286">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="e0ac9-3287">Uno o più Autorizzazione dell'accesso <xref:System.Messaging.AccessControlEntry> elementi per tutti i diritti di accesso richiesto di concessione fiduciari elencati nel token di accesso del thread in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3287">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="e0ac9-3288">Tutti i <xref:System.Messaging.AccessControlEntry> articoli sono stati verificati e vi è ancora presente almeno un diritto di accesso che non è stato esplicitamente concesso, nel qual caso, l'accesso viene implicitamente negato.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3288">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="e0ac9-3289">I diritti a una coda, specificato nella `rights` parametro, può essere qualsiasi combinazione delle opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3289">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="e0ac9-3290">Controllo completo</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3290">Full Control</span></span>  
  
-   <span data-ttu-id="e0ac9-3291">Eliminare messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3291">Delete Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3292">Ricezione messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3292">Receive Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3293">Visualizza il messaggio</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3293">Peek Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3294">Ricevi messaggio Journal</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3294">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="e0ac9-3295">Ottenere le proprietà della coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3295">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="e0ac9-3296">Impostare le proprietà della coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3296">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="e0ac9-3297">Ottenere le autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3297">Get Permissions</span></span>  
  
-   <span data-ttu-id="e0ac9-3298">Impostare le autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3298">Set Permissions</span></span>  
  
-   <span data-ttu-id="e0ac9-3299">Assumere la proprietà di coda</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3299">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="e0ac9-3300">WriteMessage</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3300">Write Message</span></span>  
  
 <span data-ttu-id="e0ac9-3301">Il <xref:System.Messaging.MessageQueueAccessRights> enumerazione rappresenta un set di flag di bit che è possibile combinare l'uso dell'operatore OR bit per bit o per compilare il `rights` parametro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3301">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="e0ac9-3302">Nella tabella seguente indica se questo metodo è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3302">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3303">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3303">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3304">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3304">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3305">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3305">Local computer</span></span>|<span data-ttu-id="e0ac9-3306">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3306">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3307">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3307">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3308">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3308">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3309">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3309">Remote computer</span></span>|<span data-ttu-id="e0ac9-3310">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3310">No</span></span>|  
|<span data-ttu-id="e0ac9-3311">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3311">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3312">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3312">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3313">L'esempio di codice seguente illustra l'uso di <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3313">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#25](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#25)]
 [!code-csharp[MessageQueue2#25](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#25)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3314">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3314">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.AccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SynchronizingObject : System.ComponentModel.ISynchronizeInvoke with get, set" Usage="System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_SynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-3315">Ottiene o imposta l'oggetto utilizzato per effettuare il marshalling della chiamata al gestore eventi risultante da un evento <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> o <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3315">Gets or sets the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-3316">Oggetto <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> che rappresenta l'oggetto utilizzato per effettuare il marshalling della chiamata al gestore eventi risultante da un evento <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> o <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3316">A <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, which represents the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span>
          </span>
          <span data-ttu-id="e0ac9-3317">Il valore predefinito è <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3317">The default is <see langword="null" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3318">Oggetto <xref:System.Messaging.MessageQueue.ReceiveCompleted> oppure <xref:System.Messaging.MessageQueue.PeekCompleted> evento risultante da una <xref:System.Messaging.MessageQueue.BeginReceive%2A> o <xref:System.Messaging.MessageQueue.BeginPeek%2A> richiedere, rispettivamente, a un thread specifico.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3318">A <xref:System.Messaging.MessageQueue.ReceiveCompleted> or <xref:System.Messaging.MessageQueue.PeekCompleted> event results from a <xref:System.Messaging.MessageQueue.BeginReceive%2A> or <xref:System.Messaging.MessageQueue.BeginPeek%2A> request, respectively, to a specific thread.</span></span> <span data-ttu-id="e0ac9-3319">In genere, il <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> viene impostato quando il relativo componente viene posizionato all'interno di un controllo o un form, in quanto tali componenti vengono associati a un thread specifico.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3319">Typically, the <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> is set when its related component is placed inside a control or a form, because those components are bound to a specific thread.</span></span>  
  
 <span data-ttu-id="e0ac9-3320">In genere, l'oggetto di sincronizzazione effettua il marshalling di una chiamata al metodo in un singolo thread.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3320">Typically, the synchronizing object marshals a method call into a single thread.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Transactional">
      <MemberSignature Language="C#" Value="public bool Transactional { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Transactional" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Transactional" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transactional As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Transactional { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.Transactional : bool" Usage="System.Messaging.MessageQueue.Transactional" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Transactional")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-3321">Ottiene un valore che indica se la coda accetta solo transazioni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3321">Gets a value that indicates whether the queue accepts only transactions.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-3322">
            <see langword="true" /> se la coda accetta solo messaggi inviati come parte di una transazione; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3322">
              <see langword="true" /> if the queue accepts only messages sent as part of a transaction; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3323">La messaggistica transazionale si intende l'accoppiamento di diversi messaggi correlati in un'unica transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3323">Transactional messaging refers to the coupling of several related messages into a single transaction.</span></span> <span data-ttu-id="e0ac9-3324">L'invio di messaggi come parte di una transazione garantisce che i messaggi vengano recapitati in ordine, recapitato una sola volta e recuperato correttamente dalla propria coda di destinazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3324">Sending messages as part of a transaction ensures that the messages are delivered in order, delivered only once, and successfully retrieved from their destination queue.</span></span>  
  
 <span data-ttu-id="e0ac9-3325">Se la coda è transazionale, accetta solo messaggi che vengono inviati come parte di una transazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3325">If a queue is transactional, it accepts only messages that are sent as part of a transaction.</span></span> <span data-ttu-id="e0ac9-3326">Tuttavia, un messaggio non transazionale può essere inviato o ricevuto da una coda di transazione locale senza in modo esplicito usando transazionali <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, e <xref:System.Messaging.MessageQueueTransaction.Abort%2A> sintassi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3326">However, a non-transactional message can be sent or received from a local transaction queue without explicitly using transactional <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, and <xref:System.Messaging.MessageQueueTransaction.Abort%2A> syntax.</span></span> <span data-ttu-id="e0ac9-3327">Se viene inviato un messaggio non transazionale a una coda transazionale, questo componente crea una transazione di messaggio singolo, tranne nel caso che fanno riferimento a una coda in un computer remoto utilizzando un nome di formato direct.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3327">If a non-transactional message is sent to a transactional queue, this component creates a single-message transaction for it, except in the case of referencing a queue on a remote computer using a direct format name.</span></span> <span data-ttu-id="e0ac9-3328">In questo caso, se non si specifica un contesto di transazione quando si invia un messaggio, non ne viene creato automaticamente e verrà inviato il messaggio per la coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3328">In this situation, if you do not specify a transaction context when sending a message, one is not created for you and the message will be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="e0ac9-3329">Se si invia un messaggio non transazionale a una coda transazionale, non sarà in grado di eseguire il rollback il messaggio in caso di un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3329">If you send a non-transactional message to a transactional queue, you will not be able to roll back the message in the event of an exception.</span></span>  
  
 <span data-ttu-id="e0ac9-3330"><xref:System.Messaging.MessageQueueTransaction> il threading apartment, pertanto se lo stato di apartment è `STA`, è possibile utilizzare la transazione in più thread.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3330"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="e0ac9-3331">Visual Basic imposta lo stato del thread principale per `STA`, pertanto è necessario applicare il <xref:System.MTAThreadAttribute> nel `Main` subroutine.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3331">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="e0ac9-3332">In caso contrario, l'invio di un messaggio transazionale mediante un altro thread genererà un'eccezione <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3332">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="e0ac9-3333">Si applica il <xref:System.MTAThreadAttribute> usando il frammento seguente.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3333">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="e0ac9-3334">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3334">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3335">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3335">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3336">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3336">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3337">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3337">Local computer</span></span>|<span data-ttu-id="e0ac9-3338">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3338">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3339">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3339">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3340">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3340">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3341">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3341">Remote computer</span></span>|<span data-ttu-id="e0ac9-3342">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3342">No</span></span>|  
|<span data-ttu-id="e0ac9-3343">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3343">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3344">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3344">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3345">Esempio di codice seguente consente di visualizzare il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.Transactional%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3345">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Transactional%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3346">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3346">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Begin" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Commit" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Abort" />
        <altmember cref="P:System.Messaging.Message.TransactionId" />
        <altmember cref="P:System.Messaging.Message.IsFirstInTransaction" />
        <altmember cref="P:System.Messaging.Message.IsLastInTransaction" />
      </Docs>
    </Member>
    <Member MemberName="UseJournalQueue">
      <MemberSignature Language="C#" Value="public bool UseJournalQueue { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool UseJournalQueue" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberSignature Language="VB.NET" Value="Public Property UseJournalQueue As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool UseJournalQueue { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.UseJournalQueue : bool with get, set" Usage="System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_UseJournalQueue")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-3347">Ottiene o imposta un valore che indica se i messaggi ricevuti vengono copiati nella coda del giornale di registrazione.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3347">Gets or sets a value that indicates whether received messages are copied to the journal queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-3348">
            <see langword="true" /> se i messaggi ricevuti dalla coda vengono copiati nella relativa coda del journal; in caso contrario, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3348">
              <see langword="true" /> if messages received from the queue are copied to its journal queue; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3349">Quando l'applicazione di Accodamento messaggi consente di creare una nuova coda dell'applicazione, viene creato automaticamente una coda del journal associata nello stesso percorso.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3349">When the Message Queuing application creates a new application queue, it automatically creates an associated journal queue in the same location.</span></span> <span data-ttu-id="e0ac9-3350">Consente di rilevare i messaggi rimossi da una coda nella coda journal.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3350">The journal queue is used to track the messages removed from a queue.</span></span> <span data-ttu-id="e0ac9-3351">Impostando questa proprietà viene modificata la coda di Accodamento messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3351">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="e0ac9-3352">Pertanto, qualsiasi altro <xref:System.Messaging.MessageQueue> istanze sono interessate dalla modifica.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3352">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="e0ac9-3353">La coda del giornale di registrazione non rileva messaggi rimossi dalla coda in quanto i timer all'ora di ricezione è scaduto, né tiene traccia dei messaggi eliminati dalla coda con un servizio di directory, Accodamento messaggi (informazioni Store o Active Directory).</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3353">The journal queue does not track messages removed from the queue because their time-to-be-received timer expired, nor does it track messages purged from the queue by using a Message Queuing directory service (Information Store or Active Directory).</span></span>  
  
 <span data-ttu-id="e0ac9-3354">Le applicazioni non è possibile inviare messaggi alle code journal; sono limitate a accesso in sola lettura di queste code.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3354">Applications cannot send messages to journal queues; they are limited to read-only access of these queues.</span></span> <span data-ttu-id="e0ac9-3355">Inoltre, il servizio Accodamento messaggi mai rimuove i messaggi dalle code di registrazione.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3355">Furthermore, Message Queuing never removes messages from journal queues.</span></span> <span data-ttu-id="e0ac9-3356">L'applicazione che utilizza la coda è necessario deselezionare questi messaggi riceverli oppure eliminando la coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3356">The application using the queue must clear these messages either by receiving them or by purging the queue.</span></span>  
  
 <span data-ttu-id="e0ac9-3357">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3357">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3358">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3358">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3359">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3359">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3360">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3360">Local computer</span></span>|<span data-ttu-id="e0ac9-3361">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3361">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3362">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3362">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3363">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3363">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3364">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3364">Remote computer</span></span>|<span data-ttu-id="e0ac9-3365">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3365">No</span></span>|  
|<span data-ttu-id="e0ac9-3366">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3366">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3367">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3367">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="e0ac9-3368">Esempio di codice seguente ottiene e imposta il valore di una coda di messaggi <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3368">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3369">Si è verificato un errore durante l'accesso a un metodo di Accodamento messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3369">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      </Docs>
    </Member>
    <Member MemberName="WriteHandle">
      <MemberSignature Language="C#" Value="public IntPtr WriteHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int WriteHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.WriteHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property WriteHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr WriteHandle { IntPtr get(); };" />
      <MemberSignature Language="F#" Value="member this.WriteHandle : nativeint" Usage="System.Messaging.MessageQueue.WriteHandle" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="e0ac9-3370">Ottiene l'handle nativo utilizzato per inviare messaggi alla coda di messaggi.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3370">Gets the native handle used to send messages to the message queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="e0ac9-3371">Handle all'oggetto coda nativo utilizzato per inviare messaggi alla coda.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3371">A handle to the native queue object that you use for sending messages to the queue.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="e0ac9-3372">Il <xref:System.Messaging.MessageQueue.WriteHandle%2A> fornisce un handle nativo di Windows all'oggetto coda di messaggi che viene usato per l'invio di messaggi alla coda.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3372">The <xref:System.Messaging.MessageQueue.WriteHandle%2A> provides a native Windows handle to the message queue object that is used for sending messages to the queue.</span></span> <span data-ttu-id="e0ac9-3373">Se si modifica il percorso della coda, l'handle viene chiusa e riaperta con un nuovo valore.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3373">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="e0ac9-3374">Nella tabella seguente indica se questa proprietà è disponibile in varie modalità gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3374">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="e0ac9-3375">Modalità gruppo di lavoro</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3375">Workgroup mode</span></span>|<span data-ttu-id="e0ac9-3376">Disponibile</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3376">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="e0ac9-3377">Computer locale</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3377">Local computer</span></span>|<span data-ttu-id="e0ac9-3378">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3378">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3379">Computer locale e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3379">Local computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3380">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3380">Yes</span></span>|  
|<span data-ttu-id="e0ac9-3381">Computer remoto</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3381">Remote computer</span></span>|<span data-ttu-id="e0ac9-3382">No</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3382">No</span></span>|  
|<span data-ttu-id="e0ac9-3383">Computer remoto e il nome di formato direct</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3383">Remote computer and direct format name</span></span>|<span data-ttu-id="e0ac9-3384">Yes</span><span class="sxs-lookup"><span data-stu-id="e0ac9-3384">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="e0ac9-3385">La coda di messaggi non è disponibile per la scrittura.</span>
          <span class="sxs-lookup">
            <span data-stu-id="e0ac9-3385">The message queue is not available for writing.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
  </Members>
</Type>